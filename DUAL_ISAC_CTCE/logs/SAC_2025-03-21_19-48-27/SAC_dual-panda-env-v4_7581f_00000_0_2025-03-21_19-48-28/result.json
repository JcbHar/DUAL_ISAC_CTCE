{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400, "num_agent_steps_trained": 0, "num_env_steps_sampled": 200, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 200, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 176.42837102460268, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 200, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 400, "timers": {"training_iteration_time_ms": 1133.605, "sample_time_ms": 316.411}, "counters": {"num_env_steps_sampled": 200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "7581f_00000", "date": "2025-03-21_19-48-53", "timestamp": 1742586533, "time_this_iter_s": 1.1382033824920654, "time_total_s": 1.1382033824920654, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57C6700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1.1382033824920654, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.8, "ram_util_percent": 89.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 0, "num_env_steps_sampled": 800, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 521.7345441850013, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 800, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1600, "timers": {"training_iteration_time_ms": 570.904, "sample_time_ms": 319.27}, "counters": {"num_env_steps_sampled": 800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "7581f_00000", "date": "2025-03-21_19-48-55", "timestamp": 1742586535, "time_this_iter_s": 1.1551477909088135, "time_total_s": 2.293351173400879, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A574EA60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 2.293351173400879, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.1, "ram_util_percent": 88.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 1400, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2800, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800, "num_agent_steps_trained": 0, "num_env_steps_sampled": 1400, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 527.8621767933249, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 1400, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2800, "timers": {"training_iteration_time_ms": 488.611, "sample_time_ms": 319.445}, "counters": {"num_env_steps_sampled": 1400, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2800, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "7581f_00000", "date": "2025-03-21_19-48-56", "timestamp": 1742586536, "time_this_iter_s": 1.1366603374481201, "time_total_s": 3.430011510848999, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57C68B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 3.430011510848999, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 52.4, "ram_util_percent": 88.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.415414810180664, "actor_loss": -5.423704147338867, "critic_loss": 7.445570468902588, "alpha_loss": -0.004024623427540064, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.000299999926937744, "target_entropy": -8.0, "policy_t": 0.004338741302490234, "mean_q": 0.010121150873601437, "max_q": 0.020560037344694138, "min_q": 0.0035478747449815273}, "td_error": [8.823452949523926, 8.344731330871582, 8.6629638671875, 8.083883285522461, 9.046857833862305, 8.136161804199219, 8.343708038330078, 7.9199419021606445, 8.547574996948242, 8.248824119567871, 8.157965660095215, 8.103872299194336, 6.81052303314209, 8.478857040405273, 7.721728324890137, 8.699856758117676, 8.501953125, 8.78520393371582, 7.872078895568848, 8.161226272583008, 7.747097969055176, 9.06794548034668, 8.42641830444336, 8.932283401489258, 8.388143539428711, 7.924046516418457, 10.280538558959961, 7.956520080566406, 6.71563196182251, 8.221049308776855, 8.621838569641113, 8.237798690795898, 9.552732467651367, 8.294929504394531, 9.971247673034668, 9.695564270019531, 7.982644081115723, 8.504298210144043, 8.660518646240234, 8.398026466369629, 9.778205871582031, 8.33109188079834, 7.142733573913574, 9.777423858642578, 8.224422454833984, 9.57669448852539, 8.722039222717285, 8.24748420715332, 9.122262954711914, 9.48965072631836, 8.523109436035156, 8.608673095703125, 8.476646423339844, 8.004327774047852, 8.878244400024414, 8.220890045166016, 8.405620574951172, 8.227456092834473, 7.669231414794922, 8.611021041870117, 7.065831184387207, 8.455795288085938, 8.820541381835938, 9.193012237548828, 8.923572540283203, 8.149471282958984, 8.40199089050293, 9.4572172164917, 8.361345291137695, 8.731168746948242, 8.119474411010742, 8.617240905761719, 8.522981643676758, 7.839766025543213, 8.781818389892578, 7.525943756103516, 9.162910461425781, 7.578289031982422, 7.298290729522705, 9.144979476928711, 8.9407320022583, 7.955414295196533, 7.286267280578613, 8.484664916992188, 7.953075408935547, 8.573420524597168, 8.463895797729492, 8.218928337097168, 9.39334774017334, 7.925533294677734, 8.923351287841797, 7.233098030090332, 7.433146953582764, 8.845907211303711, 9.752346992492676, 8.51895523071289, 8.110225677490234, 8.606864929199219, 8.687164306640625, 8.141061782836914, 7.0706281661987305, 9.602885246276855, 9.872743606567383, 9.127197265625, 8.790934562683105, 8.478917121887207, 8.390739440917969, 9.532848358154297, 7.822607040405273, 8.043121337890625, 8.026275634765625, 7.369698524475098, 8.178438186645508, 8.581398010253906, 7.188615798950195, 8.381985664367676, 8.829854965209961, 7.905813217163086, 8.299520492553711, 8.451358795166016, 9.862435340881348, 8.998491287231445, 8.05465316772461, 8.087203979492188, 8.868040084838867, 8.31805419921875, 9.783400535583496, 8.118077278137207], "mean_td_error": 8.458616256713867, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.40594482421875, "actor_loss": -5.413572788238525, "critic_loss": 7.6663970947265625, "alpha_loss": -0.004021783359348774, "alpha_value": 0.9997000694274902, "log_alpha_value": -0.00029999998514540493, "target_entropy": -8.0, "policy_t": 0.008343004621565342, "mean_q": 0.011927367188036442, "max_q": 0.024327002465724945, "min_q": 0.00667115394026041}, "td_error": [8.881919860839844, 9.334844589233398, 9.06832504272461, 8.956367492675781, 8.565832138061523, 8.529033660888672, 7.975979804992676, 9.013702392578125, 7.764827728271484, 9.757157325744629, 7.712405681610107, 8.577982902526855, 8.195423126220703, 7.887144088745117, 9.097443580627441, 8.279243469238281, 8.689453125, 9.111074447631836, 8.307561874389648, 8.476142883300781, 7.972740173339844, 8.861123085021973, 8.151713371276855, 9.958568572998047, 8.893232345581055, 8.933279037475586, 9.449023246765137, 9.03207778930664, 8.046182632446289, 9.325328826904297, 9.131708145141602, 8.567081451416016, 8.113361358642578, 10.606950759887695, 8.170991897583008, 9.07608413696289, 9.042129516601562, 8.036985397338867, 9.049646377563477, 8.073213577270508, 9.294854164123535, 9.603252410888672, 8.018925666809082, 8.965989112854004, 8.64793586730957, 9.186052322387695, 8.767889022827148, 9.131095886230469, 8.59355354309082, 9.031003952026367, 9.527185440063477, 9.220142364501953, 8.792871475219727, 7.382931709289551, 8.322931289672852, 8.319087982177734, 9.901315689086914, 7.740827560424805, 8.516792297363281, 7.661693096160889, 8.861721992492676, 8.680973052978516, 7.977964878082275, 9.367313385009766, 9.160381317138672, 7.800642967224121, 9.276399612426758, 9.694297790527344, 8.887168884277344, 9.863828659057617, 8.496822357177734, 8.883488655090332, 7.742260932922363, 8.550422668457031, 8.178010940551758, 8.961252212524414, 9.512313842773438, 8.892010688781738, 9.407190322875977, 9.7139892578125, 8.45885181427002, 8.141830444335938, 8.189213752746582, 9.05782413482666, 7.959620475769043, 9.091856002807617, 8.810787200927734, 9.029006004333496, 8.791143417358398, 8.066554069519043, 8.609587669372559, 8.807890892028809, 8.136805534362793, 9.127973556518555, 9.471900939941406, 8.486474990844727, 10.005123138427734, 8.482736587524414, 8.446271896362305, 7.863121509552002, 9.32789134979248, 9.31649398803711, 8.034768104553223, 9.376476287841797, 8.572248458862305, 9.31710433959961, 8.549840927124023, 8.988336563110352, 8.070272445678711, 8.405740737915039, 8.99366569519043, 8.616867065429688, 9.822261810302734, 9.536784172058105, 7.874255180358887, 8.712284088134766, 8.685002326965332, 7.944915771484375, 8.64666748046875, 9.059988021850586, 9.224628448486328, 8.783027648925781, 8.713946342468262, 8.533914566040039, 8.659053802490234, 9.635412216186523, 8.899614334106445, 8.322336196899414], "mean_td_error": 8.756769180297852, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0}}, "num_env_steps_sampled": 1800, "num_env_steps_trained": 512, "num_agent_steps_sampled": 3600, "num_agent_steps_trained": 512, "last_target_update_ts": 1800, "num_target_updates": 2}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600, "num_agent_steps_trained": 512, "num_env_steps_sampled": 1800, "num_env_steps_trained": 512, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 370.20923161114075, "num_env_steps_trained_throughput_per_sec": 473.8678164622602, "timesteps_total": 1800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3600, "timers": {"training_iteration_time_ms": 500.083, "sample_time_ms": 315.585, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 59.556, "learn_throughput": 4298.509, "synch_weights_time_ms": 9.693}, "counters": {"num_env_steps_sampled": 1800, "num_env_steps_trained": 512, "num_agent_steps_sampled": 3600, "num_agent_steps_trained": 512, "last_target_update_ts": 1800, "num_target_updates": 2}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "7581f_00000", "date": "2025-03-21_19-48-57", "timestamp": 1742586537, "time_this_iter_s": 1.0961127281188965, "time_total_s": 4.5261242389678955, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57B0C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 4.5261242389678955, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.55, "ram_util_percent": 89.30000000000001}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1839.291728861241, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1960.2941024759666, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.468019485473633, "actor_loss": -5.498042583465576, "critic_loss": 6.987673282623291, "alpha_loss": -0.012122806161642075, "alpha_value": 0.9991002678871155, "log_alpha_value": -0.0009001179714687169, "target_entropy": -8.0, "policy_t": -0.0027242202777415514, "mean_q": 0.035626284778118134, "max_q": 0.07482311129570007, "min_q": 0.020106365904211998}, "td_error": [8.759910583496094, 9.237213134765625, 8.879388809204102, 8.735776901245117, 8.29855728149414, 7.777975082397461, 8.112669944763184, 7.855742454528809, 7.98214054107666, 8.321870803833008, 9.558834075927734, 8.131242752075195, 8.458724021911621, 7.891047477722168, 8.72293472290039, 9.080436706542969, 9.094145774841309, 8.24211311340332, 9.251199722290039, 7.938544750213623, 9.459392547607422, 8.367103576660156, 8.806568145751953, 9.582468032836914, 8.865562438964844, 8.931221961975098, 8.656927108764648, 9.052926063537598, 8.748703956604004, 9.573464393615723, 10.140472412109375, 7.816669464111328, 9.594996452331543, 8.484773635864258, 8.105714797973633, 7.585088729858398, 7.5434370040893555, 8.640999794006348, 8.12164306640625, 8.773981094360352, 8.312713623046875, 7.886599540710449, 9.238478660583496, 7.864169120788574, 7.404363632202148, 9.738460540771484, 8.283817291259766, 9.479803085327148, 8.291958808898926, 9.23812484741211, 8.5855073928833, 8.977727890014648, 10.302886962890625, 8.87407398223877, 7.602458953857422, 8.631227493286133, 8.71754264831543, 8.030192375183105, 8.703119277954102, 8.845959663391113, 8.989450454711914, 9.312522888183594, 7.575188636779785, 8.444524765014648, 8.534383773803711, 8.453893661499023, 7.608327865600586, 7.557003974914551, 8.722478866577148, 9.116260528564453, 9.324426651000977, 9.385149002075195, 7.088824272155762, 7.9936370849609375, 9.475796699523926, 9.32247543334961, 8.180105209350586, 8.749311447143555, 9.573432922363281, 7.969882011413574, 9.765400886535645, 7.7774248123168945, 8.885272026062012, 8.645259857177734, 10.424592971801758, 7.952175140380859, 7.05217981338501, 8.844289779663086, 9.13385009765625, 8.368056297302246, 8.77030086517334, 7.104240417480469, 8.248108863830566, 8.575263977050781, 8.44195556640625, 8.727999687194824, 8.721744537353516, 7.5072174072265625, 8.957740783691406, 9.36546516418457, 9.062966346740723, 8.01352596282959, 8.63176155090332, 9.783317565917969, 8.853988647460938, 8.241324424743652, 8.485143661499023, 8.522855758666992, 9.763429641723633, 9.099937438964844, 9.090166091918945, 6.801578521728516, 9.731868743896484, 8.02151870727539, 9.110939979553223, 8.453192710876465, 10.575075149536133, 9.490729331970215, 8.951906204223633, 7.620631217956543, 8.413593292236328, 10.299497604370117, 8.254432678222656, 7.582310676574707, 8.117022514343262, 9.320493698120117, 8.930641174316406, 9.140974998474121], "mean_td_error": 8.650017738342285, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.458758354187012, "actor_loss": -5.489969253540039, "critic_loss": 7.123465538024902, "alpha_loss": -0.012113829143345356, "alpha_value": 0.9991003274917603, "log_alpha_value": -0.0009000702993944287, "target_entropy": -8.0, "policy_t": 0.015390152111649513, "mean_q": 0.04019996523857117, "max_q": 0.06307501345872879, "min_q": 0.02114810422062874}, "td_error": [9.199106216430664, 8.345468521118164, 9.61314582824707, 8.204179763793945, 9.739107131958008, 9.752616882324219, 9.320259094238281, 8.959994316101074, 8.588912010192871, 9.411575317382812, 9.709465026855469, 8.695594787597656, 8.043631553649902, 9.480329513549805, 7.70578670501709, 8.84111499786377, 8.669029235839844, 8.60217571258545, 8.90225601196289, 7.585399150848389, 8.220758438110352, 9.42353630065918, 8.159822463989258, 8.947688102722168, 8.98967170715332, 9.876611709594727, 8.656230926513672, 8.221298217773438, 8.697254180908203, 8.660972595214844, 9.186634063720703, 9.38151741027832, 9.003619194030762, 8.016950607299805, 9.84471321105957, 8.9703369140625, 9.03307819366455, 7.592987060546875, 8.541778564453125, 8.93389892578125, 8.369470596313477, 8.491565704345703, 8.704977035522461, 8.729758262634277, 8.245149612426758, 9.322161674499512, 8.622621536254883, 8.37501049041748, 7.853355407714844, 9.960918426513672, 8.763151168823242, 7.798623085021973, 7.923150062561035, 9.221336364746094, 9.909317016601562, 9.89544677734375, 9.094755172729492, 8.45289421081543, 8.25085163116455, 8.984269142150879, 8.985557556152344, 8.815373420715332, 7.150547027587891, 8.389066696166992, 8.460700988769531, 7.531345367431641, 9.03807258605957, 8.960055351257324, 8.540502548217773, 10.068986892700195, 9.667123794555664, 9.591413497924805, 8.85463809967041, 8.881707191467285, 9.089822769165039, 8.427118301391602, 7.45240592956543, 7.63934850692749, 8.301766395568848, 9.890796661376953, 7.259751319885254, 9.100605010986328, 8.978490829467773, 8.744840621948242, 7.896458625793457, 8.1986083984375, 9.549511909484863, 9.64516830444336, 8.545303344726562, 9.154623031616211, 8.239980697631836, 8.02237319946289, 8.88835620880127, 9.10601806640625, 8.518302917480469, 7.458557605743408, 9.02377986907959, 9.248559951782227, 8.875455856323242, 8.172889709472656, 8.949174880981445, 8.806131362915039, 7.922696590423584, 8.263519287109375, 10.306979179382324, 7.3172197341918945, 8.630752563476562, 9.199993133544922, 9.563652992248535, 9.034127235412598, 8.321239471435547, 9.63716983795166, 8.441810607910156, 9.492438316345215, 8.004785537719727, 9.28096866607666, 9.18247127532959, 8.672403335571289, 8.63066291809082, 8.37398910522461, 8.712943077087402, 9.110652923583984, 8.938735961914062, 7.91202449798584, 9.648384094238281, 8.42544174194336, 7.467686653137207, 9.141851425170898], "mean_td_error": 8.753524780273438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 3.0}}, "num_env_steps_sampled": 2200, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 4400, "num_agent_steps_trained": 1024, "last_target_update_ts": 2200, "num_target_updates": 4}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3799.5858313372073, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1839.291728861241, "robot_1": 1960.2941024759666}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1839.291728861241, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1960.2941024759666, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8651673685617325, "mean_inference_ms": 3.9256316780394953, "mean_action_processing_ms": 0.5483202190018392, "mean_env_wait_ms": 0.515293404324734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08450448513031006}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3799.5858313372073, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1839.291728861241, "robot_1": 1960.2941024759666}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8651673685617325, "mean_inference_ms": 3.9256316780394953, "mean_action_processing_ms": 0.5483202190018392, "mean_env_wait_ms": 0.515293404324734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08450448513031006}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 2200, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 311.1054327317568, "num_env_steps_trained_throughput_per_sec": 398.21495389664875, "timesteps_total": 2200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4400, "timers": {"training_iteration_time_ms": 465.288, "sample_time_ms": 318.706, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 49.703, "learn_throughput": 5150.644, "synch_weights_time_ms": 9.973}, "counters": {"num_env_steps_sampled": 2200, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 4400, "num_agent_steps_trained": 1024, "last_target_update_ts": 2200, "num_target_updates": 4}, "done": false, "episodes_total": 4, "training_iteration": 5, "trial_id": "7581f_00000", "date": "2025-03-21_19-48-58", "timestamp": 1742586538, "time_this_iter_s": 1.305138111114502, "time_total_s": 5.8312623500823975, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A587F160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 5.8312623500823975, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.0, "ram_util_percent": 88.4}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1839.291728861241, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1960.2941024759666, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.417900085449219, "actor_loss": -5.471830368041992, "critic_loss": 6.378629684448242, "alpha_loss": -0.020131047815084457, "alpha_value": 0.9985008239746094, "log_alpha_value": -0.0015003127045929432, "target_entropy": -8.0, "policy_t": -0.021055860444903374, "mean_q": 0.06345715373754501, "max_q": 0.10918702930212021, "min_q": 0.03658211976289749}, "td_error": [9.414052963256836, 9.341001510620117, 9.687414169311523, 7.6167402267456055, 8.708124160766602, 8.634170532226562, 7.55391263961792, 9.507192611694336, 9.526555061340332, 8.668136596679688, 8.086939811706543, 8.272216796875, 7.959593772888184, 8.831565856933594, 8.05463981628418, 7.753848552703857, 9.562379837036133, 7.850766181945801, 7.956489562988281, 8.75364875793457, 8.925299644470215, 8.241804122924805, 9.008489608764648, 8.712158203125, 8.759958267211914, 7.770275115966797, 7.359781742095947, 8.512125015258789, 8.498100280761719, 9.246883392333984, 8.479482650756836, 7.968670845031738, 9.278665542602539, 8.601043701171875, 9.13424015045166, 8.278291702270508, 7.454573631286621, 8.566253662109375, 8.703030586242676, 8.111638069152832, 8.665555953979492, 9.500345230102539, 8.55178451538086, 9.288209915161133, 8.75346565246582, 8.738426208496094, 8.229680061340332, 8.503793716430664, 8.776153564453125, 8.54930591583252, 9.533102035522461, 8.851521492004395, 8.14334487915039, 8.911355018615723, 9.512813568115234, 8.763750076293945, 8.673186302185059, 9.003535270690918, 9.245904922485352, 7.420452117919922, 8.660614013671875, 9.690381050109863, 8.066516876220703, 8.821015357971191, 7.709202766418457, 8.544471740722656, 9.158428192138672, 8.344335556030273, 7.794380187988281, 8.544780731201172, 8.290677070617676, 7.991944313049316, 8.071322441101074, 7.935955047607422, 7.498833656311035, 7.286893844604492, 8.215883255004883, 8.414522171020508, 7.807712554931641, 9.995407104492188, 8.134395599365234, 8.406417846679688, 8.563285827636719, 8.66415023803711, 8.4389066696167, 7.977588176727295, 8.503074645996094, 8.808588027954102, 9.164142608642578, 8.007319450378418, 9.221738815307617, 8.416730880737305, 7.087074279785156, 8.82152271270752, 7.949280738830566, 7.790665626525879, 9.148892402648926, 9.235530853271484, 9.349808692932129, 9.535619735717773, 8.621105194091797, 8.875476837158203, 9.367947578430176, 9.482051849365234, 7.610790252685547, 9.234966278076172, 9.746722221374512, 8.133819580078125, 8.570051193237305, 8.600982666015625, 7.190682888031006, 7.861304759979248, 8.355965614318848, 8.25912094116211, 8.16645622253418, 8.844525337219238, 8.6499662399292, 7.52048397064209, 8.617757797241211, 9.209699630737305, 8.094792366027832, 9.018458366394043, 8.662785530090332, 7.897424697875977, 9.042129516601562, 8.057903289794922, 8.128271102905273, 8.332735061645508], "mean_td_error": 8.540533065795898, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.450275421142578, "actor_loss": -5.50480318069458, "critic_loss": 6.665378570556641, "alpha_loss": -0.020179344341158867, "alpha_value": 0.9985008239746094, "log_alpha_value": -0.0015002922154963017, "target_entropy": -8.0, "policy_t": -0.021714547649025917, "mean_q": 0.07186773419380188, "max_q": 0.11285188049077988, "min_q": 0.03537090867757797}, "td_error": [9.361903190612793, 8.572754859924316, 8.683916091918945, 10.031240463256836, 8.523630142211914, 9.038479804992676, 8.502998352050781, 8.196170806884766, 8.82878303527832, 9.098082542419434, 8.054397583007812, 8.103813171386719, 8.812990188598633, 8.61003303527832, 8.53671646118164, 9.110490798950195, 9.827369689941406, 6.956125259399414, 8.346099853515625, 8.583369255065918, 10.526942253112793, 8.368317604064941, 9.592500686645508, 7.844830513000488, 8.67630386352539, 9.23083209991455, 8.604970932006836, 8.546000480651855, 8.225360870361328, 8.249629974365234, 8.06178092956543, 8.880496978759766, 9.04611873626709, 8.623605728149414, 8.519889831542969, 9.253629684448242, 8.653621673583984, 8.67452335357666, 8.627408981323242, 7.717299461364746, 9.333768844604492, 8.008584022521973, 8.977108001708984, 8.015373229980469, 8.072829246520996, 8.452202796936035, 8.430227279663086, 8.466651916503906, 8.740842819213867, 9.77834701538086, 8.696784973144531, 8.740617752075195, 8.999345779418945, 9.315752983093262, 8.937508583068848, 8.208468437194824, 7.340579986572266, 8.699552536010742, 8.135332107543945, 7.507020950317383, 9.466516494750977, 9.58260726928711, 8.176734924316406, 8.383674621582031, 7.69827938079834, 8.235233306884766, 9.123027801513672, 9.348899841308594, 8.76213264465332, 8.760995864868164, 8.000564575195312, 8.462955474853516, 7.8556718826293945, 9.45776081085205, 8.689435958862305, 9.353464126586914, 8.642759323120117, 8.686943054199219, 9.884810447692871, 9.310163497924805, 8.419839859008789, 9.167745590209961, 8.609550476074219, 9.666961669921875, 8.748454093933105, 9.409624099731445, 8.295209884643555, 8.515670776367188, 8.867944717407227, 9.623690605163574, 8.437164306640625, 8.231586456298828, 8.779170989990234, 7.991045951843262, 8.931146621704102, 8.291961669921875, 9.595610618591309, 9.208718299865723, 9.35702133178711, 9.720678329467773, 9.093059539794922, 9.266464233398438, 8.529701232910156, 7.874209403991699, 8.043970108032227, 8.50273323059082, 8.544271469116211, 9.387144088745117, 8.679743766784668, 8.315025329589844, 8.066190719604492, 8.72567367553711, 8.862836837768555, 7.966683387756348, 8.867798805236816, 9.434106826782227, 8.16279411315918, 9.332008361816406, 8.236886978149414, 8.765251159667969, 8.150606155395508, 9.442373275756836, 9.542231559753418, 8.931862831115723, 6.953639030456543, 9.00631332397461, 8.493911743164062, 9.001203536987305], "mean_td_error": 8.70695686340332, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6.0, "diff_num_grad_updates_vs_sampler_policy": 5.0}}, "num_env_steps_sampled": 2600, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 5200, "num_agent_steps_trained": 1536, "last_target_update_ts": 2600, "num_target_updates": 6}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3799.5858313372073, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1839.291728861241, "robot_1": 1960.2941024759666}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1839.291728861241, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1960.2941024759666, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8651673685617325, "mean_inference_ms": 3.9256316780394953, "mean_action_processing_ms": 0.5483202190018392, "mean_env_wait_ms": 0.515293404324734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08450448513031006}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3799.5858313372073, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1839.291728861241, "robot_1": 1960.2941024759666}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8651673685617325, "mean_inference_ms": 3.9256316780394953, "mean_action_processing_ms": 0.5483202190018392, "mean_env_wait_ms": 0.515293404324734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08450448513031006}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200, "num_agent_steps_trained": 1536, "num_env_steps_sampled": 2600, "num_env_steps_trained": 1536, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 340.35047715804416, "num_env_steps_trained_throughput_per_sec": 435.6486107622965, "timesteps_total": 2600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5200, "timers": {"training_iteration_time_ms": 505.009, "sample_time_ms": 318.64, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 49.07, "learn_throughput": 5217.028, "synch_weights_time_ms": 9.767}, "counters": {"num_env_steps_sampled": 2600, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 5200, "num_agent_steps_trained": 1536, "last_target_update_ts": 2600, "num_target_updates": 6}, "done": false, "episodes_total": 4, "training_iteration": 6, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-06", "timestamp": 1742586546, "time_this_iter_s": 1.1917779445648193, "time_total_s": 7.023040294647217, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57B0E50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 7.023040294647217, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.84545454545454, "ram_util_percent": 89.61818181818182}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1839.291728861241, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1960.2941024759666, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.453580856323242, "actor_loss": -5.5334625244140625, "critic_loss": 6.43704891204834, "alpha_loss": -0.02825872413814068, "alpha_value": 0.9979017376899719, "log_alpha_value": -0.0021004609297960997, "target_entropy": -8.0, "policy_t": 0.026406854391098022, "mean_q": 0.09335218369960785, "max_q": 0.17728053033351898, "min_q": 0.05665942654013634}, "td_error": [8.994461059570312, 9.467767715454102, 8.807476997375488, 8.732420921325684, 9.002796173095703, 8.787233352661133, 7.996453285217285, 8.331283569335938, 9.88896656036377, 8.145820617675781, 8.562366485595703, 8.213743209838867, 8.663433074951172, 7.290786266326904, 8.706642150878906, 9.081443786621094, 9.346586227416992, 8.55197525024414, 8.764592170715332, 8.421666145324707, 8.198332786560059, 8.760828018188477, 8.17750358581543, 8.39214038848877, 9.172883033752441, 8.504461288452148, 8.13531494140625, 8.097982406616211, 8.709341049194336, 8.244049072265625, 8.995613098144531, 9.358684539794922, 8.82509708404541, 8.56302547454834, 8.004945755004883, 8.679328918457031, 8.700342178344727, 7.569167137145996, 8.75601577758789, 9.025260925292969, 8.117870330810547, 8.466827392578125, 8.912339210510254, 9.256736755371094, 8.688648223876953, 9.264702796936035, 8.72195053100586, 8.611177444458008, 8.05862808227539, 7.690288543701172, 8.461057662963867, 8.699026107788086, 8.135526657104492, 8.089431762695312, 8.198162078857422, 8.091493606567383, 8.158937454223633, 8.643150329589844, 7.895737171173096, 8.332630157470703, 8.208576202392578, 8.049272537231445, 8.865961074829102, 8.823488235473633, 8.934741020202637, 8.265328407287598, 8.131900787353516, 7.976687908172607, 8.785589218139648, 8.316311836242676, 7.875893592834473, 7.980978965759277, 8.466243743896484, 7.875168800354004, 7.912187576293945, 10.490026473999023, 9.8157320022583, 9.026049613952637, 8.2338228225708, 9.224406242370605, 9.02488899230957, 8.956172943115234, 8.405009269714355, 8.422788619995117, 8.134110450744629, 7.188783645629883, 8.357220649719238, 8.513957023620605, 8.263574600219727, 8.386312484741211, 8.349092483520508, 9.44467830657959, 8.670238494873047, 9.098749160766602, 8.318933486938477, 8.03759479522705, 9.425237655639648, 7.656033515930176, 8.696346282958984, 8.685359954833984, 8.461996078491211, 7.937980651855469, 8.806686401367188, 7.894052982330322, 9.02643871307373, 7.933673858642578, 7.559309005737305, 7.899379730224609, 8.770622253417969, 8.253215789794922, 6.963825225830078, 8.474489212036133, 8.705276489257812, 8.40182113647461, 8.649066925048828, 8.513355255126953, 7.468502044677734, 8.126068115234375, 8.435968399047852, 8.721519470214844, 8.120197296142578, 9.808465957641602, 7.874153137207031, 8.154634475708008, 7.849286079406738, 7.898902893066406, 8.681151390075684, 9.427114486694336], "mean_td_error": 8.494009017944336, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.399359703063965, "actor_loss": -5.486562252044678, "critic_loss": 6.46746826171875, "alpha_loss": -0.02814571000635624, "alpha_value": 0.9979016780853271, "log_alpha_value": -0.0021005263552069664, "target_entropy": -8.0, "policy_t": -0.03423669561743736, "mean_q": 0.1106160581111908, "max_q": 0.16578486561775208, "min_q": 0.058262478560209274}, "td_error": [8.268661499023438, 7.892690658569336, 8.675399780273438, 9.329177856445312, 8.81775188446045, 8.664053916931152, 9.32417106628418, 9.700960159301758, 9.415526390075684, 9.050664901733398, 8.884323120117188, 9.006555557250977, 8.44947624206543, 8.190932273864746, 9.153120040893555, 8.744186401367188, 8.69348430633545, 8.508111000061035, 8.923168182373047, 8.291314125061035, 9.683096885681152, 8.188860893249512, 8.758821487426758, 9.13355827331543, 8.338238716125488, 8.071178436279297, 8.403776168823242, 8.664554595947266, 8.75467300415039, 8.99679946899414, 8.551177978515625, 8.778871536254883, 8.39406967163086, 9.092084884643555, 7.693015098571777, 9.055807113647461, 9.200878143310547, 8.36785888671875, 7.825366020202637, 7.628868579864502, 7.449197292327881, 8.753945350646973, 8.849579811096191, 8.873001098632812, 8.966248512268066, 9.312637329101562, 8.782798767089844, 9.85506820678711, 9.45589828491211, 9.527262687683105, 7.962371826171875, 8.646005630493164, 7.760703086853027, 8.859277725219727, 9.425973892211914, 8.757375717163086, 8.651098251342773, 9.229941368103027, 9.614948272705078, 9.274602890014648, 9.408355712890625, 8.428306579589844, 9.091156005859375, 8.436967849731445, 8.890430450439453, 9.232198715209961, 7.676296234130859, 8.740884780883789, 8.751938819885254, 7.929690837860107, 9.697041511535645, 8.59896469116211, 8.426453590393066, 9.050683975219727, 8.409097671508789, 8.664812088012695, 8.087191581726074, 9.435070037841797, 8.72909927368164, 9.429855346679688, 8.473410606384277, 9.112329483032227, 9.215368270874023, 8.853039741516113, 8.760906219482422, 9.179618835449219, 8.122973442077637, 8.925643920898438, 8.683712005615234, 8.31039810180664, 7.681309223175049, 8.981033325195312, 7.879496097564697, 8.545873641967773, 8.626358985900879, 9.380404472351074, 8.453872680664062, 8.691301345825195, 8.719098091125488, 8.883659362792969, 9.338937759399414, 8.450348854064941, 9.178007125854492, 8.342107772827148, 10.060176849365234, 8.788331031799316, 8.802350997924805, 8.39015007019043, 8.870038986206055, 8.806148529052734, 8.241641998291016, 8.867679595947266, 8.726018905639648, 9.025941848754883, 8.389337539672852, 9.098731994628906, 8.888948440551758, 7.915836811065674, 8.863292694091797, 9.493755340576172, 7.6634907722473145, 8.402278900146484, 9.627097129821777, 8.252138137817383, 9.304495811462402, 8.668304443359375, 8.440736770629883, 8.62706184387207], "mean_td_error": 8.747584342956543, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 7.0}}, "num_env_steps_sampled": 3000, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 2048, "last_target_update_ts": 3000, "num_target_updates": 8}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3799.5858313372073, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1839.291728861241, "robot_1": 1960.2941024759666}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1839.291728861241, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1960.2941024759666, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8651673685617325, "mean_inference_ms": 3.9256316780394953, "mean_action_processing_ms": 0.5483202190018392, "mean_env_wait_ms": 0.515293404324734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08450448513031006}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3799.5858313372073, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1839.291728861241, "robot_1": 1960.2941024759666}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8651673685617325, "mean_inference_ms": 3.9256316780394953, "mean_action_processing_ms": 0.5483202190018392, "mean_env_wait_ms": 0.515293404324734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08450448513031006}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 3000, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 333.36067423946184, "num_env_steps_trained_throughput_per_sec": 426.70166302651114, "timesteps_total": 3000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 547.935, "sample_time_ms": 323.93, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 46.167, "learn_throughput": 5545.034, "synch_weights_time_ms": 9.398}, "counters": {"num_env_steps_sampled": 3000, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 2048, "last_target_update_ts": 3000, "num_target_updates": 8}, "done": false, "episodes_total": 4, "training_iteration": 7, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-07", "timestamp": 1742586547, "time_this_iter_s": 1.2168476581573486, "time_total_s": 8.239887952804565, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A582EE50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 8.239887952804565, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 33.2, "ram_util_percent": 90.5}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1839.291728861241, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1960.2941024759666, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.441898345947266, "actor_loss": -5.57835578918457, "critic_loss": 6.03247594833374, "alpha_loss": -0.04033757746219635, "alpha_value": 0.9970036149024963, "log_alpha_value": -0.003000884084030986, "target_entropy": -8.0, "policy_t": -0.013689158484339714, "mean_q": 0.1589115560054779, "max_q": 0.3094019591808319, "min_q": 0.07983477413654327}, "td_error": [8.549474716186523, 8.491655349731445, 8.882984161376953, 9.289570808410645, 9.100776672363281, 9.336645126342773, 8.478180885314941, 8.107929229736328, 8.142128944396973, 8.279607772827148, 7.799079895019531, 8.305054664611816, 7.929518222808838, 9.260651588439941, 8.42671012878418, 8.54782772064209, 8.79957103729248, 8.081426620483398, 8.60403060913086, 8.093545913696289, 9.676056861877441, 7.8005523681640625, 7.984246253967285, 8.553638458251953, 8.525888442993164, 8.190040588378906, 8.177001953125, 7.841464996337891, 8.657180786132812, 8.91879653930664, 9.253609657287598, 8.474568367004395, 6.931159019470215, 7.442816734313965, 8.78213119506836, 9.45555305480957, 9.169090270996094, 8.305496215820312, 8.364946365356445, 8.095974922180176, 8.275135040283203, 8.146814346313477, 8.607316017150879, 7.902573108673096, 7.6022047996521, 8.318511962890625, 8.249067306518555, 9.34710693359375, 8.96512222290039, 9.209376335144043, 8.657069206237793, 7.906014442443848, 7.929172039031982, 9.22291374206543, 7.75299072265625, 8.441242218017578, 8.836055755615234, 8.613666534423828, 8.265251159667969, 8.465139389038086, 8.72463607788086, 8.19064712524414, 7.409383296966553, 9.04411506652832, 8.216119766235352, 7.972070693969727, 7.719703197479248, 8.194747924804688, 8.736427307128906, 8.328764915466309, 7.955785751342773, 7.743734836578369, 8.33059310913086, 8.008853912353516, 7.922665119171143, 9.00177001953125, 8.720928192138672, 8.205232620239258, 8.057429313659668, 8.190342903137207, 8.21725845336914, 9.1370210647583, 7.980384826660156, 9.917522430419922, 8.359403610229492, 8.528111457824707, 8.882349014282227, 7.924752235412598, 7.322068691253662, 8.199898719787598, 7.858860015869141, 9.003204345703125, 8.930675506591797, 7.901093482971191, 8.236940383911133, 8.506502151489258, 8.404279708862305, 8.721345901489258, 8.877272605895996, 8.647869110107422, 8.156553268432617, 7.607870101928711, 9.16868782043457, 8.010096549987793, 7.713071823120117, 8.422613143920898, 8.200075149536133, 9.045921325683594, 7.741423606872559, 9.141260147094727, 7.465592861175537, 8.432075500488281, 9.096212387084961, 8.623994827270508, 8.726289749145508, 8.810209274291992, 8.551761627197266, 9.146410942077637, 8.499226570129395, 7.653968811035156, 8.604501724243164, 8.102641105651855, 8.88728141784668, 8.402261734008789, 7.002187252044678, 7.325099468231201, 8.663415908813477, 7.6275835037231445], "mean_td_error": 8.39748764038086, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.44054889678955, "actor_loss": -5.583690166473389, "critic_loss": 6.554866790771484, "alpha_loss": -0.04033258184790611, "alpha_value": 0.9970036745071411, "log_alpha_value": -0.003000813303515315, "target_entropy": -8.0, "policy_t": -0.0003831610083580017, "mean_q": 0.17895077168941498, "max_q": 0.3024815320968628, "min_q": 0.09546537697315216}, "td_error": [8.566232681274414, 8.893878936767578, 8.110417366027832, 8.455175399780273, 8.212686538696289, 9.11393928527832, 9.554454803466797, 8.883326530456543, 9.131628036499023, 9.632244110107422, 8.572858810424805, 8.805431365966797, 8.804133415222168, 8.2099609375, 8.795334815979004, 8.274839401245117, 8.940099716186523, 9.097661018371582, 7.985953330993652, 8.403709411621094, 8.560089111328125, 9.293128967285156, 9.014785766601562, 8.876233100891113, 9.010998725891113, 9.271169662475586, 8.982284545898438, 8.545799255371094, 7.686725616455078, 7.929895877838135, 8.190924644470215, 8.119037628173828, 8.82420825958252, 9.027149200439453, 8.503507614135742, 8.32186508178711, 8.33781623840332, 9.3724365234375, 8.609559059143066, 8.200850486755371, 8.825547218322754, 9.487199783325195, 9.175834655761719, 8.589887619018555, 9.338333129882812, 8.738574981689453, 8.64793586730957, 8.671446800231934, 8.663797378540039, 7.2739434242248535, 8.605684280395508, 9.287830352783203, 9.363872528076172, 8.856082916259766, 8.386999130249023, 8.841634750366211, 8.571542739868164, 7.97757625579834, 9.236774444580078, 8.67674446105957, 8.769242286682129, 8.24949836730957, 9.199443817138672, 8.561180114746094, 9.839844703674316, 8.980663299560547, 9.161417961120605, 8.352603912353516, 8.714841842651367, 8.736124038696289, 8.377907752990723, 8.646669387817383, 8.060453414916992, 9.411059379577637, 7.8709917068481445, 7.697871208190918, 8.95771598815918, 8.534085273742676, 8.130171775817871, 8.499086380004883, 8.087684631347656, 8.241966247558594, 9.065176010131836, 8.624198913574219, 8.354894638061523, 8.249126434326172, 8.741769790649414, 8.46110725402832, 7.954799652099609, 8.368757247924805, 7.070550918579102, 8.896074295043945, 8.255546569824219, 8.852493286132812, 8.592884063720703, 8.712411880493164, 8.667938232421875, 9.061565399169922, 8.97099781036377, 8.222383499145508, 8.002168655395508, 8.714969635009766, 9.195246696472168, 8.386661529541016, 8.537660598754883, 8.076322555541992, 9.121997833251953, 9.169490814208984, 8.651556015014648, 9.526989936828613, 8.514542579650879, 8.546499252319336, 8.713391304016113, 8.267475128173828, 8.83044719696045, 8.499502182006836, 9.02656364440918, 8.407073020935059, 8.760986328125, 8.860210418701172, 8.942281723022461, 8.764848709106445, 8.226890563964844, 8.546627044677734, 9.150480270385742, 9.092439651489258, 8.273200988769531, 8.291717529296875], "mean_td_error": 8.653446197509766, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 3600, "num_env_steps_trained": 2816, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 2816, "last_target_update_ts": 3600, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3799.5858313372073, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1839.291728861241, "robot_1": 1960.2941024759666}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1839.291728861241, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1960.2941024759666, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8651673685617325, "mean_inference_ms": 3.9256316780394953, "mean_action_processing_ms": 0.5483202190018392, "mean_env_wait_ms": 0.515293404324734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08450448513031006}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3799.5858313372073, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1839.291728861241, "robot_1": 1960.2941024759666}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8651673685617325, "mean_inference_ms": 3.9256316780394953, "mean_action_processing_ms": 0.5483202190018392, "mean_env_wait_ms": 0.515293404324734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08450448513031006}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 2816, "num_env_steps_sampled": 3600, "num_env_steps_trained": 2816, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 404.4802699168468, "num_env_steps_trained_throughput_per_sec": 517.7347454935639, "timesteps_total": 3600, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 7200, "timers": {"training_iteration_time_ms": 565.791, "sample_time_ms": 315.798, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 39.319, "learn_throughput": 6510.797, "synch_weights_time_ms": 10.028}, "counters": {"num_env_steps_sampled": 3600, "num_env_steps_trained": 2816, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 2816, "last_target_update_ts": 3600, "num_target_updates": 11}, "done": false, "episodes_total": 4, "training_iteration": 8, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-09", "timestamp": 1742586549, "time_this_iter_s": 1.525310754776001, "time_total_s": 9.765198707580566, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298BB31A820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 9.765198707580566, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.266666666666666, "ram_util_percent": 90.59999999999998}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1857.6351115559803, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1948.3698007810326, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.461873054504395, "actor_loss": -5.671558380126953, "critic_loss": 6.508965492248535, "alpha_loss": -0.052519675344228745, "alpha_value": 0.9961062073707581, "log_alpha_value": -0.003901364514604211, "target_entropy": -8.0, "policy_t": -0.002235539723187685, "mean_q": 0.23433741927146912, "max_q": 0.43888047337532043, "min_q": 0.11989892274141312}, "td_error": [8.235696792602539, 8.594802856445312, 8.719778060913086, 8.042579650878906, 7.72519588470459, 7.6293535232543945, 7.953120231628418, 8.040773391723633, 8.389129638671875, 7.750669956207275, 8.798517227172852, 8.222949981689453, 8.856072425842285, 7.923121929168701, 8.615363121032715, 8.630643844604492, 8.71379566192627, 9.783342361450195, 8.855612754821777, 8.028125762939453, 8.168563842773438, 8.460653305053711, 9.159324645996094, 8.802726745605469, 8.650739669799805, 8.640875816345215, 8.470987319946289, 8.153380393981934, 7.17866325378418, 8.142328262329102, 8.871935844421387, 7.924920082092285, 8.502126693725586, 8.519430160522461, 8.05957317352295, 8.629447937011719, 8.381345748901367, 8.307199478149414, 7.940174102783203, 7.770123481750488, 7.847470283508301, 8.319198608398438, 8.171425819396973, 9.11906623840332, 7.939599990844727, 7.456691265106201, 8.193887710571289, 7.619652271270752, 8.30168342590332, 8.312263488769531, 8.05398178100586, 8.017356872558594, 8.768744468688965, 8.392494201660156, 8.335982322692871, 9.069509506225586, 8.54532241821289, 9.853975296020508, 8.534130096435547, 8.793487548828125, 8.492372512817383, 8.541106224060059, 8.900863647460938, 8.468816757202148, 7.976602554321289, 8.275619506835938, 9.223457336425781, 8.178653717041016, 7.671395301818848, 9.080670356750488, 8.73892593383789, 9.702259063720703, 7.789822578430176, 9.051502227783203, 8.961828231811523, 8.203930854797363, 8.066715240478516, 9.353897094726562, 8.128007888793945, 7.4377617835998535, 8.793755531311035, 7.958233833312988, 7.884552001953125, 7.942351341247559, 7.975028991699219, 7.578373432159424, 9.25974178314209, 8.09716510772705, 8.28689193725586, 8.703564643859863, 8.161813735961914, 8.016708374023438, 9.477273941040039, 8.250088691711426, 9.001547813415527, 8.346878051757812, 8.604948043823242, 8.296111106872559, 8.320585250854492, 8.799880981445312, 8.12645435333252, 8.172236442565918, 7.842349052429199, 8.433671951293945, 8.469313621520996, 8.17336654663086, 8.356367111206055, 7.665513038635254, 8.105704307556152, 10.430152893066406, 8.096174240112305, 8.482328414916992, 8.394233703613281, 9.009720802307129, 8.8173828125, 8.560470581054688, 8.157492637634277, 8.197219848632812, 8.943084716796875, 7.909989356994629, 8.441106796264648, 8.61417007446289, 8.58731746673584, 7.862720489501953, 7.674567222595215, 8.283447265625, 7.839232444763184, 8.469523429870605], "mean_td_error": 8.390657424926758, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.470562934875488, "actor_loss": -5.683582305908203, "critic_loss": 6.4349164962768555, "alpha_loss": -0.05255018174648285, "alpha_value": 0.9961065053939819, "log_alpha_value": -0.003901112824678421, "target_entropy": -8.0, "policy_t": 0.03593730181455612, "mean_q": 0.2626960873603821, "max_q": 0.4148261547088623, "min_q": 0.12869539856910706}, "td_error": [7.913604736328125, 9.736255645751953, 8.418825149536133, 8.341266632080078, 8.964438438415527, 9.00324821472168, 8.778648376464844, 8.577028274536133, 8.846278190612793, 8.393125534057617, 8.711858749389648, 8.331886291503906, 8.836381912231445, 8.771114349365234, 8.142988204956055, 8.838838577270508, 9.493635177612305, 8.079272270202637, 8.923012733459473, 8.364068031311035, 7.895857810974121, 8.414836883544922, 8.733665466308594, 8.548544883728027, 8.281180381774902, 8.805998802185059, 8.979875564575195, 8.501012802124023, 9.401092529296875, 7.9927825927734375, 8.462430953979492, 8.762679100036621, 8.844350814819336, 8.686996459960938, 8.789153099060059, 8.448680877685547, 8.399991989135742, 8.164398193359375, 9.002304077148438, 8.821392059326172, 8.422557830810547, 8.41064453125, 9.358055114746094, 8.756497383117676, 8.884516716003418, 9.134418487548828, 8.542850494384766, 8.533905029296875, 7.9923930168151855, 9.892491340637207, 8.362480163574219, 9.347631454467773, 8.496387481689453, 8.817361831665039, 7.919934272766113, 8.066624641418457, 8.431676864624023, 7.707151889801025, 8.885747909545898, 9.175485610961914, 8.473357200622559, 8.87061595916748, 8.01978874206543, 8.861149787902832, 7.682643413543701, 7.939611434936523, 8.172957420349121, 8.106527328491211, 8.44019889831543, 8.9578275680542, 8.673965454101562, 8.814020156860352, 8.290132522583008, 8.835206031799316, 8.288519859313965, 8.315765380859375, 8.374807357788086, 8.415185928344727, 9.54931354522705, 8.912367820739746, 8.38882064819336, 8.874988555908203, 8.266510009765625, 9.129916191101074, 8.570257186889648, 8.951211929321289, 7.799899578094482, 8.81545639038086, 8.269002914428711, 7.908829689025879, 8.601985931396484, 8.677364349365234, 8.167524337768555, 8.546384811401367, 8.31894302368164, 8.282316207885742, 7.793950080871582, 7.820547103881836, 8.813661575317383, 8.029657363891602, 8.951753616333008, 8.518152236938477, 8.139097213745117, 8.28428840637207, 8.353597640991211, 8.89072036743164, 8.427501678466797, 8.963645935058594, 8.554327011108398, 8.642126083374023, 8.087665557861328, 8.368965148925781, 8.512055397033691, 8.104816436767578, 8.86471176147461, 8.622647285461426, 8.235325813293457, 9.033926010131836, 9.694650650024414, 8.744070053100586, 7.805807113647461, 8.664653778076172, 8.583242416381836, 8.407215118408203, 8.189409255981445, 8.31022834777832, 8.598906517028809, 8.807981491088867], "mean_td_error": 8.561910629272461, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 4200, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 3584, "last_target_update_ts": 4200, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3806.0049123370127, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1857.6351115559803, "robot_1": 1948.3698007810326}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1857.6351115559803, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1948.3698007810326, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587235475827323, "mean_inference_ms": 3.875302239088631, "mean_action_processing_ms": 0.5465177207896128, "mean_env_wait_ms": 0.5057577564494509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012575089931488037, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1596212387084961}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3806.0049123370127, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1857.6351115559803, "robot_1": 1948.3698007810326}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587235475827323, "mean_inference_ms": 3.875302239088631, "mean_action_processing_ms": 0.5465177207896128, "mean_env_wait_ms": 0.5057577564494509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012575089931488037, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1596212387084961}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 3584, "num_env_steps_sampled": 4200, "num_env_steps_trained": 3584, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 404.0033308113049, "num_env_steps_trained_throughput_per_sec": 517.1242634384703, "timesteps_total": 4200, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 534.368, "sample_time_ms": 303.114, "load_time_ms": 0.835, "load_throughput": 306651.956, "learn_time_ms": 37.928, "learn_throughput": 6749.655, "synch_weights_time_ms": 9.343}, "counters": {"num_env_steps_sampled": 4200, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 3584, "last_target_update_ts": 4200, "num_target_updates": 14}, "done": false, "episodes_total": 8, "training_iteration": 9, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-10", "timestamp": 1742586550, "time_this_iter_s": 1.5016357898712158, "time_total_s": 11.266834497451782, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57B0E50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 11.266834497451782, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.25, "ram_util_percent": 90.5}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1857.6351115559803, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1948.3698007810326, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.415717124938965, "actor_loss": -5.714537620544434, "critic_loss": 5.80982780456543, "alpha_loss": -0.06442194432020187, "alpha_value": 0.9952095150947571, "log_alpha_value": -0.004801975563168526, "target_entropy": -8.0, "policy_t": -0.011287612840533257, "mean_q": 0.3388473391532898, "max_q": 0.6274058818817139, "min_q": 0.17101892828941345}, "td_error": [8.759078979492188, 8.34329605102539, 7.520522117614746, 8.191170692443848, 7.774625778198242, 8.602534294128418, 8.670306205749512, 7.807019233703613, 8.283416748046875, 7.800034523010254, 8.404483795166016, 7.940483570098877, 8.86579704284668, 8.598291397094727, 8.44322395324707, 8.02867317199707, 8.376838684082031, 8.496685981750488, 7.672900676727295, 7.591706275939941, 8.15165901184082, 7.614808082580566, 8.39529800415039, 9.49062728881836, 7.709985733032227, 8.947908401489258, 8.132294654846191, 8.39900016784668, 7.682580947875977, 8.138662338256836, 8.277235984802246, 8.296850204467773, 8.004178047180176, 7.981539726257324, 8.817564010620117, 8.602041244506836, 7.633244037628174, 7.626731872558594, 9.210540771484375, 8.007940292358398, 8.10328483581543, 8.178686141967773, 7.842480659484863, 8.05051040649414, 7.792629241943359, 7.963591575622559, 7.830195426940918, 8.631170272827148, 7.798130035400391, 8.58552360534668, 7.992750644683838, 7.674644470214844, 7.98538875579834, 8.500751495361328, 8.303503036499023, 8.036666870117188, 8.321514129638672, 8.49471664428711, 7.325321197509766, 8.467729568481445, 7.44527530670166, 8.718982696533203, 7.966395378112793, 8.120481491088867, 7.915818691253662, 8.82806396484375, 8.466020584106445, 7.952775001525879, 8.044082641601562, 8.160236358642578, 8.39462661743164, 7.859694480895996, 8.890563011169434, 8.342124938964844, 8.753740310668945, 8.76263427734375, 7.672555446624756, 8.035533905029297, 8.500630378723145, 8.956991195678711, 7.9493408203125, 7.861605644226074, 8.442333221435547, 8.556816101074219, 7.927109241485596, 8.208311080932617, 8.093278884887695, 8.660674095153809, 8.089244842529297, 7.965188026428223, 8.400056838989258, 7.638317108154297, 7.606706619262695, 8.301156997680664, 7.324435234069824, 7.742220878601074, 8.536529541015625, 8.261642456054688, 8.0994291305542, 8.557266235351562, 7.408214569091797, 8.126697540283203, 8.15265941619873, 7.809908866882324, 8.252984046936035, 7.942914962768555, 8.196113586425781, 8.329659461975098, 8.247472763061523, 8.329414367675781, 7.696811676025391, 7.991511344909668, 7.702376365661621, 8.787025451660156, 8.045042037963867, 7.877317905426025, 8.425281524658203, 8.741601943969727, 9.03778076171875, 7.794083595275879, 7.7796478271484375, 7.628624439239502, 8.637754440307617, 8.812426567077637, 8.369722366333008, 8.583517074584961, 8.233999252319336, 8.61749267578125], "mean_td_error": 8.193264961242676, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.478206634521484, "actor_loss": -5.793247222900391, "critic_loss": 6.298538684844971, "alpha_loss": -0.06471574306488037, "alpha_value": 0.9952099919319153, "log_alpha_value": -0.004801510367542505, "target_entropy": -8.0, "policy_t": 0.012536315247416496, "mean_q": 0.3802838921546936, "max_q": 0.7047389149665833, "min_q": 0.22433558106422424}, "td_error": [8.844993591308594, 7.774904251098633, 8.944740295410156, 8.335070610046387, 8.11464786529541, 8.098740577697754, 8.177407264709473, 8.029936790466309, 8.547632217407227, 9.090856552124023, 7.992259979248047, 7.945328712463379, 8.412294387817383, 8.196762084960938, 8.777262687683105, 8.679422378540039, 8.025400161743164, 8.37961196899414, 8.250452041625977, 7.78385066986084, 8.303958892822266, 8.678239822387695, 8.76188850402832, 8.213411331176758, 8.337797164916992, 8.915427207946777, 8.472017288208008, 8.609914779663086, 8.531550407409668, 9.325399398803711, 8.8760986328125, 8.264546394348145, 8.540346145629883, 8.611729621887207, 7.542047500610352, 7.967955589294434, 8.695247650146484, 8.326522827148438, 8.56480884552002, 8.804692268371582, 8.126779556274414, 7.698307037353516, 9.218194961547852, 8.511334419250488, 8.358455657958984, 7.736869812011719, 8.203925132751465, 8.043200492858887, 8.473671913146973, 8.180144309997559, 8.350725173950195, 8.147050857543945, 8.837508201599121, 8.490854263305664, 8.776044845581055, 8.378314971923828, 8.50949764251709, 8.566122055053711, 8.00326156616211, 9.368782043457031, 8.366233825683594, 8.143091201782227, 8.715154647827148, 7.493183135986328, 8.090388298034668, 8.524317741394043, 8.996597290039062, 7.868612766265869, 8.613103866577148, 8.282878875732422, 8.307491302490234, 7.795522212982178, 8.463560104370117, 8.766223907470703, 8.727126121520996, 9.169032096862793, 8.259514808654785, 8.838375091552734, 7.994441032409668, 8.163707733154297, 7.997807502746582, 7.871158599853516, 9.280158042907715, 7.845673561096191, 8.431731224060059, 8.085504531860352, 7.923050403594971, 8.037033081054688, 8.290645599365234, 7.445826530456543, 8.581815719604492, 8.822943687438965, 8.2250337600708, 7.787527084350586, 8.747333526611328, 8.327385902404785, 7.879245758056641, 8.17294692993164, 9.031538963317871, 8.73147201538086, 8.791629791259766, 8.204636573791504, 8.514408111572266, 8.299649238586426, 8.4197359085083, 8.831392288208008, 8.618227005004883, 8.387248992919922, 8.689538955688477, 8.086343765258789, 8.38361930847168, 8.142406463623047, 7.382540702819824, 8.584638595581055, 8.147438049316406, 7.621797561645508, 7.5531511306762695, 9.13415813446045, 8.900400161743164, 8.601914405822754, 8.564303398132324, 8.563484191894531, 7.992160797119141, 8.030261039733887, 9.145870208740234, 7.91543436050415, 8.944622039794922, 8.452042579650879], "mean_td_error": 8.380638122558594, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4352, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 4352, "last_target_update_ts": 4800, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3806.0049123370127, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1857.6351115559803, "robot_1": 1948.3698007810326}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1857.6351115559803, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1948.3698007810326, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587235475827323, "mean_inference_ms": 3.875302239088631, "mean_action_processing_ms": 0.5465177207896128, "mean_env_wait_ms": 0.5057577564494509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012575089931488037, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1596212387084961}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3806.0049123370127, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1857.6351115559803, "robot_1": 1948.3698007810326}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587235475827323, "mean_inference_ms": 3.875302239088631, "mean_action_processing_ms": 0.5465177207896128, "mean_env_wait_ms": 0.5057577564494509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012575089931488037, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1596212387084961}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 4352, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4352, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 387.0396336216542, "num_env_steps_trained_throughput_per_sec": 495.4107310357174, "timesteps_total": 4800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 9600, "timers": {"training_iteration_time_ms": 515.199, "sample_time_ms": 296.34, "load_time_ms": 0.936, "load_throughput": 273592.678, "learn_time_ms": 34.73, "learn_throughput": 7371.128, "synch_weights_time_ms": 10.707}, "counters": {"num_env_steps_sampled": 4800, "num_env_steps_trained": 4352, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 4352, "last_target_update_ts": 4800, "num_target_updates": 17}, "done": false, "episodes_total": 8, "training_iteration": 10, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-12", "timestamp": 1742586552, "time_this_iter_s": 1.5665791034698486, "time_total_s": 12.83341360092163, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A582EE50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 12.83341360092163, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.95, "ram_util_percent": 90.5}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1857.6351115559803, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1948.3698007810326, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.416170120239258, "actor_loss": -5.79429292678833, "critic_loss": 5.99467658996582, "alpha_loss": -0.07247792184352875, "alpha_value": 0.9946122765541077, "log_alpha_value": -0.005402281414717436, "target_entropy": -8.0, "policy_t": -0.01868937350809574, "mean_q": 0.41831013560295105, "max_q": 0.8387731313705444, "min_q": 0.2566896378993988}, "td_error": [8.458690643310547, 8.727907180786133, 8.327154159545898, 8.599142074584961, 8.288370132446289, 7.837540626525879, 8.371133804321289, 8.005112648010254, 8.271095275878906, 7.7787981033325195, 8.830345153808594, 8.56625747680664, 7.882708549499512, 8.167366027832031, 8.110162734985352, 8.075874328613281, 7.534897804260254, 8.164010047912598, 8.338333129882812, 8.653705596923828, 7.453756332397461, 8.006974220275879, 7.981600761413574, 7.672491073608398, 7.542941093444824, 7.689723968505859, 8.023616790771484, 8.347127914428711, 7.544862747192383, 7.988418102264404, 8.162839889526367, 9.14346694946289, 7.773974418640137, 8.237817764282227, 7.321690559387207, 8.552803039550781, 8.516414642333984, 8.60097599029541, 7.729291915893555, 7.9684858322143555, 7.893953800201416, 7.757375717163086, 7.4774627685546875, 7.267729759216309, 7.597087860107422, 8.6087646484375, 9.04623031616211, 7.844790458679199, 8.05624771118164, 7.963731288909912, 7.447014808654785, 7.971714496612549, 7.6522111892700195, 8.084800720214844, 7.797929763793945, 8.946578025817871, 7.978011608123779, 9.00006103515625, 8.407193183898926, 8.58730411529541, 8.180278778076172, 7.959026336669922, 7.681120872497559, 7.778541088104248, 7.8302717208862305, 8.804405212402344, 8.01482105255127, 8.739850997924805, 8.232847213745117, 8.15581226348877, 8.229793548583984, 9.145811080932617, 8.58510971069336, 7.715880870819092, 7.507355690002441, 7.828629493713379, 8.306330680847168, 7.985533714294434, 8.193084716796875, 8.088846206665039, 8.711193084716797, 7.918056488037109, 8.154787063598633, 8.499310493469238, 8.214818954467773, 8.476594924926758, 7.711713790893555, 8.049936294555664, 8.722038269042969, 8.986078262329102, 8.313969612121582, 8.037555694580078, 8.346739768981934, 7.583218097686768, 8.06106185913086, 8.06669807434082, 8.056424140930176, 8.172834396362305, 7.6055216789245605, 8.044063568115234, 7.953722953796387, 8.121477127075195, 8.265327453613281, 8.224205017089844, 8.04777717590332, 8.355598449707031, 8.327963829040527, 7.908041000366211, 8.396984100341797, 7.787652015686035, 7.9453582763671875, 8.075891494750977, 8.65390396118164, 7.654345512390137, 7.709819793701172, 8.283456802368164, 7.210321426391602, 7.826744079589844, 7.9304609298706055, 9.411661148071289, 7.258272171020508, 8.10719108581543, 7.583096027374268, 7.73621129989624, 7.9074530601501465, 8.12244987487793, 7.408985614776611, 8.688032150268555], "mean_td_error": 8.111190795898438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.489421844482422, "actor_loss": -5.902041912078857, "critic_loss": 5.862154006958008, "alpha_loss": -0.07286801189184189, "alpha_value": 0.9946126937866211, "log_alpha_value": -0.005401862319558859, "target_entropy": -8.0, "policy_t": 0.006960761733353138, "mean_q": 0.48137229681015015, "max_q": 0.8277537822723389, "min_q": 0.27815067768096924}, "td_error": [8.962943077087402, 8.446041107177734, 7.7624077796936035, 8.110736846923828, 8.270759582519531, 8.789620399475098, 9.341316223144531, 8.466737747192383, 7.524600982666016, 8.044062614440918, 8.147520065307617, 8.7256498336792, 8.416410446166992, 8.073568344116211, 8.053207397460938, 7.911381244659424, 8.04813003540039, 9.054726600646973, 8.747404098510742, 7.986306667327881, 7.988964557647705, 8.855657577514648, 9.138886451721191, 9.053452491760254, 8.541336059570312, 7.957139492034912, 7.4430952072143555, 8.220016479492188, 8.974693298339844, 8.396797180175781, 8.59757137298584, 8.691486358642578, 8.885347366333008, 7.982524871826172, 8.034677505493164, 8.964611053466797, 8.125044822692871, 7.907966613769531, 8.160962104797363, 8.99016284942627, 8.086159706115723, 8.01814079284668, 8.704452514648438, 8.188802719116211, 8.916129112243652, 8.476455688476562, 9.333763122558594, 8.532190322875977, 8.294889450073242, 8.772138595581055, 8.537086486816406, 8.785404205322266, 8.029312133789062, 8.214864730834961, 8.741515159606934, 8.234984397888184, 7.6892499923706055, 8.824300765991211, 8.507160186767578, 8.165534973144531, 7.755660057067871, 8.470561981201172, 7.61769962310791, 7.508754730224609, 7.222003936767578, 7.7701520919799805, 8.14416790008545, 8.660268783569336, 8.032236099243164, 8.30896282196045, 8.693536758422852, 7.953667163848877, 7.414414405822754, 7.9514617919921875, 8.289685249328613, 8.515425682067871, 8.020328521728516, 10.029375076293945, 8.050655364990234, 8.493339538574219, 7.987080097198486, 7.847661972045898, 7.707904815673828, 8.897136688232422, 8.207172393798828, 7.895732879638672, 7.82285737991333, 7.804504871368408, 8.248531341552734, 7.998804092407227, 7.934972763061523, 8.007061004638672, 7.765678405761719, 8.376724243164062, 7.759463310241699, 8.013668060302734, 8.793867111206055, 7.582296371459961, 7.985897541046143, 8.785962104797363, 8.509461402893066, 8.2009859085083, 8.825437545776367, 8.302913665771484, 8.97072982788086, 9.31338882446289, 8.136129379272461, 7.87716007232666, 8.619163513183594, 7.753900051116943, 8.564136505126953, 9.265522003173828, 8.724685668945312, 7.994521141052246, 8.298730850219727, 7.610072135925293, 8.500544548034668, 8.01241397857666, 8.39360237121582, 7.344303131103516, 8.509114265441895, 8.299748420715332, 8.877034187316895, 7.789534568786621, 8.788663864135742, 8.919483184814453, 7.819740295410156, 8.390378952026367], "mean_td_error": 8.310807228088379, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 5200, "num_env_steps_trained": 4864, "num_agent_steps_sampled": 10400, "num_agent_steps_trained": 4864, "last_target_update_ts": 5200, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3806.0049123370127, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1857.6351115559803, "robot_1": 1948.3698007810326}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1857.6351115559803, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1948.3698007810326, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587235475827323, "mean_inference_ms": 3.875302239088631, "mean_action_processing_ms": 0.5465177207896128, "mean_env_wait_ms": 0.5057577564494509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012575089931488037, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1596212387084961}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3806.0049123370127, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1857.6351115559803, "robot_1": 1948.3698007810326}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587235475827323, "mean_inference_ms": 3.875302239088631, "mean_action_processing_ms": 0.5465177207896128, "mean_env_wait_ms": 0.5057577564494509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012575089931488037, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1596212387084961}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10400, "num_agent_steps_trained": 4864, "num_env_steps_sampled": 5200, "num_env_steps_trained": 4864, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 373.1772283189313, "num_env_steps_trained_throughput_per_sec": 477.6668522482321, "timesteps_total": 5200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10400, "timers": {"training_iteration_time_ms": 511.565, "sample_time_ms": 290.152, "load_time_ms": 0.936, "load_throughput": 273592.678, "learn_time_ms": 36.349, "learn_throughput": 7042.805, "synch_weights_time_ms": 12.391}, "counters": {"num_env_steps_sampled": 5200, "num_env_steps_trained": 4864, "num_agent_steps_sampled": 10400, "num_agent_steps_trained": 4864, "last_target_update_ts": 5200, "num_target_updates": 19}, "done": false, "episodes_total": 8, "training_iteration": 11, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-13", "timestamp": 1742586553, "time_this_iter_s": 1.0886311531066895, "time_total_s": 13.92204475402832, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298BB31AEE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 13.92204475402832, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 43.95, "ram_util_percent": 90.69999999999999}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1857.6351115559803, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1948.3698007810326, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.43569564819336, "actor_loss": -5.933852195739746, "critic_loss": 5.8566975593566895, "alpha_loss": -0.08467934280633926, "alpha_value": 0.9937172532081604, "log_alpha_value": -0.00630256487056613, "target_entropy": -8.0, "policy_t": -0.011332927271723747, "mean_q": 0.5385124087333679, "max_q": 1.0102289915084839, "min_q": 0.3436746299266815}, "td_error": [8.066665649414062, 7.75132942199707, 8.017523765563965, 8.414470672607422, 7.16226053237915, 8.714906692504883, 7.7500176429748535, 7.805057525634766, 7.8881635665893555, 7.22100830078125, 8.79482650756836, 7.977478981018066, 7.612907409667969, 7.448056221008301, 7.755846977233887, 8.110549926757812, 7.742719650268555, 9.289899826049805, 8.313362121582031, 7.557774066925049, 7.681502819061279, 7.159372329711914, 7.4378204345703125, 8.317575454711914, 7.736605644226074, 7.937037944793701, 8.078267097473145, 8.306653022766113, 8.148242950439453, 8.279348373413086, 7.949403762817383, 8.041996955871582, 6.876105308532715, 8.08223819732666, 8.398138046264648, 7.460024833679199, 8.630939483642578, 7.997716903686523, 9.109100341796875, 7.036012649536133, 8.005865097045898, 7.710391998291016, 8.586080551147461, 7.90615177154541, 7.440255165100098, 8.694086074829102, 8.034762382507324, 8.206778526306152, 7.453266143798828, 8.067792892456055, 7.8466901779174805, 8.55669116973877, 8.673912048339844, 12.289405822753906, 8.343921661376953, 7.42516565322876, 7.8381667137146, 8.051684379577637, 7.988580226898193, 8.400079727172852, 8.228848457336426, 6.9177680015563965, 8.615488052368164, 8.555065155029297, 8.21726131439209, 7.5220842361450195, 8.234766006469727, 8.039763450622559, 7.8725175857543945, 7.795775413513184, 7.2902984619140625, 8.090463638305664, 7.441542625427246, 9.62592887878418, 7.601858615875244, 7.898976802825928, 8.247734069824219, 8.000597953796387, 7.681921005249023, 7.684244155883789, 8.387593269348145, 7.349303245544434, 8.040437698364258, 7.832934856414795, 7.926990032196045, 8.465744972229004, 7.941777229309082, 7.539640426635742, 7.607600688934326, 7.877286434173584, 8.009147644042969, 8.184572219848633, 8.48539924621582, 7.889508247375488, 8.275044441223145, 7.604568004608154, 8.047704696655273, 8.426787376403809, 8.168285369873047, 7.991931915283203, 7.752449989318848, 8.252958297729492, 8.148755073547363, 7.825958251953125, 8.072333335876465, 8.153227806091309, 7.350968837738037, 8.43304443359375, 7.3536882400512695, 8.55097484588623, 8.831716537475586, 8.445219993591309, 7.408168792724609, 8.07825756072998, 8.477180480957031, 7.854748725891113, 7.616541862487793, 8.393125534057617, 9.17232608795166, 6.902368545532227, 7.679184913635254, 8.050424575805664, 7.619048118591309, 7.345202445983887, 7.887958526611328, 7.333385944366455, 8.169197082519531, 8.087696075439453], "mean_td_error": 8.019062042236328, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.467190742492676, "actor_loss": -5.988858222961426, "critic_loss": 5.883058547973633, "alpha_loss": -0.08487746119499207, "alpha_value": 0.9937173128128052, "log_alpha_value": -0.006302536465227604, "target_entropy": -8.0, "policy_t": -0.015468668192625046, "mean_q": 0.6063795685768127, "max_q": 0.9876761436462402, "min_q": 0.34891825914382935}, "td_error": [8.041404724121094, 9.419514656066895, 7.965385437011719, 7.759799957275391, 7.9454545974731445, 8.104209899902344, 7.939749717712402, 8.611701011657715, 7.739800453186035, 7.6177778244018555, 8.557229995727539, 7.762284278869629, 8.701004981994629, 7.835868835449219, 8.160297393798828, 7.777189254760742, 7.817714214324951, 7.724369049072266, 8.52588176727295, 8.006162643432617, 8.091371536254883, 8.586992263793945, 8.636048316955566, 7.7125091552734375, 8.808172225952148, 8.06613540649414, 8.26414966583252, 8.252399444580078, 8.26033878326416, 8.033268928527832, 8.216846466064453, 7.957831382751465, 8.529032707214355, 7.619104385375977, 7.89192533493042, 8.451330184936523, 8.208748817443848, 7.6921844482421875, 8.225423812866211, 8.004192352294922, 7.813203811645508, 8.250864028930664, 8.189563751220703, 8.469374656677246, 8.21527099609375, 8.138143539428711, 8.321234703063965, 8.220399856567383, 8.979970932006836, 7.686009407043457, 8.765867233276367, 7.462613582611084, 8.59034252166748, 7.987461090087891, 7.696195602416992, 8.270870208740234, 8.016845703125, 7.988426208496094, 9.082279205322266, 7.466497421264648, 8.45991039276123, 7.807375907897949, 9.457763671875, 7.464987754821777, 7.86617374420166, 8.97637939453125, 8.973634719848633, 8.222116470336914, 9.076803207397461, 8.345197677612305, 8.315093994140625, 7.498514175415039, 8.00124740600586, 7.184775352478027, 8.60392951965332, 8.0285005569458, 8.31847095489502, 8.807063102722168, 7.417581558227539, 9.6484375, 6.961389541625977, 7.7487993240356445, 8.380741119384766, 7.6191277503967285, 6.77635383605957, 8.13460922241211, 8.098712921142578, 7.805627346038818, 8.044477462768555, 8.634870529174805, 8.361272811889648, 8.121512413024902, 7.224654197692871, 8.816097259521484, 8.508645057678223, 7.598123073577881, 8.380314826965332, 8.444332122802734, 8.7672700881958, 7.841736793518066, 8.73983383178711, 7.5430121421813965, 7.347661018371582, 8.049712181091309, 8.025212287902832, 8.066757202148438, 8.544357299804688, 8.59045124053955, 8.569339752197266, 9.085905075073242, 7.567014694213867, 7.476563930511475, 8.016633987426758, 8.302755355834961, 8.423168182373047, 7.686341285705566, 7.785799503326416, 8.752065658569336, 8.49105453491211, 8.168355941772461, 8.991445541381836, 7.508605003356934, 8.077865600585938, 8.546895980834961, 8.24467658996582, 8.764547348022461, 8.238125801086426, 7.7332305908203125], "mean_td_error": 8.16572093963623, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 5800, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 11600, "num_agent_steps_trained": 5632, "last_target_update_ts": 5800, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3806.0049123370127, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1857.6351115559803, "robot_1": 1948.3698007810326}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1857.6351115559803, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1948.3698007810326, "('robot_1', 'robot_1')_total_reward_min": 1833.9152538516823, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587235475827323, "mean_inference_ms": 3.875302239088631, "mean_action_processing_ms": 0.5465177207896128, "mean_env_wait_ms": 0.5057577564494509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012575089931488037, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1596212387084961}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3806.0049123370127, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1833.9152538516823}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1857.6351115559803, "robot_1": 1948.3698007810326}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587235475827323, "mean_inference_ms": 3.875302239088631, "mean_action_processing_ms": 0.5465177207896128, "mean_env_wait_ms": 0.5057577564494509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012575089931488037, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1596212387084961}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11600, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5800, "num_env_steps_trained": 5632, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 406.6726059014965, "num_env_steps_trained_throughput_per_sec": 520.5409355539156, "timesteps_total": 5800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 11600, "timers": {"training_iteration_time_ms": 510.603, "sample_time_ms": 287.093, "load_time_ms": 1.773, "load_throughput": 144364.767, "learn_time_ms": 34.062, "learn_throughput": 7515.627, "synch_weights_time_ms": 12.403}, "counters": {"num_env_steps_sampled": 5800, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 11600, "num_agent_steps_trained": 5632, "last_target_update_ts": 5800, "num_target_updates": 22}, "done": false, "episodes_total": 8, "training_iteration": 12, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-15", "timestamp": 1742586555, "time_this_iter_s": 1.491708517074585, "time_total_s": 15.413753271102905, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298BB31A700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 15.413753271102905, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.049999999999997, "ram_util_percent": 90.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1848.7842878749616, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1929.0756021146838, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.46407699584961, "actor_loss": -6.1136980056762695, "critic_loss": 5.67026424407959, "alpha_loss": -0.09294082969427109, "alpha_value": 0.9931209087371826, "log_alpha_value": -0.006902873516082764, "target_entropy": -8.0, "policy_t": -0.019190015271306038, "mean_q": 0.7088216543197632, "max_q": 1.3176054954528809, "min_q": 0.4031928479671478}, "td_error": [7.472084999084473, 7.898043632507324, 8.290751457214355, 8.149480819702148, 7.970871925354004, 7.359296798706055, 7.612140655517578, 8.433084487915039, 7.6039509773254395, 8.118572235107422, 7.896007537841797, 8.251667022705078, 7.581048965454102, 7.886137962341309, 7.64467716217041, 8.308694839477539, 8.128597259521484, 8.518795013427734, 7.355816841125488, 7.990022659301758, 7.714759826660156, 8.006010055541992, 7.675397872924805, 7.994715690612793, 8.238910675048828, 7.2799973487854, 7.546032905578613, 7.660299777984619, 8.266032218933105, 7.592666149139404, 7.609572410583496, 8.212162971496582, 8.123037338256836, 8.597994804382324, 7.496891498565674, 7.8642144203186035, 7.475244998931885, 8.368454933166504, 7.2977495193481445, 8.204839706420898, 8.063458442687988, 7.660998344421387, 7.788125991821289, 8.51993465423584, 8.280519485473633, 7.789536952972412, 7.694978713989258, 8.63943862915039, 7.969452857971191, 7.742018699645996, 7.065350532531738, 7.3285231590271, 8.087507247924805, 7.849143028259277, 7.56315279006958, 8.234586715698242, 7.841670989990234, 8.04829216003418, 7.466668128967285, 7.5161638259887695, 7.948032379150391, 7.3394317626953125, 7.722537040710449, 7.754610061645508, 7.9521803855896, 9.796773910522461, 7.455972671508789, 8.30728530883789, 7.466963768005371, 7.835939407348633, 8.150766372680664, 7.838858604431152, 7.64920711517334, 8.95901870727539, 8.058538436889648, 8.285070419311523, 7.8493194580078125, 8.216343879699707, 8.458290100097656, 7.977282524108887, 8.8892240524292, 8.108470916748047, 7.511819839477539, 7.41268253326416, 7.898752212524414, 7.675126075744629, 7.966307640075684, 8.116313934326172, 7.676044464111328, 7.373398780822754, 7.453362464904785, 7.791966438293457, 7.524356842041016, 7.416477203369141, 7.935187816619873, 7.621726989746094, 7.215230941772461, 8.089348793029785, 7.566712856292725, 7.870586395263672, 7.533672332763672, 8.261828422546387, 7.809156894683838, 7.539206027984619, 7.975862503051758, 7.425811767578125, 8.040565490722656, 8.135283470153809, 7.210959434509277, 7.668601036071777, 7.990048408508301, 8.32120418548584, 7.593587875366211, 8.12904167175293, 7.494138717651367, 7.635344505310059, 7.149386405944824, 8.158740997314453, 8.044122695922852, 7.831722736358643, 7.878671646118164, 7.759324073791504, 8.061342239379883, 8.190849304199219, 7.547140121459961, 7.815554618835449, 8.077787399291992, 7.718440055847168], "mean_td_error": 7.874821662902832, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.439831733703613, "actor_loss": -6.147141456604004, "critic_loss": 5.929481506347656, "alpha_loss": -0.09277570992708206, "alpha_value": 0.9931207299232483, "log_alpha_value": -0.0069030411541461945, "target_entropy": -8.0, "policy_t": 0.008347975090146065, "mean_q": 0.8021062612533569, "max_q": 1.3347177505493164, "min_q": 0.4081839919090271}, "td_error": [7.878861427307129, 7.64002799987793, 7.865635871887207, 7.541390419006348, 8.153751373291016, 8.049065589904785, 7.407370567321777, 7.89913272857666, 8.26429557800293, 9.703094482421875, 7.585312843322754, 8.146607398986816, 7.986662864685059, 8.441329956054688, 7.941747665405273, 8.941057205200195, 7.631860733032227, 7.587393760681152, 7.969870090484619, 8.355292320251465, 8.524124145507812, 7.929534912109375, 8.547469139099121, 8.334295272827148, 7.766107559204102, 7.4251298904418945, 7.871374130249023, 8.176734924316406, 8.039627075195312, 7.216010093688965, 9.276252746582031, 8.34339427947998, 8.250333786010742, 8.141120910644531, 8.444337844848633, 7.979345321655273, 8.908535957336426, 8.443157196044922, 8.193158149719238, 7.591672897338867, 7.574289321899414, 8.948532104492188, 7.587657928466797, 8.592498779296875, 8.047125816345215, 7.1881914138793945, 8.163230895996094, 7.902575492858887, 8.389705657958984, 7.82003116607666, 7.622086524963379, 8.59505844116211, 8.653159141540527, 7.978425025939941, 8.488717079162598, 7.715771675109863, 8.09376049041748, 7.850885391235352, 7.807133674621582, 8.582983016967773, 7.900293350219727, 8.286887168884277, 7.041659355163574, 8.284543991088867, 8.953584671020508, 7.765358924865723, 8.561103820800781, 7.416053771972656, 8.204594612121582, 7.347638130187988, 8.259827613830566, 7.265460014343262, 8.267922401428223, 8.620858192443848, 7.973884105682373, 8.063362121582031, 9.40394401550293, 8.45663833618164, 7.65061092376709, 7.932607173919678, 8.646258354187012, 8.476137161254883, 8.787517547607422, 8.121115684509277, 8.374588012695312, 7.704616069793701, 8.145819664001465, 7.997086048126221, 7.968084335327148, 8.750818252563477, 8.108294486999512, 8.009187698364258, 7.401022434234619, 7.96437931060791, 7.768815994262695, 8.158519744873047, 7.30428409576416, 7.293506622314453, 6.99430513381958, 8.31749153137207, 8.47665023803711, 8.088915824890137, 8.133010864257812, 8.035714149475098, 8.063702583312988, 9.135887145996094, 7.429201126098633, 7.497096061706543, 8.197657585144043, 8.19346809387207, 8.644071578979492, 8.100181579589844, 7.822726249694824, 7.557945251464844, 7.804347991943359, 8.390302658081055, 8.249000549316406, 8.170310974121094, 8.083782196044922, 7.844570159912109, 7.375782012939453, 7.374693870544434, 8.472742080688477, 8.038625717163086, 8.46204662322998, 8.48971176147461, 8.29379653930664, 8.095640182495117], "mean_td_error": 8.081746101379395, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 6200, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 12400, "num_agent_steps_trained": 6144, "last_target_update_ts": 6200, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3777.8598899896456, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1848.7842878749616, "robot_1": 1929.0756021146838}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1848.7842878749616, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1929.0756021146838, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.850441241035528, "mean_inference_ms": 3.831163917000939, "mean_action_processing_ms": 0.5353685891988943, "mean_env_wait_ms": 0.5024974317145549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009946028391520182, "StateBufferConnector_ms": 0.006472071011861165, "ViewRequirementAgentConnector_ms": 0.1561035712560018}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3777.8598899896456, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1848.7842878749616, "robot_1": 1929.0756021146838}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.850441241035528, "mean_inference_ms": 3.831163917000939, "mean_action_processing_ms": 0.5353685891988943, "mean_env_wait_ms": 0.5024974317145549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009946028391520182, "StateBufferConnector_ms": 0.006472071011861165, "ViewRequirementAgentConnector_ms": 0.1561035712560018}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12400, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6200, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 387.10143048253576, "num_env_steps_trained_throughput_per_sec": 495.4898310176458, "timesteps_total": 6200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12400, "timers": {"training_iteration_time_ms": 513.081, "sample_time_ms": 287.96, "load_time_ms": 0.938, "load_throughput": 272786.399, "learn_time_ms": 36.375, "learn_throughput": 7037.875, "synch_weights_time_ms": 13.351}, "counters": {"num_env_steps_sampled": 6200, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 12400, "num_agent_steps_trained": 6144, "last_target_update_ts": 6200, "num_target_updates": 24}, "done": false, "episodes_total": 12, "training_iteration": 13, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-16", "timestamp": 1742586556, "time_this_iter_s": 1.0496232509613037, "time_total_s": 16.46337652206421, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A587F550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 16.46337652206421, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.3, "ram_util_percent": 90.8}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1848.7842878749616, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1929.0756021146838, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.500658988952637, "actor_loss": -6.269258975982666, "critic_loss": 5.750977993011475, "alpha_loss": -0.10130064189434052, "alpha_value": 0.9925246834754944, "log_alpha_value": -0.007503384258598089, "target_entropy": -8.0, "policy_t": -0.009919431991875172, "mean_q": 0.8397194743156433, "max_q": 1.6755131483078003, "min_q": 0.4589538872241974}, "td_error": [7.366993427276611, 7.375812530517578, 7.8759307861328125, 7.030778884887695, 7.814460754394531, 7.563423156738281, 8.039278030395508, 7.617987632751465, 7.597668647766113, 7.3095173835754395, 7.660883903503418, 7.463600158691406, 8.745920181274414, 9.151835441589355, 8.118780136108398, 7.933218955993652, 7.865547180175781, 7.9377312660217285, 7.810870170593262, 7.595836162567139, 7.894458770751953, 7.488679885864258, 7.502003192901611, 7.559847831726074, 7.426705360412598, 7.771400451660156, 7.941009044647217, 7.8767313957214355, 7.196476459503174, 8.111598014831543, 7.537242889404297, 8.039618492126465, 8.237546920776367, 7.246477127075195, 7.93196964263916, 7.98832893371582, 7.479825973510742, 8.849395751953125, 7.548345565795898, 7.938013076782227, 7.971761703491211, 7.383278846740723, 7.682323455810547, 8.10207462310791, 8.094379425048828, 7.218317985534668, 8.41070556640625, 7.532717704772949, 7.6813836097717285, 7.1275835037231445, 7.325417995452881, 8.83723258972168, 8.041081428527832, 7.564242362976074, 7.877481460571289, 8.151045799255371, 7.628784656524658, 7.842168807983398, 7.106590270996094, 7.811733245849609, 7.306670665740967, 7.791566848754883, 7.866835117340088, 7.298134803771973, 7.758262634277344, 7.79390287399292, 7.878445148468018, 7.708335876464844, 8.261423110961914, 7.569263935089111, 7.899477958679199, 7.237184047698975, 7.246784210205078, 7.525479316711426, 7.698713779449463, 8.02538776397705, 7.29719352722168, 7.962334156036377, 8.091176986694336, 8.157578468322754, 7.705709457397461, 7.964632034301758, 7.831521987915039, 7.453578948974609, 7.392312049865723, 7.7581963539123535, 7.165423393249512, 8.208707809448242, 7.929281711578369, 7.472395896911621, 7.775120258331299, 7.0210371017456055, 7.4369611740112305, 7.295869827270508, 7.986686706542969, 7.467069625854492, 7.951864242553711, 7.815893650054932, 8.14857006072998, 6.9782819747924805, 7.195243835449219, 8.233455657958984, 8.086424827575684, 8.032249450683594, 8.660457611083984, 7.934742450714111, 7.72812557220459, 7.106950759887695, 7.574975967407227, 7.785794258117676, 7.008611679077148, 7.2729082107543945, 7.604545593261719, 7.764517784118652, 7.421109676361084, 7.3437910079956055, 8.087130546569824, 7.733696937561035, 7.643092155456543, 7.674504280090332, 7.353841781616211, 7.524434566497803, 7.633517742156982, 7.018915176391602, 7.595259666442871, 8.252992630004883, 7.812306880950928, 7.637294769287109], "mean_td_error": 7.7241106033325195, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.471324920654297, "actor_loss": -6.249409198760986, "critic_loss": 5.537354469299316, "alpha_loss": -0.10108177363872528, "alpha_value": 0.9925246238708496, "log_alpha_value": -0.007503477856516838, "target_entropy": -8.0, "policy_t": -0.0154175516217947, "mean_q": 0.8874850869178772, "max_q": 1.6010863780975342, "min_q": 0.5846361517906189}, "td_error": [7.8610382080078125, 8.199167251586914, 7.30894136428833, 7.571188926696777, 8.077255249023438, 9.717500686645508, 8.051868438720703, 7.539318084716797, 7.265128135681152, 8.128746032714844, 8.15536880493164, 7.39277458190918, 7.921236991882324, 8.777362823486328, 7.118465423583984, 7.97323751449585, 8.386377334594727, 8.605355262756348, 7.649274826049805, 7.822399139404297, 7.5434160232543945, 6.877523422241211, 7.30424690246582, 7.810595512390137, 7.407857894897461, 7.890659332275391, 8.45889663696289, 7.629608154296875, 8.36549186706543, 7.511628150939941, 8.546459197998047, 8.096061706542969, 8.527584075927734, 7.780590057373047, 7.855175971984863, 6.842599868774414, 7.28679084777832, 7.763938903808594, 7.60076904296875, 7.195871829986572, 7.882961273193359, 7.708120346069336, 8.0990629196167, 7.673644542694092, 7.735846996307373, 7.353411674499512, 8.255431175231934, 7.840239524841309, 7.827016353607178, 8.237129211425781, 7.953802585601807, 7.7612762451171875, 7.712113857269287, 7.227563858032227, 7.429276943206787, 7.518798351287842, 7.9468536376953125, 8.102787017822266, 8.114381790161133, 8.02047061920166, 8.337508201599121, 7.234063148498535, 8.32126235961914, 7.412776947021484, 8.116952896118164, 8.593602180480957, 8.18130111694336, 8.133773803710938, 7.633242607116699, 8.181901931762695, 7.672380447387695, 8.229047775268555, 7.933520317077637, 8.531326293945312, 8.128276824951172, 8.368163108825684, 7.320865631103516, 7.932242393493652, 7.870640754699707, 8.921220779418945, 7.4778618812561035, 7.763408184051514, 8.113656997680664, 8.061666488647461, 7.654880523681641, 6.96270751953125, 7.682533264160156, 7.978205680847168, 8.609163284301758, 6.921020030975342, 7.909489631652832, 8.506519317626953, 7.296542167663574, 8.306100845336914, 8.266119956970215, 8.099172592163086, 7.513392448425293, 7.740120887756348, 7.284414291381836, 8.254130363464355, 7.641083240509033, 8.66896915435791, 8.628137588500977, 7.545566558837891, 8.468204498291016, 7.751373291015625, 7.730865478515625, 7.811056137084961, 7.683564186096191, 8.21683406829834, 7.57528018951416, 8.142133712768555, 7.740236282348633, 7.505345344543457, 7.390869140625, 7.227402687072754, 7.400881767272949, 8.26795768737793, 7.534815788269043, 7.368674278259277, 7.682406425476074, 7.393052577972412, 7.708697319030762, 7.055397033691406, 8.529273986816406, 7.572026252746582, 8.751850128173828, 8.68441390991211], "mean_td_error": 7.869918346405029, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 6600, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 13200, "num_agent_steps_trained": 6656, "last_target_update_ts": 6600, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3777.8598899896456, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1848.7842878749616, "robot_1": 1929.0756021146838}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1848.7842878749616, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1929.0756021146838, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.850441241035528, "mean_inference_ms": 3.831163917000939, "mean_action_processing_ms": 0.5353685891988943, "mean_env_wait_ms": 0.5024974317145549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009946028391520182, "StateBufferConnector_ms": 0.006472071011861165, "ViewRequirementAgentConnector_ms": 0.1561035712560018}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3777.8598899896456, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1848.7842878749616, "robot_1": 1929.0756021146838}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.850441241035528, "mean_inference_ms": 3.831163917000939, "mean_action_processing_ms": 0.5353685891988943, "mean_env_wait_ms": 0.5024974317145549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009946028391520182, "StateBufferConnector_ms": 0.006472071011861165, "ViewRequirementAgentConnector_ms": 0.1561035712560018}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13200, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 6600, "num_env_steps_trained": 6656, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 390.35236892233, "num_env_steps_trained_throughput_per_sec": 499.6510322205824, "timesteps_total": 6600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13200, "timers": {"training_iteration_time_ms": 515.578, "sample_time_ms": 290.633, "load_time_ms": 0.889, "load_throughput": 287851.006, "learn_time_ms": 36.455, "learn_throughput": 7022.418, "synch_weights_time_ms": 12.831}, "counters": {"num_env_steps_sampled": 6600, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 13200, "num_agent_steps_trained": 6656, "last_target_update_ts": 6600, "num_target_updates": 26}, "done": false, "episodes_total": 12, "training_iteration": 14, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-17", "timestamp": 1742586557, "time_this_iter_s": 1.0413851737976074, "time_total_s": 17.504761695861816, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A587F940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 17.504761695861816, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.799999999999997, "ram_util_percent": 90.85}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1848.7842878749616, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1929.0756021146838, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.451601028442383, "actor_loss": -6.451939105987549, "critic_loss": 5.484102725982666, "alpha_loss": -0.113047756254673, "alpha_value": 0.9916311502456665, "log_alpha_value": -0.008404036983847618, "target_entropy": -8.0, "policy_t": -0.011767290532588959, "mean_q": 1.09645414352417, "max_q": 2.0482680797576904, "min_q": 0.5705851912498474}, "td_error": [7.657337188720703, 7.1692304611206055, 8.240995407104492, 7.728577136993408, 7.675161361694336, 7.720110893249512, 7.62800407409668, 7.26933479309082, 7.254968643188477, 7.881814002990723, 7.438324928283691, 6.866187572479248, 7.229833126068115, 7.438457489013672, 6.48426628112793, 7.410706520080566, 6.610398292541504, 7.46471643447876, 7.939873695373535, 7.813658714294434, 7.64700174331665, 6.901374816894531, 7.481060028076172, 6.96567440032959, 7.151232719421387, 6.797701835632324, 7.547005653381348, 7.677044868469238, 7.8385910987854, 6.62661075592041, 7.451302528381348, 7.166152000427246, 6.861918926239014, 9.310300827026367, 7.845659255981445, 7.047965049743652, 7.2039947509765625, 7.417581558227539, 7.507778167724609, 7.766653060913086, 7.465793132781982, 7.38947057723999, 7.000199317932129, 7.185723304748535, 7.387481689453125, 7.389039993286133, 8.187145233154297, 7.290947437286377, 6.8496012687683105, 7.366425514221191, 7.134154319763184, 6.885422229766846, 7.123255729675293, 7.85740852355957, 7.3981733322143555, 7.075236797332764, 7.5314621925354, 7.42462158203125, 7.498520851135254, 7.470020771026611, 7.484714031219482, 6.778903484344482, 7.173068046569824, 6.968944549560547, 6.790735721588135, 7.360353946685791, 7.237659931182861, 7.567900657653809, 7.600698471069336, 7.520053863525391, 7.294089317321777, 7.7938947677612305, 7.7080488204956055, 7.370969772338867, 7.675745964050293, 7.307462692260742, 7.199373722076416, 7.772559642791748, 7.170470237731934, 7.700107574462891, 7.432118892669678, 7.699671745300293, 7.902854919433594, 7.982122421264648, 7.140988349914551, 7.710695266723633, 7.515918731689453, 8.509603500366211, 7.109244346618652, 7.532538414001465, 7.571540832519531, 7.540756702423096, 7.628192901611328, 7.699281692504883, 7.457108497619629, 7.457522392272949, 7.249349594116211, 8.01445484161377, 7.36578369140625, 7.852239608764648, 7.603817462921143, 6.848792552947998, 7.531993865966797, 6.861191749572754, 7.592554092407227, 7.242996692657471, 7.958373069763184, 7.683723449707031, 7.658576965332031, 7.898373603820801, 7.172379016876221, 7.830970764160156, 6.881725788116455, 7.132730484008789, 7.2923903465271, 7.510003089904785, 6.924858570098877, 7.8744730949401855, 7.325416564941406, 7.114607810974121, 7.1846723556518555, 7.522612571716309, 7.3782806396484375, 7.291706085205078, 7.608736038208008, 8.1976318359375, 7.566622734069824, 7.354474067687988], "mean_td_error": 7.437008380889893, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.494598388671875, "actor_loss": -6.5623908042907715, "critic_loss": 5.350168704986572, "alpha_loss": -0.11340907216072083, "alpha_value": 0.9916311502456665, "log_alpha_value": -0.008404035121202469, "target_entropy": -8.0, "policy_t": -0.014906877651810646, "mean_q": 1.1908137798309326, "max_q": 1.9773942232131958, "min_q": 0.696414589881897}, "td_error": [7.469120025634766, 7.438182353973389, 8.187495231628418, 8.048013687133789, 6.940276145935059, 7.627053737640381, 8.019351959228516, 7.757225036621094, 7.682547092437744, 6.62988805770874, 7.14784049987793, 9.483135223388672, 7.397299766540527, 6.938865661621094, 7.495748519897461, 7.2128753662109375, 7.564617156982422, 7.195958614349365, 7.312263488769531, 7.254426956176758, 7.5444464683532715, 7.06032657623291, 7.555345058441162, 7.356027603149414, 7.415998458862305, 8.198556900024414, 6.632392883300781, 7.331935882568359, 6.9438934326171875, 7.590153694152832, 7.430375099182129, 7.986227035522461, 7.957374572753906, 8.216136932373047, 7.85240364074707, 7.695985794067383, 7.5262556076049805, 7.625279426574707, 8.424596786499023, 7.376175880432129, 7.205684661865234, 6.866131782531738, 7.524660110473633, 7.713193893432617, 8.065351486206055, 7.485269546508789, 7.177731513977051, 7.282995700836182, 8.084217071533203, 8.291640281677246, 6.904314041137695, 6.822359085083008, 7.128344535827637, 7.706299781799316, 7.777810096740723, 7.233426094055176, 6.92424201965332, 7.548084259033203, 7.824187278747559, 8.064580917358398, 7.494441509246826, 6.64839506149292, 7.549452781677246, 7.760987281799316, 8.140970230102539, 8.148290634155273, 7.841578006744385, 7.811692714691162, 6.7152910232543945, 8.18393325805664, 6.525398254394531, 7.576061248779297, 7.4738006591796875, 7.371851921081543, 7.641426086425781, 7.187807083129883, 7.5386199951171875, 7.886354446411133, 7.0423688888549805, 7.629722595214844, 7.301413536071777, 7.793635368347168, 7.616946697235107, 7.427333831787109, 7.747561454772949, 7.908896446228027, 7.392638206481934, 7.609952926635742, 6.961727142333984, 7.289816856384277, 6.920147895812988, 8.148794174194336, 7.590174674987793, 7.679182529449463, 7.602136611938477, 7.482234001159668, 6.9756622314453125, 6.678269386291504, 7.334421157836914, 7.590370178222656, 7.193872451782227, 7.295858383178711, 7.397141456604004, 7.54043436050415, 7.6234025955200195, 7.774962425231934, 6.965166091918945, 6.86445426940918, 7.530089378356934, 7.358933448791504, 8.306795120239258, 8.078141212463379, 8.191390991210938, 7.4581403732299805, 7.758554458618164, 7.436309814453125, 8.144969940185547, 8.032665252685547, 7.103538513183594, 8.16202163696289, 8.35737133026123, 7.447061538696289, 6.760091781616211, 7.755825996398926, 7.321247577667236, 7.735509872436523, 6.718299865722656, 7.656537055969238], "mean_td_error": 7.526102542877197, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 28.0}}, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7424, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 7424, "last_target_update_ts": 7200, "num_target_updates": 29}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3777.8598899896456, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1848.7842878749616, "robot_1": 1929.0756021146838}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1848.7842878749616, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1929.0756021146838, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.850441241035528, "mean_inference_ms": 3.831163917000939, "mean_action_processing_ms": 0.5353685891988943, "mean_env_wait_ms": 0.5024974317145549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009946028391520182, "StateBufferConnector_ms": 0.006472071011861165, "ViewRequirementAgentConnector_ms": 0.1561035712560018}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3777.8598899896456, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1848.7842878749616, "robot_1": 1929.0756021146838}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.850441241035528, "mean_inference_ms": 3.831163917000939, "mean_action_processing_ms": 0.5353685891988943, "mean_env_wait_ms": 0.5024974317145549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009946028391520182, "StateBufferConnector_ms": 0.006472071011861165, "ViewRequirementAgentConnector_ms": 0.1561035712560018}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 7424, "num_env_steps_sampled": 7200, "num_env_steps_trained": 7424, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 410.42479083535875, "num_env_steps_trained_throughput_per_sec": 525.3437322692592, "timesteps_total": 7200, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 14400, "timers": {"training_iteration_time_ms": 499.532, "sample_time_ms": 278.655, "load_time_ms": 0.889, "load_throughput": 287851.006, "learn_time_ms": 33.704, "learn_throughput": 7595.587, "synch_weights_time_ms": 11.599}, "counters": {"num_env_steps_sampled": 7200, "num_env_steps_trained": 7424, "num_agent_steps_sampled": 14400, "num_agent_steps_trained": 7424, "last_target_update_ts": 7200, "num_target_updates": 29}, "done": false, "episodes_total": 12, "training_iteration": 15, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-18", "timestamp": 1742586558, "time_this_iter_s": 1.4784233570098877, "time_total_s": 18.983185052871704, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57C6790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 18.983185052871704, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.75, "ram_util_percent": 90.9}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1848.7842878749616, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1929.0756021146838, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.407622337341309, "actor_loss": -6.574900150299072, "critic_loss": 5.577949523925781, "alpha_loss": -0.12072701752185822, "alpha_value": 0.991036057472229, "log_alpha_value": -0.009004357270896435, "target_entropy": -8.0, "policy_t": -0.001972183119505644, "mean_q": 1.2411737442016602, "max_q": 2.2707507610321045, "min_q": 0.706377387046814}, "td_error": [7.738913059234619, 7.2525129318237305, 7.791872978210449, 8.016753196716309, 7.2096381187438965, 7.250044822692871, 7.822982311248779, 7.279171943664551, 7.9608283042907715, 6.972963333129883, 7.9935455322265625, 7.121452808380127, 8.033990859985352, 7.13659143447876, 7.53455114364624, 6.5118913650512695, 7.107713222503662, 8.39854621887207, 7.50632381439209, 7.963099956512451, 7.352202415466309, 7.3027544021606445, 7.651922225952148, 7.84169864654541, 7.406020164489746, 7.942474365234375, 7.502415657043457, 6.693112850189209, 7.184024810791016, 7.4118194580078125, 6.966981410980225, 7.055363655090332, 8.313713073730469, 7.527535438537598, 7.424103736877441, 7.2788825035095215, 7.651538372039795, 7.595365524291992, 7.148812294006348, 7.399683475494385, 6.756263732910156, 7.788530349731445, 7.379321098327637, 6.804313659667969, 7.493110656738281, 7.297591209411621, 7.8515729904174805, 7.510169506072998, 7.067322731018066, 7.643459320068359, 7.43630313873291, 7.5267534255981445, 7.091087818145752, 7.1389923095703125, 7.005110740661621, 7.023321151733398, 7.612608432769775, 7.168967247009277, 7.301766395568848, 7.287276268005371, 7.8546142578125, 6.897345066070557, 7.638064384460449, 7.191832542419434, 7.78008508682251, 7.295336723327637, 6.970036506652832, 7.071741104125977, 6.951680660247803, 6.614110469818115, 7.235467433929443, 7.625617980957031, 7.053589820861816, 6.748549461364746, 7.164981842041016, 7.160531997680664, 7.012228488922119, 7.286719799041748, 6.929627418518066, 8.075420379638672, 7.090211868286133, 7.762560844421387, 7.594970226287842, 7.24468994140625, 7.578254699707031, 7.447793006896973, 7.755677223205566, 7.177546501159668, 7.4425048828125, 7.346643924713135, 7.667149543762207, 6.933936595916748, 7.605091094970703, 7.361225128173828, 7.314075946807861, 8.864776611328125, 6.614480495452881, 6.997217178344727, 7.165276527404785, 7.3948211669921875, 6.8877763748168945, 7.4334716796875, 7.465144157409668, 8.226640701293945, 6.808660507202148, 7.04796028137207, 7.629383563995361, 6.813808441162109, 7.418664932250977, 6.837943077087402, 7.250831604003906, 7.08709716796875, 7.015615463256836, 7.470534324645996, 6.951340675354004, 6.572723388671875, 6.707627296447754, 7.459921836853027, 7.563094615936279, 6.841597557067871, 5.984314918518066, 7.450361251831055, 7.036879062652588, 7.062182426452637, 7.987499237060547, 6.660068511962891, 7.350423336029053, 6.588335990905762], "mean_td_error": 7.327844142913818, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.487857818603516, "actor_loss": -6.737607955932617, "critic_loss": 5.401228427886963, "alpha_loss": -0.1214512437582016, "alpha_value": 0.9910359382629395, "log_alpha_value": -0.009004487656056881, "target_entropy": -8.0, "policy_t": 0.010005073621869087, "mean_q": 1.4284223318099976, "max_q": 2.2924375534057617, "min_q": 0.902295708656311}, "td_error": [7.582662582397461, 7.217733383178711, 6.938241004943848, 6.630841255187988, 8.008357048034668, 7.4981255531311035, 7.115777015686035, 7.319835662841797, 8.748775482177734, 7.142385482788086, 7.129611968994141, 8.11865234375, 7.014071941375732, 7.457747459411621, 6.485754489898682, 6.928733825683594, 7.794981479644775, 7.48018217086792, 6.82892370223999, 7.074583053588867, 7.465057849884033, 6.680528163909912, 6.817256450653076, 6.741745948791504, 7.3966217041015625, 7.167214870452881, 7.014799118041992, 6.703656196594238, 7.443070411682129, 8.070189476013184, 7.599700927734375, 7.993992805480957, 8.555404663085938, 6.822610855102539, 7.939851760864258, 6.605323791503906, 7.257336616516113, 8.303133010864258, 6.328585624694824, 7.146176338195801, 7.875983238220215, 7.355554103851318, 7.049963474273682, 7.461890697479248, 7.737255096435547, 6.803423881530762, 7.255380153656006, 8.609172821044922, 7.334007263183594, 7.0132551193237305, 7.290839195251465, 8.195365905761719, 7.376530170440674, 7.395258903503418, 7.209796905517578, 7.291041374206543, 7.3951568603515625, 7.558222770690918, 7.700367450714111, 7.778149604797363, 6.808629035949707, 7.873539924621582, 7.327256202697754, 7.3307061195373535, 7.508683204650879, 7.237941741943359, 7.571630001068115, 7.774587631225586, 6.331169605255127, 7.7421112060546875, 7.235784530639648, 7.865084171295166, 7.701227188110352, 7.200017929077148, 7.141166687011719, 7.214210033416748, 6.831801891326904, 7.8861613273620605, 7.813459396362305, 7.215287208557129, 7.382647514343262, 7.539992332458496, 6.886610984802246, 7.339722633361816, 7.680963516235352, 7.022261619567871, 7.460937023162842, 7.616228103637695, 7.1789093017578125, 7.294625282287598, 7.132572650909424, 7.150906562805176, 7.343249320983887, 7.016772747039795, 7.058656692504883, 7.366777420043945, 7.806779861450195, 7.189807891845703, 7.361310958862305, 7.683704376220703, 6.780893325805664, 7.065301418304443, 7.318918228149414, 6.792032241821289, 7.75799560546875, 7.929558277130127, 7.6522722244262695, 7.227595329284668, 8.005388259887695, 7.306615352630615, 6.590734481811523, 6.8797712326049805, 7.244711875915527, 8.16174602508545, 7.338876724243164, 7.051979064941406, 6.98075532913208, 8.394186019897461, 8.130022048950195, 7.906287670135498, 6.722020149230957, 7.547460556030273, 7.30392599105835, 6.535396575927734, 7.325492858886719, 7.024606704711914, 6.790938377380371, 6.843483924865723], "mean_td_error": 7.351466655731201, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 7600, "num_env_steps_trained": 7936, "num_agent_steps_sampled": 15200, "num_agent_steps_trained": 7936, "last_target_update_ts": 7600, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3777.8598899896456, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1848.7842878749616, "robot_1": 1929.0756021146838}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1848.7842878749616, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1929.0756021146838, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.850441241035528, "mean_inference_ms": 3.831163917000939, "mean_action_processing_ms": 0.5353685891988943, "mean_env_wait_ms": 0.5024974317145549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009946028391520182, "StateBufferConnector_ms": 0.006472071011861165, "ViewRequirementAgentConnector_ms": 0.1561035712560018}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3777.8598899896456, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1848.7842878749616, "robot_1": 1929.0756021146838}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.850441241035528, "mean_inference_ms": 3.831163917000939, "mean_action_processing_ms": 0.5353685891988943, "mean_env_wait_ms": 0.5024974317145549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009946028391520182, "StateBufferConnector_ms": 0.006472071011861165, "ViewRequirementAgentConnector_ms": 0.1561035712560018}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15200, "num_agent_steps_trained": 7936, "num_env_steps_sampled": 7600, "num_env_steps_trained": 7936, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 393.3038173679717, "num_env_steps_trained_throughput_per_sec": 503.4288862310038, "timesteps_total": 7600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15200, "timers": {"training_iteration_time_ms": 504.528, "sample_time_ms": 279.801, "load_time_ms": 0.138, "load_throughput": 1853196.106, "learn_time_ms": 36.243, "learn_throughput": 7063.529, "synch_weights_time_ms": 11.837}, "counters": {"num_env_steps_sampled": 7600, "num_env_steps_trained": 7936, "num_agent_steps_sampled": 15200, "num_agent_steps_trained": 7936, "last_target_update_ts": 7600, "num_target_updates": 31}, "done": false, "episodes_total": 12, "training_iteration": 16, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-20", "timestamp": 1742586560, "time_this_iter_s": 1.0336170196533203, "time_total_s": 20.016802072525024, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57C68B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 20.016802072525024, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.5, "ram_util_percent": 91.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1861.0395305675788, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1930.5695773084603, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.489901542663574, "actor_loss": -6.986938953399658, "critic_loss": 5.118864059448242, "alpha_loss": -0.1336127519607544, "alpha_value": 0.9901442527770996, "log_alpha_value": -0.009904650039970875, "target_entropy": -8.0, "policy_t": 0.02076619490981102, "mean_q": 1.6216837167739868, "max_q": 2.9583828449249268, "min_q": 0.9161884188652039}, "td_error": [6.603642463684082, 6.272463798522949, 6.683542251586914, 6.511748313903809, 7.661029815673828, 6.600130081176758, 6.550980567932129, 6.1691575050354, 7.029086589813232, 7.490729331970215, 7.388295650482178, 6.638887405395508, 7.240828514099121, 6.4908623695373535, 6.788305282592773, 6.3888325691223145, 6.872045516967773, 8.029900550842285, 7.073184967041016, 7.0674943923950195, 6.6670942306518555, 6.375074863433838, 6.777243614196777, 6.748782157897949, 7.455839157104492, 6.729458332061768, 6.240333557128906, 7.432217597961426, 6.715773105621338, 6.886957168579102, 7.380523681640625, 7.1636176109313965, 7.163115501403809, 7.0605974197387695, 7.5639448165893555, 7.425181865692139, 6.74589729309082, 6.831806182861328, 6.858310699462891, 7.525764465332031, 7.153249740600586, 7.162570953369141, 6.607644081115723, 7.031937599182129, 8.099502563476562, 6.972585201263428, 6.7887701988220215, 6.8336310386657715, 7.202210426330566, 6.597108364105225, 6.638339996337891, 6.78558874130249, 8.195829391479492, 6.880784034729004, 6.38487434387207, 6.464348793029785, 7.260817527770996, 6.619098663330078, 6.5706281661987305, 6.471946716308594, 6.964840412139893, 7.135681629180908, 8.41973876953125, 6.590605735778809, 6.047840118408203, 7.046415328979492, 7.439249515533447, 6.65902042388916, 7.4744977951049805, 6.855738162994385, 7.415836334228516, 7.376638412475586, 7.277657508850098, 6.2263593673706055, 6.367015838623047, 6.661554336547852, 6.729671478271484, 6.565913677215576, 7.887084484100342, 7.407243251800537, 6.5855937004089355, 7.422327041625977, 6.5570244789123535, 6.695974349975586, 6.716553211212158, 6.54398250579834, 7.460763454437256, 6.607006549835205, 7.410371780395508, 6.622935771942139, 7.5046706199646, 6.365766525268555, 7.140773773193359, 6.52541446685791, 7.197731018066406, 7.898258686065674, 7.869839668273926, 6.984159469604492, 7.157626152038574, 7.196874618530273, 6.819086074829102, 5.991960048675537, 6.882534027099609, 6.799707412719727, 7.251656532287598, 6.972953796386719, 7.029570579528809, 6.95961856842041, 7.476245403289795, 6.877615451812744, 6.478475570678711, 7.115974426269531, 6.938963413238525, 7.570725440979004, 7.387618064880371, 6.757632255554199, 6.5292744636535645, 6.701382637023926, 6.570374488830566, 6.545469760894775, 6.804879665374756, 6.972586631774902, 6.531435966491699, 6.590652942657471, 6.931849956512451, 6.880895614624023, 6.6878767013549805, 6.694956302642822], "mean_td_error": 6.943627834320068, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.48844051361084, "actor_loss": -7.0267744064331055, "critic_loss": 5.09153938293457, "alpha_loss": -0.13360637426376343, "alpha_value": 0.9901436567306519, "log_alpha_value": -0.009905250743031502, "target_entropy": -8.0, "policy_t": 0.010440465062856674, "mean_q": 1.7129848003387451, "max_q": 2.818490743637085, "min_q": 1.051546573638916}, "td_error": [7.209408760070801, 6.917819499969482, 7.86826229095459, 7.184235572814941, 6.976552963256836, 7.545943260192871, 7.069684028625488, 6.868141174316406, 6.708636283874512, 6.7149457931518555, 6.774379730224609, 6.276808738708496, 6.466416358947754, 7.0167107582092285, 7.25475549697876, 6.772551536560059, 7.21780252456665, 7.239606857299805, 7.557802200317383, 7.795833110809326, 7.0317769050598145, 7.067594051361084, 7.573843955993652, 6.141213893890381, 7.340269088745117, 7.866001605987549, 6.836002349853516, 7.418497085571289, 6.54571533203125, 6.748871803283691, 6.589593887329102, 7.437763214111328, 6.732949733734131, 6.828989028930664, 8.252772331237793, 6.5598907470703125, 6.7978715896606445, 7.07485294342041, 7.204316139221191, 7.0166215896606445, 7.474300384521484, 7.163673400878906, 7.017581462860107, 6.5218186378479, 6.765511512756348, 6.115128517150879, 6.872435092926025, 7.478710174560547, 6.874049186706543, 7.5951619148254395, 7.3343400955200195, 6.317408561706543, 6.235752105712891, 7.024491786956787, 7.259825706481934, 7.3263468742370605, 7.1220598220825195, 7.003386497497559, 8.04812240600586, 6.140524387359619, 6.702476978302002, 7.1523332595825195, 6.560525894165039, 6.412258148193359, 6.066847801208496, 6.241989612579346, 6.682160377502441, 7.823193073272705, 6.987778186798096, 7.500855445861816, 7.04661750793457, 7.259410858154297, 6.631140232086182, 6.612545013427734, 6.879790782928467, 7.868258476257324, 8.123617172241211, 6.907482147216797, 7.3460540771484375, 6.854485034942627, 7.347630500793457, 6.184748649597168, 6.732362747192383, 8.52725601196289, 6.97696590423584, 6.630561828613281, 6.876681327819824, 7.19334602355957, 7.677772521972656, 6.834108352661133, 6.952064514160156, 6.918459892272949, 6.56025505065918, 7.575896263122559, 6.574246883392334, 6.732573509216309, 7.433628082275391, 8.122459411621094, 6.948411464691162, 7.951711654663086, 7.887844085693359, 7.525641441345215, 7.237572193145752, 6.947099685668945, 6.950913906097412, 6.4386186599731445, 6.389914512634277, 7.871567249298096, 8.116575241088867, 7.450477600097656, 6.540380954742432, 6.607443809509277, 7.744132995605469, 7.070507526397705, 6.429621696472168, 7.1069841384887695, 6.95720100402832, 7.1380228996276855, 6.804349422454834, 7.177083969116211, 7.114620208740234, 6.40070915222168, 6.789959907531738, 6.787322521209717, 7.100971698760986, 7.279866695404053, 7.000330924987793, 7.958587169647217], "mean_td_error": 7.058028221130371, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 8200, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 16400, "num_agent_steps_trained": 8704, "last_target_update_ts": 8200, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3791.609107876039, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1861.0395305675788, "robot_1": 1930.5695773084603}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1861.0395305675788, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1930.5695773084603, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8442652898667917, "mean_inference_ms": 3.7838985697948004, "mean_action_processing_ms": 0.5257937057557023, "mean_env_wait_ms": 0.49641528186882106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017344951629638672, "StateBufferConnector_ms": 0.004854053258895874, "ViewRequirementAgentConnector_ms": 0.13148486614227295}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3791.609107876039, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1861.0395305675788, "robot_1": 1930.5695773084603}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8442652898667917, "mean_inference_ms": 3.7838985697948004, "mean_action_processing_ms": 0.5257937057557023, "mean_env_wait_ms": 0.49641528186882106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017344951629638672, "StateBufferConnector_ms": 0.004854053258895874, "ViewRequirementAgentConnector_ms": 0.13148486614227295}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16400, "num_agent_steps_trained": 8704, "num_env_steps_sampled": 8200, "num_env_steps_trained": 8704, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 413.67827256634376, "num_env_steps_trained_throughput_per_sec": 529.50818888492, "timesteps_total": 8200, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 16400, "timers": {"training_iteration_time_ms": 495.404, "sample_time_ms": 273.96, "load_time_ms": 0.138, "load_throughput": 1853196.106, "learn_time_ms": 34.592, "learn_throughput": 7400.533, "synch_weights_time_ms": 11.785}, "counters": {"num_env_steps_sampled": 8200, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 16400, "num_agent_steps_trained": 8704, "last_target_update_ts": 8200, "num_target_updates": 34}, "done": false, "episodes_total": 16, "training_iteration": 17, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-21", "timestamp": 1742586561, "time_this_iter_s": 1.4668333530426025, "time_total_s": 21.483635425567627, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A587F940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 21.483635425567627, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.049999999999997, "ram_util_percent": 91.1}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1861.0395305675788, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1930.5695773084603, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.505025863647461, "actor_loss": -7.3610310554504395, "critic_loss": 4.934606552124023, "alpha_loss": -0.14592167735099792, "alpha_value": 0.9892531633377075, "log_alpha_value": -0.010804989375174046, "target_entropy": -8.0, "policy_t": -0.019007384777069092, "mean_q": 1.9833989143371582, "max_q": 3.75067400932312, "min_q": 1.096914529800415}, "td_error": [6.444756031036377, 7.132978439331055, 6.873325347900391, 6.302318096160889, 6.830661773681641, 6.955883026123047, 6.270804405212402, 6.553282737731934, 7.349703788757324, 6.967433929443359, 7.227872848510742, 7.061972141265869, 7.006222724914551, 6.6449432373046875, 6.765044212341309, 6.719554424285889, 6.094638347625732, 5.9864068031311035, 6.2452239990234375, 6.748598098754883, 7.231123924255371, 6.52248477935791, 6.319873332977295, 5.366188049316406, 6.629227161407471, 6.712778091430664, 6.138171195983887, 6.21006965637207, 6.766973495483398, 6.4025983810424805, 6.322575569152832, 5.933011054992676, 6.475650787353516, 7.786223888397217, 5.9622392654418945, 6.7801947593688965, 6.086409091949463, 6.040327072143555, 5.993130683898926, 7.4983978271484375, 7.166163444519043, 6.209242820739746, 6.4931416511535645, 6.2644758224487305, 6.446820259094238, 6.55049991607666, 7.814329147338867, 6.741697788238525, 5.830720901489258, 6.527734756469727, 6.6826581954956055, 6.110675811767578, 6.674313545227051, 6.287812232971191, 5.578640937805176, 6.987284183502197, 6.061300754547119, 5.720987319946289, 7.056276321411133, 6.5985283851623535, 6.041689872741699, 5.872043132781982, 6.979604244232178, 7.1795454025268555, 6.10167121887207, 5.984379291534424, 6.085104942321777, 6.803635120391846, 6.1834917068481445, 6.551124572753906, 7.06597900390625, 6.498534202575684, 7.0743913650512695, 7.043636322021484, 6.617953300476074, 6.248691082000732, 6.768775939941406, 5.997014045715332, 6.411643981933594, 7.363870620727539, 6.972125053405762, 5.631372451782227, 6.728663444519043, 6.732696533203125, 6.758473873138428, 6.1852707862854, 6.484273910522461, 6.884576797485352, 6.008733749389648, 6.383059501647949, 7.0521111488342285, 6.691036224365234, 6.551035404205322, 5.822077751159668, 6.190982818603516, 7.400406360626221, 6.642907619476318, 6.722609519958496, 6.939812183380127, 6.3528852462768555, 6.573944091796875, 6.639340400695801, 6.170527458190918, 6.500807285308838, 5.731358528137207, 6.455694675445557, 6.903909206390381, 6.075993537902832, 6.887857437133789, 6.382311820983887, 6.224621772766113, 7.713905334472656, 6.518024444580078, 5.173899173736572, 6.802890777587891, 6.836830139160156, 6.485424041748047, 6.736893653869629, 5.914022445678711, 6.4009690284729, 6.966284275054932, 5.726012229919434, 7.0886945724487305, 6.728909492492676, 7.045475959777832, 6.079015254974365, 6.88319206237793, 6.546653747558594], "mean_td_error": 6.541905403137207, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.450761795043945, "actor_loss": -7.373462677001953, "critic_loss": 4.887467861175537, "alpha_loss": -0.14535047113895416, "alpha_value": 0.9892520904541016, "log_alpha_value": -0.010806115344166756, "target_entropy": -8.0, "policy_t": 0.033948808908462524, "mean_q": 2.148254632949829, "max_q": 3.591843843460083, "min_q": 1.2860651016235352}, "td_error": [5.854203701019287, 6.631098747253418, 7.204714775085449, 6.617255210876465, 6.716442108154297, 6.260758399963379, 7.5761919021606445, 6.296425819396973, 6.939353942871094, 6.518466949462891, 6.788425922393799, 7.238800048828125, 5.78378963470459, 7.078887462615967, 7.058326721191406, 6.909658432006836, 6.994776725769043, 6.240468502044678, 6.785954475402832, 6.5167694091796875, 7.520343780517578, 6.907866477966309, 6.112699031829834, 7.266445159912109, 6.0375800132751465, 6.4102091789245605, 6.259218215942383, 5.750420570373535, 6.267922878265381, 6.601434707641602, 6.431246757507324, 6.138111114501953, 6.6410722732543945, 5.91799259185791, 6.512934684753418, 6.07546329498291, 7.8856987953186035, 6.4029951095581055, 5.847908973693848, 6.418111801147461, 6.808708190917969, 6.588926315307617, 6.075343132019043, 7.390201568603516, 6.196136474609375, 6.543910503387451, 5.715684413909912, 5.992048263549805, 6.936166763305664, 6.54249906539917, 7.207336902618408, 8.576375961303711, 6.123502731323242, 7.029391288757324, 6.90077543258667, 6.539440155029297, 6.920855522155762, 7.235052108764648, 6.0691752433776855, 6.839583396911621, 5.928686141967773, 6.413116455078125, 5.891354560852051, 7.426621437072754, 6.021714687347412, 6.281436920166016, 6.149553298950195, 5.762869358062744, 6.382440567016602, 7.148080825805664, 6.48126220703125, 7.068996906280518, 7.525774955749512, 6.616728782653809, 7.351579666137695, 7.298224449157715, 6.115050315856934, 6.221776008605957, 7.5076446533203125, 6.4717864990234375, 6.0217180252075195, 6.87140417098999, 7.01390266418457, 6.155886650085449, 6.61263370513916, 6.958355903625488, 6.781257629394531, 7.0972089767456055, 7.025437831878662, 7.605724811553955, 6.424063682556152, 6.193974018096924, 6.4015398025512695, 5.812075614929199, 5.713223934173584, 6.120996475219727, 6.064985752105713, 6.416411399841309, 5.999568939208984, 7.159797668457031, 6.709705352783203, 7.175687789916992, 7.185789108276367, 6.356369972229004, 6.207366943359375, 6.926719665527344, 7.61102294921875, 6.269222259521484, 6.275561809539795, 6.602998733520508, 6.773106575012207, 6.537021636962891, 8.156414985656738, 6.717993259429932, 6.3521270751953125, 6.310794830322266, 7.514826774597168, 6.432890892028809, 6.627695083618164, 6.768172740936279, 7.032012462615967, 6.87047815322876, 6.524497032165527, 6.480968475341797, 6.2091169357299805, 7.64818000793457, 6.29919958114624, 7.2377471923828125], "mean_td_error": 6.640438556671143, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 8800, "num_env_steps_trained": 9472, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 9472, "last_target_update_ts": 8800, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3791.609107876039, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1861.0395305675788, "robot_1": 1930.5695773084603}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1861.0395305675788, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1930.5695773084603, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8442652898667917, "mean_inference_ms": 3.7838985697948004, "mean_action_processing_ms": 0.5257937057557023, "mean_env_wait_ms": 0.49641528186882106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017344951629638672, "StateBufferConnector_ms": 0.004854053258895874, "ViewRequirementAgentConnector_ms": 0.13148486614227295}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3791.609107876039, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1861.0395305675788, "robot_1": 1930.5695773084603}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8442652898667917, "mean_inference_ms": 3.7838985697948004, "mean_action_processing_ms": 0.5257937057557023, "mean_env_wait_ms": 0.49641528186882106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017344951629638672, "StateBufferConnector_ms": 0.004854053258895874, "ViewRequirementAgentConnector_ms": 0.13148486614227295}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 9472, "num_env_steps_sampled": 8800, "num_env_steps_trained": 9472, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 406.6871299090531, "num_env_steps_trained_throughput_per_sec": 520.559526283588, "timesteps_total": 8800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 17600, "timers": {"training_iteration_time_ms": 491.636, "sample_time_ms": 268.538, "load_time_ms": 0.086, "load_throughput": 2963681.546, "learn_time_ms": 36.245, "learn_throughput": 7063.004, "synch_weights_time_ms": 12.521}, "counters": {"num_env_steps_sampled": 8800, "num_env_steps_trained": 9472, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 9472, "last_target_update_ts": 8800, "num_target_updates": 37}, "done": false, "episodes_total": 16, "training_iteration": 18, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-23", "timestamp": 1742586563, "time_this_iter_s": 1.4918813705444336, "time_total_s": 22.97551679611206, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57C6790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 22.97551679611206, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.4, "ram_util_percent": 91.15}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1861.0395305675788, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1930.5695773084603, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.440871238708496, "actor_loss": -7.607089996337891, "critic_loss": 4.592309474945068, "alpha_loss": -0.15329806506633759, "alpha_value": 0.9886594414710999, "log_alpha_value": -0.011405366472899914, "target_entropy": -8.0, "policy_t": -0.0005548307672142982, "mean_q": 2.3133962154388428, "max_q": 4.21268892288208, "min_q": 1.495328664779663}, "td_error": [6.572200775146484, 7.766959190368652, 6.509528636932373, 6.431796073913574, 6.76795768737793, 6.738631248474121, 6.191641330718994, 6.904898643493652, 6.6944990158081055, 6.425578594207764, 6.5331220626831055, 5.618678092956543, 6.2542829513549805, 5.817728042602539, 6.7130537033081055, 5.86729621887207, 6.439281463623047, 6.629752159118652, 6.742384910583496, 6.81297492980957, 6.212375164031982, 5.838925838470459, 6.491042137145996, 6.725343704223633, 6.732780456542969, 6.387566566467285, 6.531583309173584, 6.21058988571167, 6.486198425292969, 6.315907001495361, 4.558710098266602, 5.710786819458008, 6.573230743408203, 5.869843482971191, 6.5471954345703125, 5.5085601806640625, 6.173459053039551, 5.672754287719727, 6.3653564453125, 6.579629421234131, 6.391934394836426, 6.3374552726745605, 6.290292263031006, 4.690095901489258, 6.6989006996154785, 6.157739639282227, 6.463739395141602, 7.002622604370117, 5.870090961456299, 6.448608875274658, 6.222797393798828, 5.035390377044678, 6.230422019958496, 6.618080139160156, 5.146646022796631, 6.350918769836426, 5.69508171081543, 5.521132946014404, 5.769042015075684, 5.986642837524414, 5.757238388061523, 5.162141799926758, 6.638017654418945, 6.45095157623291, 5.71442174911499, 6.577566146850586, 6.703352928161621, 6.056795597076416, 7.596650123596191, 5.263765335083008, 5.437632083892822, 6.909063339233398, 5.982132434844971, 5.377010345458984, 5.514131546020508, 6.60155725479126, 4.2063984870910645, 5.780682563781738, 7.191279411315918, 6.4694952964782715, 5.870885848999023, 5.377263069152832, 5.955334186553955, 6.374561786651611, 5.330901145935059, 5.889047145843506, 5.223640441894531, 6.541428089141846, 6.645827293395996, 5.32637882232666, 6.1320109367370605, 6.1307244300842285, 5.287461757659912, 5.5575737953186035, 6.669539451599121, 7.435279369354248, 5.883527755737305, 6.947205543518066, 6.681252956390381, 5.910187721252441, 6.461936950683594, 5.835413455963135, 6.439168930053711, 5.823579788208008, 5.39688777923584, 6.568927764892578, 7.066454887390137, 6.545685291290283, 5.801878929138184, 5.824176788330078, 5.128776550292969, 6.584909439086914, 5.73906135559082, 6.2511091232299805, 6.5497212409973145, 6.351081848144531, 5.479333400726318, 5.37272834777832, 6.4355573654174805, 6.733508110046387, 5.121108055114746, 5.707004070281982, 6.434826850891113, 5.027407169342041, 6.802129745483398, 6.117386817932129, 5.6065216064453125, 6.392201900482178], "mean_td_error": 6.148519515991211, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.456466674804688, "actor_loss": -7.734579086303711, "critic_loss": 4.432703018188477, "alpha_loss": -0.15349233150482178, "alpha_value": 0.9886582493782043, "log_alpha_value": -0.01140658650547266, "target_entropy": -8.0, "policy_t": -0.002741121919825673, "mean_q": 2.5173492431640625, "max_q": 4.420534133911133, "min_q": 1.6337286233901978}, "td_error": [7.426363945007324, 6.131018161773682, 5.97903299331665, 7.326157569885254, 6.242044448852539, 6.114516735076904, 6.864738464355469, 5.519769668579102, 6.708984375, 6.172883987426758, 6.934917449951172, 5.619105815887451, 6.006023406982422, 6.518824577331543, 7.164831161499023, 6.850200176239014, 5.641712188720703, 5.677800178527832, 6.396205902099609, 6.338335037231445, 6.866559028625488, 5.446455001831055, 6.481424331665039, 6.139944076538086, 5.881651878356934, 6.456302642822266, 6.789849281311035, 6.801041603088379, 5.871404647827148, 6.428008079528809, 7.188189506530762, 6.702542304992676, 7.163578987121582, 6.325369834899902, 5.806515693664551, 5.9464569091796875, 6.078770637512207, 6.207619667053223, 6.897518157958984, 6.015934944152832, 6.523714065551758, 6.1577606201171875, 5.776772499084473, 6.611205101013184, 6.546176910400391, 6.214850425720215, 5.3338727951049805, 6.690990447998047, 6.06386137008667, 6.665068626403809, 6.125396251678467, 6.338175296783447, 6.973752021789551, 6.774314880371094, 6.301033020019531, 5.978134632110596, 6.706084251403809, 6.134105205535889, 5.973318099975586, 6.947649002075195, 6.949798107147217, 6.529445171356201, 6.40562629699707, 7.079641819000244, 6.058023452758789, 6.340409278869629, 5.778555870056152, 6.040440082550049, 6.591032028198242, 6.342966079711914, 6.19486665725708, 6.25329065322876, 5.989029884338379, 6.0306596755981445, 5.2136125564575195, 6.530105113983154, 6.44559907913208, 5.942605972290039, 7.0624003410339355, 6.077759265899658, 7.436173439025879, 6.912195682525635, 5.922788143157959, 6.504173278808594, 5.9033403396606445, 6.278233528137207, 5.321839809417725, 5.97355842590332, 6.088508605957031, 6.76603889465332, 6.03989315032959, 6.862861633300781, 5.23874044418335, 5.9346513748168945, 6.1293816566467285, 6.556622505187988, 6.166903495788574, 5.758184432983398, 5.570244789123535, 6.577267646789551, 5.552938461303711, 5.808636665344238, 5.3768157958984375, 5.126830101013184, 6.431099891662598, 6.608077049255371, 6.302937030792236, 6.462497234344482, 6.5192718505859375, 6.811179161071777, 6.286462783813477, 5.689903736114502, 6.8659515380859375, 7.8975911140441895, 6.355698585510254, 6.267216682434082, 5.2408528327941895, 6.798766136169434, 7.161969184875488, 6.66597843170166, 6.140990257263184, 5.508551597595215, 5.746936798095703, 6.754875183105469, 5.595143795013428, 6.368701934814453, 6.466525077819824, 6.355202674865723], "mean_td_error": 6.304140090942383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 9200, "num_env_steps_trained": 9984, "num_agent_steps_sampled": 18400, "num_agent_steps_trained": 9984, "last_target_update_ts": 9200, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3791.609107876039, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1861.0395305675788, "robot_1": 1930.5695773084603}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1861.0395305675788, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1930.5695773084603, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8442652898667917, "mean_inference_ms": 3.7838985697948004, "mean_action_processing_ms": 0.5257937057557023, "mean_env_wait_ms": 0.49641528186882106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017344951629638672, "StateBufferConnector_ms": 0.004854053258895874, "ViewRequirementAgentConnector_ms": 0.13148486614227295}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3791.609107876039, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1861.0395305675788, "robot_1": 1930.5695773084603}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8442652898667917, "mean_inference_ms": 3.7838985697948004, "mean_action_processing_ms": 0.5257937057557023, "mean_env_wait_ms": 0.49641528186882106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017344951629638672, "StateBufferConnector_ms": 0.004854053258895874, "ViewRequirementAgentConnector_ms": 0.13148486614227295}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18400, "num_agent_steps_trained": 9984, "num_env_steps_sampled": 9200, "num_env_steps_trained": 9984, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 394.33084724218753, "num_env_steps_trained_throughput_per_sec": 504.74348447000006, "timesteps_total": 9200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18400, "timers": {"training_iteration_time_ms": 495.613, "sample_time_ms": 266.05, "load_time_ms": 0.278, "load_throughput": 922379.369, "learn_time_ms": 38.639, "learn_throughput": 6625.439, "synch_weights_time_ms": 12.727}, "counters": {"num_env_steps_sampled": 9200, "num_env_steps_trained": 9984, "num_agent_steps_sampled": 18400, "num_agent_steps_trained": 9984, "last_target_update_ts": 9200, "num_target_updates": 39}, "done": false, "episodes_total": 16, "training_iteration": 19, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-24", "timestamp": 1742586564, "time_this_iter_s": 1.035421371459961, "time_total_s": 24.01093816757202, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57C68B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 24.01093816757202, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.9, "ram_util_percent": 91.2}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1861.0395305675788, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1930.5695773084603, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.429732322692871, "actor_loss": -7.803957462310791, "critic_loss": 4.163374900817871, "alpha_loss": -0.1612345278263092, "alpha_value": 0.9880660176277161, "log_alpha_value": -0.012005788274109364, "target_entropy": -8.0, "policy_t": 0.01016753539443016, "mean_q": 2.5989491939544678, "max_q": 4.651702404022217, "min_q": 1.5279234647750854}, "td_error": [6.6198930740356445, 5.8508758544921875, 7.012181282043457, 4.872997283935547, 6.222335338592529, 6.2163238525390625, 5.8350090980529785, 6.15882682800293, 6.466472148895264, 6.494095802307129, 5.6094207763671875, 4.953371047973633, 6.711338043212891, 4.772297382354736, 5.051900386810303, 5.9657487869262695, 6.084220886230469, 6.220557689666748, 5.568373203277588, 6.070404052734375, 6.5938568115234375, 5.516167640686035, 6.593602180480957, 5.7589111328125, 6.64384651184082, 6.380075454711914, 4.7509331703186035, 6.145374298095703, 4.39604377746582, 7.389710903167725, 5.44335412979126, 6.16934871673584, 5.971004962921143, 5.740980625152588, 6.218125820159912, 5.763620853424072, 4.775386810302734, 5.92114782333374, 6.896165370941162, 5.656671524047852, 5.918473243713379, 6.588059425354004, 5.688169479370117, 5.934116840362549, 5.833252906799316, 6.552642822265625, 6.252969264984131, 6.272028923034668, 5.162242889404297, 6.156996250152588, 7.271806716918945, 5.907977104187012, 5.331161022186279, 5.73737907409668, 5.322440147399902, 6.248733997344971, 5.4398088455200195, 5.277778625488281, 5.099604606628418, 5.271615028381348, 6.3989410400390625, 5.209946632385254, 6.613829612731934, 6.735208511352539, 6.186725616455078, 5.752861022949219, 4.801802635192871, 5.865060806274414, 5.823955059051514, 7.016261100769043, 6.462497711181641, 6.113829135894775, 6.971576690673828, 5.734419345855713, 5.085705757141113, 5.826501846313477, 5.529698371887207, 5.526122093200684, 5.979572772979736, 5.520159721374512, 6.438117504119873, 4.67917537689209, 5.796542167663574, 6.034950256347656, 6.611616134643555, 6.656858921051025, 6.279440879821777, 6.22290563583374, 4.978578567504883, 5.7477264404296875, 5.335268020629883, 5.658505916595459, 5.440117835998535, 5.489077568054199, 4.957026481628418, 6.670193195343018, 5.7435760498046875, 5.496552467346191, 6.791467189788818, 5.906414985656738, 5.847077369689941, 6.266008377075195, 5.230499267578125, 6.617847919464111, 6.032413005828857, 5.76165771484375, 4.920360088348389, 5.932476043701172, 5.879715919494629, 6.119834899902344, 6.089398384094238, 6.199689865112305, 5.267514228820801, 6.48924446105957, 4.807765007019043, 5.7964935302734375, 5.51670503616333, 4.8573784828186035, 6.245452880859375, 5.767006874084473, 6.55053186416626, 6.2008056640625, 5.893837928771973, 5.959444046020508, 5.019900798797607, 6.53598690032959, 5.989561080932617, 4.388985633850098], "mean_td_error": 5.882973670959473, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.452486038208008, "actor_loss": -8.029176712036133, "critic_loss": 4.204620361328125, "alpha_loss": -0.16152237355709076, "alpha_value": 0.9880649447441101, "log_alpha_value": -0.012006878852844238, "target_entropy": -8.0, "policy_t": 0.013780707493424416, "mean_q": 2.7724928855895996, "max_q": 5.280725479125977, "min_q": 1.4546655416488647}, "td_error": [6.081787109375, 6.1275200843811035, 5.85265588760376, 6.667591571807861, 5.415584564208984, 6.439033508300781, 5.971780776977539, 6.064591407775879, 5.716485023498535, 6.338624954223633, 5.383535385131836, 5.446148872375488, 5.630417823791504, 5.970080375671387, 7.1195902824401855, 5.8934431076049805, 5.388411045074463, 6.923566818237305, 4.8737616539001465, 5.873750686645508, 6.126195430755615, 6.279388427734375, 6.561570644378662, 5.017507553100586, 6.720032691955566, 5.390896797180176, 6.387972831726074, 6.08613395690918, 5.661041259765625, 5.7086968421936035, 6.086040496826172, 6.712101936340332, 6.245657920837402, 5.604401111602783, 5.751643657684326, 5.4257493019104, 5.969955921173096, 5.420658111572266, 6.061657905578613, 7.579627990722656, 7.37386417388916, 6.112174034118652, 6.122325897216797, 6.033770561218262, 5.725759029388428, 5.4547553062438965, 6.129646301269531, 6.1697211265563965, 6.100581169128418, 5.535240173339844, 5.797420024871826, 5.989663600921631, 6.2752685546875, 5.46561861038208, 6.336769104003906, 5.157724380493164, 5.53173828125, 5.512995719909668, 6.31182861328125, 5.905629634857178, 5.365968227386475, 5.758837699890137, 6.997404098510742, 5.428814888000488, 6.230327129364014, 4.900785446166992, 5.930336952209473, 7.062037467956543, 5.7145795822143555, 6.779865264892578, 6.035924911499023, 7.644874572753906, 6.579161643981934, 5.298572063446045, 6.430715560913086, 6.397494792938232, 6.445809364318848, 6.291175842285156, 5.326813220977783, 5.8079609870910645, 4.839591979980469, 5.669745445251465, 6.058558464050293, 6.240972518920898, 5.0868754386901855, 5.15762996673584, 5.846503257751465, 6.791167259216309, 5.108097076416016, 6.089159965515137, 6.340266227722168, 6.14653205871582, 6.7813544273376465, 5.2182440757751465, 5.430130958557129, 5.714052200317383, 6.193477630615234, 7.181692123413086, 5.463047504425049, 5.980738639831543, 5.588779926300049, 5.467282295227051, 5.635493755340576, 6.335161209106445, 5.812747001647949, 4.878983020782471, 6.342333793640137, 6.06799840927124, 6.62275505065918, 6.056953430175781, 7.095288276672363, 5.792708396911621, 6.742845058441162, 5.261116981506348, 4.859007835388184, 5.516254425048828, 6.125837326049805, 5.175450325012207, 4.664626121520996, 6.12935733795166, 6.735078811645508, 5.871242523193359, 6.1666717529296875, 4.920080184936523, 5.528098106384277, 6.160907745361328, 5.719598770141602, 5.842007637023926], "mean_td_error": 5.952325820922852, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 9600, "num_env_steps_trained": 10496, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 10496, "last_target_update_ts": 9600, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3791.609107876039, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1861.0395305675788, "robot_1": 1930.5695773084603}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1861.0395305675788, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1930.5695773084603, "('robot_1', 'robot_1')_total_reward_min": 1831.8770391907287, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8442652898667917, "mean_inference_ms": 3.7838985697948004, "mean_action_processing_ms": 0.5257937057557023, "mean_env_wait_ms": 0.49641528186882106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017344951629638672, "StateBufferConnector_ms": 0.004854053258895874, "ViewRequirementAgentConnector_ms": 0.13148486614227295}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3657.8684429649375, "episode_reward_mean": 3791.609107876039, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1831.8770391907287}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1861.0395305675788, "robot_1": 1930.5695773084603}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8442652898667917, "mean_inference_ms": 3.7838985697948004, "mean_action_processing_ms": 0.5257937057557023, "mean_env_wait_ms": 0.49641528186882106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017344951629638672, "StateBufferConnector_ms": 0.004854053258895874, "ViewRequirementAgentConnector_ms": 0.13148486614227295}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 10496, "num_env_steps_sampled": 9600, "num_env_steps_trained": 10496, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 337.41236984440656, "num_env_steps_trained_throughput_per_sec": 431.8878334008404, "timesteps_total": 9600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19200, "timers": {"training_iteration_time_ms": 512.459, "sample_time_ms": 269.885, "load_time_ms": 0.191, "load_throughput": 1339164.161, "learn_time_ms": 37.517, "learn_throughput": 6823.543, "synch_weights_time_ms": 12.657}, "counters": {"num_env_steps_sampled": 9600, "num_env_steps_trained": 10496, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 10496, "last_target_update_ts": 9600, "num_target_updates": 41}, "done": false, "episodes_total": 16, "training_iteration": 20, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-25", "timestamp": 1742586565, "time_this_iter_s": 1.1948161125183105, "time_total_s": 25.205754280090332, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A5891EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 25.205754280090332, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.65, "ram_util_percent": 91.3}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.470231056213379, "actor_loss": -8.211539268493652, "critic_loss": 4.000686168670654, "alpha_loss": -0.16980570554733276, "alpha_value": 0.9874731302261353, "log_alpha_value": -0.012605998665094376, "target_entropy": -8.0, "policy_t": -0.005071521271020174, "mean_q": 2.923356056213379, "max_q": 5.361690521240234, "min_q": 1.9161430597305298}, "td_error": [5.290012359619141, 5.235371112823486, 4.623829364776611, 4.782278537750244, 6.926358222961426, 3.5928878784179688, 4.939878463745117, 6.531773567199707, 4.831897258758545, 4.7292256355285645, 5.536036491394043, 5.480676651000977, 5.779932498931885, 5.651905059814453, 3.953494071960449, 5.3427348136901855, 5.2510666847229, 4.047109603881836, 4.785403728485107, 4.884212493896484, 6.2718281745910645, 6.352646827697754, 5.463401794433594, 6.139981269836426, 5.649321556091309, 5.394786834716797, 5.725782871246338, 5.203990936279297, 5.309350490570068, 5.313807487487793, 5.33609676361084, 5.328915596008301, 5.396683692932129, 6.371556282043457, 5.508546829223633, 4.439733505249023, 5.438448905944824, 5.135256767272949, 5.439799785614014, 5.9202470779418945, 5.433829307556152, 5.563575744628906, 5.492438316345215, 5.827902793884277, 5.092158317565918, 5.984124660491943, 6.056944847106934, 5.612285137176514, 6.4672017097473145, 6.083395004272461, 5.588263988494873, 5.963255882263184, 6.081483840942383, 5.893877029418945, 5.7734694480896, 5.121085166931152, 6.051959991455078, 5.3895745277404785, 5.296393394470215, 6.841290473937988, 5.391236305236816, 4.936930179595947, 4.975539207458496, 5.665340423583984, 3.919612169265747, 5.939624309539795, 5.390200138092041, 5.752047061920166, 6.918743133544922, 5.6615142822265625, 5.216477394104004, 5.266098976135254, 5.7548604011535645, 5.884822845458984, 6.4144606590271, 4.620716094970703, 5.825733184814453, 4.835030555725098, 5.84201717376709, 6.680734157562256, 6.415331840515137, 6.0626983642578125, 5.877272129058838, 5.333412170410156, 6.254125595092773, 5.763600826263428, 5.359310626983643, 4.754596710205078, 4.45985221862793, 6.699481964111328, 6.289270401000977, 5.82693338394165, 5.337103843688965, 6.479548931121826, 5.89949369430542, 6.682394027709961, 5.501328468322754, 6.750131607055664, 5.417698860168457, 6.109320640563965, 5.001276016235352, 5.942054748535156, 5.17118501663208, 5.468775749206543, 5.216952800750732, 4.122278213500977, 6.634112358093262, 5.506679534912109, 5.918006896972656, 5.347635269165039, 4.8108062744140625, 5.749451160430908, 5.891350269317627, 5.568580627441406, 4.417911529541016, 5.540920734405518, 6.196834564208984, 6.004880428314209, 4.394253730773926, 5.893404960632324, 5.439658164978027, 3.475541591644287, 5.041612148284912, 5.685423374176025, 4.134835243225098, 4.3267130851745605, 5.733662128448486, 6.711555480957031], "mean_td_error": 5.519232749938965, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.452895164489746, "actor_loss": -8.433500289916992, "critic_loss": 4.003857135772705, "alpha_loss": -0.16959941387176514, "alpha_value": 0.9874722361564636, "log_alpha_value": -0.0126069076359272, "target_entropy": -8.0, "policy_t": 0.03005339950323105, "mean_q": 3.2359540462493896, "max_q": 5.504585266113281, "min_q": 1.7545948028564453}, "td_error": [3.7054171562194824, 5.227261066436768, 5.431089401245117, 4.786758899688721, 4.792856216430664, 6.001028060913086, 5.626646518707275, 5.160061359405518, 5.69186544418335, 5.491257190704346, 5.337961196899414, 6.422267436981201, 5.214225769042969, 4.617965221405029, 5.805089950561523, 5.977530002593994, 5.229401588439941, 4.981320381164551, 5.735650062561035, 6.0336713790893555, 5.8818254470825195, 4.8306403160095215, 6.780590057373047, 5.945398330688477, 5.134258270263672, 4.201165199279785, 5.510781288146973, 5.520519256591797, 6.161901950836182, 5.855329513549805, 5.577816009521484, 5.371772766113281, 6.222772121429443, 5.361746788024902, 4.984375476837158, 5.078526973724365, 6.696994781494141, 6.018194198608398, 4.620171070098877, 6.062417030334473, 5.232345104217529, 5.652315139770508, 4.4500579833984375, 4.765703201293945, 7.300258159637451, 5.032286643981934, 5.830440998077393, 4.686527252197266, 5.236686706542969, 4.8462233543396, 6.037154197692871, 5.139801979064941, 6.371241569519043, 5.549706935882568, 6.397641181945801, 6.122513771057129, 6.892263412475586, 6.169495582580566, 5.605996131896973, 5.562351226806641, 5.798002243041992, 6.4163594245910645, 5.793461799621582, 5.839795112609863, 6.305880546569824, 6.384636878967285, 5.844222545623779, 5.347111225128174, 5.863602638244629, 5.73347282409668, 3.966517686843872, 5.993466377258301, 6.313716888427734, 6.378598213195801, 5.303979396820068, 6.173058986663818, 5.175924301147461, 5.855337142944336, 5.338285446166992, 5.332374572753906, 4.8087568283081055, 5.918761253356934, 4.953454971313477, 6.183229446411133, 5.626444339752197, 5.817023754119873, 5.435072898864746, 6.191169261932373, 4.9603962898254395, 6.880722999572754, 5.177211761474609, 6.146700859069824, 4.66246223449707, 4.311354637145996, 6.4261627197265625, 5.235137939453125, 6.06831693649292, 5.3733134269714355, 6.723294258117676, 6.166744709014893, 5.909980773925781, 6.079153060913086, 5.077892780303955, 5.112218856811523, 5.19366455078125, 5.818643093109131, 5.703543663024902, 6.6743879318237305, 6.511251449584961, 7.082597255706787, 5.193206787109375, 5.324241638183594, 4.600551128387451, 5.2291765213012695, 5.496886253356934, 3.9145240783691406, 4.274772644042969, 5.56867790222168, 5.031825542449951, 5.081864833831787, 5.6546125411987305, 4.9718756675720215, 6.0810933113098145, 5.513167858123779, 4.771821975708008, 5.572659969329834, 4.532716274261475, 5.317157745361328], "mean_td_error": 5.558478355407715, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 11008, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 11008, "last_target_update_ts": 10000, "num_target_updates": 43}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 11008, "num_env_steps_sampled": 10000, "num_env_steps_trained": 11008, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 396.75299092140955, "num_env_steps_trained_throughput_per_sec": 507.8438283794042, "timesteps_total": 10000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 518.264, "sample_time_ms": 274.65, "load_time_ms": 0.191, "load_throughput": 1339164.161, "learn_time_ms": 38.343, "learn_throughput": 6676.644, "synch_weights_time_ms": 12.759}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 11008, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 11008, "last_target_update_ts": 10000, "num_target_updates": 43}, "done": false, "episodes_total": 20, "training_iteration": 21, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-26", "timestamp": 1742586566, "time_this_iter_s": 1.024822473526001, "time_total_s": 26.230576753616333, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57C6790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 26.230576753616333, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 33.0, "ram_util_percent": 91.3}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.460546493530273, "actor_loss": -8.96963119506836, "critic_loss": 3.527313232421875, "alpha_loss": -0.1818026900291443, "alpha_value": 0.986584484577179, "log_alpha_value": -0.013506338000297546, "target_entropy": -8.0, "policy_t": -0.0008701113983988762, "mean_q": 3.7129006385803223, "max_q": 6.7683258056640625, "min_q": 2.017378568649292}, "td_error": [5.669023513793945, 5.081916332244873, 3.693413734436035, 5.2648420333862305, 5.625354766845703, 4.300829887390137, 4.44877815246582, 5.1288957595825195, 5.447835922241211, 3.7372803688049316, 5.644049167633057, 5.331165790557861, 6.111968994140625, 5.294930458068848, 4.6294660568237305, 4.345710754394531, 4.925276756286621, 2.0707974433898926, 5.4587883949279785, 5.502814292907715, 4.58016300201416, 6.584254264831543, 6.565011978149414, 5.0952630043029785, 5.6355814933776855, 4.238037109375, 4.904825210571289, 5.735130310058594, 4.110021591186523, 4.937897205352783, 3.686361312866211, 4.75257682800293, 5.425917148590088, 4.696294784545898, 5.363535404205322, 4.686960220336914, 4.583139419555664, 3.9915366172790527, 6.056105613708496, 5.2468156814575195, 5.07424783706665, 5.475272178649902, 5.318305015563965, 3.4724276065826416, 3.9234156608581543, 5.409765243530273, 4.925824165344238, 5.0501322746276855, 4.647566795349121, 3.458784341812134, 5.031770706176758, 5.895545482635498, 5.728362083435059, 6.30518913269043, 4.823216915130615, 5.4822869300842285, 4.992709159851074, 4.808798789978027, 5.223567962646484, 4.387541770935059, 4.569075107574463, 4.212846755981445, 3.4525885581970215, 4.933952331542969, 4.6336798667907715, 3.726719617843628, 4.670331001281738, 4.305983543395996, 5.4760637283325195, 2.980607271194458, 4.893885612487793, 4.054971218109131, 4.785665988922119, 4.879806041717529, 5.159421443939209, 3.9394121170043945, 6.882393836975098, 2.769789218902588, 5.596114635467529, 4.661613464355469, 4.38931941986084, 4.674139022827148, 5.838984489440918, 4.39130973815918, 3.7984132766723633, 5.489472389221191, 5.21136474609375, 5.699784278869629, 5.086966514587402, 4.406750679016113, 3.0435738563537598, 4.80272102355957, 5.675622940063477, 2.079866886138916, 5.708741664886475, 5.094335079193115, 4.393675327301025, 5.561491966247559, 5.4807353019714355, 3.145151376724243, 5.699071884155273, 4.012824058532715, 5.0222039222717285, 5.7096848487854, 4.757201194763184, 4.390209197998047, 4.005148887634277, 5.793694496154785, 5.13702917098999, 5.3341522216796875, 4.049042224884033, 4.527758598327637, 4.093179702758789, 2.8253726959228516, 5.719023704528809, 5.285641193389893, 4.056845664978027, 5.589253902435303, 4.976988315582275, 4.948205947875977, 5.05804443359375, 3.1266300678253174, 4.93552303314209, 5.509025573730469, 5.044405937194824, 4.980633735656738, 2.9013285636901855, 2.6820454597473145], "mean_td_error": 4.787116050720215, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.50522518157959, "actor_loss": -9.061016082763672, "critic_loss": 3.5040550231933594, "alpha_loss": -0.18240974843502045, "alpha_value": 0.9865841865539551, "log_alpha_value": -0.013506605289876461, "target_entropy": -8.0, "policy_t": 0.024681247770786285, "mean_q": 3.8679935932159424, "max_q": 6.963168144226074, "min_q": 2.4180667400360107}, "td_error": [5.081096649169922, 5.7014007568359375, 5.410021781921387, 5.480910301208496, 5.121811866760254, 5.477264404296875, 5.342642784118652, 6.598811149597168, 6.115386486053467, 4.989947319030762, 5.095367431640625, 3.7089881896972656, 4.938150405883789, 5.252301216125488, 4.684043884277344, 5.081761360168457, 3.8215444087982178, 5.706313610076904, 5.3043293952941895, 6.574532508850098, 3.525538921356201, 5.1320648193359375, 4.758880615234375, 5.115825653076172, 5.605559349060059, 5.5642499923706055, 4.033600807189941, 5.54952335357666, 5.621005058288574, 4.308403015136719, 5.149188995361328, 4.636503219604492, 4.486551761627197, 3.8074235916137695, 4.924103736877441, 5.04483699798584, 2.322396993637085, 4.695646286010742, 5.39750862121582, 3.6354684829711914, 6.20557165145874, 4.441994667053223, 3.313995361328125, 3.613032817840576, 4.461630821228027, 4.932263374328613, 3.7834200859069824, 5.462965965270996, 5.908297538757324, 5.385523796081543, 4.539851188659668, 4.680999279022217, 4.496096134185791, 6.080092430114746, 4.493977069854736, 4.464437484741211, 4.991894721984863, 3.8135130405426025, 6.444415092468262, 4.03758430480957, 5.7415452003479, 4.394404411315918, 5.491618633270264, 5.7546892166137695, 2.8317923545837402, 4.984424591064453, 4.714365005493164, 5.2353081703186035, 3.140033006668091, 3.2187421321868896, 5.802791595458984, 4.217192649841309, 5.5700836181640625, 4.43541145324707, 4.891721725463867, 5.564505577087402, 5.361871719360352, 4.363642692565918, 6.053777694702148, 5.9469194412231445, 5.540384292602539, 4.184276580810547, 4.628559589385986, 4.729191780090332, 4.857612609863281, 5.805882453918457, 4.606101989746094, 4.838795185089111, 4.501379489898682, 3.917252779006958, 3.8695223331451416, 4.949670791625977, 4.692683219909668, 5.511935234069824, 4.239116668701172, 4.844738006591797, 3.9187729358673096, 5.4825849533081055, 5.054204940795898, 5.299720764160156, 5.860237121582031, 4.345273017883301, 4.395303726196289, 5.1542510986328125, 5.674220085144043, 6.729430198669434, 4.7827959060668945, 5.117999076843262, 5.062762260437012, 3.8666341304779053, 4.97210693359375, 4.624970436096191, 2.786853313446045, 5.380249500274658, 4.098834991455078, 5.770497798919678, 4.392107009887695, 4.444571495056152, 5.989740371704102, 4.494101047515869, 5.013803482055664, 5.853880882263184, 5.0533671379089355, 5.6875691413879395, 4.219088554382324, 5.315009593963623, 5.561848163604736, 4.331176280975342], "mean_td_error": 4.894674301147461, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 10600, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 21200, "num_agent_steps_trained": 11776, "last_target_update_ts": 10600, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21200, "num_agent_steps_trained": 11776, "num_env_steps_sampled": 10600, "num_env_steps_trained": 11776, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 408.4306810417441, "num_env_steps_trained_throughput_per_sec": 522.7912717334325, "timesteps_total": 10600, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 21200, "timers": {"training_iteration_time_ms": 517.722, "sample_time_ms": 275.925, "load_time_ms": 0.191, "load_throughput": 1339164.161, "learn_time_ms": 38.107, "learn_throughput": 6717.949, "synch_weights_time_ms": 12.301}, "counters": {"num_env_steps_sampled": 10600, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 21200, "num_agent_steps_trained": 11776, "last_target_update_ts": 10600, "num_target_updates": 46}, "done": false, "episodes_total": 20, "training_iteration": 22, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-28", "timestamp": 1742586568, "time_this_iter_s": 1.4832792282104492, "time_total_s": 27.713855981826782, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57C68B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 27.713855981826782, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.95, "ram_util_percent": 91.45}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.416083335876465, "actor_loss": -9.215797424316406, "critic_loss": 3.104499340057373, "alpha_loss": -0.18925467133522034, "alpha_value": 0.9859924912452698, "log_alpha_value": -0.014106552116572857, "target_entropy": -8.0, "policy_t": 0.007389653008431196, "mean_q": 3.9559295177459717, "max_q": 7.455125331878662, "min_q": 2.3060505390167236}, "td_error": [3.086300849914551, 1.8682992458343506, 4.326783657073975, 4.45037841796875, 4.692537307739258, 1.8792016506195068, 3.9591805934906006, 1.2075738906860352, 5.443411827087402, 3.9567818641662598, 5.763495922088623, 5.003999710083008, 5.443971157073975, 6.083771705627441, 3.008683443069458, 4.501087188720703, 4.695770263671875, 4.606572151184082, 5.3788557052612305, 5.007439136505127, 4.850459098815918, 4.0533223152160645, 5.829123497009277, 2.7561938762664795, 3.0755491256713867, 4.719510555267334, 4.845803737640381, 4.524829864501953, 5.289809703826904, 4.383769989013672, 4.874266147613525, 4.8130717277526855, 5.058961868286133, 5.4407057762146, 4.9047698974609375, 5.213277339935303, 2.7926127910614014, 5.283252239227295, 4.2318220138549805, 4.739493370056152, 5.267484664916992, 4.79608678817749, 5.02616548538208, 1.1463329792022705, 5.637190341949463, 4.898097038269043, 5.019254207611084, 4.527071952819824, 4.2110090255737305, 4.5920562744140625, 3.0383431911468506, 5.389264106750488, 4.327136039733887, 5.619885444641113, 4.245025634765625, 4.771193504333496, 5.303616523742676, 4.2000908851623535, 4.78059196472168, 4.612096786499023, 4.40559720993042, 4.271614074707031, 4.172967910766602, 5.539287567138672, 5.318965911865234, 5.351124286651611, 3.4833438396453857, 6.105589866638184, 4.788680076599121, 4.558166027069092, 5.369097709655762, 5.263912677764893, 5.579644203186035, 4.141274929046631, 4.627372741699219, 2.785264730453491, 4.792160511016846, 3.4963390827178955, 3.773552656173706, 4.838050365447998, 5.874548435211182, 4.052233695983887, 4.936793327331543, 6.1473493576049805, 5.181365489959717, 4.477178573608398, 4.912945747375488, 3.383272647857666, 1.7752795219421387, 4.354732513427734, 4.038664817810059, 4.779015064239502, 3.6035115718841553, 4.564061164855957, 3.1393299102783203, 4.553007125854492, 5.094723224639893, 4.045590877532959, 5.03580379486084, 4.158522129058838, 2.8210768699645996, 5.715754508972168, 3.897737503051758, 4.6461076736450195, 3.3267605304718018, 4.9239068031311035, 4.122818946838379, 1.277703046798706, 3.8152620792388916, 5.1112565994262695, 5.558148384094238, 4.698951244354248, 4.153407096862793, 5.219925403594971, 4.402920722961426, 3.9916200637817383, 3.9522595405578613, 4.832071304321289, 4.566718101501465, 4.457932949066162, 3.8905727863311768, 5.979526042938232, 3.80124831199646, 4.973843574523926, 4.535276412963867, 5.712158679962158, 4.8177809715271, 3.2528016567230225], "mean_td_error": 4.458423614501953, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.40934944152832, "actor_loss": -9.407751083374023, "critic_loss": 3.2896361351013184, "alpha_loss": -0.1891598403453827, "alpha_value": 0.9859924912452698, "log_alpha_value": -0.014106563292443752, "target_entropy": -8.0, "policy_t": 0.02481050416827202, "mean_q": 4.202788352966309, "max_q": 7.514301300048828, "min_q": 2.282668352127075}, "td_error": [2.207137107849121, 4.618202209472656, 5.686140537261963, 3.432844638824463, 4.110535621643066, 4.366873741149902, 4.551577568054199, 4.089885711669922, 4.613393783569336, 4.261131763458252, 4.71766471862793, 6.288451194763184, 4.231539249420166, 4.572665691375732, 5.278728485107422, 4.071725368499756, 4.66237735748291, 4.319699287414551, 4.555805206298828, 6.442685127258301, 4.490277290344238, 5.957132816314697, 5.029085159301758, 4.795376777648926, 4.193831920623779, 4.992735385894775, 5.017542839050293, 4.962889671325684, 4.349070072174072, 3.468806266784668, 5.306861877441406, 3.0077972412109375, 4.5237812995910645, 5.357128143310547, 5.303408622741699, 4.196386337280273, 3.5287926197052, 5.1641693115234375, 4.742471694946289, 4.753110885620117, 5.673495769500732, 2.8321471214294434, 4.546189308166504, 6.1341753005981445, 5.010204315185547, 5.087014198303223, 4.239264488220215, 3.875211477279663, 4.787235736846924, 4.535125255584717, 4.637670040130615, 5.022660255432129, 5.098978042602539, 4.287059307098389, 4.913411617279053, 3.7643074989318848, 3.972899913787842, 4.586002826690674, 3.4478747844696045, 5.045753479003906, 3.544356107711792, 3.9001340866088867, 3.642355442047119, 4.015092849731445, 5.183856964111328, 2.6096067428588867, 4.968845367431641, 5.209443092346191, 4.222346305847168, 5.20442008972168, 4.286769866943359, 3.958759069442749, 4.994283676147461, 4.093676567077637, 4.324593544006348, 4.940132141113281, 4.982100009918213, 4.159163475036621, 5.445108413696289, 2.772449016571045, 3.85345458984375, 5.284080982208252, 5.398360252380371, 3.510511875152588, 3.3559467792510986, 4.022481918334961, 4.133671283721924, 4.440783500671387, 4.593263626098633, 5.424960613250732, 5.852360725402832, 3.882497787475586, 3.5431246757507324, 4.150998592376709, 4.664019584655762, 5.005100250244141, 5.05263614654541, 4.211262226104736, 5.35284423828125, 5.254390716552734, 4.257302284240723, 5.45108699798584, 5.060053825378418, 4.154219627380371, 3.6213161945343018, 4.593725204467773, 4.913456439971924, 3.1848533153533936, 5.1460161209106445, 4.7933502197265625, 4.910531044006348, 4.7111077308654785, 6.328741073608398, 6.844227313995361, 5.152322769165039, 4.925411224365234, 4.227626800537109, 6.1821088790893555, 5.225203514099121, 4.298077583312988, 5.266734600067139, 3.7125906944274902, 4.154115676879883, 4.054469585418701, 4.700218677520752, 5.450078964233398, 3.5553808212280273, 3.0093789100646973], "mean_td_error": 4.5706586837768555, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 47.0}}, "num_env_steps_sampled": 11000, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 12288, "last_target_update_ts": 11000, "num_target_updates": 48}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 11000, "num_env_steps_trained": 12288, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 363.61235784959774, "num_env_steps_trained_throughput_per_sec": 465.4238180474851, "timesteps_total": 11000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 527.657, "sample_time_ms": 281.826, "load_time_ms": 0.764, "load_throughput": 335135.873, "learn_time_ms": 37.231, "learn_throughput": 6875.935, "synch_weights_time_ms": 12.84}, "counters": {"num_env_steps_sampled": 11000, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 12288, "last_target_update_ts": 11000, "num_target_updates": 48}, "done": false, "episodes_total": 20, "training_iteration": 23, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-29", "timestamp": 1742586569, "time_this_iter_s": 1.116694688796997, "time_total_s": 28.83055067062378, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298BB31B4C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 28.83055067062378, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.85, "ram_util_percent": 91.65}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.432220458984375, "actor_loss": -9.656736373901367, "critic_loss": 2.6963045597076416, "alpha_loss": -0.19754257798194885, "alpha_value": 0.9854009747505188, "log_alpha_value": -0.014706620946526527, "target_entropy": -8.0, "policy_t": 0.007180982269346714, "mean_q": 4.531733989715576, "max_q": 7.915247440338135, "min_q": 2.862422227859497}, "td_error": [4.836956977844238, 2.890901565551758, 3.915917158126831, 3.2513110637664795, 2.068035364151001, 2.9545280933380127, 3.5500497817993164, 1.3900260925292969, 3.797171115875244, 4.872859001159668, 2.0653200149536133, 4.160067081451416, 4.248719692230225, 4.51745080947876, 3.9164154529571533, 3.8654439449310303, 4.650739669799805, 3.9152121543884277, 2.660446882247925, 3.9177112579345703, 5.237577438354492, 4.298234939575195, 3.467325448989868, 4.390673637390137, 3.7941231727600098, 4.834646224975586, 4.373979568481445, 3.5439541339874268, 4.394142150878906, 3.8351478576660156, 3.9229166507720947, 0.7489683628082275, 0.97292160987854, 1.6757853031158447, 4.641800880432129, 4.127057075500488, 4.371217727661133, 4.825148582458496, 3.4926676750183105, 4.347439765930176, 4.061654567718506, 3.201023817062378, 3.810169219970703, 6.226528167724609, 4.577814102172852, 5.257157802581787, 4.630193710327148, 3.522960901260376, 1.8535451889038086, 4.956027984619141, 4.240362644195557, 4.550924301147461, 4.437777519226074, 4.596030235290527, 3.978649616241455, 2.9881105422973633, 2.6558120250701904, 3.876028537750244, 2.5350494384765625, 4.047250747680664, 3.716752052307129, 5.296969413757324, 3.7835514545440674, 4.294049263000488, 5.156533241271973, 3.0945096015930176, 4.041400909423828, 2.343459129333496, 4.036225318908691, 4.101073265075684, 4.431581974029541, 4.745182991027832, 4.109750747680664, 3.076573133468628, 4.367833137512207, 3.0164480209350586, 4.704974174499512, 4.461939334869385, 4.527940273284912, 4.509331703186035, 4.68818998336792, 3.7611923217773438, 4.250467300415039, 4.486863613128662, 5.287858963012695, 2.8240907192230225, 3.878662586212158, 4.34267520904541, 4.388648509979248, 4.55293083190918, 2.5673515796661377, 5.235387325286865, 4.984348297119141, 4.395576000213623, 5.6796464920043945, 1.4416964054107666, 1.8407657146453857, 0.8821001052856445, 3.712050199508667, 3.793445587158203, 4.934700965881348, 2.792003631591797, 4.438309669494629, 5.28111457824707, 4.426278114318848, 3.8175699710845947, 3.7966885566711426, 4.496148109436035, 4.195173740386963, 4.777351379394531, 3.636479139328003, 2.6610381603240967, 3.507700204849243, 4.510561943054199, 4.769086837768555, 3.954993724822998, 4.140388488769531, 4.8650102615356445, 3.9849727153778076, 4.675564289093018, 3.645723581314087, 4.919386863708496, 4.068004608154297, 3.5332672595977783, 3.113536834716797, 3.6115314960479736, 3.995910406112671, 5.370663642883301], "mean_td_error": 3.917759895324707, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.409153938293457, "actor_loss": -10.019119262695312, "critic_loss": 2.580143451690674, "alpha_loss": -0.19719932973384857, "alpha_value": 0.9854012727737427, "log_alpha_value": -0.014706321060657501, "target_entropy": -8.0, "policy_t": 0.0032627577893435955, "mean_q": 4.8840765953063965, "max_q": 8.658357620239258, "min_q": 3.147571086883545}, "td_error": [2.581186532974243, 5.034757137298584, 3.205470085144043, 4.051653861999512, 3.954526901245117, 3.3024306297302246, 3.942446231842041, 4.671639919281006, 3.6399145126342773, 4.932865142822266, 1.330559253692627, 3.9528660774230957, 3.7077746391296387, 4.024878978729248, 4.733037948608398, 3.8129210472106934, 5.338764190673828, 3.766934871673584, 2.414785623550415, 3.4175772666931152, 3.5291833877563477, 3.945448398590088, 3.6032371520996094, 2.9555866718292236, 3.8185477256774902, 2.9474475383758545, 4.410577774047852, 4.284806251525879, 2.948873519897461, 3.9015560150146484, 5.835179328918457, 3.4013254642486572, 4.240963459014893, 3.815061092376709, 2.8325469493865967, 4.7493486404418945, 3.493358612060547, 3.551008939743042, 2.2155280113220215, 4.831972122192383, 4.010811805725098, 3.604775905609131, 4.318569183349609, 4.065837860107422, 2.2535765171051025, 4.001137733459473, 4.486313819885254, 4.382009983062744, 4.929304122924805, 4.169507026672363, 4.189385890960693, 5.534589767456055, 3.781214475631714, 1.3993244171142578, 1.8340864181518555, 4.177694797515869, 3.7208805084228516, 2.625155210494995, 4.832921028137207, 3.200263023376465, 3.8704943656921387, 3.5830674171447754, 3.0267374515533447, 3.3932816982269287, 3.658869981765747, 4.483420372009277, 3.6040687561035156, 5.276532173156738, 4.174389362335205, 4.359251976013184, 3.8962349891662598, 3.738346576690674, 3.8307971954345703, 4.5714826583862305, 4.765724182128906, 3.8633573055267334, 4.4051833152771, 3.1801366806030273, 3.557528495788574, 4.074212551116943, 3.3205223083496094, 4.369218826293945, 5.7774248123168945, 4.448812007904053, 3.948594093322754, 3.489349126815796, 4.428833484649658, 4.339375019073486, 3.1846916675567627, 3.5979511737823486, 3.377533435821533, 4.050708770751953, 2.1063528060913086, 3.8625271320343018, 2.832609176635742, 4.615908622741699, 3.419811725616455, 4.758889198303223, 2.857605457305908, 1.0684483051300049, 1.9169375896453857, 4.119322776794434, 3.7503950595855713, 4.8014116287231445, 4.409188747406006, 2.382802963256836, 3.3784003257751465, 4.273580074310303, 3.697538137435913, 3.833106279373169, 4.57310676574707, 2.32791805267334, 5.354957580566406, 4.020235061645508, 1.2672920227050781, 3.9718449115753174, 1.785947561264038, 4.570074081420898, 3.7594759464263916, 4.8707122802734375, 4.760426044464111, 4.758579254150391, 3.28153395652771, 3.330899477005005, 5.342171669006348, 4.3605804443359375, 3.937952995300293, 3.9115238189697266], "mean_td_error": 3.801266670227051, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 11400, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 22800, "num_agent_steps_trained": 12800, "last_target_update_ts": 11400, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 11400, "num_env_steps_trained": 12800, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 342.80864078338436, "num_env_steps_trained_throughput_per_sec": 438.79506020273203, "timesteps_total": 11400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22800, "timers": {"training_iteration_time_ms": 524.901, "sample_time_ms": 288.489, "load_time_ms": 0.677, "load_throughput": 378291.229, "learn_time_ms": 37.177, "learn_throughput": 6886.046, "synch_weights_time_ms": 12.859}, "counters": {"num_env_steps_sampled": 11400, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 22800, "num_agent_steps_trained": 12800, "last_target_update_ts": 11400, "num_target_updates": 50}, "done": false, "episodes_total": 20, "training_iteration": 24, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-30", "timestamp": 1742586570, "time_this_iter_s": 1.1878466606140137, "time_total_s": 30.018397331237793, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A57C6790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 30.018397331237793, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.7, "ram_util_percent": 91.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.42760181427002, "actor_loss": -10.263169288635254, "critic_loss": 1.9072340726852417, "alpha_loss": -0.20553065836429596, "alpha_value": 0.9848099946975708, "log_alpha_value": -0.015306578017771244, "target_entropy": -8.0, "policy_t": -0.014133147895336151, "mean_q": 4.925931930541992, "max_q": 9.010632514953613, "min_q": 2.615091323852539}, "td_error": [1.033996343612671, 3.568392753601074, 3.6171822547912598, 1.4350762367248535, 5.097354412078857, 2.888728618621826, 3.932588577270508, 2.8836171627044678, 3.9606781005859375, 2.4219019412994385, 0.9896416664123535, 4.323434829711914, 4.595928192138672, 1.2433795928955078, 3.89404296875, 3.9861016273498535, 2.9434382915496826, 4.844944953918457, 4.870513916015625, 4.015963554382324, 4.0307111740112305, 4.045210838317871, 3.1161069869995117, 3.805572986602783, 4.324448585510254, 3.910202980041504, 2.8474135398864746, 2.9684839248657227, 3.3404159545898438, 5.088224411010742, 3.325777530670166, 0.8936977386474609, 2.861992597579956, 0.7051143646240234, 4.143064975738525, 3.6262130737304688, 3.4241812229156494, 1.3286364078521729, 1.6021113395690918, 3.775057315826416, 3.9725208282470703, 1.163184642791748, 4.02928352355957, 4.405089378356934, 4.608340263366699, 3.8136448860168457, 2.0742478370666504, 4.222225189208984, 3.6454050540924072, 4.114665508270264, 2.059847354888916, 1.1099648475646973, 3.486499786376953, 3.176163673400879, 1.661010980606079, 3.854774236679077, 4.401984214782715, 3.465557813644409, 3.559417247772217, 3.975564956665039, 2.7478396892547607, 3.3641915321350098, 2.865311861038208, 2.5288426876068115, 4.223484992980957, 3.849684715270996, 4.0446858406066895, 4.129225254058838, 2.712736129760742, 5.3798956871032715, 3.7025835514068604, 1.3374066352844238, 2.3722035884857178, 4.309296607971191, 4.47629976272583, 4.579969882965088, 3.450145721435547, 2.670956611633301, 3.4283087253570557, 3.163400173187256, 3.838160276412964, 4.1215500831604, 2.206104278564453, 3.370818853378296, 4.853254795074463, 3.07319974899292, 5.259422779083252, 3.448446750640869, 4.020846366882324, 5.115469932556152, 2.8235387802124023, 4.899823188781738, 4.381298542022705, 3.801053524017334, 3.764834403991699, 4.929182529449463, 1.2447524070739746, 4.095406532287598, 1.9207983016967773, 2.511944055557251, 1.1300792694091797, 2.801511764526367, 3.460005044937134, 4.7605743408203125, 3.400292158126831, 5.199882984161377, 4.025569915771484, 3.6196391582489014, 3.803107500076294, 2.524902582168579, 4.193957328796387, 3.8353796005249023, 4.156087398529053, 4.591648578643799, 3.446305751800537, 5.016810894012451, 1.9658899307250977, 4.2480669021606445, 3.964376449584961, 4.151397705078125, 3.0140042304992676, 1.7925739288330078, 4.49859094619751, 3.4386911392211914, 4.25711727142334, 3.528884172439575, 0.8397307395935059, 2.609240770339966], "mean_td_error": 3.420309543609619, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.450662612915039, "actor_loss": -10.621405601501465, "critic_loss": 1.516371250152588, "alpha_loss": -0.20587386190891266, "alpha_value": 0.9848107099533081, "log_alpha_value": -0.015305852517485619, "target_entropy": -8.0, "policy_t": -0.00029135309159755707, "mean_q": 5.57133150100708, "max_q": 9.644969940185547, "min_q": 3.514307737350464}, "td_error": [2.8774282932281494, 3.801434278488159, 1.3203108310699463, 4.247207164764404, 2.4902074337005615, 2.537282943725586, 2.4070308208465576, 4.7249650955200195, 1.3788995742797852, 3.2555196285247803, 4.148849010467529, 3.07094669342041, 2.608273506164551, 4.548847675323486, 4.239595413208008, 1.9556224346160889, 3.4719409942626953, 2.222322940826416, 0.8974199295043945, 3.90248441696167, 4.010791301727295, 2.1995246410369873, 3.203472852706909, 3.108590841293335, 3.6783950328826904, 3.3767642974853516, 0.024218082427978516, 4.075973987579346, 3.0428366661071777, 3.660954475402832, 3.9841675758361816, 3.2270445823669434, 2.7291667461395264, 3.2825498580932617, 2.9347753524780273, 3.225412130355835, 1.9429988861083984, 2.428983449935913, 2.312252998352051, 4.180628299713135, 0.5939927101135254, 3.9022316932678223, 3.2590911388397217, 3.0297820568084717, 3.7871055603027344, 2.149902105331421, 3.3770194053649902, 4.192924499511719, 4.564139366149902, 3.926469564437866, 3.9340498447418213, 3.0355706214904785, 3.837999105453491, 3.904193162918091, 3.2922987937927246, 3.9921467304229736, 3.495589256286621, 3.3811941146850586, 0.8287439346313477, 2.867762327194214, 4.880401611328125, 3.39599347114563, 2.3979384899139404, 3.633430004119873, 2.741424560546875, 3.9150214195251465, 3.7785451412200928, 1.3850808143615723, 2.246030807495117, 4.668869972229004, 2.2563083171844482, 2.2336480617523193, 3.222616672515869, 2.066786050796509, 2.8307018280029297, 4.109260559082031, 2.1055195331573486, 4.754270553588867, 3.6010868549346924, 2.1208112239837646, 2.689387321472168, 4.285378456115723, 1.1685655117034912, 4.516258716583252, 3.903822898864746, 3.804969310760498, 3.551556348800659, 3.2523605823516846, 3.9012608528137207, 2.7345364093780518, 2.901296854019165, 4.198224067687988, 3.7551474571228027, 3.2291433811187744, 3.3523454666137695, 4.571136951446533, 0.21533536911010742, 2.77728533744812, 1.8993563652038574, 3.677393913269043, 3.841392993927002, 3.5349996089935303, 2.1632354259490967, 4.006012916564941, 3.884146213531494, 4.444446563720703, 3.190364360809326, 3.5619354248046875, 2.6989240646362305, 3.318521499633789, 2.321925163269043, 3.301910877227783, 3.0688858032226562, 3.2313337326049805, 2.746692419052124, 3.0076959133148193, 2.4471678733825684, 0.9521427154541016, 3.5534796714782715, 2.8521854877471924, 3.0398049354553223, 3.842639207839966, 3.3077232837677, 3.455986261367798, 4.173022747039795, 2.9767189025878906, 3.119795083999634, 4.242842197418213], "mean_td_error": 3.149240016937256, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 51.0}}, "num_env_steps_sampled": 11800, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 23600, "num_agent_steps_trained": 13312, "last_target_update_ts": 11800, "num_target_updates": 52}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1867.956219458337, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1915.3514605369542, "('robot_1', 'robot_1')_total_reward_min": 1829.3888863166073, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3637.567875571126, "episode_reward_mean": 3783.3076799952905, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1829.3888863166073}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1867.956219458337, "robot_1": 1915.3514605369542}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8377623576085282, "mean_inference_ms": 3.742829866811088, "mean_action_processing_ms": 0.521710452568861, "mean_env_wait_ms": 0.49108170529633705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013875961303710938, "StateBufferConnector_ms": 0.0038832426071166992, "ViewRequirementAgentConnector_ms": 0.15757977962493896}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23600, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 11800, "num_env_steps_trained": 13312, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 342.7862275142015, "num_env_steps_trained_throughput_per_sec": 438.76637121817794, "timesteps_total": 11800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23600, "timers": {"training_iteration_time_ms": 541.72, "sample_time_ms": 292.953, "load_time_ms": 0.677, "load_throughput": 378291.229, "learn_time_ms": 38.842, "learn_throughput": 6590.814, "synch_weights_time_ms": 12.843}, "counters": {"num_env_steps_sampled": 11800, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 23600, "num_agent_steps_trained": 13312, "last_target_update_ts": 11800, "num_target_updates": 52}, "done": false, "episodes_total": 20, "training_iteration": 25, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-31", "timestamp": 1742586571, "time_this_iter_s": 1.1833925247192383, "time_total_s": 31.20178985595703, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A5860CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 31.20178985595703, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 40.349999999999994, "ram_util_percent": 91.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1864.432091551135, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1904.7826652583205, "('robot_1', 'robot_1')_total_reward_min": 1773.3923186107245, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.402621269226074, "actor_loss": -10.806683540344238, "critic_loss": 1.6394693851470947, "alpha_loss": -0.213186115026474, "alpha_value": 0.9842195510864258, "log_alpha_value": -0.015906300395727158, "target_entropy": -8.0, "policy_t": -0.006937806960195303, "mean_q": 5.623353481292725, "max_q": 10.707120895385742, "min_q": 3.397322416305542}, "td_error": [1.4458072185516357, 3.5266199111938477, 3.8883728981018066, 1.5668480396270752, 3.37794828414917, 2.6406097412109375, 0.6039681434631348, 1.7764406204223633, 2.3613088130950928, 2.9171862602233887, 3.7493038177490234, 2.483797788619995, 2.781742572784424, 3.950502634048462, 3.2404067516326904, 3.617560386657715, 4.567694664001465, 2.939229726791382, 2.287240743637085, 2.7057886123657227, 3.8257741928100586, 2.940056324005127, 3.342487335205078, 1.017049789428711, 3.5243115425109863, 3.7028920650482178, 1.4752964973449707, 2.236175298690796, 2.0194175243377686, 3.87185001373291, 2.923017740249634, 4.07383394241333, 3.3181378841400146, 2.5316848754882812, 4.071719646453857, 3.8023838996887207, 1.0967283248901367, 2.9134974479675293, 3.3407669067382812, 4.398837089538574, 3.4465091228485107, 2.004905939102173, 2.089021682739258, 2.6930930614471436, 2.4370944499969482, 4.00770902633667, 3.8228836059570312, 3.4429373741149902, 4.225826740264893, 4.7990522384643555, 2.7080752849578857, 0.7322220802307129, 3.0708203315734863, 2.423978567123413, 2.4962587356567383, 2.9737658500671387, 0.8145005702972412, 4.08453369140625, 4.690359592437744, 2.490814685821533, 3.57761287689209, 2.9065356254577637, 4.909317493438721, 2.5532338619232178, 3.9452011585235596, 3.387725830078125, 0.7013087272644043, 3.637120485305786, 0.680727481842041, 2.8471004962921143, 4.688905239105225, 2.722670793533325, 2.239391326904297, 2.6762795448303223, 2.9753611087799072, 1.5830209255218506, 3.793548345565796, 2.3462164402008057, 1.4360346794128418, 3.6851494312286377, 2.4002695083618164, 2.616427183151245, 3.6804769039154053, 3.1314303874969482, 3.6074025630950928, 2.5481889247894287, 1.3352398872375488, 4.906408309936523, 3.1272225379943848, 2.749058485031128, 0.9890806674957275, 3.3993661403656006, 3.914402484893799, 4.067237377166748, 2.284353733062744, 3.9991190433502197, 3.962062358856201, 2.964097738265991, 1.4405632019042969, 4.350034713745117, 1.4622530937194824, 2.2401232719421387, 3.4885785579681396, 2.6912477016448975, 2.5081660747528076, 2.825881004333496, 3.0309834480285645, 2.7195611000061035, 1.8593621253967285, 3.1616265773773193, 2.2765235900878906, 2.593193769454956, 1.5822649002075195, 4.190798759460449, 3.2246341705322266, 2.0288145542144775, 1.4093074798583984, 3.0320894718170166, 3.7561378479003906, 3.3383681774139404, 3.069326877593994, 2.851132869720459, 1.0268020629882812, 4.30318546295166, 2.794146776199341, 1.730159044265747, 1.9420161247253418, 4.536791801452637], "mean_td_error": 2.896461248397827, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.392753601074219, "actor_loss": -11.11764144897461, "critic_loss": 0.7699998617172241, "alpha_loss": -0.21301846206188202, "alpha_value": 0.9842203259468079, "log_alpha_value": -0.015905503183603287, "target_entropy": -8.0, "policy_t": 0.02904372662305832, "mean_q": 6.0576324462890625, "max_q": 10.589705467224121, "min_q": 3.8215556144714355}, "td_error": [0.3526005744934082, 3.4546051025390625, 4.051897048950195, 1.8961563110351562, 1.275430679321289, 4.021383762359619, 4.069059371948242, 2.306150436401367, 4.2033491134643555, 1.5102343559265137, 3.521970272064209, 3.7773258686065674, 2.5564684867858887, 4.189776420593262, 2.575700521469116, 2.494842290878296, 5.01400089263916, 0.5604639053344727, 0.29008960723876953, 3.4185009002685547, 0.8802604675292969, 1.9831821918487549, 3.3211658000946045, 3.1181392669677734, 3.969205379486084, 2.8688409328460693, 3.0808322429656982, 2.3145971298217773, 1.547680139541626, 3.8282012939453125, 2.9446334838867188, 3.1214048862457275, 3.660684823989868, 2.2822835445404053, 3.3754727840423584, 2.5519983768463135, 2.5758345127105713, 1.0167217254638672, 0.5751404762268066, 2.355416774749756, 2.1101975440979004, 3.1327648162841797, 2.610119581222534, 4.820651054382324, 4.387636184692383, 2.3715481758117676, 3.9027187824249268, 4.764888763427734, 2.452389717102051, 3.4795279502868652, 2.148465633392334, 3.045945644378662, 3.547994375228882, 1.16314697265625, 3.118955373764038, 2.8754615783691406, 2.5859720706939697, 2.5113582611083984, 1.7770919799804688, 2.153477191925049, 2.8877501487731934, 1.6377696990966797, 1.1562795639038086, 3.1325018405914307, 1.1242280006408691, 3.5208966732025146, 2.297794818878174, 0.9470953941345215, 3.1493005752563477, 2.3001973628997803, 3.926542043685913, 0.8778553009033203, 2.289592742919922, 2.4196951389312744, 3.3623383045196533, 1.9125902652740479, 3.498720169067383, 2.3671059608459473, 0.08353185653686523, 2.2935943603515625, 3.403435707092285, 2.7932090759277344, 2.070753574371338, 3.381471633911133, 2.0611519813537598, 3.4214255809783936, 2.4639322757720947, 3.8389296531677246, 2.692704916000366, 4.605425834655762, 2.178048849105835, 3.827664613723755, 4.720120906829834, 0.6275045871734619, 2.4167263507843018, 4.412901401519775, 3.0079591274261475, 3.34454607963562, 3.0965681076049805, 3.7471492290496826, 1.7318732738494873, 3.785719394683838, 2.719491481781006, 2.6745765209198, 4.764615058898926, 2.867541551589966, 1.436004400253296, 3.673203706741333, 0.5285358428955078, 0.8853344917297363, 3.661863088607788, 3.0395641326904297, 1.8420910835266113, 2.8376755714416504, 4.204606056213379, 1.0989019870758057, 2.45902419090271, 4.3420000076293945, 2.607024669647217, 2.7828028202056885, 3.4914071559906006, 4.194798469543457, 4.331219673156738, 2.146692991256714, 4.154853820800781, 2.6635096073150635, 2.0834734439849854, 2.776167869567871], "mean_td_error": 2.7574498653411865, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}}, "num_env_steps_sampled": 12200, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 24400, "num_agent_steps_trained": 13824, "last_target_update_ts": 12200, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3622.616396967597, "episode_reward_mean": 3769.214756809455, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1773.3923186107245}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1864.432091551135, "robot_1": 1904.7826652583205}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1864.432091551135, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1904.7826652583205, "('robot_1', 'robot_1')_total_reward_min": 1773.3923186107245, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214, 3696.0299486811664, 3634.558608155463, 3841.7956097168767, 3622.616396967597], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175, 1922.637630070447, 1765.9086724431065, 1868.6488148252522, 1830.0506907217002], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477, 1773.3923186107245, 1868.6499357123587, 1973.1467948916281, 1792.5657062458931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8334303821126002, "mean_inference_ms": 3.714437514007697, "mean_action_processing_ms": 0.5227044228512651, "mean_env_wait_ms": 0.4881566537319446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01574605703353882, "StateBufferConnector_ms": 0.0032360355059305825, "ViewRequirementAgentConnector_ms": 0.13131648302078247}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3622.616396967597, "episode_reward_mean": 3769.214756809455, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1773.3923186107245}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1864.432091551135, "robot_1": 1904.7826652583205}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214, 3696.0299486811664, 3634.558608155463, 3841.7956097168767, 3622.616396967597], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175, 1922.637630070447, 1765.9086724431065, 1868.6488148252522, 1830.0506907217002], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477, 1773.3923186107245, 1868.6499357123587, 1973.1467948916281, 1792.5657062458931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8334303821126002, "mean_inference_ms": 3.714437514007697, "mean_action_processing_ms": 0.5227044228512651, "mean_env_wait_ms": 0.4881566537319446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01574605703353882, "StateBufferConnector_ms": 0.0032360355059305825, "ViewRequirementAgentConnector_ms": 0.13131648302078247}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24400, "num_agent_steps_trained": 13824, "num_env_steps_sampled": 12200, "num_env_steps_trained": 13824, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 353.06607113883547, "num_env_steps_trained_throughput_per_sec": 451.9245710577094, "timesteps_total": 12200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24400, "timers": {"training_iteration_time_ms": 557.382, "sample_time_ms": 302.084, "load_time_ms": 0.677, "load_throughput": 378291.229, "learn_time_ms": 39.667, "learn_throughput": 6453.648, "synch_weights_time_ms": 11.857}, "counters": {"num_env_steps_sampled": 12200, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 24400, "num_agent_steps_trained": 13824, "last_target_update_ts": 12200, "num_target_updates": 54}, "done": false, "episodes_total": 24, "training_iteration": 26, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-36", "timestamp": 1742586576, "time_this_iter_s": 1.1579055786132812, "time_total_s": 32.35969543457031, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A58609D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 32.35969543457031, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 24.97142857142857, "ram_util_percent": 91.91428571428571}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1864.432091551135, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1904.7826652583205, "('robot_1', 'robot_1')_total_reward_min": 1773.3923186107245, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.333868980407715, "actor_loss": -11.532098770141602, "critic_loss": 1.3385581970214844, "alpha_loss": -0.22008804976940155, "alpha_value": 0.9836295247077942, "log_alpha_value": -0.01650594174861908, "target_entropy": -8.0, "policy_t": 0.022138575091958046, "mean_q": 6.240170478820801, "max_q": 11.058294296264648, "min_q": 3.7132112979888916}, "td_error": [2.6054816246032715, 3.1655750274658203, 3.7367944717407227, 0.9466996192932129, 3.5883891582489014, 0.7135162353515625, 0.9531779289245605, 3.0483245849609375, 2.987504243850708, 4.170366287231445, 1.4179186820983887, 2.7713472843170166, 2.444952964782715, 1.2708497047424316, 3.1100568771362305, 3.5494091510772705, 2.9400079250335693, 0.677980899810791, 2.5497188568115234, 1.5004329681396484, 2.1706292629241943, 3.499427318572998, 2.9149792194366455, 2.064847946166992, 2.587364912033081, 2.1009509563446045, 1.8780531883239746, 2.2508158683776855, 2.1427218914031982, 3.8602805137634277, 2.620652675628662, 2.896681547164917, 2.1800994873046875, 2.531669855117798, 3.3515141010284424, 2.7400224208831787, 4.524357795715332, 1.384385585784912, 5.0859270095825195, 2.791090965270996, 1.61686372756958, 3.6666109561920166, 3.227567672729492, 3.793012857437134, 3.0265815258026123, 0.6826581954956055, 3.5835044384002686, 2.7435615062713623, 2.372415065765381, 1.240987777709961, 2.522152900695801, 3.089277744293213, 3.259814977645874, 1.7380027770996094, 2.9216721057891846, 2.823599100112915, 2.9174869060516357, 3.8161771297454834, 2.773465156555176, 1.0391769409179688, 3.6798765659332275, 0.941195011138916, 3.090423822402954, 3.0796403884887695, 2.888333559036255, 1.658400058746338, 3.4474844932556152, 3.5053768157958984, 3.0985183715820312, 1.649289846420288, 3.4069859981536865, 3.051737070083618, 2.7952277660369873, 2.5807816982269287, 2.518918752670288, 2.779690742492676, 2.968395471572876, 2.8228280544281006, 1.6015112400054932, 1.1826791763305664, 0.9714078903198242, 2.317305564880371, 1.941697120666504, 4.001372337341309, 3.43530011177063, 1.8723750114440918, 1.9221041202545166, 3.7990310192108154, 1.9369516372680664, 2.79502534866333, 3.735593795776367, 3.7940499782562256, 1.7657513618469238, 2.7629554271698, 2.3027093410491943, 2.536083698272705, 1.0291528701782227, 0.8535280227661133, 2.2954068183898926, 2.826761245727539, 2.8152735233306885, 3.022909164428711, 1.0364835262298584, 1.9344451427459717, 3.1132121086120605, 2.369964599609375, 1.292083501815796, 2.101625680923462, 2.5819220542907715, 2.5256450176239014, 2.903947114944458, 3.239528179168701, 2.99109148979187, 0.5023369789123535, 0.6790566444396973, 1.0769124031066895, 1.873279333114624, 3.7318408489227295, 2.5203487873077393, 1.642195224761963, 1.9688093662261963, 2.7540853023529053, 3.143312692642212, 1.2394886016845703, 2.871152877807617, 3.4490509033203125, 3.2901904582977295, 1.6970765590667725], "mean_td_error": 2.5202243328094482, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.405942916870117, "actor_loss": -11.574968338012695, "critic_loss": 0.6047976016998291, "alpha_loss": -0.22126491367816925, "alpha_value": 0.9836304783821106, "log_alpha_value": -0.016504986211657524, "target_entropy": -8.0, "policy_t": -0.0003868844360113144, "mean_q": 6.535853385925293, "max_q": 11.2252779006958, "min_q": 2.5375850200653076}, "td_error": [3.7836313247680664, 0.6691150665283203, 1.2615108489990234, 1.6296000480651855, 2.8558013439178467, 2.689293146133423, 1.9987030029296875, 3.152547597885132, 1.6031303405761719, 3.779266357421875, 0.5698337554931641, 2.5483760833740234, 2.9426724910736084, 0.8197498321533203, 1.5261123180389404, 1.5721893310546875, 1.9664902687072754, 2.4881885051727295, 1.7938990592956543, 1.95684814453125, 1.5566620826721191, 2.245918035507202, 2.0620384216308594, 3.341642379760742, 1.464463472366333, 2.4959628582000732, 4.188374042510986, 2.3165669441223145, 1.855344295501709, 0.31951427459716797, 1.9262163639068604, 2.825124502182007, 1.967088222503662, 1.252591848373413, 2.129136562347412, 1.5661847591400146, 2.3421523571014404, 1.2863731384277344, 2.573831081390381, 3.305593967437744, 0.7802672386169434, 0.6986136436462402, 3.5549066066741943, 2.934718370437622, 2.894287586212158, 3.0705482959747314, 2.768566370010376, 2.8545682430267334, 1.6485157012939453, 2.97957444190979, 3.141983985900879, 2.48240065574646, 0.9638364315032959, 4.846756935119629, 3.082828998565674, 3.017841339111328, 3.383404016494751, 3.0772721767425537, 3.3438098430633545, 3.4753239154815674, 1.6483609676361084, 0.8988537788391113, 1.5928211212158203, 0.8786811828613281, 1.261026382446289, 3.3715686798095703, 5.687993049621582, 1.386345624923706, 2.965488910675049, 1.6341066360473633, 0.5645463466644287, 1.2262802124023438, 1.5165715217590332, 3.119232416152954, 2.0138816833496094, 2.58158016204834, 1.8517608642578125, 2.6332297325134277, 4.196996688842773, 2.795579433441162, 6.371762752532959, 1.6534698009490967, 1.333979845046997, 3.2205238342285156, 1.851149082183838, 3.119492292404175, 1.970961332321167, 1.419173240661621, 1.3469738960266113, 1.585855484008789, 3.0716657638549805, 2.6032626628875732, 1.7974412441253662, 2.4721803665161133, 3.432082176208496, 1.8639335632324219, 1.6240835189819336, 2.97773814201355, 0.7512190341949463, 4.909812927246094, 4.575138092041016, 0.821420431137085, 1.8515748977661133, 2.439819812774658, 1.7486743927001953, 3.252197265625, 2.3169021606445312, 3.179248332977295, 0.6007328033447266, 0.9746353626251221, 3.028223991394043, 2.7997076511383057, 2.5292916297912598, 2.054682970046997, 3.151862621307373, 3.014392137527466, 2.10872220993042, 1.0446550846099854, 2.8238916397094727, 3.523324489593506, 3.1762752532958984, 2.365938186645508, 0.6442523002624512, 3.5822625160217285, 0.8461296558380127, 3.4308388233184814, 1.000896692276001, 2.7055578231811523], "mean_td_error": 2.331411600112915, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 12600, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 14336, "last_target_update_ts": 12600, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": 3993.1459643824464, "episode_reward_min": 3622.616396967597, "episode_reward_mean": 3769.214756809455, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1773.3923186107245}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1864.432091551135, "robot_1": 1904.7826652583205}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1864.432091551135, "('robot_0', 'robot_0')_total_reward_min": 1718.777861584021, "('robot_0', 'robot_0')_total_reward_max": 1990.0897526823971, "('robot_1', 'robot_1')_total_reward_mean": 1904.7826652583205, "('robot_1', 'robot_1')_total_reward_min": 1773.3923186107245, "('robot_1', 'robot_1')_total_reward_max": 2057.453219159036}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214, 3696.0299486811664, 3634.558608155463, 3841.7956097168767, 3622.616396967597], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175, 1922.637630070447, 1765.9086724431065, 1868.6488148252522, 1830.0506907217002], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477, 1773.3923186107245, 1868.6499357123587, 1973.1467948916281, 1792.5657062458931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8334303821126002, "mean_inference_ms": 3.714437514007697, "mean_action_processing_ms": 0.5227044228512651, "mean_env_wait_ms": 0.4881566537319446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01574605703353882, "StateBufferConnector_ms": 0.0032360355059305825, "ViewRequirementAgentConnector_ms": 0.13131648302078247}}, "episode_reward_max": 3993.1459643824464, "episode_reward_min": 3622.616396967597, "episode_reward_mean": 3769.214756809455, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1718.777861584021, "robot_1": 1773.3923186107245}, "policy_reward_max": {"robot_0": 1990.0897526823971, "robot_1": 2057.453219159036}, "policy_reward_mean": {"robot_0": 1864.432091551135, "robot_1": 1904.7826652583205}, "hist_stats": {"episode_reward": [3881.799331224325, 3665.5295867771197, 3993.1459643824464, 3657.8684429649375, 3729.0530748422343, 3866.1452261800823, 3872.9834541461682, 3781.5142181787855, 3688.586009245976, 3783.6496633748775, 3740.1475254480238, 3673.8961831107667, 3754.9167568372573, 3890.1691254050465, 3883.6125779287495, 3802.728585969829, 3802.9995399308123, 3808.2034488201366, 3637.567875571126, 3751.6370095671214, 3696.0299486811664, 3634.558608155463, 3841.7956097168767, 3622.616396967597], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1824.3461120652878, 1718.777861584021, 1990.0897526823971, 1823.9531891132576, 1810.0934201954005, 1891.1905047839036, 1908.5776122770928, 1894.0524397464815, 1794.269778544237, 1834.9650620825153, 1853.0765775049124, 1842.0191439200332, 1873.4862847605345, 1933.9495726311504, 1932.2710230356897, 1851.5141541543464, 1901.4242647062988, 1978.8145625035268, 1808.0451661534719, 1894.207906722175, 1922.637630070447, 1765.9086724431065, 1868.6488148252522, 1830.0506907217002], "policy_robot_1_reward": [2057.453219159036, 1946.7517251930965, 2003.0562117000504, 1833.9152538516823, 1918.9596546468329, 1974.9547213961828, 1964.4058418690822, 1887.461778432299, 1894.3162307017383, 1948.684601292366, 1887.0709479431137, 1831.8770391907287, 1881.430472076726, 1956.2195527738947, 1951.341554893056, 1951.2144318154794, 1901.5752752245103, 1829.3888863166073, 1829.522709417659, 1857.4291028449477, 1773.3923186107245, 1868.6499357123587, 1973.1467948916281, 1792.5657062458931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8334303821126002, "mean_inference_ms": 3.714437514007697, "mean_action_processing_ms": 0.5227044228512651, "mean_env_wait_ms": 0.4881566537319446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01574605703353882, "StateBufferConnector_ms": 0.0032360355059305825, "ViewRequirementAgentConnector_ms": 0.13131648302078247}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 12600, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 369.3652490271731, "num_env_steps_trained_throughput_per_sec": 472.78751875478156, "timesteps_total": 12600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25200, "timers": {"training_iteration_time_ms": 564.968, "sample_time_ms": 303.97, "load_time_ms": 0.677, "load_throughput": 378291.229, "learn_time_ms": 39.65, "learn_throughput": 6456.512, "synch_weights_time_ms": 13.268}, "counters": {"num_env_steps_sampled": 12600, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 14336, "last_target_update_ts": 12600, "num_target_updates": 56}, "done": false, "episodes_total": 24, "training_iteration": 27, "trial_id": "7581f_00000", "date": "2025-03-21_19-49-37", "timestamp": 1742586577, "time_this_iter_s": 1.1000216007232666, "time_total_s": 33.45971703529358, "pid": 2644, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x00000298A58604C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 33.45971703529358, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 36.05, "ram_util_percent": 92.05}}
