{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400, "num_agent_steps_trained": 0, "num_env_steps_sampled": 200, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 200, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 177.75803773418582, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 200, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 400, "timers": {"training_iteration_time_ms": 1125.125, "sample_time_ms": 291.53}, "counters": {"num_env_steps_sampled": 200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-14", "timestamp": 1742591174, "time_this_iter_s": 1.1332051753997803, "time_total_s": 1.1332051753997803, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE298F040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1.1332051753997803, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.35, "ram_util_percent": 90.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 0, "num_env_steps_sampled": 800, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 576.016831546515, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 800, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1600, "timers": {"training_iteration_time_ms": 541.69, "sample_time_ms": 287.405}, "counters": {"num_env_steps_sampled": 800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-15", "timestamp": 1742591175, "time_this_iter_s": 1.0416362285614014, "time_total_s": 2.1748414039611816, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE298FCA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 2.1748414039611816, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.85, "ram_util_percent": 91.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.279491424560547, "actor_loss": -5.276352405548096, "critic_loss": 8.090557098388672, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -8.0, "policy_t": 0.018727241083979607, "mean_q": 5.47793970326893e-05, "max_q": 0.0036521011497825384, "min_q": -0.004317387007176876}, "td_error": [8.410810470581055, 8.350201606750488, 9.443711280822754, 8.741477966308594, 8.108745574951172, 7.480442047119141, 9.35374641418457, 8.67934799194336, 8.393455505371094, 8.5897855758667, 9.717733383178711, 8.907767295837402, 9.21017074584961, 9.342033386230469, 8.006171226501465, 8.711925506591797, 8.841976165771484, 8.41252613067627, 8.987317085266113, 7.940495491027832, 8.528343200683594, 8.363840103149414, 7.695932388305664, 8.253168106079102, 9.779422760009766, 7.728748321533203, 10.06385612487793, 8.146384239196777, 8.939451217651367, 8.401899337768555, 7.285626411437988, 8.31130313873291, 8.592910766601562, 8.353277206420898, 8.262969970703125, 8.706893920898438, 7.122255325317383, 7.189901351928711, 8.34844970703125, 7.931954383850098, 7.845268249511719, 8.652076721191406, 9.247081756591797, 8.439502716064453, 8.107614517211914, 8.476522445678711, 8.378515243530273, 8.210494041442871, 8.969676971435547, 7.972582817077637, 9.03111457824707, 8.648128509521484, 9.806978225708008, 8.948278427124023, 9.943645477294922, 8.632467269897461, 9.330184936523438, 8.493796348571777, 9.64728832244873, 8.77992057800293, 8.47784423828125, 8.939665794372559, 9.041805267333984, 8.8016357421875, 9.308610916137695, 7.412164688110352, 8.307279586791992, 9.279765129089355, 9.072479248046875, 8.412150382995605, 8.051788330078125, 9.08435344696045, 7.6677961349487305, 8.151912689208984, 8.83022689819336, 8.936615943908691, 9.705558776855469, 7.933776378631592, 9.234485626220703, 8.312999725341797, 8.247957229614258, 9.566474914550781, 8.973320007324219, 6.86061954498291, 8.879510879516602, 7.736082553863525, 7.577455520629883, 9.650554656982422, 7.728695869445801, 9.533889770507812, 7.95120096206665, 9.150160789489746, 8.703985214233398, 8.414874076843262, 9.541518211364746, 9.083251953125, 8.509820938110352, 8.868885040283203, 8.109051704406738, 8.014078140258789, 7.520063400268555, 8.969500541687012, 8.086385726928711, 9.30781364440918, 7.636274814605713, 8.971216201782227, 7.059940338134766, 9.052749633789062, 9.776996612548828, 8.383233070373535, 8.35278034210205, 9.696340560913086, 8.658592224121094, 9.25086498260498, 8.868643760681152, 9.197978973388672, 8.863588333129883, 8.39779281616211, 8.546049118041992, 7.819356918334961, 8.929012298583984, 9.008125305175781, 8.555989265441895, 7.792510986328125, 8.462005615234375, 6.966907501220703, 9.582672119140625, 8.616142272949219], "mean_td_error": 8.590558052062988, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.29251480102539, "actor_loss": -5.291929721832275, "critic_loss": 8.056392669677734, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -8.0, "policy_t": -0.00687661487609148, "mean_q": 0.0013883430510759354, "max_q": 0.006489628925919533, "min_q": -0.006362845189869404}, "td_error": [9.406070709228516, 7.9810991287231445, 9.509103775024414, 7.691678047180176, 7.768787860870361, 8.77276611328125, 7.890333652496338, 9.153484344482422, 9.723191261291504, 8.163265228271484, 10.514074325561523, 8.772984504699707, 9.037641525268555, 7.849430084228516, 6.9806318283081055, 9.885786056518555, 8.475160598754883, 9.780099868774414, 9.074172973632812, 8.251618385314941, 9.40060043334961, 7.916996002197266, 8.800437927246094, 9.238359451293945, 8.201760292053223, 8.582540512084961, 8.838449478149414, 8.413042068481445, 8.563125610351562, 8.595911026000977, 8.709423065185547, 7.841666221618652, 8.001420021057129, 8.81072998046875, 8.760496139526367, 8.479230880737305, 10.078361511230469, 8.048379898071289, 8.732949256896973, 8.732765197753906, 8.242574691772461, 8.937414169311523, 7.603663921356201, 8.149148941040039, 8.942667007446289, 6.8770952224731445, 9.177763938903809, 9.074796676635742, 8.168821334838867, 7.20410680770874, 8.292177200317383, 9.370414733886719, 8.787908554077148, 8.039397239685059, 8.452577590942383, 8.583006858825684, 7.3612165451049805, 9.008201599121094, 8.447524070739746, 8.827540397644043, 7.854948997497559, 9.474493026733398, 7.681179046630859, 8.416179656982422, 8.678350448608398, 8.910528182983398, 8.799394607543945, 7.955993175506592, 8.411304473876953, 8.546009063720703, 8.688863754272461, 7.364810943603516, 8.99997329711914, 8.297586441040039, 8.962539672851562, 8.376691818237305, 8.346481323242188, 8.421297073364258, 7.944390773773193, 7.713979721069336, 9.065369606018066, 8.20220947265625, 8.432886123657227, 8.486163139343262, 9.019363403320312, 9.023740768432617, 8.282958984375, 8.187765121459961, 7.683009147644043, 8.320592880249023, 8.015453338623047, 9.016921043395996, 9.0023193359375, 8.600629806518555, 7.928281784057617, 9.167181015014648, 7.064690589904785, 8.882116317749023, 8.251352310180664, 8.241607666015625, 8.810999870300293, 9.336459159851074, 8.412193298339844, 8.02884292602539, 7.9283294677734375, 9.776296615600586, 8.037954330444336, 8.477672576904297, 9.073846817016602, 9.061094284057617, 8.053485870361328, 9.258172988891602, 8.211316108703613, 8.716097831726074, 8.677218437194824, 8.158599853515625, 8.629225730895996, 9.113288879394531, 8.161356925964355, 8.670653343200684, 9.079910278320312, 8.532598495483398, 8.52906608581543, 9.287281036376953, 8.670549392700195, 9.096370697021484, 8.886703491210938, 8.846981048583984], "mean_td_error": 8.556392669677734, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1600, "num_env_steps_trained": 256, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 256, "last_target_update_ts": 1600, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 256, "num_env_steps_sampled": 1600, "num_env_steps_trained": 256, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 256, "num_env_steps_sampled_throughput_per_sec": 521.6884427923296, "num_env_steps_trained_throughput_per_sec": 166.94030169354548, "timesteps_total": 1600, "num_steps_trained_this_iter": 256, "agent_timesteps_total": 3200, "timers": {"training_iteration_time_ms": 462.53, "sample_time_ms": 283.235, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 58.548, "learn_throughput": 4372.447, "synch_weights_time_ms": 8.322}, "counters": {"num_env_steps_sampled": 1600, "num_env_steps_trained": 256, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 256, "last_target_update_ts": 1600, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-16", "timestamp": 1742591176, "time_this_iter_s": 1.550058126449585, "time_total_s": 3.7248995304107666, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE298FA60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 3.7248995304107666, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.5, "ram_util_percent": 91.19999999999999}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.410319328308105, "actor_loss": -5.4283881187438965, "critic_loss": 7.184938907623291, "alpha_loss": -0.00804632343351841, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0006000098073855042, "target_entropy": -8.0, "policy_t": 0.0069526322185993195, "mean_q": 0.023420946672558784, "max_q": 0.04524107649922371, "min_q": 0.01432775054126978}, "td_error": [8.968202590942383, 8.103357315063477, 8.521188735961914, 8.21832275390625, 7.757460117340088, 7.016593933105469, 8.90134048461914, 8.374438285827637, 9.379158020019531, 8.682743072509766, 8.927849769592285, 8.384353637695312, 9.01131820678711, 10.333633422851562, 9.104334831237793, 9.07740592956543, 9.46290397644043, 8.39116382598877, 8.857900619506836, 8.86745548248291, 7.784087657928467, 8.906938552856445, 9.05314826965332, 9.022863388061523, 9.104917526245117, 8.683238983154297, 9.878950119018555, 8.59054183959961, 7.972453594207764, 8.109770774841309, 7.912942409515381, 8.429040908813477, 8.17941951751709, 8.843043327331543, 8.69672679901123, 8.587894439697266, 9.666436195373535, 8.355684280395508, 9.721431732177734, 8.63323974609375, 8.952695846557617, 8.445384979248047, 9.335794448852539, 8.101186752319336, 8.63338851928711, 8.011500358581543, 8.896074295043945, 8.175054550170898, 8.042024612426758, 8.440160751342773, 8.641021728515625, 8.767585754394531, 9.194465637207031, 8.281845092773438, 8.163784980773926, 9.296936988830566, 9.195659637451172, 9.496315002441406, 8.252875328063965, 7.113720893859863, 8.796640396118164, 7.520644187927246, 7.914082050323486, 7.813977241516113, 7.382879257202148, 9.042654991149902, 8.067676544189453, 8.438369750976562, 9.380182266235352, 7.722713470458984, 8.66530990600586, 8.292718887329102, 8.987773895263672, 7.464282989501953, 8.462377548217773, 9.031299591064453, 8.263854026794434, 9.43725872039795, 8.923513412475586, 8.770435333251953, 9.539468765258789, 9.062471389770508, 8.803220748901367, 8.693244934082031, 8.163419723510742, 7.669572830200195, 8.536556243896484, 8.968347549438477, 8.139677047729492, 9.367770195007324, 9.480857849121094, 8.969059944152832, 8.420913696289062, 8.466094970703125, 9.310588836669922, 9.049819946289062, 9.28175163269043, 8.816070556640625, 9.013700485229492, 9.438268661499023, 9.294584274291992, 8.797674179077148, 9.2564058303833, 8.610113143920898, 8.23838996887207, 9.183176040649414, 9.000232696533203, 9.374242782592773, 10.158447265625, 7.946491241455078, 7.292245864868164, 9.134842872619629, 8.484819412231445, 8.881808280944824, 8.611331939697266, 8.68290901184082, 8.712930679321289, 9.179768562316895, 8.594602584838867, 9.305647850036621, 9.767452239990234, 9.287628173828125, 8.536529541015625, 8.705263137817383, 8.504558563232422, 9.979110717773438, 8.267770767211914, 8.671686172485352], "mean_td_error": 8.702669143676758, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.370598793029785, "actor_loss": -5.395240306854248, "critic_loss": 7.154760360717773, "alpha_loss": -0.008023584261536598, "alpha_value": 0.9994000792503357, "log_alpha_value": -0.0006000916473567486, "target_entropy": -8.0, "policy_t": -0.03486417979001999, "mean_q": 0.031039584428071976, "max_q": 0.04934753105044365, "min_q": 0.01970760151743889}, "td_error": [8.320711135864258, 7.610994338989258, 8.830982208251953, 8.42011833190918, 9.386890411376953, 7.892800807952881, 9.726898193359375, 8.538163185119629, 8.215187072753906, 7.548946380615234, 9.378620147705078, 8.11120891571045, 8.423200607299805, 9.517057418823242, 7.687006950378418, 9.56447982788086, 9.039240837097168, 7.621945381164551, 8.46806812286377, 9.912870407104492, 8.965131759643555, 8.890148162841797, 9.068401336669922, 9.58702564239502, 9.016639709472656, 8.684120178222656, 8.908044815063477, 9.525113105773926, 9.834283828735352, 9.056992530822754, 10.362404823303223, 8.719114303588867, 8.122309684753418, 8.644044876098633, 8.38470458984375, 8.811592102050781, 8.47523307800293, 8.24726676940918, 9.34324836730957, 7.798509120941162, 7.783314228057861, 8.527524948120117, 8.374366760253906, 9.29767894744873, 8.972356796264648, 9.123882293701172, 8.065999984741211, 8.760608673095703, 8.612512588500977, 8.173357963562012, 9.123278617858887, 9.431097030639648, 8.247444152832031, 6.992602348327637, 8.836942672729492, 9.256832122802734, 8.366573333740234, 9.029202461242676, 8.787555694580078, 9.425344467163086, 8.219049453735352, 8.472246170043945, 8.211160659790039, 8.708551406860352, 8.505505561828613, 9.479000091552734, 9.47186279296875, 8.676017761230469, 8.444515228271484, 8.381207466125488, 8.380865097045898, 9.21759033203125, 10.266529083251953, 9.245771408081055, 8.653755187988281, 8.621688842773438, 8.134597778320312, 8.475820541381836, 9.184736251831055, 9.168195724487305, 8.474336624145508, 9.068021774291992, 9.167448043823242, 8.916443824768066, 8.671614646911621, 8.578981399536133, 8.651806831359863, 8.914281845092773, 9.24465274810791, 9.871810913085938, 9.785493850708008, 8.575624465942383, 9.17756462097168, 8.173105239868164, 8.398890495300293, 8.671469688415527, 8.950967788696289, 9.530664443969727, 8.203041076660156, 8.60824966430664, 8.587739944458008, 8.358603477478027, 7.8604350090026855, 8.39127254486084, 8.978473663330078, 9.1135892868042, 9.028463363647461, 8.896150588989258, 10.296958923339844, 7.715480804443359, 7.979774475097656, 9.33026123046875, 8.747230529785156, 9.109678268432617, 9.36876106262207, 8.929239273071289, 9.26333236694336, 8.55428695678711, 8.850798606872559, 9.809293746948242, 8.910348892211914, 8.569135665893555, 9.580680847167969, 7.663381576538086, 8.075517654418945, 8.292128562927246, 8.763715744018555, 8.174120903015137], "mean_td_error": 8.77031421661377, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 768, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 768, "last_target_update_ts": 2000, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}}, "episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 768, "num_env_steps_sampled": 2000, "num_env_steps_trained": 768, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 382.92431082728115, "num_env_steps_trained_throughput_per_sec": 490.1431178589199, "timesteps_total": 2000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 474.484, "sample_time_ms": 283.467, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 47.23, "learn_throughput": 5420.31, "synch_weights_time_ms": 10.693}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 768, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 768, "last_target_update_ts": 2000, "num_target_updates": 3}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-17", "timestamp": 1742591177, "time_this_iter_s": 1.0749404430389404, "time_total_s": 4.799839973449707, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFDE960790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 4.799839973449707, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 32.7, "ram_util_percent": 91.2}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.42444896697998, "actor_loss": -5.466081142425537, "critic_loss": 6.63372278213501, "alpha_loss": -0.016111671924591064, "alpha_value": 0.9988005757331848, "log_alpha_value": -0.0012001738650724292, "target_entropy": -8.0, "policy_t": -0.026983151212334633, "mean_q": 0.05063310265541077, "max_q": 0.09346745163202286, "min_q": 0.03180214762687683}, "td_error": [8.683341979980469, 7.403672218322754, 8.584243774414062, 7.843664169311523, 8.63360595703125, 8.06884765625, 8.162821769714355, 9.000384330749512, 8.747962951660156, 7.547438621520996, 9.608160972595215, 9.248529434204102, 8.138021469116211, 8.607128143310547, 9.07476806640625, 8.670120239257812, 8.320932388305664, 9.125116348266602, 8.84351921081543, 9.311837196350098, 9.423219680786133, 8.395652770996094, 9.088200569152832, 7.265556335449219, 8.82304859161377, 8.47540283203125, 8.278879165649414, 9.09794807434082, 8.248140335083008, 9.234380722045898, 9.251493453979492, 8.392816543579102, 8.57658576965332, 8.731616020202637, 8.856051445007324, 7.7065019607543945, 8.922590255737305, 8.745290756225586, 8.023635864257812, 9.422473907470703, 7.785885810852051, 8.287453651428223, 8.735246658325195, 8.900999069213867, 9.615570068359375, 8.225627899169922, 8.367890357971191, 7.241876125335693, 9.608914375305176, 8.795292854309082, 8.886878967285156, 9.207449913024902, 8.662063598632812, 8.974397659301758, 8.005911827087402, 9.421284675598145, 9.1176176071167, 8.473161697387695, 8.891678810119629, 9.111923217773438, 8.045795440673828, 9.278902053833008, 8.839447021484375, 8.062994003295898, 8.445008277893066, 9.087930679321289, 8.781669616699219, 7.751617908477783, 9.618091583251953, 8.846382141113281, 9.204902648925781, 7.513571739196777, 8.671632766723633, 7.628236293792725, 9.558599472045898, 9.142436027526855, 6.8844685554504395, 9.428564071655273, 8.528968811035156, 8.683332443237305, 8.14117431640625, 10.080860137939453, 8.878669738769531, 7.624342918395996, 8.363014221191406, 8.702926635742188, 7.904265880584717, 7.5950927734375, 9.202352523803711, 8.330001831054688, 8.37658405303955, 8.96847915649414, 7.610157012939453, 10.530614852905273, 8.902647972106934, 8.77306842803955, 7.226497173309326, 8.503595352172852, 8.739014625549316, 7.972270488739014, 8.399337768554688, 8.961067199707031, 8.362643241882324, 8.493300437927246, 8.72485065460205, 8.993500709533691, 8.559799194335938, 8.636323928833008, 9.396326065063477, 8.927227973937988, 9.169656753540039, 8.48660659790039, 9.25668716430664, 8.611217498779297, 7.899864196777344, 9.794268608093262, 9.15359115600586, 8.779898643493652, 8.517793655395508, 8.693925857543945, 8.334573745727539, 8.342071533203125, 8.942100524902344, 9.525140762329102, 7.996136665344238, 8.45458984375, 9.10699462890625, 8.504253387451172], "mean_td_error": 8.643380165100098, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.394710540771484, "actor_loss": -5.446312427520752, "critic_loss": 6.775129318237305, "alpha_loss": -0.016075698658823967, "alpha_value": 0.9988005757331848, "log_alpha_value": -0.0012001527938991785, "target_entropy": -8.0, "policy_t": 0.02155504748225212, "mean_q": 0.06321744620800018, "max_q": 0.10537213087081909, "min_q": 0.03647211939096451}, "td_error": [8.095431327819824, 8.320942878723145, 7.938941955566406, 8.617036819458008, 9.107053756713867, 9.91576862335205, 8.02273178100586, 7.552959442138672, 7.778950214385986, 8.4631986618042, 9.004076957702637, 9.041055679321289, 9.313061714172363, 7.39797306060791, 8.378467559814453, 8.634462356567383, 8.783119201660156, 8.334832191467285, 9.167791366577148, 8.59124755859375, 8.063898086547852, 8.34693717956543, 8.836814880371094, 8.303150177001953, 9.858779907226562, 8.152131080627441, 9.01207160949707, 8.464162826538086, 8.797600746154785, 9.315877914428711, 7.458340644836426, 9.106660842895508, 9.139595985412598, 8.52659797668457, 8.305047988891602, 7.260433197021484, 9.546884536743164, 8.810820579528809, 9.563570022583008, 9.512950897216797, 9.650054931640625, 8.24030590057373, 8.885993957519531, 8.846050262451172, 9.290436744689941, 8.612284660339355, 8.473943710327148, 8.968351364135742, 8.935219764709473, 8.35184097290039, 9.495113372802734, 9.670852661132812, 10.071377754211426, 9.522096633911133, 7.639054298400879, 9.891778945922852, 9.067420959472656, 8.968570709228516, 8.68618392944336, 8.70809555053711, 8.243631362915039, 8.06595230102539, 9.287728309631348, 8.698383331298828, 9.27188491821289, 9.20155143737793, 7.967040538787842, 8.73857307434082, 9.251717567443848, 8.454090118408203, 7.940749168395996, 8.489721298217773, 9.245028495788574, 9.388456344604492, 8.798460006713867, 8.22906494140625, 9.659773826599121, 8.239547729492188, 8.331501960754395, 9.058257102966309, 9.55886173248291, 9.149147033691406, 7.289355278015137, 7.949409484863281, 8.785774230957031, 7.635013580322266, 7.9693284034729, 8.004090309143066, 8.164056777954102, 8.570259094238281, 8.159753799438477, 8.744060516357422, 8.995368957519531, 8.065905570983887, 9.321989059448242, 8.407684326171875, 6.7808027267456055, 9.190790176391602, 9.19961929321289, 8.877094268798828, 8.745610237121582, 8.623037338256836, 7.860097408294678, 9.057251930236816, 10.052074432373047, 8.88847541809082, 7.806110858917236, 7.947388648986816, 8.511086463928223, 8.43917465209961, 8.35843563079834, 8.256060600280762, 8.42286491394043, 9.545265197753906, 8.226813316345215, 7.5457000732421875, 7.653170585632324, 8.115514755249023, 10.274309158325195, 8.793828964233398, 8.115492820739746, 9.028200149536133, 7.7496185302734375, 8.790121078491211, 8.900773048400879, 7.143198013305664, 9.63340950012207, 9.451204299926758], "mean_td_error": 8.657267570495605, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 2400, "num_env_steps_trained": 1280, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 1280, "last_target_update_ts": 2400, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}}, "episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 1280, "num_env_steps_sampled": 2400, "num_env_steps_trained": 1280, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 308.91350459580485, "num_env_steps_trained_throughput_per_sec": 395.40928588263023, "timesteps_total": 2400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4800, "timers": {"training_iteration_time_ms": 456.484, "sample_time_ms": 287.465, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 41.701, "learn_throughput": 6138.944, "synch_weights_time_ms": 13.483}, "counters": {"num_env_steps_sampled": 2400, "num_env_steps_trained": 1280, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 1280, "last_target_update_ts": 2400, "num_target_updates": 5}, "done": false, "episodes_total": 4, "training_iteration": 5, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-19", "timestamp": 1742591179, "time_this_iter_s": 1.3043594360351562, "time_total_s": 6.104199409484863, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFDE960940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 6.104199409484863, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.45, "ram_util_percent": 91.8}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.372806549072266, "actor_loss": -5.440356731414795, "critic_loss": 6.52755069732666, "alpha_loss": -0.024077819660305977, "alpha_value": 0.9982011318206787, "log_alpha_value": -0.001800506142899394, "target_entropy": -8.0, "policy_t": 0.03922279179096222, "mean_q": 0.07918136566877365, "max_q": 0.13876116275787354, "min_q": 0.05130359157919884}, "td_error": [8.680569648742676, 7.775840759277344, 8.480579376220703, 7.792867660522461, 8.701484680175781, 8.872472763061523, 8.772497177124023, 8.292171478271484, 9.205896377563477, 8.770879745483398, 8.635770797729492, 8.617019653320312, 8.758397102355957, 8.916400909423828, 8.875789642333984, 8.31851863861084, 8.065776824951172, 9.973796844482422, 9.29224681854248, 9.218731880187988, 8.515716552734375, 8.470355987548828, 9.764477729797363, 8.115144729614258, 7.867366790771484, 8.106555938720703, 7.355822563171387, 8.921625137329102, 8.48041820526123, 8.250518798828125, 8.540733337402344, 9.019201278686523, 7.565269947052002, 8.118913650512695, 8.886762619018555, 8.557252883911133, 8.325729370117188, 9.348657608032227, 8.749922752380371, 8.74045181274414, 8.135173797607422, 7.93126106262207, 8.924455642700195, 9.609619140625, 8.204623222351074, 9.00329303741455, 8.737335205078125, 8.073379516601562, 7.720643043518066, 8.296493530273438, 7.888091564178467, 8.170455932617188, 9.189184188842773, 9.369684219360352, 8.061366081237793, 9.157052040100098, 8.079458236694336, 8.07806396484375, 8.118289947509766, 7.933350563049316, 7.9683685302734375, 8.509010314941406, 8.357677459716797, 9.446549415588379, 8.18659496307373, 7.497311592102051, 8.238237380981445, 7.708595275878906, 8.99488639831543, 8.761367797851562, 8.5770263671875, 8.305652618408203, 9.22114372253418, 8.174592018127441, 9.315208435058594, 9.340697288513184, 8.432107925415039, 8.920042991638184, 9.028914451599121, 8.606117248535156, 8.745317459106445, 8.797721862792969, 8.97126579284668, 8.352153778076172, 8.275290489196777, 8.843545913696289, 9.197097778320312, 8.376039505004883, 7.755145072937012, 8.599992752075195, 9.754399299621582, 8.36095905303955, 9.398378372192383, 9.407777786254883, 7.851661682128906, 7.891324520111084, 8.796960830688477, 7.906252861022949, 8.876863479614258, 9.073038101196289, 8.807292938232422, 9.413948059082031, 9.028026580810547, 8.365763664245605, 7.936303615570068, 8.68578815460205, 7.962436199188232, 9.196945190429688, 8.919063568115234, 8.367419242858887, 8.718915939331055, 8.2352294921875, 8.490039825439453, 8.21275806427002, 8.291433334350586, 9.566089630126953, 8.830516815185547, 8.205598831176758, 8.77698802947998, 8.003990173339844, 8.784292221069336, 8.682174682617188, 8.468465805053711, 8.260173797607422, 8.352937698364258, 8.452744483947754, 9.152181625366211, 8.824091911315918], "mean_td_error": 8.579788208007812, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.375381469726562, "actor_loss": -5.458073616027832, "critic_loss": 6.608027458190918, "alpha_loss": -0.024078568443655968, "alpha_value": 0.9982014298439026, "log_alpha_value": -0.001800215570256114, "target_entropy": -8.0, "policy_t": -0.001671976875513792, "mean_q": 0.0997527688741684, "max_q": 0.17145292460918427, "min_q": 0.06794773787260056}, "td_error": [7.93148136138916, 7.611880302429199, 9.229890823364258, 9.20805549621582, 8.792811393737793, 8.44389533996582, 8.128767013549805, 8.893533706665039, 8.065845489501953, 8.61652946472168, 8.692731857299805, 8.6356782913208, 8.629744529724121, 7.463038444519043, 9.080145835876465, 9.164979934692383, 7.443870544433594, 9.268473625183105, 8.37326717376709, 8.352812767028809, 9.43028450012207, 8.10290813446045, 8.656362533569336, 8.805940628051758, 8.875728607177734, 9.063079833984375, 8.791191101074219, 8.983613967895508, 7.998661994934082, 9.171957015991211, 9.31973648071289, 8.676362991333008, 8.580682754516602, 8.780349731445312, 8.548534393310547, 7.879809856414795, 8.61751651763916, 8.612092971801758, 9.703786849975586, 8.379440307617188, 9.266580581665039, 9.814718246459961, 7.677096366882324, 8.146675109863281, 8.456647872924805, 8.969626426696777, 9.494502067565918, 9.108981132507324, 8.60269546508789, 8.448354721069336, 9.513896942138672, 9.405519485473633, 8.610100746154785, 8.320453643798828, 7.377012252807617, 8.576519966125488, 8.817207336425781, 8.71712589263916, 9.041116714477539, 9.110631942749023, 9.22637939453125, 8.343914031982422, 7.527553558349609, 9.124283790588379, 8.891069412231445, 8.354561805725098, 8.762731552124023, 8.987079620361328, 8.828742980957031, 8.193868637084961, 8.922576904296875, 8.133549690246582, 7.815902233123779, 9.34172248840332, 8.570954322814941, 8.651138305664062, 8.260359764099121, 7.871598720550537, 8.525636672973633, 8.776164054870605, 9.845226287841797, 8.262392044067383, 7.647195816040039, 8.507392883300781, 9.951871871948242, 8.05140495300293, 9.020587921142578, 9.422967910766602, 8.678494453430176, 8.158951759338379, 8.785526275634766, 8.486709594726562, 8.279816627502441, 8.907960891723633, 8.239496231079102, 8.205881118774414, 9.322025299072266, 9.515891075134277, 8.879866600036621, 9.914070129394531, 8.394922256469727, 7.716526985168457, 8.325241088867188, 8.596757888793945, 8.458210945129395, 8.01437759399414, 9.306010246276855, 9.725831031799316, 8.042692184448242, 8.521444320678711, 8.22102165222168, 8.708754539489746, 8.592775344848633, 8.33121109008789, 8.815885543823242, 9.252283096313477, 8.532833099365234, 9.791326522827148, 9.612306594848633, 8.02279281616211, 7.804863929748535, 9.257614135742188, 8.14279556274414, 8.840085983276367, 8.016988754272461, 8.372222900390625, 8.255460739135742, 8.601997375488281], "mean_td_error": 8.65585708618164, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 2800, "num_env_steps_trained": 1792, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 1792, "last_target_update_ts": 2800, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}}, "episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 1792, "num_env_steps_sampled": 2800, "num_env_steps_trained": 1792, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 319.89066237125985, "num_env_steps_trained_throughput_per_sec": 409.46004783521255, "timesteps_total": 2800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5600, "timers": {"training_iteration_time_ms": 512.336, "sample_time_ms": 311.571, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 40.039, "learn_throughput": 6393.843, "synch_weights_time_ms": 12.677}, "counters": {"num_env_steps_sampled": 2800, "num_env_steps_trained": 1792, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 1792, "last_target_update_ts": 2800, "num_target_updates": 7}, "done": false, "episodes_total": 4, "training_iteration": 6, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-20", "timestamp": 1742591180, "time_this_iter_s": 1.2730309963226318, "time_total_s": 7.377230405807495, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE298FA60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 7.377230405807495, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.35, "ram_util_percent": 91.80000000000001}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.470603942871094, "actor_loss": -5.566180229187012, "critic_loss": 6.23872184753418, "alpha_loss": -0.03234220668673515, "alpha_value": 0.9976019263267517, "log_alpha_value": -0.002400947269052267, "target_entropy": -8.0, "policy_t": -0.0156390517950058, "mean_q": 0.11650390923023224, "max_q": 0.20368699729442596, "min_q": 0.05736255645751953}, "td_error": [8.858304023742676, 7.596138954162598, 7.866748332977295, 8.28481674194336, 8.925248146057129, 7.938708305358887, 7.959379196166992, 8.684015274047852, 7.938515663146973, 8.991615295410156, 8.194562911987305, 8.386661529541016, 8.03016471862793, 7.67075252532959, 8.400465965270996, 8.148500442504883, 8.306190490722656, 8.985340118408203, 8.810959815979004, 7.967284202575684, 8.104114532470703, 8.812891006469727, 9.225030899047852, 8.353155136108398, 8.793397903442383, 8.238866806030273, 7.897388458251953, 8.621562957763672, 9.664470672607422, 8.260019302368164, 9.744589805603027, 8.639603614807129, 7.59394645690918, 9.332084655761719, 8.115097999572754, 8.209203720092773, 8.653326988220215, 7.225458145141602, 8.555658340454102, 8.629667282104492, 8.70158576965332, 8.845041275024414, 8.238462448120117, 8.041156768798828, 8.631439208984375, 7.812191963195801, 7.9981184005737305, 7.684120178222656, 8.71792984008789, 8.359622955322266, 8.2290678024292, 8.735973358154297, 8.382759094238281, 7.744943141937256, 8.21377182006836, 8.754746437072754, 9.272541046142578, 8.342672348022461, 8.885321617126465, 9.256608963012695, 8.29079818725586, 8.180154800415039, 8.307050704956055, 7.870985984802246, 8.589317321777344, 7.8043293952941895, 8.650873184204102, 9.04910659790039, 8.981595993041992, 8.504033088684082, 8.793441772460938, 8.6832275390625, 7.326432228088379, 8.483015060424805, 8.667875289916992, 8.125513076782227, 7.561711311340332, 8.393616676330566, 8.640127182006836, 8.144014358520508, 8.524436950683594, 8.538131713867188, 9.621288299560547, 8.675260543823242, 8.932371139526367, 8.654962539672852, 8.180591583251953, 9.494940757751465, 9.53767204284668, 8.193060874938965, 8.176902770996094, 7.858037948608398, 9.435985565185547, 9.041773796081543, 8.935558319091797, 8.206880569458008, 8.570621490478516, 8.224926948547363, 8.561538696289062, 7.611526012420654, 8.659353256225586, 9.473127365112305, 9.142509460449219, 8.455835342407227, 9.004539489746094, 8.09364128112793, 8.703325271606445, 8.639089584350586, 9.281431198120117, 7.400906562805176, 8.589475631713867, 8.433558464050293, 8.704761505126953, 8.400028228759766, 9.139374732971191, 8.887319564819336, 8.895024299621582, 8.126309394836426, 9.224872589111328, 7.682693958282471, 8.799859046936035, 7.932526111602783, 8.243877410888672, 7.912435531616211, 7.680128574371338, 8.654296875, 8.994060516357422, 9.466177940368652], "mean_td_error": 8.48520565032959, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.505538940429688, "actor_loss": -5.623652935028076, "critic_loss": 6.639482498168945, "alpha_loss": -0.03241827338933945, "alpha_value": 0.9976025223731995, "log_alpha_value": -0.002400368684902787, "target_entropy": -8.0, "policy_t": 0.018015071749687195, "mean_q": 0.14074589312076569, "max_q": 0.22944752871990204, "min_q": 0.0977235808968544}, "td_error": [9.310235023498535, 8.816795349121094, 9.313715934753418, 7.97407865524292, 8.997032165527344, 8.886226654052734, 9.058359146118164, 9.448272705078125, 8.789957046508789, 9.017723083496094, 8.694637298583984, 8.428805351257324, 8.154499053955078, 8.648038864135742, 8.748167037963867, 8.950202941894531, 8.708531379699707, 9.025184631347656, 8.560040473937988, 8.148411750793457, 7.514418601989746, 8.133819580078125, 8.474421501159668, 8.779031753540039, 7.894537925720215, 8.436943054199219, 9.189401626586914, 9.067333221435547, 8.695547103881836, 7.6350250244140625, 8.190689086914062, 8.237905502319336, 9.215730667114258, 8.69723892211914, 7.706755638122559, 8.696924209594727, 8.216889381408691, 9.095582008361816, 9.589346885681152, 8.868951797485352, 8.86086654663086, 9.508773803710938, 7.632200241088867, 8.403242111206055, 8.140241622924805, 8.542861938476562, 9.007457733154297, 9.019853591918945, 8.71194839477539, 8.290498733520508, 8.578954696655273, 9.43636703491211, 9.726070404052734, 9.060957908630371, 8.607009887695312, 8.468501091003418, 9.420808792114258, 7.885043144226074, 9.177103042602539, 8.345026016235352, 9.177961349487305, 8.978546142578125, 9.028785705566406, 9.486562728881836, 8.759710311889648, 7.759017467498779, 8.775915145874023, 9.163494110107422, 11.474851608276367, 8.153825759887695, 8.603822708129883, 9.305015563964844, 7.994606018066406, 9.136770248413086, 9.303794860839844, 8.046001434326172, 8.63711166381836, 9.403523445129395, 9.049905776977539, 8.329784393310547, 7.930407524108887, 8.81442928314209, 8.29789924621582, 8.3383207321167, 8.361170768737793, 8.260427474975586, 9.447235107421875, 7.913570404052734, 8.378746032714844, 7.8616509437561035, 8.12914752960205, 8.769129753112793, 8.431583404541016, 9.211301803588867, 8.166322708129883, 9.043773651123047, 8.436626434326172, 8.410932540893555, 8.655854225158691, 8.362720489501953, 9.04139518737793, 8.938767433166504, 8.547521591186523, 8.635650634765625, 8.467190742492676, 8.073630332946777, 8.377588272094727, 8.162721633911133, 9.547079086303711, 9.012808799743652, 9.357331275939941, 8.763551712036133, 9.006414413452148, 9.252535820007324, 9.201412200927734, 7.737207412719727, 8.195183753967285, 9.551417350769043, 9.443448066711426, 8.464942932128906, 8.664497375488281, 8.938751220703125, 8.799070358276367, 8.744590759277344, 8.301841735839844, 8.50468921661377, 8.357063293457031, 8.506441116333008], "mean_td_error": 8.697064399719238, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 3200, "num_env_steps_trained": 2304, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 2304, "last_target_update_ts": 3200, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}}, "episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 2304, "num_env_steps_sampled": 3200, "num_env_steps_trained": 2304, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 383.0890411959842, "num_env_steps_trained_throughput_per_sec": 490.3539727308597, "timesteps_total": 3200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6400, "timers": {"training_iteration_time_ms": 550.888, "sample_time_ms": 315.156, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 39.473, "learn_throughput": 6485.393, "synch_weights_time_ms": 12.005}, "counters": {"num_env_steps_sampled": 3200, "num_env_steps_trained": 2304, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 2304, "last_target_update_ts": 3200, "num_target_updates": 9}, "done": false, "episodes_total": 4, "training_iteration": 7, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-21", "timestamp": 1742591181, "time_this_iter_s": 1.0582284927368164, "time_total_s": 8.435458898544312, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 8.435458898544312, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 33.55, "ram_util_percent": 92.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.505706787109375, "actor_loss": -5.633030891418457, "critic_loss": 6.433386325836182, "alpha_loss": -0.040540046989917755, "alpha_value": 0.9970027804374695, "log_alpha_value": -0.0030016980599611998, "target_entropy": -8.0, "policy_t": -0.02173984982073307, "mean_q": 0.1514992117881775, "max_q": 0.2739593982696533, "min_q": 0.0969642847776413}, "td_error": [7.912514686584473, 8.8045654296875, 8.699899673461914, 7.98976469039917, 8.721914291381836, 7.703723907470703, 8.155498504638672, 8.653820037841797, 9.007492065429688, 8.564875602722168, 8.113109588623047, 7.967724800109863, 8.281731605529785, 9.339456558227539, 8.053520202636719, 8.518681526184082, 9.079370498657227, 8.920440673828125, 8.322492599487305, 9.019891738891602, 7.93471097946167, 7.932272434234619, 8.3745756149292, 7.881899356842041, 8.968461990356445, 8.106006622314453, 8.47446060180664, 8.253702163696289, 8.897499084472656, 8.602729797363281, 8.401817321777344, 9.059223175048828, 9.278219223022461, 8.309088706970215, 8.370012283325195, 7.193772792816162, 9.358503341674805, 8.769377708435059, 8.913830757141113, 8.683332443237305, 9.012514114379883, 8.430465698242188, 7.118278503417969, 8.52780532836914, 9.457897186279297, 8.086666107177734, 8.943062782287598, 9.345264434814453, 8.434563636779785, 8.637718200683594, 9.000875473022461, 8.264246940612793, 8.993557929992676, 9.051433563232422, 8.397361755371094, 8.82802677154541, 9.201794624328613, 8.429044723510742, 8.243492126464844, 9.185895919799805, 8.404001235961914, 8.242818832397461, 8.36397933959961, 8.355441093444824, 8.875503540039062, 8.310720443725586, 7.983095169067383, 7.834638595581055, 8.117273330688477, 9.277090072631836, 8.362283706665039, 8.779533386230469, 9.213726043701172, 8.755416870117188, 9.089882850646973, 7.9877824783325195, 8.248735427856445, 8.762495040893555, 9.371970176696777, 8.946922302246094, 8.90563678741455, 8.36397933959961, 8.919827461242676, 9.486831665039062, 8.813394546508789, 8.482513427734375, 8.74109172821045, 8.383125305175781, 8.759300231933594, 8.993867874145508, 9.397768020629883, 8.646517753601074, 9.089649200439453, 8.932397842407227, 8.263622283935547, 8.682024002075195, 8.667598724365234, 7.199670791625977, 8.531965255737305, 8.516929626464844, 8.20783805847168, 8.685929298400879, 8.107749938964844, 8.805557250976562, 8.51899242401123, 8.5504732131958, 8.97561264038086, 8.93408203125, 9.132822036743164, 7.385620594024658, 8.721059799194336, 8.506087303161621, 7.954227924346924, 8.386713027954102, 8.083866119384766, 8.619872093200684, 9.334692001342773, 9.208839416503906, 9.688949584960938, 8.398202896118164, 8.141256332397461, 8.067974090576172, 9.398645401000977, 9.475627899169922, 8.989770889282227, 8.228642463684082, 8.72664737701416, 9.36931037902832], "mean_td_error": 8.600391387939453, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.44546127319336, "actor_loss": -5.6063055992126465, "critic_loss": 6.446070194244385, "alpha_loss": -0.04034896194934845, "alpha_value": 0.9970035552978516, "log_alpha_value": -0.0030009353067725897, "target_entropy": -8.0, "policy_t": -0.004588913172483444, "mean_q": 0.18755313754081726, "max_q": 0.3159928619861603, "min_q": 0.12560859322547913}, "td_error": [8.184616088867188, 8.21150016784668, 9.242563247680664, 8.990640640258789, 9.829495429992676, 8.46798324584961, 8.264253616333008, 7.742630958557129, 7.29986047744751, 8.731294631958008, 8.677972793579102, 9.724466323852539, 8.414072036743164, 8.827869415283203, 8.028482437133789, 8.318693161010742, 8.619377136230469, 8.999451637268066, 8.191991806030273, 8.481748580932617, 8.299383163452148, 8.650678634643555, 9.124032974243164, 8.862370491027832, 7.139972686767578, 9.002950668334961, 9.112606048583984, 8.5972900390625, 8.532695770263672, 8.691205978393555, 9.350482940673828, 8.0609130859375, 8.906465530395508, 8.33364486694336, 8.323826789855957, 8.999756813049316, 8.837864875793457, 8.929024696350098, 8.717862129211426, 8.141899108886719, 8.613228797912598, 8.489177703857422, 8.471925735473633, 8.574758529663086, 8.156097412109375, 7.940689563751221, 7.498734474182129, 8.220014572143555, 8.30224895477295, 7.8304338455200195, 8.020116806030273, 8.243636131286621, 8.196113586425781, 9.27365779876709, 7.862549304962158, 9.003788948059082, 9.035901069641113, 9.072369575500488, 8.252300262451172, 8.394357681274414, 8.260183334350586, 8.868730545043945, 8.95307445526123, 9.18323040008545, 8.901481628417969, 7.831697463989258, 9.673676490783691, 8.527983665466309, 8.116130828857422, 8.646167755126953, 9.455238342285156, 8.952432632446289, 7.419362545013428, 8.213627815246582, 9.138421058654785, 8.676671981811523, 8.385480880737305, 8.776342391967773, 8.745563507080078, 8.053146362304688, 7.921293258666992, 9.208303451538086, 8.684003829956055, 8.895580291748047, 8.828973770141602, 8.885851860046387, 9.111282348632812, 8.927129745483398, 8.747057914733887, 8.637990951538086, 8.44371223449707, 8.87552261352539, 8.536479949951172, 9.360151290893555, 8.459851264953613, 8.401372909545898, 8.718143463134766, 8.915727615356445, 8.119991302490234, 9.292616844177246, 8.35141372680664, 8.643447875976562, 10.229682922363281, 8.002555847167969, 8.920724868774414, 9.178936958312988, 8.503357887268066, 8.728804588317871, 8.918668746948242, 8.732292175292969, 8.046874046325684, 7.922137260437012, 9.574617385864258, 8.114148139953613, 8.738077163696289, 8.87161636352539, 8.51048469543457, 8.690206527709961, 8.77496337890625, 8.351272583007812, 8.915193557739258, 8.311639785766602, 7.9639434814453125, 8.634765625, 8.831737518310547, 8.272308349609375, 8.144153594970703, 8.612053871154785], "mean_td_error": 8.598091125488281, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 3600, "num_env_steps_trained": 2816, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 2816, "last_target_update_ts": 3600, "num_target_updates": 11}, "sampler_results": {"episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1907.334348279564, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2011.1232764458748, "('robot_1', 'robot_1')_total_reward_mean": 1909.8218108432861, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1972.7749226086364}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}}, "episode_reward_max": 3983.8981990545126, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3817.156159122852, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2011.1232764458748, "robot_1": 1972.7749226086364}, "policy_reward_mean": {"robot_0": 1907.334348279564, "robot_1": 1909.8218108432861}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235953287212197, "mean_inference_ms": 3.4282308614658503, "mean_action_processing_ms": 0.45688042859593314, "mean_env_wait_ms": 0.4571322909372295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.11319518089294434}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 2816, "num_env_steps_sampled": 3600, "num_env_steps_trained": 2816, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 377.8888007202251, "num_env_steps_trained_throughput_per_sec": 483.69766492188813, "timesteps_total": 3600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7200, "timers": {"training_iteration_time_ms": 568.409, "sample_time_ms": 316.568, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 36.639, "learn_throughput": 6987.086, "synch_weights_time_ms": 11.925}, "counters": {"num_env_steps_sampled": 3600, "num_env_steps_trained": 2816, "num_agent_steps_sampled": 7200, "num_agent_steps_trained": 2816, "last_target_update_ts": 3600, "num_target_updates": 11}, "done": false, "episodes_total": 4, "training_iteration": 8, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-22", "timestamp": 1742591182, "time_this_iter_s": 1.0672457218170166, "time_total_s": 9.502704620361328, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 9.502704620361328, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.0, "ram_util_percent": 92.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.462302207946777, "actor_loss": -5.633061408996582, "critic_loss": 6.7246575355529785, "alpha_loss": -0.04849905148148537, "alpha_value": 0.9964038729667664, "log_alpha_value": -0.003602582262828946, "target_entropy": -8.0, "policy_t": 0.0036369548179209232, "mean_q": 0.19916605949401855, "max_q": 0.3621786832809448, "min_q": 0.12090366333723068}, "td_error": [8.600711822509766, 8.12002182006836, 9.15488338470459, 7.491690158843994, 9.026896476745605, 7.816552639007568, 7.903665065765381, 9.080062866210938, 8.445788383483887, 8.419841766357422, 8.515974044799805, 8.218945503234863, 7.974242210388184, 8.392619132995605, 8.29558277130127, 8.306486129760742, 8.593713760375977, 8.805063247680664, 8.627439498901367, 9.008401870727539, 9.004508972167969, 8.015693664550781, 8.464204788208008, 8.98782730102539, 8.460315704345703, 9.021135330200195, 9.323650360107422, 8.276988983154297, 8.615699768066406, 7.960730075836182, 9.800167083740234, 7.929864883422852, 8.600851058959961, 8.918149948120117, 8.6005220413208, 8.42546558380127, 8.578679084777832, 9.921281814575195, 7.950781345367432, 8.84597396850586, 8.038978576660156, 7.4861602783203125, 8.20933723449707, 8.549285888671875, 8.456742286682129, 9.256908416748047, 7.149919509887695, 8.95806884765625, 8.428035736083984, 7.7570953369140625, 8.878374099731445, 8.051017761230469, 8.134671211242676, 8.700605392456055, 8.671980857849121, 7.799069404602051, 8.420730590820312, 8.923007011413574, 8.696098327636719, 8.625008583068848, 9.094552040100098, 8.275384902954102, 8.266828536987305, 9.080062866210938, 9.261911392211914, 8.355609893798828, 8.322341918945312, 9.636262893676758, 8.484696388244629, 8.876527786254883, 8.646806716918945, 8.444742202758789, 8.484882354736328, 8.79592514038086, 9.057450294494629, 8.518407821655273, 8.881397247314453, 7.90465784072876, 8.421751022338867, 9.217260360717773, 7.172201156616211, 8.523574829101562, 8.208949089050293, 8.072626113891602, 9.070844650268555, 8.535918235778809, 7.864358425140381, 8.872489929199219, 8.909224510192871, 7.951504707336426, 8.729986190795898, 7.750600814819336, 8.952693939208984, 7.93924617767334, 7.978116989135742, 8.240116119384766, 8.389076232910156, 8.807823181152344, 8.442522048950195, 8.609722137451172, 8.112428665161133, 8.026694297790527, 9.054426193237305, 9.434450149536133, 8.791826248168945, 8.664722442626953, 8.365619659423828, 8.778596878051758, 9.047051429748535, 8.20387077331543, 8.274282455444336, 8.810978889465332, 8.48769760131836, 9.377269744873047, 8.114371299743652, 7.717430591583252, 9.327423095703125, 8.323034286499023, 8.350805282592773, 7.861688613891602, 7.5300798416137695, 8.571992874145508, 9.373027801513672, 8.577306747436523, 8.819805145263672, 8.820685386657715, 8.065179824829102, 8.537742614746094], "mean_td_error": 8.516887664794922, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.440438270568848, "actor_loss": -5.6553120613098145, "critic_loss": 6.289794921875, "alpha_loss": -0.04840702563524246, "alpha_value": 0.9964048862457275, "log_alpha_value": -0.0036015957593917847, "target_entropy": -8.0, "policy_t": 0.0032110889442265034, "mean_q": 0.250507652759552, "max_q": 0.40613022446632385, "min_q": 0.162572979927063}, "td_error": [8.589363098144531, 8.470378875732422, 8.69117546081543, 7.465618133544922, 8.851156234741211, 9.04517936706543, 8.296028137207031, 8.252876281738281, 8.313360214233398, 7.792750835418701, 8.696839332580566, 8.121835708618164, 9.452329635620117, 8.555919647216797, 8.49280071258545, 8.065473556518555, 9.599737167358398, 9.16443157196045, 8.393011093139648, 8.34631633758545, 8.053218841552734, 8.556806564331055, 8.447351455688477, 9.236417770385742, 8.737349510192871, 8.199274063110352, 8.397706985473633, 8.449681282043457, 8.639467239379883, 8.50667953491211, 8.261116981506348, 8.676177978515625, 7.816380500793457, 8.625661849975586, 8.69658374786377, 7.862844467163086, 8.49718189239502, 8.435443878173828, 9.107701301574707, 9.23871898651123, 7.842896461486816, 8.367328643798828, 8.480494499206543, 8.471074104309082, 8.186705589294434, 8.806806564331055, 8.75372314453125, 8.40192985534668, 8.672688484191895, 8.523050308227539, 8.137971878051758, 8.01144027709961, 8.863428115844727, 8.133434295654297, 8.075607299804688, 7.255524635314941, 8.338495254516602, 8.36114501953125, 7.965071201324463, 9.072713851928711, 8.870246887207031, 8.814754486083984, 8.754667282104492, 7.948381423950195, 8.613801002502441, 8.460016250610352, 8.868106842041016, 9.290260314941406, 8.679414749145508, 8.380934715270996, 8.851481437683105, 8.947466850280762, 8.281351089477539, 8.761979103088379, 9.28812026977539, 8.439793586730957, 8.259761810302734, 8.683313369750977, 8.23526668548584, 8.583087921142578, 8.197996139526367, 9.215709686279297, 8.640687942504883, 8.414606094360352, 8.836833953857422, 8.014497756958008, 8.43421459197998, 8.201766967773438, 8.533344268798828, 7.726261615753174, 8.591612815856934, 8.156225204467773, 8.0132474899292, 9.136858940124512, 9.390199661254883, 8.074359893798828, 7.926700592041016, 7.036600589752197, 8.945211410522461, 9.349223136901855, 8.444475173950195, 8.746536254882812, 8.487504959106445, 8.42507266998291, 8.156964302062988, 9.749188423156738, 8.639886856079102, 9.045104026794434, 7.780439376831055, 9.441753387451172, 8.56068229675293, 7.817059516906738, 7.867605209350586, 9.283367156982422, 7.736083030700684, 9.920581817626953, 9.789207458496094, 8.16329574584961, 9.099469184875488, 8.840288162231445, 8.785386085510254, 8.366199493408203, 9.191699028015137, 8.080242156982422, 9.324904441833496, 8.726011276245117, 8.77514362335205, 7.997631549835205], "mean_td_error": 8.538359642028809, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 3328, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 3328, "last_target_update_ts": 4000, "num_target_updates": 13}, "sampler_results": {"episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}}, "episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 3328, "num_env_steps_sampled": 4000, "num_env_steps_trained": 3328, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 383.97290230296096, "num_env_steps_trained_throughput_per_sec": 491.48531494779, "timesteps_total": 4000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 568.124, "sample_time_ms": 316.215, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 36.395, "learn_throughput": 7033.947, "synch_weights_time_ms": 12.533}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 3328, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 3328, "last_target_update_ts": 4000, "num_target_updates": 13}, "done": false, "episodes_total": 8, "training_iteration": 9, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-23", "timestamp": 1742591183, "time_this_iter_s": 1.0581269264221191, "time_total_s": 10.560831546783447, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE298FA60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 10.560831546783447, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.7, "ram_util_percent": 92.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.457921981811523, "actor_loss": -5.688615798950195, "critic_loss": 6.367848873138428, "alpha_loss": -0.05656982213258743, "alpha_value": 0.9958053827285767, "log_alpha_value": -0.004203458782285452, "target_entropy": -8.0, "policy_t": -0.009201097302138805, "mean_q": 0.2685265839099884, "max_q": 0.4745624363422394, "min_q": 0.1571992188692093}, "td_error": [8.309854507446289, 8.971861839294434, 9.549442291259766, 9.093941688537598, 8.091012954711914, 8.781988143920898, 8.965415954589844, 8.889521598815918, 9.115274429321289, 8.651395797729492, 8.249092102050781, 8.486745834350586, 8.749073028564453, 8.683382034301758, 8.467094421386719, 9.222911834716797, 8.711111068725586, 8.583513259887695, 7.944167613983154, 9.085744857788086, 8.22848892211914, 8.01813793182373, 8.590974807739258, 9.217180252075195, 9.227664947509766, 8.65785026550293, 8.167301177978516, 8.33881950378418, 7.64298152923584, 8.481085777282715, 9.030169486999512, 8.019725799560547, 8.574874877929688, 7.858245372772217, 8.378990173339844, 8.51348876953125, 8.261011123657227, 8.118688583374023, 7.949517250061035, 8.755910873413086, 8.76999568939209, 8.038545608520508, 7.942867279052734, 9.303779602050781, 8.54629898071289, 8.004816055297852, 8.169149398803711, 8.41293716430664, 8.455196380615234, 8.554292678833008, 7.756258964538574, 7.712410926818848, 8.157915115356445, 9.010904312133789, 7.999176979064941, 7.582364082336426, 8.423215866088867, 8.735214233398438, 8.509729385375977, 7.73585319519043, 8.457573890686035, 8.782354354858398, 8.445891380310059, 8.594364166259766, 8.3896484375, 8.806697845458984, 7.345461845397949, 8.179378509521484, 8.895990371704102, 8.875350952148438, 8.816030502319336, 8.429821014404297, 8.500604629516602, 7.65911865234375, 9.226858139038086, 8.656835556030273, 8.763406753540039, 8.531599044799805, 8.48392105102539, 7.902184963226318, 8.33698558807373, 9.362272262573242, 8.785571098327637, 8.67298698425293, 8.67233657836914, 7.969635963439941, 8.503938674926758, 8.114973068237305, 9.500935554504395, 8.083616256713867, 8.881003379821777, 8.19906234741211, 8.511026382446289, 8.680522918701172, 8.390384674072266, 8.548067092895508, 8.372418403625488, 7.234408378601074, 7.819939136505127, 9.510087013244629, 8.648721694946289, 8.037979125976562, 8.880860328674316, 7.531700134277344, 8.088573455810547, 8.862497329711914, 8.881318092346191, 8.575111389160156, 8.016624450683594, 8.52238655090332, 8.367940902709961, 8.992252349853516, 9.256082534790039, 9.074592590332031, 8.995136260986328, 8.390425682067871, 8.771442413330078, 8.126176834106445, 8.789426803588867, 8.190069198608398, 8.602899551391602, 8.652824401855469, 8.560598373413086, 9.078086853027344, 8.521198272705078, 8.675371170043945, 8.85072135925293, 9.187389373779297], "mean_td_error": 8.511533737182617, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.446318626403809, "actor_loss": -5.72168493270874, "critic_loss": 6.132460117340088, "alpha_loss": -0.05650379881262779, "alpha_value": 0.9958066344261169, "log_alpha_value": -0.004202175885438919, "target_entropy": -8.0, "policy_t": -0.0023842421360313892, "mean_q": 0.3192577660083771, "max_q": 0.5377500057220459, "min_q": 0.1819877326488495}, "td_error": [8.44428825378418, 8.463711738586426, 8.473546981811523, 8.239934921264648, 8.566144943237305, 8.636629104614258, 8.465871810913086, 8.361812591552734, 8.023438453674316, 8.015626907348633, 9.125677108764648, 8.30392074584961, 8.111706733703613, 7.781404495239258, 9.228171348571777, 8.482306480407715, 7.806521892547607, 8.49737548828125, 9.19125747680664, 8.751644134521484, 8.412534713745117, 8.328815460205078, 8.830158233642578, 9.277337074279785, 8.518844604492188, 8.06943130493164, 8.650323867797852, 7.361561298370361, 8.479937553405762, 8.19900894165039, 8.694266319274902, 8.003217697143555, 9.239401817321777, 8.315339088439941, 8.834386825561523, 8.073322296142578, 8.270236015319824, 8.009269714355469, 8.65291976928711, 8.442845344543457, 7.640063285827637, 7.9415178298950195, 8.01601505279541, 9.188949584960938, 9.028499603271484, 8.103883743286133, 8.303707122802734, 8.341163635253906, 8.035280227661133, 7.943150520324707, 8.584779739379883, 9.327677726745605, 8.554258346557617, 8.585735321044922, 8.379173278808594, 8.085641860961914, 8.641386032104492, 8.139516830444336, 8.84560775756836, 8.702524185180664, 9.083224296569824, 7.4812517166137695, 8.139525413513184, 8.272372245788574, 8.867496490478516, 7.911128044128418, 8.876666069030762, 8.68322467803955, 8.258939743041992, 8.445518493652344, 9.314374923706055, 8.368982315063477, 8.546173095703125, 7.656749725341797, 8.415103912353516, 8.390823364257812, 8.801631927490234, 9.060712814331055, 8.60657024383545, 9.143177032470703, 8.882740020751953, 8.67257308959961, 8.50362777709961, 8.400229454040527, 8.27589225769043, 8.77324390411377, 8.303183555603027, 8.213611602783203, 8.410041809082031, 9.071035385131836, 8.53713607788086, 8.771892547607422, 7.907784461975098, 8.859840393066406, 8.505559921264648, 8.988557815551758, 7.340987205505371, 7.5542168617248535, 7.992527008056641, 8.446627616882324, 8.508150100708008, 7.474520683288574, 8.791614532470703, 8.584207534790039, 8.118935585021973, 8.743053436279297, 8.409822463989258, 8.278447151184082, 7.629010200500488, 7.623627662658691, 7.850510597229004, 8.672056198120117, 7.888269424438477, 8.616470336914062, 8.762792587280273, 8.405488967895508, 8.479686737060547, 8.260692596435547, 8.726167678833008, 8.611427307128906, 8.357671737670898, 9.623526573181152, 8.241809844970703, 8.885157585144043, 8.298116683959961, 8.762517929077148, 8.338146209716797, 10.125150680541992], "mean_td_error": 8.45175552368164, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 4400, "num_env_steps_trained": 3840, "num_agent_steps_sampled": 8800, "num_agent_steps_trained": 3840, "last_target_update_ts": 4400, "num_target_updates": 15}, "sampler_results": {"episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}}, "episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8800, "num_agent_steps_trained": 3840, "num_env_steps_sampled": 4400, "num_env_steps_trained": 3840, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 383.9814266796482, "num_env_steps_trained_throughput_per_sec": 491.49622614994973, "timesteps_total": 4400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8800, "timers": {"training_iteration_time_ms": 542.81, "sample_time_ms": 311.406, "load_time_ms": 0.831, "load_throughput": 307900.618, "learn_time_ms": 37.37, "learn_throughput": 6850.434, "synch_weights_time_ms": 10.625}, "counters": {"num_env_steps_sampled": 4400, "num_env_steps_trained": 3840, "num_agent_steps_sampled": 8800, "num_agent_steps_trained": 3840, "last_target_update_ts": 4400, "num_target_updates": 15}, "done": false, "episodes_total": 8, "training_iteration": 10, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-24", "timestamp": 1742591184, "time_this_iter_s": 1.0584497451782227, "time_total_s": 11.61928129196167, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AD7670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 11.61928129196167, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.0, "ram_util_percent": 92.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.472003936767578, "actor_loss": -5.771847248077393, "critic_loss": 6.348886013031006, "alpha_loss": -0.06472361832857132, "alpha_value": 0.9952071905136108, "log_alpha_value": -0.004804304800927639, "target_entropy": -8.0, "policy_t": -0.00548802874982357, "mean_q": 0.3413550853729248, "max_q": 0.6149358749389648, "min_q": 0.1978612095117569}, "td_error": [8.381474494934082, 7.774965286254883, 8.27824592590332, 8.687647819519043, 8.086345672607422, 8.752267837524414, 9.154901504516602, 8.763830184936523, 9.226922988891602, 9.782459259033203, 8.45057487487793, 8.031393051147461, 8.274163246154785, 9.09377670288086, 8.234930038452148, 7.878030300140381, 7.791941165924072, 9.223901748657227, 9.072751998901367, 8.3590087890625, 8.239114761352539, 8.541004180908203, 9.04074478149414, 8.46211051940918, 7.857141971588135, 8.706366539001465, 8.796056747436523, 8.63067626953125, 7.643078804016113, 8.57152271270752, 8.717243194580078, 8.913211822509766, 8.472404479980469, 7.5683135986328125, 8.431243896484375, 8.337693214416504, 8.376222610473633, 8.398000717163086, 8.173578262329102, 8.382915496826172, 8.260366439819336, 7.963578224182129, 8.678285598754883, 8.24775218963623, 8.357072830200195, 7.533719062805176, 8.77773380279541, 8.1846923828125, 8.57127571105957, 7.286421775817871, 8.850602149963379, 8.76948356628418, 8.642385482788086, 7.473447799682617, 8.208641052246094, 9.062925338745117, 8.476205825805664, 8.659820556640625, 8.317620277404785, 8.642162322998047, 7.478860378265381, 7.777682304382324, 8.522676467895508, 8.74325942993164, 7.931425094604492, 8.989912033081055, 9.228403091430664, 7.947296619415283, 8.77685546875, 8.240243911743164, 7.924905776977539, 8.233741760253906, 8.736133575439453, 9.093944549560547, 8.891090393066406, 7.913552761077881, 8.8738374710083, 7.894462585449219, 8.269369125366211, 8.648639678955078, 8.460502624511719, 8.861839294433594, 8.733723640441895, 8.513320922851562, 9.33370590209961, 9.083817481994629, 8.735912322998047, 7.20667839050293, 8.163091659545898, 8.279528617858887, 8.069755554199219, 8.447725296020508, 7.344305992126465, 8.893354415893555, 8.055608749389648, 8.306951522827148, 8.740242958068848, 8.204413414001465, 8.950407028198242, 9.117416381835938, 8.943455696105957, 8.400952339172363, 7.850664138793945, 8.252470016479492, 8.537957191467285, 8.156280517578125, 7.920829772949219, 7.892630100250244, 9.222210884094238, 9.115974426269531, 8.407966613769531, 8.148970603942871, 8.606760025024414, 7.703061103820801, 7.742215633392334, 9.33728313446045, 8.33377742767334, 8.099142074584961, 8.737614631652832, 8.191100120544434, 8.417386054992676, 8.596308708190918, 8.068464279174805, 7.801967620849609, 8.9835205078125, 9.152937889099121, 8.56679916381836, 8.253517150878906], "mean_td_error": 8.434243202209473, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.429134368896484, "actor_loss": -5.77633810043335, "critic_loss": 6.30627965927124, "alpha_loss": -0.06449657678604126, "alpha_value": 0.9952087998390198, "log_alpha_value": -0.004802735056728125, "target_entropy": -8.0, "policy_t": -0.01149058062583208, "mean_q": 0.40459293127059937, "max_q": 0.6946291923522949, "min_q": 0.2517024874687195}, "td_error": [7.710877418518066, 8.011968612670898, 8.494711875915527, 8.164836883544922, 8.228612899780273, 8.049386978149414, 8.075052261352539, 9.113180160522461, 8.671310424804688, 7.477712631225586, 8.580720901489258, 7.851595401763916, 8.966480255126953, 8.210545539855957, 7.739874362945557, 8.439516067504883, 8.14493179321289, 8.065040588378906, 8.215784072875977, 9.152383804321289, 8.685135841369629, 8.966236114501953, 8.300851821899414, 8.54256820678711, 8.888914108276367, 8.81561279296875, 8.714097023010254, 7.786476135253906, 8.857187271118164, 11.079622268676758, 8.283041000366211, 8.400035858154297, 8.314680099487305, 8.091780662536621, 8.060160636901855, 8.446005821228027, 8.329450607299805, 8.58941650390625, 8.26577377319336, 8.32000732421875, 8.091989517211914, 8.122791290283203, 7.988508224487305, 7.760907173156738, 7.896434307098389, 8.869585037231445, 8.069524765014648, 7.926535606384277, 8.587989807128906, 7.950901985168457, 8.10947322845459, 7.802864074707031, 8.8550443649292, 7.500277042388916, 8.197103500366211, 8.584165573120117, 8.879007339477539, 8.158639907836914, 8.134683609008789, 7.824556350708008, 8.63808822631836, 8.150320053100586, 7.59586238861084, 9.097890853881836, 7.918083190917969, 7.813294410705566, 8.191065788269043, 8.500286102294922, 7.72247314453125, 8.234235763549805, 9.678388595581055, 8.06028938293457, 8.483915328979492, 8.644455909729004, 8.334611892700195, 8.70290756225586, 8.42321491241455, 8.219078063964844, 8.626774787902832, 8.558637619018555, 8.306421279907227, 8.093972206115723, 7.895341396331787, 8.037435531616211, 8.447534561157227, 8.564275741577148, 8.134202003479004, 8.833534240722656, 8.248222351074219, 7.987125396728516, 8.73000717163086, 8.015522003173828, 7.28978157043457, 8.239519119262695, 8.514535903930664, 8.57708740234375, 8.236562728881836, 8.742140769958496, 8.27990436553955, 7.783695697784424, 8.051905632019043, 8.033774375915527, 8.31539535522461, 8.806060791015625, 7.903785705566406, 8.520906448364258, 8.742015838623047, 9.191471099853516, 9.473386764526367, 8.017990112304688, 8.6555814743042, 8.515262603759766, 8.212629318237305, 8.718936920166016, 9.002925872802734, 8.089080810546875, 8.337238311767578, 8.465919494628906, 9.130191802978516, 8.862953186035156, 8.206007957458496, 9.046913146972656, 7.907774925231934, 8.026168823242188, 7.933411598205566, 8.714105606079102, 8.0117769241333, 7.890324592590332], "mean_td_error": 8.357398986816406, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4352, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 4352, "last_target_update_ts": 4800, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}}, "episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 4352, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4352, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 379.51594864871714, "num_env_steps_trained_throughput_per_sec": 485.78041427035794, "timesteps_total": 4800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9600, "timers": {"training_iteration_time_ms": 523.164, "sample_time_ms": 288.951, "load_time_ms": 0.831, "load_throughput": 307900.618, "learn_time_ms": 38.334, "learn_throughput": 6678.176, "synch_weights_time_ms": 10.534}, "counters": {"num_env_steps_sampled": 4800, "num_env_steps_trained": 4352, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 4352, "last_target_update_ts": 4800, "num_target_updates": 17}, "done": false, "episodes_total": 8, "training_iteration": 11, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-26", "timestamp": 1742591186, "time_this_iter_s": 1.06657075881958, "time_total_s": 12.68585205078125, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 12.68585205078125, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 33.45, "ram_util_percent": 92.05}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.399227142333984, "actor_loss": -5.769016265869141, "critic_loss": 6.196663856506348, "alpha_loss": -0.07242493331432343, "alpha_value": 0.9946094155311584, "log_alpha_value": -0.0054051573388278484, "target_entropy": -8.0, "policy_t": -0.02271505817770958, "mean_q": 0.41505828499794006, "max_q": 0.7461011409759521, "min_q": 0.2607596814632416}, "td_error": [8.667831420898438, 8.396656036376953, 8.394942283630371, 8.571561813354492, 7.85792350769043, 8.740120887756348, 9.390369415283203, 8.247612953186035, 8.674673080444336, 8.13869857788086, 7.912013053894043, 8.311420440673828, 8.017538070678711, 8.96488094329834, 7.5344367027282715, 8.67476749420166, 8.843143463134766, 7.822831153869629, 7.990021705627441, 8.623598098754883, 7.829289436340332, 8.429906845092773, 8.650628089904785, 8.08302116394043, 8.575901985168457, 8.782176971435547, 8.109199523925781, 11.631460189819336, 7.705216407775879, 8.747157096862793, 7.526715278625488, 8.324726104736328, 8.09617805480957, 8.966772079467773, 8.567283630371094, 8.86117172241211, 9.23458480834961, 8.325053215026855, 7.529145240783691, 8.695119857788086, 7.963213920593262, 8.082344055175781, 8.857186317443848, 7.973219871520996, 8.872041702270508, 8.498425483703613, 7.90412712097168, 8.467934608459473, 7.750236511230469, 7.986318588256836, 8.667985916137695, 8.078962326049805, 7.866057395935059, 8.408258438110352, 8.06956958770752, 8.047199249267578, 8.410712242126465, 8.037599563598633, 7.9315385818481445, 8.765691757202148, 8.175301551818848, 7.975399494171143, 8.504304885864258, 8.58566951751709, 10.261567115783691, 7.775355339050293, 7.7581658363342285, 7.097121238708496, 8.176871299743652, 7.844295024871826, 8.118148803710938, 9.519454956054688, 8.068047523498535, 8.196937561035156, 7.642585754394531, 8.417350769042969, 8.277751922607422, 8.517984390258789, 7.8518877029418945, 8.75477409362793, 8.260890007019043, 8.353160858154297, 8.722068786621094, 8.859886169433594, 8.872296333312988, 8.41849136352539, 8.716962814331055, 8.742048263549805, 8.355608940124512, 8.51138687133789, 8.265743255615234, 8.528928756713867, 7.953225135803223, 8.728269577026367, 8.15125846862793, 8.205031394958496, 8.600502014160156, 8.131647109985352, 8.15992259979248, 9.074531555175781, 8.014241218566895, 9.039506912231445, 9.380342483520508, 8.012805938720703, 8.694772720336914, 7.9883575439453125, 8.460922241210938, 8.426338195800781, 7.806801795959473, 8.585838317871094, 7.909919261932373, 8.179960250854492, 8.474655151367188, 7.626543998718262, 9.03546142578125, 8.544891357421875, 8.132458686828613, 7.895488262176514, 8.053352355957031, 8.288026809692383, 8.578332901000977, 8.197112083435059, 8.625975608825684, 7.311933517456055, 7.635433197021484, 8.033994674682617, 8.709060668945312, 9.772470474243164], "mean_td_error": 8.372110366821289, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.49470043182373, "actor_loss": -5.952218532562256, "critic_loss": 6.080051422119141, "alpha_loss": -0.07291620224714279, "alpha_value": 0.9946112632751465, "log_alpha_value": -0.005403321702033281, "target_entropy": -8.0, "policy_t": 0.034576404839754105, "mean_q": 0.5161119699478149, "max_q": 0.8407877683639526, "min_q": 0.32948949933052063}, "td_error": [8.216131210327148, 8.69312858581543, 8.360980987548828, 8.153783798217773, 7.646035671234131, 7.972848892211914, 7.949750900268555, 7.70891809463501, 8.405342102050781, 8.449681282043457, 7.977417945861816, 7.909646034240723, 8.563374519348145, 8.167684555053711, 8.51862621307373, 7.707898139953613, 8.436906814575195, 8.602950096130371, 8.631213188171387, 7.807824611663818, 8.443904876708984, 7.7670440673828125, 8.801970481872559, 8.024303436279297, 7.9882588386535645, 7.932101249694824, 7.939915657043457, 8.005796432495117, 8.100555419921875, 9.02165699005127, 8.159244537353516, 8.306790351867676, 8.189972877502441, 8.450761795043945, 8.137733459472656, 8.065389633178711, 8.369413375854492, 8.296165466308594, 8.097976684570312, 8.06328010559082, 7.834531784057617, 7.512661933898926, 8.158802032470703, 7.722395896911621, 8.162759780883789, 7.93614387512207, 8.757530212402344, 8.107933044433594, 8.32522964477539, 8.384930610656738, 8.19601058959961, 8.331155776977539, 7.697778701782227, 8.569721221923828, 8.038615226745605, 8.654104232788086, 7.564695358276367, 7.5117998123168945, 8.798818588256836, 8.616083145141602, 8.137357711791992, 8.334516525268555, 8.055538177490234, 8.019513130187988, 7.926146507263184, 9.037203788757324, 8.096918106079102, 8.008710861206055, 8.881124496459961, 8.45212459564209, 8.333736419677734, 8.973352432250977, 8.037841796875, 8.674064636230469, 8.786994934082031, 8.443474769592285, 8.68797492980957, 8.719376564025879, 8.174251556396484, 8.415634155273438, 8.306534767150879, 8.368961334228516, 8.35719108581543, 8.062931060791016, 6.942657470703125, 8.336690902709961, 6.886576175689697, 8.053434371948242, 8.261102676391602, 8.76470947265625, 8.396638870239258, 8.176790237426758, 7.743762016296387, 8.392690658569336, 7.9759016036987305, 8.165820121765137, 8.25325870513916, 8.165426254272461, 9.592170715332031, 7.950235843658447, 8.852703094482422, 8.603960037231445, 8.548869132995605, 8.25057601928711, 8.499639511108398, 7.979331016540527, 8.59178352355957, 8.067123413085938, 8.406209945678711, 8.736616134643555, 8.371596336364746, 8.363761901855469, 8.763689041137695, 8.257823944091797, 8.126728057861328, 8.920276641845703, 9.207111358642578, 7.996664047241211, 9.468473434448242, 7.998290538787842, 7.570155620574951, 8.3725004196167, 7.962917327880859, 7.449193954467773, 8.283266067504883, 8.523811340332031, 9.364113807678223, 8.503850936889648], "mean_td_error": 8.268081665039062, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 5200, "num_env_steps_trained": 4864, "num_agent_steps_sampled": 10400, "num_agent_steps_trained": 4864, "last_target_update_ts": 5200, "num_target_updates": 19}, "sampler_results": {"episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}}, "episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10400, "num_agent_steps_trained": 4864, "num_env_steps_sampled": 5200, "num_env_steps_trained": 4864, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 390.2472247259617, "num_env_steps_trained_throughput_per_sec": 499.51644764923094, "timesteps_total": 5200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10400, "timers": {"training_iteration_time_ms": 521.249, "sample_time_ms": 286.196, "load_time_ms": 0.831, "load_throughput": 307900.618, "learn_time_ms": 39.193, "learn_throughput": 6531.837, "synch_weights_time_ms": 10.252}, "counters": {"num_env_steps_sampled": 5200, "num_env_steps_trained": 4864, "num_agent_steps_sampled": 10400, "num_agent_steps_trained": 4864, "last_target_update_ts": 5200, "num_target_updates": 19}, "done": false, "episodes_total": 8, "training_iteration": 12, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-27", "timestamp": 1742591187, "time_this_iter_s": 1.0478909015655518, "time_total_s": 13.733742952346802, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A25B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 13.733742952346802, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.799999999999997, "ram_util_percent": 92.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.48565673828125, "actor_loss": -5.975151538848877, "critic_loss": 6.001628875732422, "alpha_loss": -0.08504442870616913, "alpha_value": 0.9937135577201843, "log_alpha_value": -0.006306287366896868, "target_entropy": -8.0, "policy_t": -0.021945513784885406, "mean_q": 0.5545359253883362, "max_q": 1.0375642776489258, "min_q": 0.3549899160861969}, "td_error": [7.857370853424072, 9.2059907913208, 7.993216514587402, 8.234127044677734, 8.24793529510498, 8.648834228515625, 8.157920837402344, 7.729437828063965, 8.039628982543945, 8.280372619628906, 7.868269443511963, 8.418730735778809, 8.06682300567627, 7.966607093811035, 8.424398422241211, 8.05952262878418, 7.374745845794678, 7.94300651550293, 7.929111480712891, 7.916698455810547, 7.742961883544922, 7.582066535949707, 7.862642288208008, 7.701379776000977, 8.435647964477539, 9.056692123413086, 7.306753635406494, 7.875054359436035, 8.066808700561523, 7.488582611083984, 8.173561096191406, 8.432222366333008, 8.502599716186523, 8.541438102722168, 7.759721755981445, 8.557268142700195, 7.720199108123779, 7.3291778564453125, 8.174062728881836, 7.224388122558594, 8.235597610473633, 9.209663391113281, 8.185478210449219, 7.977928161621094, 8.369384765625, 7.858306884765625, 8.393316268920898, 7.634946823120117, 8.167370796203613, 8.324369430541992, 7.902056694030762, 7.903670310974121, 8.606118202209473, 8.686270713806152, 8.740456581115723, 8.814059257507324, 8.32906436920166, 8.506702423095703, 7.8798370361328125, 7.866095542907715, 8.287137985229492, 8.238956451416016, 8.857044219970703, 9.163158416748047, 8.525245666503906, 7.6316633224487305, 8.769843101501465, 8.032024383544922, 7.937719345092773, 8.435420989990234, 8.652815818786621, 8.43355941772461, 8.245101928710938, 8.063887596130371, 8.666707992553711, 8.502436637878418, 8.411160469055176, 7.355095863342285, 9.38114070892334, 8.602593421936035, 7.834744453430176, 8.295406341552734, 8.440288543701172, 8.044906616210938, 7.991765975952148, 8.511505126953125, 8.339424133300781, 8.856897354125977, 8.803694725036621, 8.111917495727539, 9.292844772338867, 7.944746971130371, 8.27862548828125, 8.787094116210938, 8.744087219238281, 7.96484375, 9.34804630279541, 8.746341705322266, 7.783218860626221, 7.644176483154297, 8.8771333694458, 7.211813926696777, 9.019614219665527, 8.437650680541992, 8.316523551940918, 8.321280479431152, 8.007080078125, 7.956587791442871, 9.312849044799805, 8.021127700805664, 8.415298461914062, 8.390783309936523, 7.896902561187744, 7.639673233032227, 7.837477684020996, 8.138422012329102, 8.766443252563477, 8.051889419555664, 8.541070938110352, 7.754154205322266, 7.865885257720947, 8.488791465759277, 7.286754608154297, 8.591115951538086, 7.917667388916016, 8.350858688354492, 7.957984447479248, 8.571776390075684], "mean_td_error": 8.229598999023438, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.451493263244629, "actor_loss": -6.0529069900512695, "critic_loss": 5.816524505615234, "alpha_loss": -0.08480717241764069, "alpha_value": 0.9937151670455933, "log_alpha_value": -0.006304665468633175, "target_entropy": -8.0, "policy_t": -0.008079982362687588, "mean_q": 0.6656894087791443, "max_q": 1.1654614210128784, "min_q": 0.4327395260334015}, "td_error": [7.606572151184082, 7.979950904846191, 8.356748580932617, 8.499042510986328, 8.014740943908691, 8.409744262695312, 8.125646591186523, 7.9353718757629395, 7.521223068237305, 8.421161651611328, 8.361465454101562, 8.319568634033203, 7.786659240722656, 8.446762084960938, 8.113100051879883, 8.175880432128906, 8.698638916015625, 8.568679809570312, 7.693368434906006, 7.6515374183654785, 8.294286727905273, 7.827008247375488, 7.714425563812256, 8.527363777160645, 8.178701400756836, 8.031158447265625, 7.862438201904297, 8.371721267700195, 7.833723545074463, 7.969820499420166, 7.803439140319824, 7.704510688781738, 7.518318176269531, 7.799193382263184, 7.528741836547852, 8.178771018981934, 7.798437118530273, 7.65355110168457, 8.139726638793945, 7.466045379638672, 7.632392406463623, 8.130964279174805, 8.123891830444336, 7.531340599060059, 8.289555549621582, 8.035968780517578, 8.731834411621094, 8.197042465209961, 7.6406569480896, 8.375116348266602, 8.322203636169434, 7.4946064949035645, 7.966385841369629, 7.907991409301758, 8.28227424621582, 8.28829574584961, 7.609325408935547, 8.660211563110352, 7.667961120605469, 7.87038516998291, 7.838451385498047, 7.892550468444824, 8.26567554473877, 7.701811790466309, 8.659863471984863, 8.419059753417969, 8.131567001342773, 7.969135284423828, 7.843219757080078, 8.221383094787598, 8.354235649108887, 8.788018226623535, 8.139021873474121, 8.2672119140625, 7.989477157592773, 7.89874792098999, 7.4334259033203125, 9.023847579956055, 8.194154739379883, 7.609602451324463, 8.247278213500977, 8.843903541564941, 8.183889389038086, 7.991660118103027, 7.052809715270996, 7.895408630371094, 7.985189437866211, 8.855072975158691, 8.14044189453125, 7.700233459472656, 8.507183074951172, 7.805999279022217, 7.652194976806641, 6.955665111541748, 7.989201545715332, 8.619892120361328, 9.39047622680664, 8.071484565734863, 8.197649955749512, 8.164596557617188, 8.310991287231445, 8.20511245727539, 8.03016471862793, 7.932245254516602, 7.828399658203125, 7.880167007446289, 7.758418560028076, 8.302030563354492, 8.214118003845215, 8.397821426391602, 7.396624565124512, 8.321197509765625, 8.740362167358398, 7.5668864250183105, 8.072052955627441, 8.131927490234375, 8.236446380615234, 6.893932342529297, 7.3238325119018555, 8.296209335327148, 8.262344360351562, 7.878580093383789, 7.525330066680908, 8.627298355102539, 8.253883361816406, 8.149412155151367, 7.4913506507873535, 8.366071701049805], "mean_td_error": 8.054137229919434, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 21.0}}, "num_env_steps_sampled": 5800, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 11600, "num_agent_steps_trained": 5632, "last_target_update_ts": 5800, "num_target_updates": 22}, "sampler_results": {"episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.6200738445484, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2111.394451755958, "('robot_1', 'robot_1')_total_reward_mean": 1925.6625563641214, "('robot_1', 'robot_1')_total_reward_min": 1799.9561084847237, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}}, "episode_reward_max": 4011.5265903324944, "episode_reward_min": 3686.56690283832, "episode_reward_mean": 3868.2826302086714, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1799.9561084847237}, "policy_reward_max": {"robot_0": 2111.394451755958, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1942.6200738445484, "robot_1": 1925.6625563641214}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8129331128126095, "mean_inference_ms": 3.4649593855814063, "mean_action_processing_ms": 0.4685154571627068, "mean_env_wait_ms": 0.46749925377647517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.22492408752441406}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11600, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5800, "num_env_steps_trained": 5632, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 408.2002001924066, "num_env_steps_trained_throughput_per_sec": 522.4962562462805, "timesteps_total": 5800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 11600, "timers": {"training_iteration_time_ms": 512.887, "sample_time_ms": 280.786, "load_time_ms": 0.831, "load_throughput": 307900.618, "learn_time_ms": 39.238, "learn_throughput": 6524.367, "synch_weights_time_ms": 11.295}, "counters": {"num_env_steps_sampled": 5800, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 11600, "num_agent_steps_trained": 5632, "last_target_update_ts": 5800, "num_target_updates": 22}, "done": false, "episodes_total": 8, "training_iteration": 13, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-28", "timestamp": 1742591188, "time_this_iter_s": 1.483276605606079, "time_total_s": 15.21701955795288, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFDE960940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 15.21701955795288, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 35.35, "ram_util_percent": 92.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1950.9114418033816, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.979917229457, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.413650512695312, "actor_loss": -6.048117637634277, "critic_loss": 6.348265647888184, "alpha_loss": -0.09265139698982239, "alpha_value": 0.993116557598114, "log_alpha_value": -0.006907247006893158, "target_entropy": -8.0, "policy_t": 0.012689129449427128, "mean_q": 0.7083737254142761, "max_q": 1.2340006828308105, "min_q": 0.38279783725738525}, "td_error": [8.129768371582031, 8.514317512512207, 8.139667510986328, 8.08987045288086, 7.731745719909668, 7.881827354431152, 8.212080955505371, 8.202037811279297, 8.230157852172852, 8.851753234863281, 8.41473388671875, 9.944890975952148, 6.694843292236328, 8.198287963867188, 8.486516952514648, 7.6975812911987305, 8.829463958740234, 7.773874759674072, 7.4396867752075195, 7.593523979187012, 8.686996459960938, 8.052753448486328, 9.449132919311523, 7.464730262756348, 7.739346504211426, 8.204607009887695, 7.804067611694336, 8.61715316772461, 8.142485618591309, 8.082286834716797, 7.716361999511719, 8.22988510131836, 7.4329023361206055, 7.053197860717773, 8.459182739257812, 7.592121601104736, 8.4720458984375, 8.374483108520508, 8.383249282836914, 8.278742790222168, 8.473337173461914, 8.58616828918457, 8.704425811767578, 8.601417541503906, 8.825244903564453, 8.256933212280273, 8.839834213256836, 8.345175743103027, 8.472808837890625, 8.831928253173828, 7.437783241271973, 8.522128105163574, 7.923895835876465, 7.842827796936035, 7.770059585571289, 8.467401504516602, 7.871038913726807, 7.447415828704834, 7.4694600105285645, 8.188133239746094, 7.357183456420898, 7.290456771850586, 8.79705810546875, 8.815668106079102, 8.135194778442383, 8.82027530670166, 8.597912788391113, 7.922196388244629, 7.3269853591918945, 7.566754341125488, 7.88109016418457, 8.144219398498535, 8.826501846313477, 8.168633460998535, 7.701558589935303, 8.175310134887695, 8.660665512084961, 7.836640357971191, 7.337623119354248, 8.299747467041016, 7.801568984985352, 7.668887615203857, 8.279723167419434, 8.061717987060547, 8.75283432006836, 8.025745391845703, 8.471590042114258, 7.820747375488281, 7.915499687194824, 7.765702247619629, 8.264863967895508, 8.2343168258667, 7.85689640045166, 8.464095115661621, 7.367454528808594, 8.424737930297852, 7.746050834655762, 7.3498358726501465, 8.635963439941406, 7.827339172363281, 7.780233383178711, 8.726156234741211, 8.111688613891602, 8.014768600463867, 7.952563762664795, 7.984492301940918, 8.279326438903809, 8.131428718566895, 7.2063117027282715, 7.362820148468018, 8.210773468017578, 7.686821937561035, 8.043172836303711, 8.061134338378906, 9.107781410217285, 8.448415756225586, 8.942328453063965, 7.63007116317749, 7.81066370010376, 7.1329193115234375, 7.910540580749512, 8.278947830200195, 8.015454292297363, 7.934039115905762, 8.396394729614258, 7.221972465515137, 7.910037994384766, 7.8217267990112305], "mean_td_error": 8.0990629196167, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.48865795135498, "actor_loss": -6.230908393859863, "critic_loss": 5.92791223526001, "alpha_loss": -0.09314941614866257, "alpha_value": 0.9931180477142334, "log_alpha_value": -0.006905758753418922, "target_entropy": -8.0, "policy_t": 0.014443617314100266, "mean_q": 0.8164919018745422, "max_q": 1.4187960624694824, "min_q": 0.48036712408065796}, "td_error": [8.308637619018555, 8.232500076293945, 8.131141662597656, 7.821183204650879, 8.087118148803711, 7.972658634185791, 8.331313133239746, 8.18631362915039, 7.814268112182617, 9.607816696166992, 8.65516471862793, 7.585627555847168, 7.900548458099365, 7.870003700256348, 7.670116424560547, 8.43110466003418, 8.64246654510498, 8.04391098022461, 7.867578029632568, 7.990195274353027, 8.383243560791016, 8.011066436767578, 8.157468795776367, 7.543158531188965, 8.077089309692383, 7.431687831878662, 7.238408088684082, 7.639545440673828, 7.530611991882324, 7.619793891906738, 8.404352188110352, 8.645986557006836, 7.742680072784424, 7.414743423461914, 7.548701286315918, 7.978118896484375, 7.956594467163086, 7.774548530578613, 7.795760154724121, 7.084481239318848, 7.44659423828125, 7.752365589141846, 8.293998718261719, 8.192755699157715, 7.456331253051758, 7.8760457038879395, 7.84437370300293, 7.642909049987793, 7.21351432800293, 7.316960334777832, 8.05211067199707, 7.812646865844727, 8.471854209899902, 7.777543067932129, 8.672526359558105, 6.694748878479004, 8.276373863220215, 7.750967979431152, 7.978237152099609, 7.796964168548584, 8.361160278320312, 7.867364883422852, 7.32093620300293, 8.538902282714844, 7.6884965896606445, 7.786252975463867, 8.288177490234375, 7.705466270446777, 8.415724754333496, 8.312634468078613, 7.541696548461914, 8.923229217529297, 8.240898132324219, 7.941843032836914, 7.007105827331543, 8.521966934204102, 7.463242530822754, 7.925714492797852, 7.767472267150879, 8.377896308898926, 6.8710527420043945, 7.2578277587890625, 8.581079483032227, 7.568058013916016, 7.608038902282715, 8.675445556640625, 7.5474653244018555, 8.344636917114258, 7.7116594314575195, 7.76605749130249, 8.288724899291992, 8.312976837158203, 7.874726295471191, 7.931380271911621, 7.97281551361084, 7.994727611541748, 7.330507755279541, 7.980953693389893, 7.598877906799316, 8.224862098693848, 7.870454788208008, 8.6190767288208, 9.443303108215332, 9.649921417236328, 8.176422119140625, 8.253864288330078, 7.945681095123291, 7.4955644607543945, 7.868717193603516, 7.92104434967041, 8.181081771850586, 8.2276029586792, 8.36120891571045, 7.857099533081055, 8.096941947937012, 8.333171844482422, 8.445758819580078, 7.980527877807617, 8.272348403930664, 8.08840560913086, 6.995247840881348, 8.52015495300293, 7.977524757385254, 7.791441917419434, 8.354317665100098, 7.961673259735107, 7.9060444831848145, 8.259220123291016], "mean_td_error": 7.982339382171631, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24.0, "diff_num_grad_updates_vs_sampler_policy": 23.0}}, "num_env_steps_sampled": 6200, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 12400, "num_agent_steps_trained": 6144, "last_target_update_ts": 6200, "num_target_updates": 24}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3675.06241296529, "episode_reward_mean": 3857.89135903284, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1950.9114418033816, "robot_1": 1906.979917229457}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1950.9114418033816, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.979917229457, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7985223786282626, "mean_inference_ms": 3.4669070081633255, "mean_action_processing_ms": 0.46874812187002385, "mean_env_wait_ms": 0.47042300603921333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14994939168294272}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3675.06241296529, "episode_reward_mean": 3857.89135903284, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1950.9114418033816, "robot_1": 1906.979917229457}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7985223786282626, "mean_inference_ms": 3.4669070081633255, "mean_action_processing_ms": 0.46874812187002385, "mean_env_wait_ms": 0.47042300603921333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14994939168294272}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12400, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6200, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 382.78356294651707, "num_env_steps_trained_throughput_per_sec": 489.9629605715419, "timesteps_total": 6200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12400, "timers": {"training_iteration_time_ms": 511.87, "sample_time_ms": 282.068, "load_time_ms": 0.831, "load_throughput": 307900.618, "learn_time_ms": 38.261, "learn_throughput": 6690.956, "synch_weights_time_ms": 10.411}, "counters": {"num_env_steps_sampled": 6200, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 12400, "num_agent_steps_trained": 6144, "last_target_update_ts": 6200, "num_target_updates": 24}, "done": false, "episodes_total": 12, "training_iteration": 14, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-29", "timestamp": 1742591189, "time_this_iter_s": 1.0615756511688232, "time_total_s": 16.278595209121704, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 16.278595209121704, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.9, "ram_util_percent": 92.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1950.9114418033816, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.979917229457, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.527628898620605, "actor_loss": -6.278622627258301, "critic_loss": 6.096226215362549, "alpha_loss": -0.10156572610139847, "alpha_value": 0.9925200939178467, "log_alpha_value": -0.007508020848035812, "target_entropy": -8.0, "policy_t": -0.012338699772953987, "mean_q": 0.8298633098602295, "max_q": 1.6195147037506104, "min_q": 0.49082520604133606}, "td_error": [8.327489852905273, 8.297032356262207, 8.182947158813477, 7.943726539611816, 7.824623107910156, 7.772212982177734, 8.091552734375, 7.620334625244141, 7.883162021636963, 8.20231819152832, 8.129158020019531, 7.745397567749023, 8.03622055053711, 7.87156867980957, 7.6894307136535645, 7.374757289886475, 8.0531005859375, 8.139368057250977, 7.220754146575928, 7.3053812980651855, 7.593906402587891, 8.031232833862305, 7.610138893127441, 7.40309476852417, 7.673370361328125, 7.244681358337402, 7.472322463989258, 7.695498466491699, 7.273491859436035, 7.864377021789551, 7.863032817840576, 8.560859680175781, 8.485031127929688, 7.38238525390625, 8.889379501342773, 8.522520065307617, 8.0616455078125, 8.16650676727295, 7.881277084350586, 7.896567344665527, 8.075414657592773, 7.947483062744141, 7.20562219619751, 7.728653907775879, 7.5327653884887695, 8.689850807189941, 8.255441665649414, 7.704395771026611, 7.844330787658691, 8.239439010620117, 7.59968900680542, 8.059364318847656, 7.96639347076416, 8.031357765197754, 8.04899787902832, 8.240830421447754, 8.267236709594727, 7.379368782043457, 7.852591514587402, 7.605027198791504, 7.649174690246582, 7.5116400718688965, 8.156526565551758, 8.148048400878906, 8.457258224487305, 7.759064674377441, 7.34361457824707, 8.071941375732422, 7.239058494567871, 7.6818084716796875, 8.110986709594727, 7.951462745666504, 8.130056381225586, 7.356420516967773, 7.439414024353027, 8.697860717773438, 8.358219146728516, 7.892472267150879, 7.906827926635742, 8.298440933227539, 7.774895668029785, 8.047918319702148, 8.191072463989258, 8.09542465209961, 8.1671781539917, 7.829587936401367, 8.642993927001953, 8.051106452941895, 7.620060920715332, 8.536866188049316, 7.669556617736816, 7.684309959411621, 7.805951118469238, 7.973183631896973, 8.060066223144531, 8.46665096282959, 8.478992462158203, 8.260627746582031, 6.949598789215088, 7.837561130523682, 8.16204833984375, 7.83788537979126, 8.662918090820312, 7.646767616271973, 7.512612342834473, 8.232294082641602, 7.4155354499816895, 7.349613189697266, 8.226579666137695, 7.938089847564697, 7.5704803466796875, 7.806416034698486, 8.164798736572266, 8.062618255615234, 8.37701416015625, 8.490546226501465, 8.722260475158691, 7.704096794128418, 8.922273635864258, 7.356840133666992, 8.152644157409668, 8.481649398803711, 7.778759956359863, 8.386396408081055, 8.140628814697266, 8.225133895874023, 8.126777648925781, 7.845266342163086], "mean_td_error": 7.946554183959961, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.44975471496582, "actor_loss": -6.342082500457764, "critic_loss": 5.661255836486816, "alpha_loss": -0.10096698254346848, "alpha_value": 0.9925211071968079, "log_alpha_value": -0.0075069754384458065, "target_entropy": -8.0, "policy_t": 0.006239466834813356, "mean_q": 0.9746817350387573, "max_q": 1.574815273284912, "min_q": 0.5888921022415161}, "td_error": [7.382687568664551, 8.339116096496582, 8.399234771728516, 7.889020919799805, 7.4145917892456055, 8.009939193725586, 8.163534164428711, 7.701960563659668, 7.744263172149658, 7.529318809509277, 7.6231865882873535, 7.732765197753906, 8.285567283630371, 7.526725769042969, 7.6589813232421875, 6.973394393920898, 7.100284099578857, 8.238672256469727, 8.0442533493042, 8.03348159790039, 7.957261562347412, 7.422265529632568, 7.8461456298828125, 7.06154203414917, 7.450274467468262, 7.329195022583008, 8.504941940307617, 7.822917938232422, 7.345802307128906, 7.6291961669921875, 7.733059883117676, 7.474061965942383, 7.738793849945068, 8.298497200012207, 7.748122692108154, 8.107909202575684, 8.015753746032715, 6.674588203430176, 8.374728202819824, 7.6484456062316895, 7.638058662414551, 8.328645706176758, 7.813394546508789, 7.715643405914307, 8.101180076599121, 7.490667343139648, 7.395456314086914, 8.219364166259766, 7.827524662017822, 8.305595397949219, 7.952775955200195, 7.774877548217773, 7.430675506591797, 7.498212814331055, 7.993938446044922, 7.737123489379883, 7.184915065765381, 7.072793006896973, 8.591009140014648, 8.028789520263672, 7.3951802253723145, 7.909618377685547, 7.728272438049316, 7.773016929626465, 8.196023941040039, 7.9381208419799805, 7.940824031829834, 7.4934492111206055, 7.533602237701416, 7.748195648193359, 7.487366676330566, 7.284696102142334, 7.4463701248168945, 8.241971969604492, 7.708188533782959, 8.04184627532959, 7.448640823364258, 8.090425491333008, 7.997275352478027, 6.953866958618164, 7.665950775146484, 7.872462272644043, 8.350870132446289, 6.843231201171875, 7.62874698638916, 7.840189456939697, 7.979073524475098, 7.325807094573975, 8.97022819519043, 7.298123359680176, 7.809088706970215, 7.140085697174072, 8.383903503417969, 7.748950481414795, 7.239371299743652, 8.554071426391602, 8.058662414550781, 7.469926834106445, 7.2641096115112305, 7.7564191818237305, 9.245991706848145, 6.979353904724121, 7.402837753295898, 8.61198616027832, 8.052116394042969, 8.203205108642578, 7.6272664070129395, 7.3656134605407715, 7.4914350509643555, 8.095983505249023, 8.039180755615234, 7.795169830322266, 8.069313049316406, 7.976586818695068, 7.057401657104492, 7.275709629058838, 8.127925872802734, 7.679636001586914, 7.192290782928467, 8.478432655334473, 7.351837158203125, 7.938904762268066, 7.979107856750488, 7.7339091300964355, 7.605885028839111, 7.3653178215026855, 7.905305862426758, 7.875665664672852], "mean_td_error": 7.766834259033203, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 6600, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 13200, "num_agent_steps_trained": 6656, "last_target_update_ts": 6600, "num_target_updates": 26}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3675.06241296529, "episode_reward_mean": 3857.89135903284, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1950.9114418033816, "robot_1": 1906.979917229457}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1950.9114418033816, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.979917229457, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7985223786282626, "mean_inference_ms": 3.4669070081633255, "mean_action_processing_ms": 0.46874812187002385, "mean_env_wait_ms": 0.47042300603921333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14994939168294272}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3675.06241296529, "episode_reward_mean": 3857.89135903284, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1950.9114418033816, "robot_1": 1906.979917229457}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7985223786282626, "mean_inference_ms": 3.4669070081633255, "mean_action_processing_ms": 0.46874812187002385, "mean_env_wait_ms": 0.47042300603921333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14994939168294272}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13200, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 6600, "num_env_steps_trained": 6656, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 369.1858650967282, "num_env_steps_trained_throughput_per_sec": 472.5579073238121, "timesteps_total": 6600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13200, "timers": {"training_iteration_time_ms": 515.23, "sample_time_ms": 285.425, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 37.658, "learn_throughput": 6797.99, "synch_weights_time_ms": 10.467}, "counters": {"num_env_steps_sampled": 6600, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 13200, "num_agent_steps_trained": 6656, "last_target_update_ts": 6600, "num_target_updates": 26}, "done": false, "episodes_total": 12, "training_iteration": 15, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-30", "timestamp": 1742591190, "time_this_iter_s": 1.1001524925231934, "time_total_s": 17.378747701644897, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AD7EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 17.378747701644897, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.849999999999994, "ram_util_percent": 92.15}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1950.9114418033816, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.979917229457, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.518119812011719, "actor_loss": -6.432034015655518, "critic_loss": 5.706611633300781, "alpha_loss": -0.10961771756410599, "alpha_value": 0.9919238686561584, "log_alpha_value": -0.008108946494758129, "target_entropy": -8.0, "policy_t": 0.034009069204330444, "mean_q": 0.975310206413269, "max_q": 1.7601462602615356, "min_q": 0.5739415884017944}, "td_error": [8.989559173583984, 7.537238121032715, 9.005237579345703, 8.344697952270508, 7.046320915222168, 7.567086696624756, 7.554523468017578, 7.381871223449707, 7.306571006774902, 8.034219741821289, 7.456071853637695, 7.989737510681152, 8.600654602050781, 7.542715072631836, 7.161215782165527, 7.928170204162598, 8.14936637878418, 8.14775562286377, 8.138614654541016, 6.959540843963623, 8.040443420410156, 7.518294334411621, 7.556201934814453, 7.470575332641602, 8.009151458740234, 7.646040916442871, 7.581496238708496, 7.729109764099121, 7.688225746154785, 7.763004302978516, 8.43138599395752, 7.2701287269592285, 7.8399810791015625, 9.619744300842285, 7.9439897537231445, 8.223505020141602, 8.176390647888184, 8.367816925048828, 7.5397257804870605, 7.418968200683594, 7.479175567626953, 9.119184494018555, 7.708833694458008, 7.255624294281006, 7.3965744972229, 7.235889434814453, 7.595882892608643, 7.823639869689941, 7.581450462341309, 7.635467529296875, 8.355616569519043, 8.255350112915039, 8.617286682128906, 8.110136032104492, 7.166623115539551, 7.576539993286133, 7.842138290405273, 8.541332244873047, 7.278481483459473, 7.464457988739014, 7.8927812576293945, 7.425411701202393, 7.843632698059082, 8.299915313720703, 7.5479888916015625, 7.734366416931152, 7.3463311195373535, 7.586512565612793, 7.596264839172363, 7.917243957519531, 7.448470592498779, 7.855915069580078, 8.347434043884277, 7.365207195281982, 7.141902923583984, 8.461984634399414, 7.5969038009643555, 7.811004638671875, 7.99338436126709, 7.672497272491455, 7.301426887512207, 8.124265670776367, 7.309247016906738, 7.368060111999512, 7.606022357940674, 7.36026668548584, 7.556788444519043, 7.698413848876953, 7.634754180908203, 7.944586277008057, 8.295015335083008, 7.599514007568359, 7.563091278076172, 8.001849174499512, 7.925556182861328, 8.25412368774414, 7.395018100738525, 7.505970478057861, 7.29973030090332, 8.113754272460938, 7.364432334899902, 8.985563278198242, 8.117305755615234, 8.080788612365723, 8.005460739135742, 7.912260055541992, 8.321558952331543, 7.436090469360352, 7.4165849685668945, 8.047264099121094, 7.598406791687012, 8.119524002075195, 7.79216194152832, 7.586335182189941, 7.592978477478027, 7.624297142028809, 8.615761756896973, 8.038240432739258, 7.058255195617676, 7.704242706298828, 8.1468505859375, 7.812862396240234, 7.816900253295898, 8.048124313354492, 7.531024932861328, 8.352815628051758, 8.049448013305664, 8.04222297668457], "mean_td_error": 7.817776679992676, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.40523624420166, "actor_loss": -6.4338860511779785, "critic_loss": 5.671924591064453, "alpha_loss": -0.10869041085243225, "alpha_value": 0.9919247031211853, "log_alpha_value": -0.008108056150376797, "target_entropy": -8.0, "policy_t": -0.004877590108662844, "mean_q": 1.1296976804733276, "max_q": 1.9428129196166992, "min_q": 0.7419560551643372}, "td_error": [7.166471481323242, 8.110241889953613, 7.741759300231934, 7.340795040130615, 7.967810153961182, 7.180127143859863, 6.710147857666016, 7.998751640319824, 8.113475799560547, 7.900911331176758, 7.491826057434082, 7.634041786193848, 7.683274745941162, 7.665555000305176, 6.699334144592285, 7.445577144622803, 8.244453430175781, 7.340161323547363, 7.274623870849609, 7.06751823425293, 7.70842170715332, 7.170831203460693, 8.762117385864258, 7.478834629058838, 7.1350016593933105, 8.085826873779297, 7.243316650390625, 6.878450870513916, 7.411237716674805, 7.7964582443237305, 7.510898590087891, 7.509943962097168, 7.301606178283691, 6.708315849304199, 7.467353820800781, 6.744723320007324, 7.823141098022461, 7.601467132568359, 7.269070625305176, 7.244293212890625, 7.4353742599487305, 7.303632736206055, 8.13253402709961, 8.016454696655273, 7.538478851318359, 7.483585834503174, 7.6459856033325195, 6.430202960968018, 7.673961639404297, 7.503157615661621, 7.684928894042969, 7.371759414672852, 7.393300533294678, 7.398908615112305, 7.450857162475586, 7.762791156768799, 7.9807209968566895, 7.712316036224365, 8.094345092773438, 7.507946014404297, 7.027444839477539, 8.01599407196045, 7.183167457580566, 6.935751914978027, 7.019423484802246, 7.939347267150879, 7.500607967376709, 7.399822235107422, 7.638200759887695, 6.245511054992676, 7.526663780212402, 7.398782253265381, 7.725615501403809, 7.502875804901123, 7.821103572845459, 7.327341079711914, 7.402933120727539, 7.8780670166015625, 6.804102897644043, 7.621319770812988, 7.104952812194824, 7.511900901794434, 7.723532676696777, 7.747322082519531, 7.535053730010986, 7.787728309631348, 8.225807189941406, 7.995274066925049, 7.238463401794434, 7.951440811157227, 7.507177829742432, 7.41304874420166, 7.440351963043213, 7.696588039398193, 6.751546859741211, 7.896659851074219, 7.526525497436523, 7.7304534912109375, 8.037186622619629, 8.20962142944336, 7.33826208114624, 7.947026252746582, 7.052179336547852, 7.655815124511719, 8.502700805664062, 7.409311294555664, 7.63219690322876, 7.760279178619385, 7.818142890930176, 7.408079147338867, 7.735192775726318, 7.789888858795166, 7.167407035827637, 7.87751579284668, 8.46754264831543, 7.02593994140625, 7.637430191040039, 7.381488800048828, 7.840102195739746, 7.766781806945801, 9.028578758239746, 7.879668712615967, 7.819931983947754, 7.746509552001953, 7.185239315032959, 8.2366304397583, 8.686765670776367, 7.849733352661133], "mean_td_error": 7.576097011566162, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 7168, "last_target_update_ts": 7000, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3675.06241296529, "episode_reward_mean": 3857.89135903284, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1950.9114418033816, "robot_1": 1906.979917229457}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1950.9114418033816, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.979917229457, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7985223786282626, "mean_inference_ms": 3.4669070081633255, "mean_action_processing_ms": 0.46874812187002385, "mean_env_wait_ms": 0.47042300603921333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14994939168294272}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3675.06241296529, "episode_reward_mean": 3857.89135903284, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1950.9114418033816, "robot_1": 1906.979917229457}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7985223786282626, "mean_inference_ms": 3.4669070081633255, "mean_action_processing_ms": 0.46874812187002385, "mean_env_wait_ms": 0.47042300603921333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14994939168294272}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7000, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 390.9958157903691, "num_env_steps_trained_throughput_per_sec": 500.47464421167246, "timesteps_total": 7000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 515.469, "sample_time_ms": 285.446, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 36.816, "learn_throughput": 6953.48, "synch_weights_time_ms": 10.706}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 7168, "last_target_update_ts": 7000, "num_target_updates": 28}, "done": false, "episodes_total": 12, "training_iteration": 16, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-32", "timestamp": 1742591192, "time_this_iter_s": 1.041670322418213, "time_total_s": 18.42041802406311, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AD7D30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 18.42041802406311, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.2, "ram_util_percent": 92.1}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1950.9114418033816, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.979917229457, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.495485305786133, "actor_loss": -6.60249662399292, "critic_loss": 5.346985816955566, "alpha_loss": -0.12159880995750427, "alpha_value": 0.9910301566123962, "log_alpha_value": -0.009010332636535168, "target_entropy": -8.0, "policy_t": -0.017375398427248, "mean_q": 1.2171329259872437, "max_q": 2.3866982460021973, "min_q": 0.79041588306427}, "td_error": [7.247871398925781, 7.613537788391113, 8.640413284301758, 7.263442516326904, 8.285097122192383, 7.4892578125, 7.6908464431762695, 7.0206685066223145, 6.981197357177734, 7.41296911239624, 7.95136833190918, 7.5925421714782715, 7.289495944976807, 7.641416549682617, 7.604535102844238, 7.11855411529541, 7.3047919273376465, 7.1753764152526855, 7.827462196350098, 7.364270210266113, 8.126562118530273, 6.955463886260986, 6.978374481201172, 7.282614231109619, 7.309118270874023, 7.232141971588135, 7.723730087280273, 7.416730880737305, 7.537985801696777, 6.9106059074401855, 7.904116153717041, 8.965357780456543, 7.486207962036133, 7.048516750335693, 7.8044328689575195, 7.435357093811035, 6.575987815856934, 9.281351089477539, 6.289478302001953, 7.384221076965332, 8.525238037109375, 8.277937889099121, 7.066071510314941, 7.619167327880859, 7.839237213134766, 7.70864200592041, 7.763562202453613, 7.218784332275391, 7.864412307739258, 8.495453834533691, 6.986827850341797, 7.128148078918457, 7.49512243270874, 7.821680068969727, 8.62495231628418, 7.493005752563477, 7.292148590087891, 7.782029151916504, 7.4872846603393555, 7.964887619018555, 7.7715606689453125, 7.410845756530762, 7.277341842651367, 6.923381805419922, 7.479340076446533, 7.336909294128418, 7.3864426612854, 7.738157272338867, 7.830939769744873, 7.541748046875, 9.100383758544922, 8.078163146972656, 7.7412109375, 7.919624328613281, 7.303189277648926, 7.593524932861328, 7.581120491027832, 7.223464012145996, 7.949698448181152, 6.846620559692383, 7.0017476081848145, 7.046658515930176, 7.152551174163818, 7.581299781799316, 7.222040176391602, 7.111492156982422, 7.580172538757324, 7.273015975952148, 8.124222755432129, 7.013323783874512, 8.649754524230957, 8.828752517700195, 7.448680877685547, 7.907114028930664, 7.666958808898926, 7.9133453369140625, 7.304987907409668, 7.425259590148926, 6.436201095581055, 8.753459930419922, 7.280666351318359, 7.677273273468018, 7.407523155212402, 7.949089527130127, 8.078027725219727, 6.873015403747559, 7.753692626953125, 7.578803062438965, 7.5942535400390625, 7.459260940551758, 7.518865585327148, 7.463897705078125, 8.672901153564453, 7.227293491363525, 7.054262638092041, 7.707564353942871, 6.875781059265137, 7.288252830505371, 7.4667744636535645, 6.819561004638672, 8.019707679748535, 7.9210991859436035, 7.802009582519531, 8.023374557495117, 8.237144470214844, 7.450953006744385, 7.20725679397583, 8.62611198425293], "mean_td_error": 7.586931228637695, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.477277755737305, "actor_loss": -6.8156585693359375, "critic_loss": 5.4025421142578125, "alpha_loss": -0.1214170977473259, "alpha_value": 0.9910314083099365, "log_alpha_value": -0.009009022265672684, "target_entropy": -8.0, "policy_t": 0.007200854830443859, "mean_q": 1.437882661819458, "max_q": 2.7848129272460938, "min_q": 0.8966083526611328}, "td_error": [6.515582084655762, 7.142773628234863, 7.038897514343262, 6.8431220054626465, 7.074467658996582, 7.406743049621582, 7.394631385803223, 7.842419624328613, 7.555706977844238, 7.246879577636719, 7.335272312164307, 6.780665874481201, 7.033019065856934, 7.384524345397949, 7.754885196685791, 7.6472063064575195, 6.741204738616943, 6.862575054168701, 7.528414726257324, 7.35905122756958, 6.6039252281188965, 6.7812957763671875, 8.1803617477417, 7.32328462600708, 7.641217231750488, 7.477512836456299, 7.165746688842773, 7.158684730529785, 6.755460739135742, 7.583212852478027, 7.094610214233398, 7.254122734069824, 6.92507791519165, 7.433041572570801, 6.944896697998047, 7.217521667480469, 6.445310115814209, 7.181163787841797, 7.0025739669799805, 7.017777919769287, 8.158405303955078, 6.794294357299805, 7.522286415100098, 8.492008209228516, 7.991443634033203, 6.9849467277526855, 7.127368927001953, 7.229213714599609, 7.198486804962158, 7.161561012268066, 6.954389572143555, 7.394990921020508, 7.337733268737793, 6.958575248718262, 7.212406158447266, 8.434579849243164, 7.364866256713867, 7.605975151062012, 7.259515762329102, 7.358119487762451, 7.618314743041992, 7.09726619720459, 7.53501558303833, 7.348618984222412, 7.118741035461426, 7.858172416687012, 7.386178970336914, 8.184738159179688, 7.384867191314697, 7.662260055541992, 7.148669242858887, 6.916670799255371, 7.5456013679504395, 6.148441314697266, 7.348430633544922, 6.415194511413574, 7.39781379699707, 7.382527828216553, 6.877298355102539, 7.010142803192139, 6.712822914123535, 7.215023994445801, 7.632134437561035, 6.95657205581665, 7.064292907714844, 7.836266040802002, 7.081231117248535, 7.818058013916016, 6.759115219116211, 7.559022903442383, 7.278687477111816, 7.512545585632324, 6.3296661376953125, 6.474842548370361, 7.282706260681152, 6.781923294067383, 7.288506984710693, 7.110574722290039, 7.749896049499512, 7.308757781982422, 7.2117767333984375, 7.003124237060547, 7.538762092590332, 7.030133247375488, 6.718515396118164, 7.326881408691406, 6.938167572021484, 7.174867630004883, 7.004120349884033, 6.200663089752197, 7.589983940124512, 6.901637077331543, 7.722626686096191, 7.223574638366699, 7.071484565734863, 6.84846830368042, 7.247308731079102, 6.729530334472656, 7.327866554260254, 7.169274806976318, 7.531003475189209, 7.786170959472656, 6.838393211364746, 7.646756172180176, 6.97239875793457, 7.99415397644043, 7.270301342010498, 7.522516250610352], "mean_td_error": 7.241359710693359, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 7600, "num_env_steps_trained": 7936, "num_agent_steps_sampled": 15200, "num_agent_steps_trained": 7936, "last_target_update_ts": 7600, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3675.06241296529, "episode_reward_mean": 3857.89135903284, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1950.9114418033816, "robot_1": 1906.979917229457}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1950.9114418033816, "('robot_0', 'robot_0')_total_reward_min": 1815.3649752723447, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.979917229457, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 1992.9461615927437}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7985223786282626, "mean_inference_ms": 3.4669070081633255, "mean_action_processing_ms": 0.46874812187002385, "mean_env_wait_ms": 0.47042300603921333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14994939168294272}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3675.06241296529, "episode_reward_mean": 3857.89135903284, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1815.3649752723447, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 1992.9461615927437}, "policy_reward_mean": {"robot_0": 1950.9114418033816, "robot_1": 1906.979917229457}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7985223786282626, "mean_inference_ms": 3.4669070081633255, "mean_action_processing_ms": 0.46874812187002385, "mean_env_wait_ms": 0.47042300603921333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14994939168294272}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15200, "num_agent_steps_trained": 7936, "num_env_steps_sampled": 7600, "num_env_steps_trained": 7936, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 399.9862039873973, "num_env_steps_trained_throughput_per_sec": 511.9823411038686, "timesteps_total": 7600, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 15200, "timers": {"training_iteration_time_ms": 514.603, "sample_time_ms": 285.632, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 35.12, "learn_throughput": 7289.292, "synch_weights_time_ms": 9.843}, "counters": {"num_env_steps_sampled": 7600, "num_env_steps_trained": 7936, "num_agent_steps_sampled": 15200, "num_agent_steps_trained": 7936, "last_target_update_ts": 7600, "num_target_updates": 31}, "done": false, "episodes_total": 12, "training_iteration": 17, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-33", "timestamp": 1742591193, "time_this_iter_s": 1.524904727935791, "time_total_s": 19.9453227519989, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AD7AF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 19.9453227519989, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 34.23333333333333, "ram_util_percent": 92.13333333333333}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.441840171813965, "actor_loss": -6.756260395050049, "critic_loss": 5.444186687469482, "alpha_loss": -0.12919041514396667, "alpha_value": 0.9904349446296692, "log_alpha_value": -0.009611065499484539, "target_entropy": -8.0, "policy_t": -0.033977244049310684, "mean_q": 1.4068548679351807, "max_q": 2.5229341983795166, "min_q": 0.8179402351379395}, "td_error": [7.831470489501953, 7.252619743347168, 7.459506034851074, 7.391387939453125, 7.324066162109375, 6.874375343322754, 7.008913993835449, 8.544410705566406, 7.687858581542969, 7.335690498352051, 6.920015335083008, 6.948775291442871, 6.542180061340332, 6.960419178009033, 6.807375431060791, 6.693930149078369, 6.915940284729004, 8.313495635986328, 7.215494155883789, 6.957569122314453, 8.072135925292969, 6.999774932861328, 7.744916915893555, 6.902047634124756, 7.932019233703613, 6.728962421417236, 7.401791095733643, 7.3397626876831055, 6.817063808441162, 6.635220527648926, 7.000324249267578, 7.803736686706543, 7.071961879730225, 8.019170761108398, 6.891461372375488, 7.292357921600342, 7.757740020751953, 6.545782089233398, 6.789804458618164, 7.408349990844727, 7.596187591552734, 6.966119289398193, 6.928272247314453, 6.628583908081055, 8.377437591552734, 7.523113250732422, 7.375197887420654, 7.457313537597656, 6.990220069885254, 8.568781852722168, 7.666088104248047, 7.0357584953308105, 7.232139587402344, 6.520583629608154, 7.177119255065918, 8.850557327270508, 6.705106735229492, 6.891744136810303, 8.01427173614502, 7.487600326538086, 7.833771705627441, 8.523194313049316, 7.949927806854248, 7.028951644897461, 7.344350337982178, 7.062702178955078, 8.098711013793945, 7.267356872558594, 7.075231075286865, 8.378860473632812, 7.875208854675293, 7.192033767700195, 7.827515125274658, 7.317967414855957, 7.49418830871582, 7.969632625579834, 7.292662620544434, 7.778021812438965, 7.043595314025879, 8.892772674560547, 8.126192092895508, 7.384186744689941, 7.513363838195801, 7.607077121734619, 7.51914119720459, 7.280415058135986, 7.429547309875488, 7.002496719360352, 8.43177604675293, 7.713963508605957, 7.49168062210083, 6.992160797119141, 7.8994574546813965, 7.222714424133301, 7.0900444984436035, 7.381058216094971, 6.950794219970703, 7.413341045379639, 6.593981742858887, 7.569563865661621, 7.621950149536133, 7.153558731079102, 6.558444976806641, 7.4807963371276855, 7.412374973297119, 7.440901756286621, 7.517663955688477, 7.2224602699279785, 7.486799240112305, 7.480152130126953, 7.404833793640137, 6.706199645996094, 7.981693267822266, 7.65084171295166, 7.10219144821167, 7.3402605056762695, 6.9161696434021, 6.677218914031982, 6.8419342041015625, 7.050959587097168, 6.941441535949707, 8.19655704498291, 6.979541778564453, 7.627579689025879, 7.8639678955078125, 7.16568660736084, 7.336024284362793, 7.84611701965332], "mean_td_error": 7.382781028747559, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.492084503173828, "actor_loss": -7.036479949951172, "critic_loss": 5.071557998657227, "alpha_loss": -0.12965361773967743, "alpha_value": 0.9904364347457886, "log_alpha_value": -0.009609607048332691, "target_entropy": -8.0, "policy_t": 0.022896377369761467, "mean_q": 1.6500186920166016, "max_q": 2.9129271507263184, "min_q": 1.1096184253692627}, "td_error": [6.751114845275879, 7.056736469268799, 6.9740777015686035, 6.974331855773926, 6.480613708496094, 7.4580535888671875, 6.892584323883057, 6.503444671630859, 6.988507270812988, 6.916384696960449, 7.1508588790893555, 6.203325271606445, 6.627398490905762, 6.7688703536987305, 7.817320823669434, 6.663473606109619, 7.4542670249938965, 7.716923236846924, 7.425228118896484, 8.129276275634766, 7.484186172485352, 6.811250686645508, 7.266963958740234, 7.664687633514404, 7.001987457275391, 6.558825492858887, 6.713507175445557, 7.167959213256836, 7.2051801681518555, 7.2350077629089355, 8.162307739257812, 7.185763359069824, 6.491539001464844, 7.279524326324463, 6.661622524261475, 6.756426811218262, 7.310347080230713, 6.649181365966797, 7.350314140319824, 6.632250785827637, 7.426513671875, 7.214613437652588, 7.169774055480957, 7.148102760314941, 7.206873893737793, 7.38115119934082, 6.940954685211182, 7.679165840148926, 7.4763383865356445, 6.461800575256348, 7.021282196044922, 7.680858612060547, 7.016354560852051, 7.283572673797607, 6.355720520019531, 6.857163429260254, 7.223992347717285, 7.0380167961120605, 7.243924140930176, 6.131438255310059, 7.952733993530273, 7.199877738952637, 7.235389709472656, 7.442161560058594, 6.73538875579834, 6.851616859436035, 6.385587215423584, 6.834290981292725, 8.175504684448242, 7.557158946990967, 6.20360803604126, 7.286596298217773, 6.655176162719727, 6.06222677230835, 6.210431098937988, 6.939080238342285, 7.05724573135376, 8.040814399719238, 7.17612361907959, 6.81840705871582, 7.700414180755615, 6.682803153991699, 7.190166473388672, 6.641957759857178, 6.967405319213867, 7.565032005310059, 6.873324394226074, 7.447454929351807, 7.10723876953125, 7.5711822509765625, 6.834212303161621, 7.066076278686523, 6.921754837036133, 6.572878360748291, 7.565016746520996, 7.893865585327148, 7.097866535186768, 6.609068393707275, 7.847503662109375, 7.202871799468994, 6.602916717529297, 6.742977142333984, 7.797964096069336, 7.074170112609863, 6.507674217224121, 6.595158100128174, 6.744571685791016, 7.2498674392700195, 6.8546247482299805, 7.396553039550781, 6.737805366516113, 6.743976593017578, 6.58572244644165, 7.506616592407227, 6.364902973175049, 6.834019184112549, 6.7422285079956055, 6.751076698303223, 6.628042697906494, 7.02256965637207, 7.625918388366699, 7.621490478515625, 6.840219497680664, 7.17073917388916, 7.6558051109313965, 6.9394683837890625, 6.405379295349121, 8.171575546264648], "mean_td_error": 7.067115306854248, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8448, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 8448, "last_target_update_ts": 8000, "num_target_updates": 33}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 8448, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8448, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 396.68122745688214, "num_env_steps_trained_throughput_per_sec": 507.75197114480915, "timesteps_total": 8000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 513.149, "sample_time_ms": 284.46, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 34.251, "learn_throughput": 7474.339, "synch_weights_time_ms": 9.57}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8448, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 8448, "last_target_update_ts": 8000, "num_target_updates": 33}, "done": false, "episodes_total": 16, "training_iteration": 18, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-34", "timestamp": 1742591194, "time_this_iter_s": 1.0251049995422363, "time_total_s": 20.970427751541138, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F2430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 20.970427751541138, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 33.3, "ram_util_percent": 92.2}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.479487419128418, "actor_loss": -7.065285682678223, "critic_loss": 5.254293441772461, "alpha_loss": -0.13764698803424835, "alpha_value": 0.9898403882980347, "log_alpha_value": -0.010211590677499771, "target_entropy": -8.0, "policy_t": -0.004471077583730221, "mean_q": 1.6982749700546265, "max_q": 2.99748158454895, "min_q": 1.0005828142166138}, "td_error": [6.790105819702148, 6.671624660491943, 7.723343849182129, 6.906521320343018, 7.022876739501953, 7.24363374710083, 6.219322204589844, 5.868034839630127, 6.948134422302246, 7.442049980163574, 7.104480266571045, 6.907646179199219, 7.627445220947266, 7.643872261047363, 7.108626365661621, 6.878754615783691, 8.103145599365234, 8.360440254211426, 6.856273651123047, 7.711143493652344, 6.755765438079834, 6.393433570861816, 7.079345703125, 7.231632232666016, 6.915872097015381, 7.6870622634887695, 6.576016902923584, 7.535397529602051, 8.919378280639648, 6.691410064697266, 7.475934028625488, 7.67319393157959, 7.555917739868164, 6.795048713684082, 7.9259538650512695, 6.346712112426758, 6.57246208190918, 7.145704746246338, 6.991581916809082, 5.806967735290527, 7.4626336097717285, 6.607634544372559, 7.113584518432617, 6.577752113342285, 7.779506683349609, 7.3231377601623535, 7.059765815734863, 7.806308269500732, 6.127295017242432, 7.302008628845215, 7.12764835357666, 7.645217418670654, 6.6266865730285645, 6.410902976989746, 7.1103515625, 8.349241256713867, 8.214311599731445, 6.717709541320801, 7.239224433898926, 7.1688079833984375, 7.0329999923706055, 6.7661895751953125, 6.793805122375488, 6.39910888671875, 6.696732521057129, 7.605011463165283, 6.80471134185791, 6.698646545410156, 6.402307987213135, 6.7739057540893555, 6.60687255859375, 6.854824066162109, 7.8198628425598145, 7.200345993041992, 6.964345932006836, 7.948871612548828, 8.108139038085938, 7.3975701332092285, 7.154624938964844, 6.2113118171691895, 6.762102127075195, 7.674843788146973, 6.437078475952148, 7.370253562927246, 6.437213897705078, 7.603158950805664, 7.337481498718262, 7.063947677612305, 7.569347381591797, 6.488524436950684, 7.5830535888671875, 5.944859981536865, 6.497596740722656, 6.814835548400879, 6.949821949005127, 7.714260101318359, 6.5509114265441895, 6.610025405883789, 7.252964496612549, 7.3596696853637695, 6.780141830444336, 6.923387050628662, 7.0691022872924805, 6.446247577667236, 6.583512306213379, 7.365667343139648, 6.963268280029297, 6.957005977630615, 6.851456165313721, 6.269460678100586, 6.3328094482421875, 6.794737815856934, 7.301989555358887, 7.6210222244262695, 6.791232109069824, 7.235052108764648, 6.7052836418151855, 7.242700576782227, 6.924993515014648, 7.230947494506836, 7.3557448387146, 6.326847553253174, 6.268614768981934, 7.28740930557251, 6.8752241134643555, 7.411805152893066, 7.148131847381592, 6.826114654541016], "mean_td_error": 7.055734157562256, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.433401107788086, "actor_loss": -7.266483783721924, "critic_loss": 5.195124626159668, "alpha_loss": -0.1371559202671051, "alpha_value": 0.989841878414154, "log_alpha_value": -0.010210066102445126, "target_entropy": -8.0, "policy_t": -0.008308205753564835, "mean_q": 1.9412492513656616, "max_q": 3.6157844066619873, "min_q": 1.2416404485702515}, "td_error": [7.088069438934326, 7.063107013702393, 6.795952796936035, 6.544313430786133, 6.58467960357666, 6.876599311828613, 7.585775375366211, 6.7189531326293945, 6.9968976974487305, 7.619720935821533, 7.919992923736572, 7.189007759094238, 6.5433878898620605, 6.301802635192871, 5.754127025604248, 6.733160018920898, 6.376751899719238, 6.284340858459473, 7.318768501281738, 8.323509216308594, 7.099969387054443, 6.464486598968506, 6.0725507736206055, 7.629226207733154, 6.996906757354736, 6.983364105224609, 6.879978179931641, 6.5645012855529785, 5.997921943664551, 6.3466901779174805, 7.464160442352295, 7.252010822296143, 6.716618537902832, 6.639103412628174, 7.549070358276367, 6.269649505615234, 6.565848350524902, 6.225465297698975, 6.732067108154297, 7.002753257751465, 7.592397689819336, 7.179166793823242, 6.949124336242676, 6.760537624359131, 7.169966220855713, 7.711674690246582, 6.338342666625977, 6.504706859588623, 6.613525390625, 6.4628190994262695, 7.601588726043701, 7.2794084548950195, 7.390279293060303, 6.087529182434082, 7.194028854370117, 6.618014335632324, 7.7933549880981445, 7.16563606262207, 6.832101821899414, 6.668206214904785, 6.316349029541016, 6.389739036560059, 6.32362174987793, 6.5334601402282715, 6.709957122802734, 7.306776523590088, 6.424508094787598, 6.618743896484375, 6.889988899230957, 6.656648635864258, 7.223764419555664, 6.505467891693115, 7.177900314331055, 8.292947769165039, 6.462148666381836, 6.914260387420654, 6.666532516479492, 6.917510032653809, 6.78211784362793, 6.43803596496582, 6.778751373291016, 7.208612442016602, 7.290203094482422, 6.71710205078125, 6.956088066101074, 6.281142234802246, 6.71804141998291, 6.786660194396973, 6.85292911529541, 7.416014671325684, 5.995878219604492, 6.295870304107666, 7.264319896697998, 6.941591262817383, 6.461805820465088, 7.847296714782715, 6.650195598602295, 6.0597639083862305, 6.639766216278076, 7.453648567199707, 6.675705909729004, 6.87482213973999, 6.851786136627197, 8.598072052001953, 6.125975608825684, 7.126038551330566, 7.544042587280273, 6.561572074890137, 5.893512725830078, 6.918150901794434, 6.8064188957214355, 6.937634468078613, 6.697701454162598, 6.768092155456543, 6.399208068847656, 6.6302313804626465, 6.179354667663574, 6.647037506103516, 6.023471832275391, 6.4723734855651855, 6.940561771392822, 6.663620948791504, 6.711310386657715, 6.754452705383301, 6.263991355895996, 6.992145538330078, 5.791256904602051, 7.104719161987305], "mean_td_error": 6.828930854797363, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8960, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 8960, "last_target_update_ts": 8400, "num_target_updates": 35}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 8960, "num_env_steps_sampled": 8400, "num_env_steps_trained": 8960, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 390.15030255618757, "num_env_steps_trained_throughput_per_sec": 499.39238727192014, "timesteps_total": 8400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16800, "timers": {"training_iteration_time_ms": 508.169, "sample_time_ms": 279.428, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 34.244, "learn_throughput": 7475.77, "synch_weights_time_ms": 9.612}, "counters": {"num_env_steps_sampled": 8400, "num_env_steps_trained": 8960, "num_agent_steps_sampled": 16800, "num_agent_steps_trained": 8960, "last_target_update_ts": 8400, "num_target_updates": 35}, "done": false, "episodes_total": 16, "training_iteration": 19, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-35", "timestamp": 1742591195, "time_this_iter_s": 1.0416350364685059, "time_total_s": 22.012062788009644, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AD7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 22.012062788009644, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 34.0, "ram_util_percent": 92.2}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.434324264526367, "actor_loss": -7.240453243255615, "critic_loss": 5.09645938873291, "alpha_loss": -0.14525413513183594, "alpha_value": 0.9892460703849792, "log_alpha_value": -0.010812164284288883, "target_entropy": -8.0, "policy_t": 0.026087561622262, "mean_q": 1.920240044593811, "max_q": 3.5951554775238037, "min_q": 1.2566468715667725}, "td_error": [6.9465179443359375, 6.730281829833984, 7.254949569702148, 7.506419658660889, 6.991664886474609, 7.449817657470703, 6.766810417175293, 6.066445350646973, 6.747234344482422, 6.665125846862793, 6.721456527709961, 6.871614456176758, 6.09164571762085, 7.0063581466674805, 7.115242958068848, 6.787051200866699, 6.387783050537109, 6.493373870849609, 6.503086566925049, 6.3152570724487305, 6.169538497924805, 6.267870903015137, 6.294837951660156, 6.894601821899414, 6.928993225097656, 7.238198280334473, 6.642565727233887, 6.976906776428223, 7.4542236328125, 6.953465461730957, 6.155896186828613, 6.268959045410156, 6.634835243225098, 6.726395606994629, 6.618573188781738, 6.526861190795898, 7.800912857055664, 6.761015892028809, 7.263751983642578, 6.656808853149414, 5.9126482009887695, 5.829738616943359, 5.775766372680664, 7.363063812255859, 7.131633758544922, 6.523778915405273, 6.340968132019043, 7.283361911773682, 6.877123832702637, 7.462204933166504, 6.267393589019775, 7.152576923370361, 7.226396560668945, 6.23606538772583, 6.164315223693848, 6.636984825134277, 6.799387454986572, 6.143096923828125, 6.3576250076293945, 6.900614261627197, 6.896353244781494, 6.762550354003906, 6.365729331970215, 6.605469703674316, 6.966172218322754, 6.663233757019043, 7.560583114624023, 7.503026962280273, 7.445258617401123, 6.671399116516113, 7.016953945159912, 6.734779357910156, 7.700819969177246, 7.188633918762207, 7.2184906005859375, 6.071505546569824, 6.446505546569824, 7.499101161956787, 6.760817050933838, 6.210184574127197, 6.5106658935546875, 6.3750200271606445, 7.017533779144287, 7.177342414855957, 6.4325151443481445, 6.49810791015625, 7.19114875793457, 6.45517635345459, 6.564432621002197, 7.184837341308594, 6.044544696807861, 5.962254524230957, 6.452370643615723, 7.286643981933594, 7.334708213806152, 6.581582546234131, 6.248659133911133, 6.559546947479248, 6.304025650024414, 6.560337543487549, 7.709877014160156, 6.639662742614746, 6.005822658538818, 7.445363998413086, 6.746557235717773, 7.032153129577637, 6.9484968185424805, 6.729769229888916, 7.482461929321289, 8.010509490966797, 6.532054901123047, 6.116683483123779, 7.16351318359375, 6.469245910644531, 6.210634708404541, 6.339600563049316, 6.293762683868408, 7.134552955627441, 6.739670276641846, 7.251227378845215, 6.897220611572266, 6.0411272048950195, 6.234082221984863, 7.807558059692383, 6.699583053588867, 7.685096740722656, 6.658204555511475, 6.271007537841797], "mean_td_error": 6.760645389556885, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.464359283447266, "actor_loss": -7.563479423522949, "critic_loss": 4.7349467277526855, "alpha_loss": -0.1455533504486084, "alpha_value": 0.9892479777336121, "log_alpha_value": -0.010810269974172115, "target_entropy": -8.0, "policy_t": 0.030712947249412537, "mean_q": 2.257303476333618, "max_q": 4.040342330932617, "min_q": 1.3410683870315552}, "td_error": [6.79047966003418, 6.690496444702148, 7.255134582519531, 6.298011302947998, 7.053304672241211, 6.0950469970703125, 7.792910575866699, 6.981857776641846, 7.059901237487793, 7.799074172973633, 6.571455001831055, 6.449245452880859, 7.36961555480957, 6.7598114013671875, 6.702696800231934, 6.00913143157959, 6.694028854370117, 6.1483683586120605, 6.234990119934082, 6.507370948791504, 6.975805282592773, 6.772934436798096, 6.241374969482422, 7.338776588439941, 7.60092306137085, 6.52094841003418, 6.689342975616455, 6.063229084014893, 5.629746437072754, 6.606453895568848, 5.726927757263184, 6.434725761413574, 6.659045219421387, 6.756291389465332, 6.448027610778809, 6.962017059326172, 6.260074138641357, 5.817380428314209, 6.00772762298584, 7.067169666290283, 6.179110527038574, 6.612903118133545, 5.790858268737793, 6.892556190490723, 6.239964962005615, 5.820451736450195, 6.176032543182373, 5.822315216064453, 6.278292655944824, 5.908843040466309, 6.567950248718262, 6.847379684448242, 6.5989909172058105, 6.741233825683594, 7.2273125648498535, 6.444955825805664, 6.965800762176514, 6.133564472198486, 7.323664665222168, 6.210305690765381, 6.101621627807617, 6.427208423614502, 6.8420491218566895, 6.767714500427246, 6.451148986816406, 6.652844429016113, 5.447961807250977, 6.216291904449463, 6.323427200317383, 6.964333534240723, 6.879116058349609, 5.867947578430176, 6.554884433746338, 6.568056106567383, 7.092782497406006, 6.125999927520752, 6.767495155334473, 6.565861701965332, 6.367172718048096, 6.195538520812988, 5.96389102935791, 6.869282245635986, 6.257169246673584, 5.295167446136475, 7.007732391357422, 6.659188747406006, 7.045013427734375, 6.478967666625977, 6.634756565093994, 6.737390518188477, 6.3138885498046875, 7.163631439208984, 5.826614856719971, 6.136615753173828, 6.027379989624023, 6.4980340003967285, 5.952597618103027, 6.483199119567871, 6.265595436096191, 6.2137579917907715, 7.445265769958496, 6.214301109313965, 5.5165839195251465, 5.891357421875, 6.798612594604492, 6.288257122039795, 5.503202438354492, 7.091780662536621, 6.974720001220703, 5.839178085327148, 7.180048942565918, 5.910671234130859, 5.857009410858154, 5.1852006912231445, 6.876675605773926, 6.413459777832031, 6.626613616943359, 7.184869766235352, 6.421147346496582, 6.388979434967041, 6.37239933013916, 6.00693416595459, 6.899096488952637, 7.169700622558594, 5.871433258056641, 5.69384241104126, 6.4695587158203125, 6.9567718505859375], "mean_td_error": 6.4896979331970215, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 8800, "num_env_steps_trained": 9472, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 9472, "last_target_update_ts": 8800, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 9472, "num_env_steps_sampled": 8800, "num_env_steps_trained": 9472, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 364.0848593038575, "num_env_steps_trained_throughput_per_sec": 466.0286199089376, "timesteps_total": 8800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17600, "timers": {"training_iteration_time_ms": 514.693, "sample_time_ms": 281.06, "load_time_ms": 0.825, "load_throughput": 310312.07, "learn_time_ms": 35.273, "learn_throughput": 7257.714, "synch_weights_time_ms": 11.21}, "counters": {"num_env_steps_sampled": 8800, "num_env_steps_trained": 9472, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 9472, "last_target_update_ts": 8800, "num_target_updates": 37}, "done": false, "episodes_total": 16, "training_iteration": 20, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-36", "timestamp": 1742591196, "time_this_iter_s": 1.1165859699249268, "time_total_s": 23.12864875793457, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFDE960940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 23.12864875793457, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 31.3, "ram_util_percent": 92.1}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.526552200317383, "actor_loss": -7.624422550201416, "critic_loss": 4.549357891082764, "alpha_loss": -0.1543748676776886, "alpha_value": 0.9886521697044373, "log_alpha_value": -0.011412727646529675, "target_entropy": -8.0, "policy_t": -0.013001222163438797, "mean_q": 2.2824597358703613, "max_q": 3.9641244411468506, "min_q": 1.4639410972595215}, "td_error": [6.654145240783691, 6.905900001525879, 5.73432731628418, 5.986209869384766, 6.559803485870361, 6.04807186126709, 5.508080005645752, 6.14180850982666, 6.941743850708008, 6.239920616149902, 6.803079605102539, 6.818338871002197, 6.229981899261475, 6.770630359649658, 7.31714391708374, 6.153545379638672, 6.046970367431641, 6.598491668701172, 5.7768988609313965, 6.207221984863281, 6.292781829833984, 6.17110013961792, 5.971399784088135, 6.431056499481201, 6.032159805297852, 6.2106451988220215, 6.219887733459473, 7.2165961265563965, 6.385239601135254, 6.634566783905029, 6.1918463706970215, 7.320673942565918, 7.126979351043701, 6.425939559936523, 6.571267127990723, 6.95972204208374, 6.325346946716309, 6.888949871063232, 5.61551570892334, 5.66656494140625, 5.997341156005859, 7.0186567306518555, 6.168768405914307, 5.724033832550049, 6.978893756866455, 6.888919830322266, 5.936827182769775, 6.695206642150879, 6.750558853149414, 5.983541488647461, 6.023433208465576, 7.2652177810668945, 6.404722213745117, 6.566012859344482, 7.100193500518799, 5.97894811630249, 5.92902135848999, 6.688590049743652, 6.823723316192627, 5.820704936981201, 5.862469673156738, 7.922718524932861, 6.608028888702393, 5.6106858253479, 6.459197044372559, 5.707701683044434, 5.619701385498047, 5.874366283416748, 7.789574146270752, 7.523117542266846, 5.839766502380371, 5.578304290771484, 6.153162479400635, 7.326892852783203, 6.907894134521484, 6.605254173278809, 7.743038177490234, 6.627322196960449, 6.061562538146973, 7.675257205963135, 5.615778923034668, 6.346617698669434, 7.289549350738525, 6.628389835357666, 6.6393208503723145, 5.502507209777832, 6.765625953674316, 6.63538122177124, 6.2611894607543945, 6.451240062713623, 6.081366539001465, 6.1144561767578125, 6.072539329528809, 6.4644775390625, 6.002452850341797, 5.845370769500732, 6.323028564453125, 5.7655839920043945, 7.672023773193359, 6.453581809997559, 6.435174942016602, 7.569350242614746, 6.714302062988281, 7.652186393737793, 6.1916656494140625, 6.46318244934082, 6.134143829345703, 6.65016508102417, 7.448565483093262, 6.931755065917969, 5.961712837219238, 6.912911415100098, 6.355926036834717, 6.905529975891113, 5.982702732086182, 5.641901969909668, 6.574038028717041, 6.550843715667725, 5.037273406982422, 7.274927139282227, 6.686883926391602, 6.615672588348389, 7.401237487792969, 6.575772285461426, 6.509846210479736, 6.245682716369629, 6.540825843811035, 6.617615222930908], "mean_td_error": 6.467595100402832, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.3945951461792, "actor_loss": -7.876900672912598, "critic_loss": 4.468802452087402, "alpha_loss": -0.1528402417898178, "alpha_value": 0.9886542558670044, "log_alpha_value": -0.011410589329898357, "target_entropy": -8.0, "policy_t": -0.002736765891313553, "mean_q": 2.6013004779815674, "max_q": 4.797281265258789, "min_q": 1.7172118425369263}, "td_error": [5.901085376739502, 6.315381050109863, 5.489572525024414, 6.378477096557617, 6.2111639976501465, 7.0271501541137695, 6.485440731048584, 5.796637058258057, 5.372463703155518, 6.327064514160156, 5.880565643310547, 5.5610270500183105, 4.9939165115356445, 7.223829746246338, 6.843695640563965, 5.873225212097168, 5.572812080383301, 5.37137508392334, 5.471246719360352, 6.1670684814453125, 6.2239580154418945, 5.761359214782715, 6.752037048339844, 6.3841447830200195, 5.043978214263916, 7.116053104400635, 5.661212921142578, 6.364160537719727, 5.762815475463867, 5.888677597045898, 4.588249206542969, 6.294698238372803, 6.7544450759887695, 6.312282562255859, 5.378316879272461, 5.088085174560547, 6.216975688934326, 5.764095306396484, 6.22020149230957, 5.328897476196289, 6.506597518920898, 5.500446319580078, 6.527749538421631, 6.116360187530518, 6.129929542541504, 6.268411159515381, 6.370874881744385, 7.602458477020264, 6.730986595153809, 6.184225082397461, 6.70698356628418, 6.531556129455566, 6.007545471191406, 5.181343078613281, 5.7122697830200195, 4.9495062828063965, 5.826521396636963, 6.306556701660156, 6.011176109313965, 6.671803951263428, 5.721623420715332, 5.864457130432129, 5.854856491088867, 5.741639137268066, 7.111661911010742, 6.319126129150391, 6.736546516418457, 5.975671768188477, 6.099438667297363, 6.2857842445373535, 6.808834075927734, 7.144891262054443, 6.312607765197754, 6.083789348602295, 5.858712673187256, 6.368751049041748, 5.314536094665527, 6.23997688293457, 6.269504547119141, 6.280480861663818, 6.3375091552734375, 7.39262580871582, 7.005602836608887, 7.091063022613525, 5.7311248779296875, 6.121339321136475, 6.117575645446777, 6.159733295440674, 6.982700347900391, 6.739614486694336, 6.657562255859375, 6.551266670227051, 5.958588600158691, 5.798415184020996, 6.111817359924316, 6.531111240386963, 6.286101818084717, 5.814493179321289, 5.846392631530762, 5.018176555633545, 5.356686115264893, 5.853653430938721, 6.300020217895508, 6.374555587768555, 5.504202842712402, 6.263417720794678, 6.313518524169922, 6.7817583084106445, 6.298340320587158, 5.750598907470703, 6.342514514923096, 5.308394908905029, 5.627534866333008, 6.108865737915039, 4.92213249206543, 6.063531875610352, 5.950081825256348, 5.809927940368652, 5.722159385681152, 5.993214130401611, 6.520420551300049, 5.279227256774902, 6.678179740905762, 5.807482719421387, 5.449236869812012, 4.872773170471191, 6.044753551483154, 5.377871036529541], "mean_td_error": 6.080718040466309, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 9200, "num_env_steps_trained": 9984, "num_agent_steps_sampled": 18400, "num_agent_steps_trained": 9984, "last_target_update_ts": 9200, "num_target_updates": 39}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18400, "num_agent_steps_trained": 9984, "num_env_steps_sampled": 9200, "num_env_steps_trained": 9984, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 355.5418420123532, "num_env_steps_trained_throughput_per_sec": 455.0935577758121, "timesteps_total": 9200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18400, "timers": {"training_iteration_time_ms": 526.125, "sample_time_ms": 285.228, "load_time_ms": 0.825, "load_throughput": 310312.07, "learn_time_ms": 36.138, "learn_throughput": 7083.898, "synch_weights_time_ms": 10.082}, "counters": {"num_env_steps_sampled": 9200, "num_env_steps_trained": 9984, "num_agent_steps_sampled": 18400, "num_agent_steps_trained": 9984, "last_target_update_ts": 9200, "num_target_updates": 39}, "done": false, "episodes_total": 16, "training_iteration": 21, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-38", "timestamp": 1742591198, "time_this_iter_s": 1.1500024795532227, "time_total_s": 24.278651237487793, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A25040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 24.278651237487793, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 44.75, "ram_util_percent": 92.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.438730239868164, "actor_loss": -7.872778415679932, "critic_loss": 4.5334625244140625, "alpha_loss": -0.16144773364067078, "alpha_value": 0.9880582690238953, "log_alpha_value": -0.012013616971671581, "target_entropy": -8.0, "policy_t": -0.006194386165589094, "mean_q": 2.576817512512207, "max_q": 4.757805824279785, "min_q": 1.60100257396698}, "td_error": [6.050193786621094, 5.741795063018799, 6.610698223114014, 6.19290828704834, 6.804678916931152, 5.156284332275391, 6.892768383026123, 6.634570598602295, 6.019261360168457, 6.566347122192383, 6.245582580566406, 6.235123634338379, 5.674805641174316, 6.712073802947998, 6.127363681793213, 4.797794342041016, 6.868921279907227, 6.170821189880371, 6.539142608642578, 5.481939792633057, 5.36689567565918, 6.7210540771484375, 6.785443305969238, 5.378829002380371, 6.208831310272217, 6.9301228523254395, 5.901459693908691, 6.377813816070557, 6.270687103271484, 6.593790054321289, 5.516809940338135, 5.840829372406006, 6.752013206481934, 5.791376113891602, 6.267300605773926, 6.532793998718262, 6.497276306152344, 6.364818572998047, 6.179607391357422, 6.628897666931152, 5.809057235717773, 6.619452476501465, 5.929625034332275, 5.66168737411499, 6.257911205291748, 6.2837934494018555, 6.1418538093566895, 5.426137924194336, 6.397692680358887, 7.09932279586792, 7.149260520935059, 5.646927356719971, 5.262062072753906, 5.559717178344727, 6.191218376159668, 4.9732666015625, 6.444253921508789, 6.259934902191162, 6.442290306091309, 6.296687126159668, 5.9349446296691895, 6.29937744140625, 5.593851566314697, 5.884610652923584, 6.372054576873779, 7.906808853149414, 6.145654678344727, 5.840394973754883, 5.434122562408447, 5.581021308898926, 5.999636650085449, 6.2638773918151855, 5.4282073974609375, 6.4968671798706055, 6.541152000427246, 6.377544403076172, 5.931711196899414, 6.173295974731445, 5.132320404052734, 6.504000663757324, 6.343649864196777, 6.40923547744751, 7.14969539642334, 5.710533142089844, 5.740819931030273, 5.850913047790527, 5.814908027648926, 7.151855945587158, 6.087697505950928, 6.237025260925293, 5.814662933349609, 5.599695205688477, 5.798947811126709, 6.213037490844727, 6.572479248046875, 5.621100902557373, 6.523270606994629, 6.9132232666015625, 6.747105598449707, 6.565554618835449, 6.128691673278809, 5.937108993530273, 4.558106899261475, 6.419180870056152, 6.007024765014648, 5.922234535217285, 6.3087358474731445, 5.033785820007324, 5.147947788238525, 5.74778938293457, 5.793413162231445, 6.97206449508667, 5.9473466873168945, 5.370821475982666, 6.410163879394531, 5.999776840209961, 6.479397773742676, 5.417876243591309, 6.082723617553711, 7.529583930969238, 6.160943984985352, 6.015349388122559, 7.1168718338012695, 6.542196273803711, 6.43367862701416, 8.893083572387695, 5.95713996887207, 6.494872570037842], "mean_td_error": 6.170443058013916, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.44759750366211, "actor_loss": -8.245206832885742, "critic_loss": 4.1912078857421875, "alpha_loss": -0.1615157276391983, "alpha_value": 0.9880610704421997, "log_alpha_value": -0.012010750360786915, "target_entropy": -8.0, "policy_t": -0.0037763016298413277, "mean_q": 2.9888370037078857, "max_q": 5.063507080078125, "min_q": 1.6363128423690796}, "td_error": [5.485072135925293, 6.393508434295654, 5.663829803466797, 5.848296165466309, 5.970775604248047, 4.711230754852295, 5.839850425720215, 6.868289470672607, 5.128274917602539, 6.464978218078613, 5.309492588043213, 6.590190410614014, 6.434540748596191, 4.599508285522461, 5.177958011627197, 5.397544860839844, 5.8437700271606445, 6.06130313873291, 5.159144878387451, 4.6230950355529785, 5.759129524230957, 5.165557861328125, 4.712581634521484, 5.923380374908447, 5.221650123596191, 5.783142566680908, 5.183266639709473, 6.332183361053467, 5.826468467712402, 4.7446393966674805, 6.067625045776367, 6.389044761657715, 5.8384904861450195, 6.143007278442383, 5.607368469238281, 5.116744041442871, 6.025269508361816, 5.337741374969482, 4.562096118927002, 5.454251289367676, 5.521209716796875, 5.948199272155762, 5.866909980773926, 6.250148773193359, 6.24526834487915, 6.0846710205078125, 5.1524248123168945, 4.982921600341797, 7.3019819259643555, 5.642446517944336, 6.7422194480896, 5.113644599914551, 5.59055757522583, 5.480996131896973, 4.883465766906738, 5.117669105529785, 5.341564178466797, 5.683903217315674, 5.610480308532715, 4.958975791931152, 6.341099739074707, 5.448147773742676, 5.781750679016113, 6.286179542541504, 5.273578643798828, 6.047126293182373, 6.1434125900268555, 5.988358974456787, 6.417599678039551, 5.9218292236328125, 6.334900379180908, 5.716339111328125, 5.404351711273193, 4.958010196685791, 7.105173587799072, 7.223620891571045, 6.972969055175781, 5.501972675323486, 4.726727485656738, 5.334328651428223, 5.947110652923584, 6.423356533050537, 4.958393096923828, 6.867584228515625, 6.315944671630859, 5.668035507202148, 5.480579853057861, 5.385153293609619, 6.920229911804199, 5.949318885803223, 6.838637828826904, 4.764794826507568, 5.961179733276367, 5.522210121154785, 5.043685436248779, 4.913715362548828, 4.798102378845215, 5.417971611022949, 5.258444786071777, 6.405660152435303, 6.387119293212891, 5.884191989898682, 4.386140823364258, 5.753787994384766, 4.4672651290893555, 5.290122985839844, 4.930200099945068, 7.177241325378418, 5.893559455871582, 4.652149677276611, 5.56857967376709, 6.179207801818848, 5.1918182373046875, 4.58663272857666, 5.6691999435424805, 6.49483585357666, 6.559255599975586, 5.665365219116211, 5.203027725219727, 6.844778060913086, 5.276310920715332, 5.9295973777771, 6.3415021896362305, 4.3817033767700195, 6.7191267013549805, 6.072694301605225, 5.770528316497803, 6.253443717956543], "mean_td_error": 5.715476036071777, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 9600, "num_env_steps_trained": 10496, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 10496, "last_target_update_ts": 9600, "num_target_updates": 41}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.809454402504, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1906.644065294685, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3830.453519697189, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.809454402504, "robot_1": 1906.644065294685}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.793064846313355, "mean_inference_ms": 3.46107962272099, "mean_action_processing_ms": 0.4672091449182558, "mean_env_wait_ms": 0.4744441886004642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.13502538204193115}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 10496, "num_env_steps_sampled": 9600, "num_env_steps_trained": 10496, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 287.43588799105, "num_env_steps_trained_throughput_per_sec": 367.91793662854394, "timesteps_total": 9600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19200, "timers": {"training_iteration_time_ms": 564.892, "sample_time_ms": 289.856, "load_time_ms": 0.825, "load_throughput": 310312.07, "learn_time_ms": 38.682, "learn_throughput": 6618.044, "synch_weights_time_ms": 11.553}, "counters": {"num_env_steps_sampled": 9600, "num_env_steps_trained": 10496, "num_agent_steps_sampled": 19200, "num_agent_steps_trained": 10496, "last_target_update_ts": 9600, "num_target_updates": 41}, "done": false, "episodes_total": 16, "training_iteration": 22, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-39", "timestamp": 1742591199, "time_this_iter_s": 1.4002201557159424, "time_total_s": 25.678871393203735, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AD7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 25.678871393203735, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.2, "ram_util_percent": 92.80000000000001}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.7766160340839, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.0955377565388, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.453912734985352, "actor_loss": -8.403911590576172, "critic_loss": 4.033914566040039, "alpha_loss": -0.17375454306602478, "alpha_value": 0.9871682524681091, "log_alpha_value": -0.01291479729115963, "target_entropy": -8.0, "policy_t": 0.003686925396323204, "mean_q": 3.179185390472412, "max_q": 5.731695652008057, "min_q": 1.8503031730651855}, "td_error": [6.401092529296875, 4.0883941650390625, 4.336969375610352, 4.359212875366211, 5.434028625488281, 3.7027103900909424, 3.4260597229003906, 6.4633307456970215, 7.545744895935059, 5.35603141784668, 6.190640926361084, 4.964396953582764, 6.022265434265137, 5.718260288238525, 5.822495460510254, 7.324802875518799, 5.588250160217285, 5.556281566619873, 5.573103904724121, 5.168310165405273, 5.254673004150391, 4.29127311706543, 6.800168037414551, 5.061371803283691, 5.84080171585083, 6.051405906677246, 6.74622917175293, 6.60575532913208, 5.681241035461426, 4.2280473709106445, 6.044562339782715, 5.450714111328125, 5.9980058670043945, 6.042664527893066, 4.893684387207031, 6.320882797241211, 5.788658142089844, 5.280183792114258, 5.638421058654785, 6.7384257316589355, 4.891310691833496, 4.87361478805542, 4.49286413192749, 5.402505397796631, 4.925260543823242, 6.571691989898682, 6.459012031555176, 5.999509811401367, 5.118592262268066, 6.055130481719971, 5.4557037353515625, 6.934694290161133, 5.056484699249268, 5.707015037536621, 6.197556972503662, 6.089588165283203, 5.062954425811768, 4.179388999938965, 5.734559059143066, 5.078413009643555, 6.148080825805664, 4.801558494567871, 6.348104476928711, 5.601456165313721, 6.375577926635742, 4.964180946350098, 5.381387710571289, 5.819978713989258, 5.280098915100098, 5.704523086547852, 5.482709884643555, 5.7926740646362305, 6.545567512512207, 6.058357238769531, 5.593633651733398, 6.50247859954834, 5.032303333282471, 4.944772720336914, 4.457816123962402, 4.23485803604126, 6.055670738220215, 5.663067817687988, 5.440947532653809, 6.213007926940918, 6.543315887451172, 5.56317663192749, 4.240222930908203, 5.866052627563477, 5.076516151428223, 5.670705795288086, 4.50515079498291, 4.973010063171387, 6.715183258056641, 4.401046276092529, 6.473031997680664, 5.502836227416992, 4.967238426208496, 5.146185398101807, 5.361431121826172, 5.4065446853637695, 6.087613105773926, 5.359043598175049, 6.350701332092285, 4.977683067321777, 5.710603713989258, 4.960171222686768, 5.084308624267578, 5.388970375061035, 5.3904571533203125, 4.014435768127441, 5.727606773376465, 5.728605270385742, 5.790988922119141, 5.65745735168457, 6.071680068969727, 4.167877674102783, 6.788817405700684, 5.3645124435424805, 6.202126979827881, 4.875204086303711, 5.076258659362793, 4.674288749694824, 7.256376266479492, 5.185830116271973, 5.0369768142700195, 5.616735458374023, 5.134903907775879, 5.082368850708008], "mean_td_error": 5.528925895690918, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.477815628051758, "actor_loss": -8.94608211517334, "critic_loss": 3.6186532974243164, "alpha_loss": -0.1740131825208664, "alpha_value": 0.9871718883514404, "log_alpha_value": -0.012911083176732063, "target_entropy": -8.0, "policy_t": -0.013868805021047592, "mean_q": 3.70099139213562, "max_q": 6.211440086364746, "min_q": 2.2936787605285645}, "td_error": [5.883670806884766, 5.7737812995910645, 4.123340606689453, 5.0751237869262695, 4.631952285766602, 4.965996742248535, 5.372074127197266, 5.596470832824707, 5.679431915283203, 4.937474250793457, 6.21673583984375, 6.303167343139648, 5.168204307556152, 6.252479076385498, 5.062469482421875, 4.753933906555176, 5.7709197998046875, 4.653321266174316, 5.072896957397461, 6.563478469848633, 3.670872211456299, 4.788025856018066, 4.238198280334473, 4.76484489440918, 5.22899866104126, 5.042446136474609, 5.058411598205566, 6.024012565612793, 5.088817596435547, 5.0782470703125, 4.880393028259277, 6.022680282592773, 4.918534278869629, 4.901909828186035, 4.174911975860596, 4.225378513336182, 5.0481672286987305, 4.068423748016357, 4.330877304077148, 6.660599708557129, 5.9245452880859375, 4.109619140625, 4.687307357788086, 4.3467607498168945, 3.9733121395111084, 6.010736465454102, 5.814575672149658, 4.754303932189941, 5.554163455963135, 4.7591400146484375, 5.355040550231934, 4.891210556030273, 4.4460954666137695, 5.555530071258545, 5.5136260986328125, 5.547394275665283, 5.185914993286133, 5.084846496582031, 4.450374603271484, 4.343016147613525, 5.098610877990723, 4.966921806335449, 5.766567230224609, 5.025979995727539, 4.6896162033081055, 4.61552619934082, 4.688660144805908, 4.712319374084473, 3.9391069412231445, 5.858213901519775, 3.8208277225494385, 4.97041654586792, 5.151338577270508, 5.031301498413086, 5.221793174743652, 5.900031566619873, 5.179838180541992, 5.258521556854248, 5.55365514755249, 5.394492149353027, 3.8058557510375977, 5.983759880065918, 5.659018516540527, 5.937256813049316, 5.886409759521484, 4.518049716949463, 4.509461879730225, 5.593984603881836, 6.306844711303711, 6.023232936859131, 4.740699768066406, 4.236863613128662, 5.086668014526367, 3.5325005054473877, 4.8271965980529785, 3.774111747741699, 4.6234564781188965, 4.795109748840332, 5.687925815582275, 5.205370903015137, 5.711606979370117, 5.286718368530273, 3.734123706817627, 5.26366662979126, 4.946284294128418, 5.520193099975586, 4.938509941101074, 6.37672758102417, 5.663402557373047, 5.115938186645508, 4.628389358520508, 4.123757362365723, 4.296533584594727, 5.926386833190918, 3.898237466812134, 4.146750450134277, 5.990585803985596, 4.026477813720703, 5.063150405883789, 3.652482032775879, 4.546727180480957, 5.039407253265381, 5.897357940673828, 5.774601459503174, 5.30602502822876, 4.398475646972656, 4.492910385131836, 6.363468647003174], "mean_td_error": 5.063168525695801, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 10200, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 20400, "num_agent_steps_trained": 11264, "last_target_update_ts": 10200, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3831.8721537906226, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.7766160340839, "robot_1": 1908.0955377565388}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.7766160340839, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.0955377565388, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7871324107241099, "mean_inference_ms": 3.4561986291529925, "mean_action_processing_ms": 0.4686216149034264, "mean_env_wait_ms": 0.4765476878504087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025707483291625977, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10802030563354492}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3831.8721537906226, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.7766160340839, "robot_1": 1908.0955377565388}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7871324107241099, "mean_inference_ms": 3.4561986291529925, "mean_action_processing_ms": 0.4686216149034264, "mean_env_wait_ms": 0.4765476878504087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025707483291625977, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10802030563354492}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20400, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 10200, "num_env_steps_trained": 11264, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 421.1604569637978, "num_env_steps_trained_throughput_per_sec": 539.0853849136612, "timesteps_total": 10200, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 20400, "timers": {"training_iteration_time_ms": 556.513, "sample_time_ms": 284.846, "load_time_ms": 0.825, "load_throughput": 310312.07, "learn_time_ms": 38.778, "learn_throughput": 6601.658, "synch_weights_time_ms": 12.411}, "counters": {"num_env_steps_sampled": 10200, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 20400, "num_agent_steps_trained": 11264, "last_target_update_ts": 10200, "num_target_updates": 44}, "done": false, "episodes_total": 20, "training_iteration": 23, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-41", "timestamp": 1742591201, "time_this_iter_s": 1.4412705898284912, "time_total_s": 27.120141983032227, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AD7EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 27.120141983032227, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.35, "ram_util_percent": 92.8}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.7766160340839, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.0955377565388, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.443460464477539, "actor_loss": -8.932235717773438, "critic_loss": 3.521538734436035, "alpha_loss": -0.18573243916034698, "alpha_value": 0.9862791895866394, "log_alpha_value": -0.013815819285809994, "target_entropy": -8.0, "policy_t": -0.02864936552941799, "mean_q": 3.7226979732513428, "max_q": 6.3178510665893555, "min_q": 2.160524845123291}, "td_error": [4.309049606323242, 5.374817848205566, 4.323751449584961, 4.581147193908691, 3.4024550914764404, 5.3159379959106445, 4.518315315246582, 4.349278926849365, 4.513157844543457, 4.332891464233398, 5.753853797912598, 4.542945861816406, 5.890491962432861, 5.079546928405762, 4.218677043914795, 5.887219429016113, 5.099571228027344, 7.609536170959473, 5.164883613586426, 5.239949703216553, 5.60693359375, 5.8377532958984375, 5.152831077575684, 4.190503120422363, 4.890226364135742, 4.65435791015625, 4.673333168029785, 4.7065348625183105, 4.79818058013916, 4.49403190612793, 5.868974685668945, 4.329289436340332, 4.483761310577393, 4.812700271606445, 3.2554993629455566, 5.584300994873047, 4.22464656829834, 5.159846782684326, 5.060359954833984, 5.512946128845215, 5.167255401611328, 4.5911173820495605, 5.416104316711426, 5.4042463302612305, 5.059926986694336, 5.255603790283203, 5.780782699584961, 5.853714942932129, 3.801931619644165, 3.7885959148406982, 5.052177906036377, 4.260134696960449, 3.821434736251831, 5.110442161560059, 4.600368976593018, 3.882859230041504, 5.550473213195801, 6.570404052734375, 4.9005537033081055, 5.018941879272461, 5.234582901000977, 4.55401611328125, 5.356539726257324, 5.175451755523682, 5.7121782302856445, 4.3454179763793945, 5.621970176696777, 5.869869232177734, 4.874788284301758, 5.331907272338867, 4.692741394042969, 5.394861698150635, 5.097780227661133, 4.716610908508301, 4.901839256286621, 5.234845161437988, 5.2708611488342285, 3.3951754570007324, 4.723674774169922, 4.478477954864502, 3.561722755432129, 5.5704731941223145, 5.21265983581543, 4.691090106964111, 6.807384490966797, 4.71058988571167, 6.144402503967285, 4.352242469787598, 6.672713279724121, 6.0243144035339355, 4.899103164672852, 5.044466018676758, 5.277451515197754, 5.207258224487305, 3.8268394470214844, 5.241554260253906, 3.6238555908203125, 5.15179443359375, 5.561173439025879, 5.032318115234375, 5.294340133666992, 5.906981468200684, 4.693283557891846, 5.917886734008789, 6.303684711456299, 4.850588321685791, 2.470940589904785, 5.0731892585754395, 4.5588579177856445, 4.2514448165893555, 4.876012802124023, 4.746700286865234, 4.962250232696533, 5.330403804779053, 3.6264877319335938, 4.439541816711426, 4.454498767852783, 4.336902141571045, 5.054758548736572, 4.26666784286499, 4.933955192565918, 5.595621109008789, 4.398560523986816, 5.427358627319336, 5.85207986831665, 6.761770248413086, 4.278757095336914, 5.315619468688965], "mean_td_error": 4.970840930938721, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.463275909423828, "actor_loss": -9.71402645111084, "critic_loss": 3.0799155235290527, "alpha_loss": -0.18594947457313538, "alpha_value": 0.9862833619117737, "log_alpha_value": -0.013811606913805008, "target_entropy": -8.0, "policy_t": 0.02674119919538498, "mean_q": 4.435393810272217, "max_q": 7.786063194274902, "min_q": 2.7010271549224854}, "td_error": [3.9633374214172363, 4.470932960510254, 5.149989128112793, 4.983475685119629, 5.136342525482178, 3.8480100631713867, 4.043972492218018, 5.525517463684082, 5.756427764892578, 4.081738471984863, 4.098708629608154, 4.867046356201172, 3.844627618789673, 4.870473384857178, 4.8095903396606445, 2.7296555042266846, 3.5582125186920166, 4.151981353759766, 2.8491687774658203, 5.1091742515563965, 4.099059581756592, 3.4206016063690186, 5.295419216156006, 2.472635507583618, 2.4178831577301025, 4.382735252380371, 4.933826923370361, 4.7841644287109375, 3.937721014022827, 4.437243461608887, 4.494590759277344, 3.3772988319396973, 3.715423107147217, 3.7055063247680664, 4.941349506378174, 4.933108329772949, 4.386477470397949, 3.9961578845977783, 3.120431423187256, 4.956075191497803, 5.736303329467773, 4.3097920417785645, 4.255517482757568, 5.082837104797363, 4.241657257080078, 4.720739841461182, 4.896634101867676, 4.216982841491699, 4.569680213928223, 4.464254379272461, 4.139900207519531, 1.6257200241088867, 4.115172386169434, 4.897609710693359, 4.751330375671387, 2.932178020477295, 4.301609039306641, 2.638838291168213, 2.3245224952697754, 5.471125602722168, 4.400805950164795, 2.9229538440704346, 4.040173530578613, 4.358249664306641, 4.75179386138916, 5.051112174987793, 5.158614158630371, 3.506342887878418, 3.691041946411133, 6.026636123657227, 4.554145336151123, 3.5916807651519775, 5.621946334838867, 4.808190822601318, 4.5719404220581055, 2.3348028659820557, 5.0714640617370605, 4.867977142333984, 5.021105766296387, 5.188595771789551, 4.969111442565918, 6.011386871337891, 3.71467924118042, 4.8421149253845215, 2.44887638092041, 4.483603477478027, 4.9806060791015625, 4.977906227111816, 2.221158027648926, 5.08349609375, 5.007067680358887, 4.977458953857422, 5.527751922607422, 4.64968204498291, 4.421292304992676, 2.010676383972168, 4.59614372253418, 2.79211688041687, 3.087705135345459, 5.115473747253418, 3.3480477333068848, 5.1429290771484375, 4.448302268981934, 4.739041328430176, 4.090259075164795, 4.242825984954834, 5.876723289489746, 3.7102341651916504, 4.633837699890137, 5.004284858703613, 3.744645595550537, 2.0192768573760986, 2.3762049674987793, 4.716045379638672, 4.29677677154541, 4.3755669593811035, 5.026304721832275, 4.645498275756836, 5.277775287628174, 5.202810287475586, 5.785973072052002, 4.394708156585693, 4.6982245445251465, 4.787747859954834, 4.778567314147949, 4.329891681671143, 4.955281734466553, 4.615350723266602], "mean_td_error": 4.328668117523193, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 10800, "num_env_steps_trained": 12032, "num_agent_steps_sampled": 21600, "num_agent_steps_trained": 12032, "last_target_update_ts": 10800, "num_target_updates": 47}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3831.8721537906226, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.7766160340839, "robot_1": 1908.0955377565388}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.7766160340839, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.0955377565388, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7871324107241099, "mean_inference_ms": 3.4561986291529925, "mean_action_processing_ms": 0.4686216149034264, "mean_env_wait_ms": 0.4765476878504087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025707483291625977, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10802030563354492}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3831.8721537906226, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.7766160340839, "robot_1": 1908.0955377565388}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7871324107241099, "mean_inference_ms": 3.4561986291529925, "mean_action_processing_ms": 0.4686216149034264, "mean_env_wait_ms": 0.4765476878504087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025707483291625977, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10802030563354492}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21600, "num_agent_steps_trained": 12032, "num_env_steps_sampled": 10800, "num_env_steps_trained": 12032, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 428.6225681596573, "num_env_steps_trained_throughput_per_sec": 548.6368872443613, "timesteps_total": 10800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 21600, "timers": {"training_iteration_time_ms": 534.113, "sample_time_ms": 274.021, "load_time_ms": 0.83, "load_throughput": 308564.235, "learn_time_ms": 37.74, "learn_throughput": 6783.315, "synch_weights_time_ms": 10.777}, "counters": {"num_env_steps_sampled": 10800, "num_env_steps_trained": 12032, "num_agent_steps_sampled": 21600, "num_agent_steps_trained": 12032, "last_target_update_ts": 10800, "num_target_updates": 47}, "done": false, "episodes_total": 20, "training_iteration": 24, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-42", "timestamp": 1742591202, "time_this_iter_s": 1.4166078567504883, "time_total_s": 28.536749839782715, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A25040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 28.536749839782715, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.450000000000003, "ram_util_percent": 92.8}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.7766160340839, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.0955377565388, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.477254867553711, "actor_loss": -9.763751983642578, "critic_loss": 3.0641660690307617, "alpha_loss": -0.1983392834663391, "alpha_value": 0.9853911399841309, "log_alpha_value": -0.01471659354865551, "target_entropy": -8.0, "policy_t": -0.007162637077271938, "mean_q": 4.601576328277588, "max_q": 7.943000316619873, "min_q": 3.0837645530700684}, "td_error": [5.189347743988037, 4.541989326477051, 5.172929763793945, 4.586002826690674, 4.4008073806762695, 3.8003623485565186, 4.483758926391602, 3.9052786827087402, 5.711239814758301, 2.739978313446045, 2.3986480236053467, 6.038839340209961, 4.288079738616943, 4.448695182800293, 4.096522808074951, 5.510614395141602, 4.222726345062256, 4.711480617523193, 3.8729655742645264, 2.2619004249572754, 4.6629228591918945, 4.044234752655029, 2.6554043292999268, 3.8537399768829346, 4.167936325073242, 3.9343910217285156, 3.9510231018066406, 5.130988121032715, 5.0565266609191895, 2.6416492462158203, 4.306002616882324, 2.7273967266082764, 3.3831169605255127, 5.0687456130981445, 5.899774551391602, 0.8374378681182861, 2.1494176387786865, 4.275543212890625, 3.5211424827575684, 5.262607574462891, 4.472400665283203, 3.8333425521850586, 5.18125057220459, 2.2438459396362305, 5.421726226806641, 5.347043991088867, 4.96914005279541, 4.940631866455078, 3.527834892272949, 5.183314323425293, 3.6667017936706543, 3.6143670082092285, 4.26926326751709, 1.5927133560180664, 3.7232091426849365, 4.500380516052246, 4.766701698303223, 4.1194071769714355, 1.9426345825195312, 3.0033655166625977, 3.4493355751037598, 5.37760066986084, 4.212996482849121, 4.11140251159668, 4.332455635070801, 4.336657524108887, 4.459789752960205, 4.921289443969727, 4.2090935707092285, 5.319517135620117, 3.4628255367279053, 3.7086031436920166, 5.18622350692749, 4.5295820236206055, 4.714385986328125, 5.787912845611572, 3.1825833320617676, 5.525591850280762, 3.0151476860046387, 3.1094117164611816, 2.8007278442382812, 3.8709607124328613, 3.844101905822754, 4.190672874450684, 4.02874755859375, 2.446560859680176, 5.433560371398926, 3.489957332611084, 3.777076244354248, 5.2542524337768555, 3.5612478256225586, 4.746277809143066, 4.701009750366211, 4.898087501525879, 3.437411308288574, 4.316092491149902, 3.78365159034729, 3.699472188949585, 4.229125022888184, 5.169093608856201, 4.9802374839782715, 4.572997093200684, 4.069878578186035, 4.560774803161621, 3.924403667449951, 2.1007039546966553, 5.9524736404418945, 3.9167497158050537, 4.042593002319336, 2.257763385772705, 3.8423736095428467, 3.4235098361968994, 4.522273540496826, 4.5508856773376465, 2.940685510635376, 4.351078987121582, 4.353320121765137, 5.649658203125, 5.831222057342529, 5.011129379272461, 5.11862850189209, 4.206443786621094, 4.308169364929199, 5.32664680480957, 3.5556159019470215, 3.8812689781188965, 4.923275947570801, 4.974305152893066], "mean_td_error": 4.171960830688477, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.511190414428711, "actor_loss": -10.287313461303711, "critic_loss": 2.5363681316375732, "alpha_loss": -0.1987800896167755, "alpha_value": 0.9853954315185547, "log_alpha_value": -0.014712255448102951, "target_entropy": -8.0, "policy_t": 0.016126718372106552, "mean_q": 5.029674530029297, "max_q": 8.669076919555664, "min_q": 3.3830087184906006}, "td_error": [5.161279201507568, 3.5148379802703857, 4.579883575439453, 3.2148032188415527, 3.249894380569458, 1.6433556079864502, 3.260939598083496, 3.7962160110473633, 3.5695865154266357, 4.579612731933594, 4.253330230712891, 3.71870756149292, 1.835268497467041, 3.889676332473755, 4.007988929748535, 4.68146276473999, 3.716602325439453, 3.512840747833252, 3.6602389812469482, 3.415424108505249, 4.777905464172363, 3.931896448135376, 4.657346725463867, 3.6680922508239746, 1.396883249282837, 4.5033369064331055, 4.851790428161621, 4.548912048339844, 4.207444190979004, 4.123371124267578, 2.9252147674560547, 4.264983177185059, 3.0564143657684326, 1.7486748695373535, 4.886109828948975, 3.3010387420654297, 3.672623634338379, 3.7156734466552734, 4.896733283996582, 1.9750304222106934, 4.02262544631958, 3.6563808917999268, 3.9459471702575684, 3.3218982219696045, 3.1352806091308594, 4.4724249839782715, 1.5974154472351074, 3.636500597000122, 3.5895724296569824, 4.380306243896484, 2.3037331104278564, 4.393771648406982, 4.000912666320801, 3.5112266540527344, 2.1526501178741455, 4.536057472229004, 4.812332630157471, 1.5977354049682617, 2.911515235900879, 3.61599063873291, 3.6850924491882324, 5.1139421463012695, 3.9571475982666016, 3.6154327392578125, 3.509432792663574, 1.687086582183838, 3.3509650230407715, 4.110333442687988, 3.6690104007720947, 4.501530647277832, 3.27881121635437, 4.487139701843262, 5.240550994873047, 3.7664055824279785, 3.375990867614746, 4.372588157653809, 3.964290142059326, 4.166056156158447, 2.4412617683410645, 3.0478336811065674, 2.685941457748413, 3.0392045974731445, 3.773787021636963, 3.881350040435791, 4.763846397399902, 3.5710246562957764, 3.317760705947876, 5.5538010597229, 4.0489301681518555, 3.753852605819702, 3.32670521736145, 3.4799234867095947, 4.260372161865234, 4.261678695678711, 3.0515666007995605, 3.5339462757110596, 1.9674959182739258, 2.697767972946167, 4.078488826751709, 4.082361221313477, 2.375454902648926, 2.9494881629943848, 3.945751190185547, 2.8612515926361084, 3.4733517169952393, 3.838470220565796, 3.793870687484741, 2.269955635070801, 3.5966835021972656, 2.6290173530578613, 3.757248878479004, 5.177858352661133, 4.324073791503906, 4.257193565368652, 3.40753436088562, 3.5035929679870605, 3.6150341033935547, 2.9899346828460693, 4.5097503662109375, 4.5919904708862305, 4.342185974121094, 2.5774121284484863, 4.790835857391357, 4.184683322906494, 4.4022674560546875, 1.4642164707183838, 1.9477264881134033, 4.256563186645508], "mean_td_error": 3.642732858657837, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 49.0}}, "num_env_steps_sampled": 11400, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 22800, "num_agent_steps_trained": 12800, "last_target_update_ts": 11400, "num_target_updates": 50}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3831.8721537906226, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.7766160340839, "robot_1": 1908.0955377565388}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1923.7766160340839, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.0955377565388, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7871324107241099, "mean_inference_ms": 3.4561986291529925, "mean_action_processing_ms": 0.4686216149034264, "mean_env_wait_ms": 0.4765476878504087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025707483291625977, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10802030563354492}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3831.8721537906226, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1923.7766160340839, "robot_1": 1908.0955377565388}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7871324107241099, "mean_inference_ms": 3.4561986291529925, "mean_action_processing_ms": 0.4686216149034264, "mean_env_wait_ms": 0.4765476878504087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025707483291625977, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10802030563354492}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 11400, "num_env_steps_trained": 12800, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 406.77949006247536, "num_env_steps_trained_throughput_per_sec": 520.6777472799685, "timesteps_total": 11400, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 22800, "timers": {"training_iteration_time_ms": 489.11, "sample_time_ms": 264.911, "load_time_ms": 0.83, "load_throughput": 308564.235, "learn_time_ms": 36.076, "learn_throughput": 7096.061, "synch_weights_time_ms": 11.581}, "counters": {"num_env_steps_sampled": 11400, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 22800, "num_agent_steps_trained": 12800, "last_target_update_ts": 11400, "num_target_updates": 50}, "done": false, "episodes_total": 20, "training_iteration": 25, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-44", "timestamp": 1742591204, "time_this_iter_s": 1.4915287494659424, "time_total_s": 30.028278589248657, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AD7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 30.028278589248657, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.2, "ram_util_percent": 92.85}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.489245414733887, "actor_loss": -10.5846586227417, "critic_loss": 1.8516721725463867, "alpha_loss": -0.2106657326221466, "alpha_value": 0.984503984451294, "log_alpha_value": -0.01561731193214655, "target_entropy": -8.0, "policy_t": -0.03614484891295433, "mean_q": 5.438417911529541, "max_q": 9.30118465423584, "min_q": 3.2917160987854004}, "td_error": [4.04927396774292, 5.042943954467773, 2.6695077419281006, 2.5007972717285156, 4.129742622375488, 2.4712095260620117, 1.1765437126159668, 4.123086929321289, 3.8053739070892334, 4.204392910003662, 3.5618038177490234, 4.116985321044922, 1.37034273147583, 4.186358451843262, 2.1527609825134277, 3.450592517852783, 3.3401315212249756, 3.4834065437316895, 3.903602123260498, 3.604767322540283, 3.280447483062744, 5.923310279846191, 2.042868137359619, 4.029461860656738, 4.84874153137207, 3.1756889820098877, 2.1475727558135986, 4.003408432006836, 2.9540910720825195, 2.7255470752716064, 4.153395175933838, 3.564121723175049, 2.5906128883361816, 0.19483423233032227, 2.105512857437134, 2.2989649772644043, 3.486875295639038, 2.290839672088623, 3.753077268600464, 0.7332353591918945, 3.2122445106506348, 2.8612823486328125, 2.307236433029175, 4.420830726623535, 4.310565948486328, 3.805631637573242, 4.453160762786865, 4.252023696899414, 1.4539613723754883, 4.519855499267578, 2.4382057189941406, 2.4311366081237793, 3.25993275642395, 3.2576563358306885, 2.4716567993164062, 4.0166802406311035, 2.392184019088745, 5.101241588592529, 3.635019063949585, 4.244872570037842, 2.651609420776367, 5.225411891937256, 3.725661277770996, 3.6102471351623535, 2.5749611854553223, 3.659766435623169, 1.8531618118286133, 2.8134822845458984, 1.9694499969482422, 3.0374975204467773, 3.4534895420074463, 2.9060542583465576, 3.501671075820923, 0.8279953002929688, 3.0197606086730957, 2.64290189743042, 3.3490312099456787, 5.026518821716309, 3.4932703971862793, 4.714101791381836, 3.1839470863342285, 4.945028781890869, 3.962826728820801, 3.063603401184082, 0.950995922088623, 3.793867349624634, 1.8540453910827637, 3.460630178451538, 4.727262496948242, 3.4135079383850098, 3.607257843017578, 3.9967856407165527, 1.9610564708709717, 3.347937822341919, 4.370035171508789, 4.616911888122559, 5.282331466674805, 3.92116641998291, 3.4135961532592773, 5.271917819976807, 4.029473304748535, 2.4595017433166504, 2.8973352909088135, 3.104238986968994, 4.061252117156982, 3.982245922088623, 2.7482991218566895, 3.0854907035827637, 5.496208190917969, 4.496567726135254, 3.9233312606811523, 3.366408348083496, 2.748223304748535, 2.974276304244995, 4.389269828796387, 3.2339789867401123, 3.6549735069274902, 2.669461488723755, 3.7317843437194824, 3.374642848968506, 4.043216705322266, 4.155612945556641, 4.269830703735352, 4.151493549346924, 3.2081098556518555, 3.0852560997009277, 0.8732390403747559, 3.8866384029388428], "mean_td_error": 3.373380422592163, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.482311248779297, "actor_loss": -11.105151176452637, "critic_loss": 1.0458464622497559, "alpha_loss": -0.21049880981445312, "alpha_value": 0.9845082759857178, "log_alpha_value": -0.015612959861755371, "target_entropy": -8.0, "policy_t": 0.023557929322123528, "mean_q": 5.9076056480407715, "max_q": 10.206901550292969, "min_q": 3.65853214263916}, "td_error": [2.0718791484832764, 3.8039257526397705, 2.7602286338806152, 2.5401721000671387, 3.7513608932495117, 3.01151180267334, 2.266097068786621, 3.356106996536255, 2.0914759635925293, 3.053776979446411, 4.394333839416504, 2.9855518341064453, 2.671710968017578, 2.8451240062713623, 2.7457032203674316, 3.188770294189453, 3.265216827392578, 1.86240553855896, 0.6494083404541016, 3.059021472930908, 3.278327465057373, 3.1412570476531982, 3.2175509929656982, 5.651398658752441, 2.6989026069641113, 3.4823129177093506, 3.080061197280884, 2.712418556213379, 1.4421396255493164, 2.1545615196228027, 1.0073091983795166, 1.1286702156066895, 3.556295156478882, 3.57334303855896, 1.6556260585784912, 3.3198554515838623, 3.3454856872558594, 0.32128095626831055, 2.8395729064941406, 4.419778823852539, 4.823440074920654, 3.3165338039398193, 4.018638610839844, 1.8837072849273682, 2.523585796356201, 3.581162452697754, 3.135573148727417, 3.4597291946411133, 3.2219977378845215, 2.719698429107666, 3.896123170852661, 3.197218894958496, 4.482453346252441, 3.4274961948394775, 3.4283764362335205, 3.4849905967712402, 2.952244520187378, 2.761025905609131, 2.6980624198913574, 2.9412214756011963, 1.4946846961975098, 1.106872320175171, 3.506618022918701, 2.05753231048584, 2.6404366493225098, 0.1471247673034668, 2.1030375957489014, 2.4686808586120605, 0.3381309509277344, 3.746181011199951, 2.3443548679351807, 2.527430295944214, 2.692108392715454, 3.146392822265625, 2.615300178527832, 2.682644844055176, 2.6948609352111816, 2.5465946197509766, 2.5717713832855225, 0.37988758087158203, 3.5523455142974854, 3.11539363861084, 3.360051155090332, 4.176219940185547, 0.6897034645080566, 3.1956446170806885, 3.389726161956787, 2.8779139518737793, 3.0864968299865723, 2.039076328277588, 2.5013041496276855, 4.173078536987305, 2.6283938884735107, 3.4012584686279297, 2.394333839416504, 3.723637342453003, 3.3331971168518066, 2.6889657974243164, 2.07814621925354, 2.0801541805267334, 3.799304246902466, 2.717679023742676, 3.792726993560791, 1.6370666027069092, 2.7012789249420166, 3.7176852226257324, 3.7517638206481934, 3.5672686100006104, 3.7702701091766357, 2.6438865661621094, 2.4348294734954834, 2.353405475616455, 2.799685478210449, 3.3101911544799805, 4.152728080749512, 3.735262155532837, 3.043567180633545, 3.262779951095581, 4.043335914611816, 4.688766956329346, 3.0731003284454346, 2.100407123565674, 2.182065486907959, 2.3873069286346436, 3.071683168411255, 2.2966129779815674, 3.1052932739257812, 3.2845067977905273], "mean_td_error": 2.87557315826416, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 13568, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 13568, "last_target_update_ts": 12000, "num_target_updates": 53}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 13568, "num_env_steps_sampled": 12000, "num_env_steps_trained": 13568, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 418.61507736764696, "num_env_steps_trained_throughput_per_sec": 535.827299030588, "timesteps_total": 12000, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 479.142, "sample_time_ms": 263.272, "load_time_ms": 0.83, "load_throughput": 308564.235, "learn_time_ms": 35.086, "learn_throughput": 7296.41, "synch_weights_time_ms": 9.886}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 13568, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 13568, "last_target_update_ts": 12000, "num_target_updates": 53}, "done": false, "episodes_total": 24, "training_iteration": 26, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-45", "timestamp": 1742591205, "time_this_iter_s": 1.4500823020935059, "time_total_s": 31.478360891342163, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A7D790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 31.478360891342163, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 24.933333333333334, "ram_util_percent": 92.96666666666665}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.452947616577148, "actor_loss": -11.338518142700195, "critic_loss": 0.9339412450790405, "alpha_loss": -0.22221580147743225, "alpha_value": 0.9836176633834839, "log_alpha_value": -0.0165180005133152, "target_entropy": -8.0, "policy_t": 0.018737800419330597, "mean_q": 6.25876522064209, "max_q": 11.386820793151855, "min_q": 3.9900355339050293}, "td_error": [1.3841261863708496, 2.1543822288513184, 2.4297287464141846, 2.4736924171447754, 2.616292953491211, 3.3977880477905273, 1.7830872535705566, 1.4563558101654053, 2.965961217880249, 2.4118714332580566, 2.45829176902771, 3.249011516571045, 1.8759572505950928, 0.9819016456604004, 2.9750118255615234, 2.4800150394439697, 1.0102136135101318, 3.223825693130493, 0.9546618461608887, 3.611830234527588, 3.6343681812286377, 2.9990835189819336, 2.8296117782592773, 3.654149293899536, 1.6237154006958008, 1.1172425746917725, 3.568187713623047, 2.6241233348846436, 4.057243347167969, 2.7309277057647705, 2.819316864013672, 0.9999098777770996, 3.519597053527832, 2.955479145050049, 1.5482652187347412, 1.323127031326294, 2.231093406677246, 2.158153772354126, 3.3463518619537354, 2.211228132247925, 3.327439546585083, 1.3686890602111816, 2.3407487869262695, 2.803745985031128, 2.822753429412842, 3.1148786544799805, 3.3028693199157715, 1.9990360736846924, 0.40338659286499023, 2.711193323135376, 0.4564800262451172, 2.270859479904175, 2.973797082901001, 1.3825132846832275, 1.99835205078125, 1.2742500305175781, 2.367443084716797, 2.919743061065674, 0.18859100341796875, 2.4049203395843506, 3.578169107437134, 3.78289532661438, 1.5974106788635254, 1.8078947067260742, 2.159275531768799, 2.656128168106079, 4.017318248748779, 4.568743705749512, 1.1734132766723633, 2.0124433040618896, 2.472073554992676, 2.8499364852905273, 0.7928118705749512, 2.2177677154541016, 3.6487131118774414, 3.144073009490967, 2.044529914855957, 3.003483772277832, 3.5345425605773926, 3.1678104400634766, 2.3090925216674805, 2.866675853729248, 2.348595142364502, 1.846222162246704, 2.795736312866211, 3.0462448596954346, 3.0892112255096436, 2.8605189323425293, 1.2468996047973633, 3.087985038757324, 3.7838377952575684, 4.257088661193848, 3.2691640853881836, 1.6387748718261719, 1.8809373378753662, 1.1163301467895508, 2.6537678241729736, 0.9018464088439941, 1.2881343364715576, 2.4863667488098145, 2.9486541748046875, 2.4824395179748535, 2.2088122367858887, 1.534614086151123, 1.3473832607269287, 3.6829960346221924, 3.9322128295898438, 2.3412115573883057, 2.478724241256714, 2.5861968994140625, 3.172818422317505, 3.6155223846435547, 2.4068682193756104, 1.128370761871338, 2.7168660163879395, 1.6023423671722412, 2.2726550102233887, 1.787154197692871, 2.680783748626709, 1.9909229278564453, 4.556081295013428, 4.337640762329102, 2.908250093460083, 2.025132656097412, 2.0396902561187744, 4.4562602043151855, 3.307011604309082, 2.6778407096862793], "mean_td_error": 2.4883217811584473, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.433298110961914, "actor_loss": -12.196016311645508, "critic_loss": 0.7183355093002319, "alpha_loss": -0.22183293104171753, "alpha_value": 0.9836219549179077, "log_alpha_value": -0.016513660550117493, "target_entropy": -8.0, "policy_t": -0.0008661583997309208, "mean_q": 7.035820007324219, "max_q": 13.473055839538574, "min_q": 4.420562744140625}, "td_error": [2.8149991035461426, 2.5604934692382812, 1.52486252784729, 1.3201067447662354, 1.9321613311767578, 1.6515889167785645, 3.213127374649048, 2.862407684326172, 0.9246311187744141, 1.7304654121398926, 1.0124728679656982, 2.230196952819824, 2.437178134918213, 2.730985164642334, 1.7106549739837646, 2.9353561401367188, 3.000114917755127, 1.7147088050842285, 2.9733569622039795, 1.2284109592437744, 3.4573333263397217, 1.0127286911010742, 1.3466715812683105, 1.8730769157409668, 2.918112277984619, 2.45512056350708, 2.4544363021850586, 0.286740779876709, 2.837826728820801, 2.4338796138763428, 2.995399236679077, 2.408456802368164, 2.000369071960449, 2.8056392669677734, 2.97066068649292, 3.1294124126434326, 1.6359343528747559, 3.368621826171875, 2.968813419342041, 1.7745962142944336, 2.82422137260437, 3.244861364364624, 2.412609100341797, 2.3778223991394043, 0.8908658027648926, 2.0329275131225586, 1.7692975997924805, 1.4257643222808838, 1.1959848403930664, 2.743191719055176, 1.5096209049224854, 3.6358442306518555, 2.522778034210205, 3.0139713287353516, 2.8505990505218506, 1.0859589576721191, 1.89011812210083, 1.12233567237854, 1.848008632659912, 0.7195038795471191, 1.9876725673675537, 1.8286218643188477, 2.5012383460998535, 3.0803050994873047, 0.5499386787414551, 1.467552661895752, 2.8850107192993164, 0.45166778564453125, 1.0666751861572266, 4.148581027984619, 2.8179855346679688, 2.9907214641571045, 2.6210341453552246, 3.020146131515503, 0.5391380786895752, 2.2869927883148193, 2.7767229080200195, 2.2494006156921387, 2.9185616970062256, 2.382392406463623, 3.7167396545410156, 0.38797664642333984, 3.2501673698425293, 0.1411147117614746, 2.4756808280944824, 3.3459668159484863, 2.909207582473755, 3.1585853099823, 2.611307144165039, 1.1071884632110596, 1.2825517654418945, 0.4645686149597168, 2.0310897827148438, 1.7188315391540527, 2.9688026905059814, 2.7544028759002686, 3.7091410160064697, 1.4018969535827637, 2.4173874855041504, 1.6842422485351562, 1.5136055946350098, 3.0953404903411865, 3.878462314605713, 0.40485286712646484, 1.3544135093688965, 2.509971857070923, 3.5558364391326904, 0.48036813735961914, 2.539462089538574, 1.0665645599365234, 2.4292025566101074, 0.4109630584716797, 2.063591241836548, 3.1024746894836426, 1.6691625118255615, 3.1885557174682617, 0.11373710632324219, 2.2134995460510254, 0.5755047798156738, 1.811086654663086, 2.088153839111328, 0.47323036193847656, 2.5101113319396973, 1.8027801513671875, 2.0117597579956055, 0.9725732803344727, 3.5045523643493652, 1.8627839088439941], "mean_td_error": 2.125532627105713, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 12600, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 14336, "last_target_update_ts": 12600, "num_target_updates": 56}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 12600, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 416.23331193105753, "num_env_steps_trained_throughput_per_sec": 532.7786392717536, "timesteps_total": 12600, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 25200, "timers": {"training_iteration_time_ms": 481.651, "sample_time_ms": 265.578, "load_time_ms": 0.83, "load_throughput": 308564.235, "learn_time_ms": 34.236, "learn_throughput": 7477.545, "synch_weights_time_ms": 10.061}, "counters": {"num_env_steps_sampled": 12600, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 25200, "num_agent_steps_trained": 14336, "last_target_update_ts": 12600, "num_target_updates": 56}, "done": false, "episodes_total": 24, "training_iteration": 27, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-47", "timestamp": 1742591207, "time_this_iter_s": 1.4582633972167969, "time_total_s": 32.93662428855896, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFDE960940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 32.93662428855896, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 29.15, "ram_util_percent": 92.95}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.36630630493164, "actor_loss": -11.828450202941895, "critic_loss": 0.8205726146697998, "alpha_loss": -0.22880998253822327, "alpha_value": 0.9830272793769836, "log_alpha_value": -0.017118416726589203, "target_entropy": -8.0, "policy_t": -0.025120556354522705, "mean_q": 6.632339954376221, "max_q": 11.815411567687988, "min_q": 4.489254951477051}, "td_error": [1.9930315017700195, 0.35946226119995117, 2.0363729000091553, 1.8399527072906494, 1.9833974838256836, 2.465569496154785, 0.8971853256225586, 2.4115536212921143, 2.1999409198760986, 1.19319486618042, 3.070221185684204, 3.166386365890503, 3.036668062210083, 1.0713410377502441, 1.2328109741210938, 3.0806472301483154, 2.6776537895202637, 1.8924188613891602, 0.919910192489624, 3.6201987266540527, 2.8198044300079346, 2.5190651416778564, 1.587630271911621, 0.703763484954834, 1.9437229633331299, 3.2401161193847656, 2.347446918487549, 2.44431734085083, 2.768130302429199, 2.8166093826293945, 2.742872953414917, 0.3886713981628418, 2.057176113128662, 2.960451602935791, 1.906902551651001, 1.3879797458648682, 2.1879897117614746, 1.288078784942627, 1.6688954830169678, 1.3624188899993896, 2.559504985809326, 1.529710292816162, 1.9633686542510986, 1.2135169506072998, 1.9952375888824463, 4.310855865478516, 1.6025564670562744, 2.404233694076538, 0.6447203159332275, 1.0787739753723145, 3.052579164505005, 2.150956869125366, 3.89735746383667, 2.404242753982544, 2.428757905960083, 2.2567691802978516, 3.624459743499756, 2.4793169498443604, 3.155029058456421, 2.4046058654785156, 1.9965507984161377, 2.9536757469177246, 1.5680112838745117, 2.86126446723938, 2.2422258853912354, 3.358469009399414, 3.1231749057769775, 2.3398075103759766, 0.5538787841796875, 1.1214079856872559, 2.116431474685669, 3.192660331726074, 2.80389404296875, 0.2827434539794922, 1.6291048526763916, 2.758176326751709, 2.383331537246704, 2.1716434955596924, 1.715407133102417, 2.761727809906006, 3.272073268890381, 1.3682937622070312, 0.34262728691101074, 1.6221861839294434, 2.1951708793640137, 0.6388225555419922, 3.3662779331207275, 3.1807377338409424, 1.8234834671020508, 3.2051174640655518, 2.631911516189575, 1.5101768970489502, 2.7834279537200928, 1.0779287815093994, 1.9631984233856201, 2.293156862258911, 0.9814610481262207, 1.4998109340667725, 2.814044952392578, 1.1838293075561523, 3.1466920375823975, 1.7377471923828125, 3.7975471019744873, 3.2565817832946777, 3.29772686958313, 0.36337709426879883, 4.288759231567383, 1.9241104125976562, 2.288548231124878, 3.624725580215454, 2.567466974258423, 1.6715810298919678, 2.1289098262786865, 1.7071051597595215, 0.6776485443115234, 3.546165943145752, 1.7328038215637207, 1.1585280895233154, 3.075218677520752, 2.3225502967834473, 3.0177268981933594, 1.5313260555267334, 3.629990577697754, 1.4411735534667969, 1.9789776802062988, 3.262502670288086, 3.1036393642425537, 2.3545596599578857], "mean_td_error": 2.2013087272644043, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.431622505187988, "actor_loss": -12.665956497192383, "critic_loss": 0.48858895897865295, "alpha_loss": -0.22986875474452972, "alpha_value": 0.9830316305160522, "log_alpha_value": -0.017113998532295227, "target_entropy": -8.0, "policy_t": 0.021236857399344444, "mean_q": 7.527329444885254, "max_q": 13.034053802490234, "min_q": 4.971522808074951}, "td_error": [2.4456143379211426, 2.224576711654663, 1.5577220916748047, 2.914947748184204, 1.0618078708648682, 1.1380414962768555, 1.5195817947387695, 1.4585118293762207, 0.8254661560058594, 0.6867225170135498, 2.4297852516174316, 1.587733507156372, 3.0024240016937256, 1.63728666305542, 0.26259422302246094, 2.9836299419403076, 0.8564083576202393, 0.9553754329681396, 2.2339272499084473, 2.092705726623535, 0.3961677551269531, 0.8160321712493896, 2.334519863128662, 1.9937949180603027, 0.4770209789276123, 2.644425868988037, 1.9795286655426025, 0.7122924327850342, 1.2912895679473877, 1.0355331897735596, 2.612619400024414, 2.5550131797790527, 0.7966418266296387, 2.0506598949432373, 1.9184370040893555, 1.9125897884368896, 1.7042920589447021, 1.3520169258117676, 0.5407943725585938, 1.9222898483276367, 1.313988208770752, 0.309354305267334, 1.6663079261779785, 2.5429375171661377, 3.0376806259155273, 2.136721611022949, 2.0187106132507324, 1.5973057746887207, 3.2802672386169434, 1.52774977684021, 0.3631591796875, 1.869262933731079, 0.7971267700195312, 0.4321455955505371, 0.8682923316955566, 0.7909595966339111, 0.23245644569396973, 0.3079962730407715, 0.5847625732421875, 1.8065478801727295, 2.340104103088379, 0.6187305450439453, 0.48047828674316406, 0.7705860137939453, 1.022566795349121, 1.4234490394592285, 0.7223243713378906, 1.0606963634490967, 2.2821221351623535, 3.528506278991699, 1.9658522605895996, 2.569025993347168, 1.9908428192138672, 2.789262533187866, 0.23521947860717773, 0.892876148223877, 1.8597640991210938, 2.4187300205230713, 1.4818754196166992, 2.484454393386841, 2.823784112930298, 2.3785295486450195, 1.1389315128326416, 1.3832299709320068, 2.0214974880218506, 0.2468705177307129, 1.4760501384735107, 2.090653896331787, 0.5236468315124512, 3.0929150581359863, 1.1572279930114746, 2.080756187438965, 1.019423007965088, 2.2381584644317627, 0.8333749771118164, 1.6994283199310303, 2.4841320514678955, 1.9971885681152344, 2.70881986618042, 1.6497504711151123, 0.8210206031799316, 0.32979607582092285, 1.1108157634735107, 2.7552409172058105, 2.586913824081421, 1.8300888538360596, 0.730475664138794, 0.2322678565979004, 3.5562727451324463, 0.4748101234436035, 2.5495777130126953, 0.981393575668335, 2.6493425369262695, 0.18972063064575195, 2.254659414291382, 1.1846592426300049, 2.3423709869384766, 0.830848217010498, 2.9302875995635986, 1.291210651397705, 1.6777257919311523, 1.3391203880310059, 1.57029390335083, 1.6969401836395264, 2.2591633796691895, 1.9417126178741455, 2.1111674308776855, 1.755256175994873], "mean_td_error": 1.6122620105743408, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 13000, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 14848, "last_target_update_ts": 13000, "num_target_updates": 58}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 14848, "num_env_steps_sampled": 13000, "num_env_steps_trained": 14848, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 362.00125405269176, "num_env_steps_trained_throughput_per_sec": 463.3616051874455, "timesteps_total": 13000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 497.767, "sample_time_ms": 271.995, "load_time_ms": 0.103, "load_throughput": 2477484.596, "learn_time_ms": 36.416, "learn_throughput": 7029.807, "synch_weights_time_ms": 10.615}, "counters": {"num_env_steps_sampled": 13000, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 14848, "last_target_update_ts": 13000, "num_target_updates": 58}, "done": false, "episodes_total": 24, "training_iteration": 28, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-48", "timestamp": 1742591208, "time_this_iter_s": 1.1209945678710938, "time_total_s": 34.057618856430054, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 34.057618856430054, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 35.9, "ram_util_percent": 90.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.4239501953125, "actor_loss": -12.754670143127441, "critic_loss": 0.489109605550766, "alpha_loss": -0.23785050213336945, "alpha_value": 0.9824376702308655, "log_alpha_value": -0.017718369141221046, "target_entropy": -8.0, "policy_t": 0.025501780211925507, "mean_q": 7.691629886627197, "max_q": 14.231721878051758, "min_q": 4.97692346572876}, "td_error": [0.8586030006408691, 0.3548707962036133, 2.2813496589660645, 1.1698565483093262, 2.7002618312835693, 0.5399227142333984, 3.5559215545654297, 1.17476224899292, 1.9127562046051025, 0.8397848606109619, 0.3245840072631836, 1.1670372486114502, 1.7883775234222412, 2.9993622303009033, 1.1549532413482666, 1.2644360065460205, 2.226747751235962, 2.2761311531066895, 1.0909290313720703, 2.543656587600708, 0.9073677062988281, 2.8495280742645264, 1.3002889156341553, 1.2580945491790771, 2.5651869773864746, 1.4404857158660889, 1.4085464477539062, 2.6379730701446533, 0.08810067176818848, 2.93465256690979, 2.437242031097412, 3.2938220500946045, 1.8361868858337402, 3.136366605758667, 0.7901232242584229, 1.7971551418304443, 2.722656726837158, 0.4769437313079834, 2.796082019805908, 0.92795729637146, 2.0233681201934814, 1.4133799076080322, 1.1782474517822266, 0.13090848922729492, 0.6418883800506592, 1.8904433250427246, 1.5177240371704102, 0.6151947975158691, 0.8375990390777588, 0.8160367012023926, 1.0525445938110352, 1.490530252456665, 1.1588985919952393, 2.4138646125793457, 1.5552082061767578, 2.3470988273620605, 1.3069729804992676, 0.38269567489624023, 1.0723907947540283, 2.263979911804199, 3.1519246101379395, 0.7186994552612305, 0.840761661529541, 2.756749391555786, 1.7008435726165771, 2.4228878021240234, 0.48637819290161133, 1.7756433486938477, 2.099416494369507, 0.9247856140136719, 0.5870966911315918, 2.0823991298675537, 2.095623254776001, 2.185182571411133, 1.8405890464782715, 1.8210067749023438, 1.448394536972046, 4.228538513183594, 1.5787391662597656, 0.6261534690856934, 1.8868308067321777, 1.947293996810913, 1.6311781406402588, 4.167583465576172, 1.1028461456298828, 1.2225375175476074, 0.7593467235565186, 0.8353331089019775, 1.6781816482543945, 1.2125978469848633, 1.327375888824463, 0.43829846382141113, 2.5041091442108154, 1.8049499988555908, 1.0193347930908203, 0.014058113098144531, 2.553709030151367, 1.2975132465362549, 1.02003812789917, 0.8996143341064453, 1.0437238216400146, 1.2793891429901123, 0.49065589904785156, 1.537229299545288, 0.34082937240600586, 2.7786903381347656, 1.2661945819854736, 1.4782226085662842, 1.063380241394043, 1.0835530757904053, 0.4162559509277344, 1.3944828510284424, 1.8297176361083984, 0.11458349227905273, 0.5134072303771973, 1.1758317947387695, 0.8063538074493408, 2.6545398235321045, 2.3845889568328857, 2.6138415336608887, 1.875906229019165, 0.32677483558654785, 1.962024450302124, 1.594975471496582, 2.310016393661499, 2.3543529510498047, 1.581061840057373, 2.4801576137542725], "mean_td_error": 1.5733073949813843, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.35503101348877, "actor_loss": -13.206035614013672, "critic_loss": 0.5159202218055725, "alpha_loss": -0.2365736961364746, "alpha_value": 0.982441782951355, "log_alpha_value": -0.01771419867873192, "target_entropy": -8.0, "policy_t": -0.02104238048195839, "mean_q": 8.127016067504883, "max_q": 14.524918556213379, "min_q": 4.649875164031982}, "td_error": [1.1265835762023926, 1.7329728603363037, 1.7748830318450928, 3.262709140777588, 1.4399876594543457, 1.5965816974639893, 1.0467629432678223, 0.9199185371398926, 0.8640623092651367, 0.30043745040893555, 2.6560232639312744, 2.4963176250457764, 0.4602632522583008, 2.4681150913238525, 1.6302900314331055, 1.3233599662780762, 0.5440058708190918, 1.474623680114746, 0.9175431728363037, 2.489107131958008, 0.8805456161499023, 0.4150843620300293, 0.975252628326416, 0.1922588348388672, 2.026042938232422, 0.18701553344726562, 0.5867919921875, 0.9446487426757812, 1.3001484870910645, 0.734260082244873, 0.5865921974182129, 4.027423858642578, 3.621924877166748, 1.5792183876037598, 2.124544143676758, 1.3440117835998535, 2.7574515342712402, 3.099881410598755, 1.2242484092712402, 2.194775104522705, 1.3363213539123535, 3.1001477241516113, 3.070936679840088, 0.6996951103210449, 3.570486307144165, 1.4622502326965332, 0.819857120513916, 1.553515911102295, 0.5333099365234375, 4.109118938446045, 1.4792795181274414, 0.7949352264404297, 4.488891124725342, 2.1434309482574463, 0.5716490745544434, 0.20465898513793945, 0.9353539943695068, 1.7562475204467773, 0.764369010925293, 2.814948081970215, 1.5210511684417725, 1.3621938228607178, 0.7769131660461426, 0.8730721473693848, 2.835425853729248, 1.1825523376464844, 0.1134028434753418, 1.490687370300293, 1.111828088760376, 1.821666955947876, 0.5885601043701172, 3.4127495288848877, 1.4371998310089111, 1.5348949432373047, 0.08932304382324219, 1.7790355682373047, 0.050624847412109375, 2.513073444366455, 1.6862835884094238, 1.5741581916809082, 0.20026826858520508, 3.3385260105133057, 2.9797310829162598, 1.918212890625, 0.7526206970214844, 1.75331711769104, 1.3694334030151367, 1.5485005378723145, 0.9968044757843018, 3.403160572052002, 1.3671081066131592, 1.251772403717041, 2.2681853771209717, 0.9584872722625732, 0.5219817161560059, 0.7658488750457764, 0.24018049240112305, 2.331606388092041, 1.2928662300109863, 2.0186333656311035, 0.31831789016723633, 1.5516345500946045, 1.7671799659729004, 1.0762343406677246, 0.18556547164916992, 2.5220530033111572, 1.1611621379852295, 0.3771233558654785, 0.43799924850463867, 0.6490137577056885, 4.560726642608643, 2.6312241554260254, 1.548013687133789, 0.37621593475341797, 3.779604434967041, 2.055635690689087, 2.8263309001922607, 3.2354536056518555, 1.175701379776001, 2.2614645957946777, 0.7432441711425781, 3.7086172103881836, 3.626847267150879, 0.18909382820129395, 2.557187795639038, 2.7759342193603516, 1.2263002395629883, 0.808295726776123], "mean_td_error": 1.6148451566696167, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.0, "diff_num_grad_updates_vs_sampler_policy": 59.0}}, "num_env_steps_sampled": 13400, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 26800, "num_agent_steps_trained": 15360, "last_target_update_ts": 13400, "num_target_updates": 60}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26800, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 13400, "num_env_steps_trained": 15360, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 344.974544138572, "num_env_steps_trained_throughput_per_sec": 441.56741649737216, "timesteps_total": 13400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26800, "timers": {"training_iteration_time_ms": 513.927, "sample_time_ms": 283.404, "load_time_ms": 0.336, "load_throughput": 762546.569, "learn_time_ms": 38.434, "learn_throughput": 6660.694, "synch_weights_time_ms": 9.966}, "counters": {"num_env_steps_sampled": 13400, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 26800, "num_agent_steps_trained": 15360, "last_target_update_ts": 13400, "num_target_updates": 60}, "done": false, "episodes_total": 24, "training_iteration": 29, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-49", "timestamp": 1742591209, "time_this_iter_s": 1.1792490482330322, "time_total_s": 35.236867904663086, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A25430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 35.236867904663086, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 57.6, "ram_util_percent": 85.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.358057022094727, "actor_loss": -13.191079139709473, "critic_loss": 0.32457053661346436, "alpha_loss": -0.2446950525045395, "alpha_value": 0.9818485975265503, "log_alpha_value": -0.018318161368370056, "target_entropy": -8.0, "policy_t": 0.021732978522777557, "mean_q": 8.224371910095215, "max_q": 14.030487060546875, "min_q": 4.821129322052002}, "td_error": [0.8054168224334717, 2.4124152660369873, 1.2795438766479492, 0.5018630027770996, 2.4874775409698486, 2.7496838569641113, 2.0839834213256836, 0.6499698162078857, 1.9517922401428223, 2.19454288482666, 2.074655055999756, 2.95583438873291, 0.6692032814025879, 1.3825962543487549, 1.177032709121704, 1.3055694103240967, 1.7967519760131836, 1.0848851203918457, 0.935394287109375, 0.3702664375305176, 0.6178717613220215, 2.122250556945801, 0.5207295417785645, 1.6741487979888916, 1.0570504665374756, 0.6452529430389404, 2.2320375442504883, 0.7543516159057617, 3.2322182655334473, 1.0722904205322266, 0.6111576557159424, 3.478135824203491, 2.516077756881714, 1.1849803924560547, 2.380373477935791, 1.7630562782287598, 0.2725653648376465, 3.3412017822265625, 0.14994430541992188, 0.5977692604064941, 1.5956978797912598, 0.487515926361084, 1.6213293075561523, 2.763615846633911, 1.4634990692138672, 2.1557202339172363, 1.6804590225219727, 0.6574163436889648, 0.5423769950866699, 0.5502004623413086, 0.4989652633666992, 0.2319345474243164, 1.51804518699646, 2.1336283683776855, 2.038876533508301, 0.8925871849060059, 1.5648541450500488, 1.4741158485412598, 1.7525339126586914, 2.4048476219177246, 1.3182613849639893, 0.37519121170043945, 3.181947708129883, 1.9266119003295898, 0.34223294258117676, 0.9350776672363281, 1.8451731204986572, 2.7004904747009277, 1.3633828163146973, 0.9288058280944824, 2.0906591415405273, 1.2889668941497803, 2.2014267444610596, 3.314155101776123, 1.484020471572876, 1.1031994819641113, 1.0595574378967285, 0.4474773406982422, 0.6673412322998047, 1.336623191833496, 0.5494170188903809, 3.94382381439209, 1.1177687644958496, 1.7166938781738281, 3.726715087890625, 1.3654608726501465, 0.9507846832275391, 1.951974630355835, 1.5084280967712402, 2.384556770324707, 1.067000389099121, 0.7377448081970215, 0.9001688957214355, 2.014665365219116, 2.473783254623413, 0.7250456809997559, 1.8607890605926514, 0.3396615982055664, 3.8564605712890625, 2.034198045730591, 0.6595592498779297, 0.6626591682434082, 1.4652156829833984, 1.1725754737854004, 3.052462100982666, 2.9915404319763184, 2.5968494415283203, 0.22067594528198242, 0.47545385360717773, 1.995915412902832, 0.7786061763763428, 0.7152905464172363, 0.20731163024902344, 0.8145575523376465, 1.028411865234375, 0.5853714942932129, 2.102571487426758, 2.076298713684082, 1.3138747215270996, 2.707174777984619, 0.23282718658447266, 2.925496816635132, 0.934354305267334, 2.9798407554626465, 0.6463265419006348, 1.176504135131836, 0.9825775623321533, 3.450866222381592], "mean_td_error": 1.5250585079193115, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.381135940551758, "actor_loss": -13.5701322555542, "critic_loss": 0.32306480407714844, "alpha_loss": -0.2450607270002365, "alpha_value": 0.9818527698516846, "log_alpha_value": -0.018313895910978317, "target_entropy": -8.0, "policy_t": -0.0139874666929245, "mean_q": 8.426067352294922, "max_q": 14.778847694396973, "min_q": 5.4292755126953125}, "td_error": [0.9060335159301758, 0.6301872730255127, 0.7039897441864014, 0.5272035598754883, 1.10227370262146, 1.0644011497497559, 0.12328553199768066, 1.2322986125946045, 1.0525836944580078, 1.3663794994354248, 1.5287184715270996, 2.018676280975342, 2.587207794189453, 0.9098906517028809, 0.6926028728485107, 2.320509433746338, 1.7717609405517578, 0.39696455001831055, 1.0192205905914307, 0.4119291305541992, 1.0408835411071777, 0.31920433044433594, 0.8641533851623535, 0.9300603866577148, 0.7965044975280762, 1.6624946594238281, 1.8529033660888672, 0.736997127532959, 1.5461750030517578, 0.8989112377166748, 2.0088601112365723, 0.8300070762634277, 0.47937488555908203, 3.3959274291992188, 0.15854167938232422, 3.4299440383911133, 0.9000763893127441, 0.6106038093566895, 0.6299283504486084, 0.44941139221191406, 1.8424537181854248, 0.25808286666870117, 0.5645608901977539, 0.49096059799194336, 1.6098253726959229, 2.8408570289611816, 1.7244234085083008, 3.6547088623046875, 0.10357475280761719, 0.2693824768066406, 0.6742675304412842, 1.4141769409179688, 2.3692400455474854, 0.8237142562866211, 0.6400089263916016, 0.4553956985473633, 2.950838088989258, 1.3278663158416748, 0.20749568939208984, 0.872154712677002, 1.3476829528808594, 0.7945830821990967, 0.5562591552734375, 1.1929147243499756, 2.0872461795806885, 0.446521520614624, 1.2716474533081055, 0.31795358657836914, 0.8930819034576416, 0.17397308349609375, 0.3444352149963379, 4.49755859375, 0.3897562026977539, 0.5723257064819336, 0.28153276443481445, 0.41168713569641113, 0.8971340656280518, 4.304754257202148, 0.4513707160949707, 0.35941195487976074, 1.260103464126587, 0.9596071243286133, 3.539733409881592, 1.7244102954864502, 0.13432550430297852, 2.1698920726776123, 0.4881899356842041, 1.0458168983459473, 1.6484746932983398, 5.028881549835205, 2.086432456970215, 0.24692296981811523, 1.846360206604004, 0.2799081802368164, 1.268221378326416, 1.583019733428955, 0.6585593223571777, 1.259507417678833, 2.2211265563964844, 0.4552626609802246, 2.1651828289031982, 2.4516091346740723, 0.9483482837677002, 1.5106773376464844, 0.4541149139404297, 0.3369593620300293, 0.3123209476470947, 0.9665963649749756, 0.417449951171875, 0.26726245880126953, 0.6090555191040039, 1.5496461391448975, 1.4537582397460938, 0.9411375522613525, 0.1335604190826416, 0.9953141212463379, 0.40018606185913086, 0.9457283020019531, 0.882889986038208, 2.4088447093963623, 1.572977066040039, 0.4318242073059082, 1.3797354698181152, 0.31865930557250977, 1.668867826461792, 0.1448225975036621, 1.0567989349365234, 1.079758644104004], "mean_td_error": 1.1742323637008667, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62.0, "diff_num_grad_updates_vs_sampler_policy": 61.0}}, "num_env_steps_sampled": 13800, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 27600, "num_agent_steps_trained": 15872, "last_target_update_ts": 13800, "num_target_updates": 62}, "sampler_results": {"episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1917.032334339194, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1908.196396853701, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2016.984887258763}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}}, "episode_reward_max": 4085.5011446780477, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3825.2287311928944, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2016.984887258763}, "policy_reward_mean": {"robot_0": 1917.032334339194, "robot_1": 1908.196396853701}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7793026778632663, "mean_inference_ms": 3.4497238645396684, "mean_action_processing_ms": 0.4676280871969863, "mean_env_wait_ms": 0.47724284821045665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02142290274302165, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10736087958017985}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27600, "num_agent_steps_trained": 15872, "num_env_steps_sampled": 13800, "num_env_steps_trained": 15872, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 346.4759837637294, "num_env_steps_trained_throughput_per_sec": 443.48925921757365, "timesteps_total": 13800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27600, "timers": {"training_iteration_time_ms": 534.381, "sample_time_ms": 293.288, "load_time_ms": 0.336, "load_throughput": 762546.569, "learn_time_ms": 40.627, "learn_throughput": 6301.28, "synch_weights_time_ms": 10.869}, "counters": {"num_env_steps_sampled": 13800, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 27600, "num_agent_steps_trained": 15872, "last_target_update_ts": 13800, "num_target_updates": 62}, "done": false, "episodes_total": 24, "training_iteration": 30, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-50", "timestamp": 1742591210, "time_this_iter_s": 1.1735599040985107, "time_total_s": 36.4104278087616, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFDE960940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 36.4104278087616, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 47.3, "ram_util_percent": 80.4}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1922.1187380963358, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1927.8382378891515, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.444666862487793, "actor_loss": -13.57540512084961, "critic_loss": 0.24840284883975983, "alpha_loss": -0.2583698034286499, "alpha_value": 0.9809662103652954, "log_alpha_value": -0.019217271357774734, "target_entropy": -8.0, "policy_t": -0.030624112114310265, "mean_q": 8.580503463745117, "max_q": 15.554824829101562, "min_q": 6.017103672027588}, "td_error": [0.48966121673583984, 1.1251511573791504, 2.0657222270965576, 1.786191463470459, 1.2346322536468506, 1.0246658325195312, 3.4272186756134033, 1.3977084159851074, 0.16678977012634277, 0.8691310882568359, 1.2008132934570312, 1.4035825729370117, 1.037484884262085, 0.34214234352111816, 0.9344925880432129, 0.7027301788330078, 2.02514386177063, 1.6793057918548584, 1.5915746688842773, 0.5515279769897461, 0.90090012550354, 0.2984476089477539, 1.389247179031372, 1.1147584915161133, 0.10548210144042969, 1.1445400714874268, 0.3601799011230469, 0.2471323013305664, 0.2734966278076172, 1.8366608619689941, 0.9771864414215088, 1.494307518005371, 1.6452908515930176, 0.8064823150634766, 0.8952760696411133, 0.7609372138977051, 1.5842363834381104, 1.0703840255737305, 1.4384541511535645, 2.4242992401123047, 1.8708062171936035, 0.7330219745635986, 0.8928370475769043, 0.9665377140045166, 1.2037379741668701, 0.5993270874023438, 1.2053775787353516, 2.103577136993408, 0.6114490032196045, 0.5904018878936768, 1.3260490894317627, 1.5295679569244385, 2.4012672901153564, 2.9633312225341797, 0.38226318359375, 1.8300819396972656, 1.037484884262085, 0.05476856231689453, 1.9245305061340332, 0.3440279960632324, 0.7245774269104004, 1.1512227058410645, 0.5007052421569824, 1.0287704467773438, 0.43591976165771484, 0.8895816802978516, 0.4555392265319824, 1.560020923614502, 2.2672977447509766, 0.35222578048706055, 1.7737984657287598, 0.4835052490234375, 0.5907645225524902, 0.0290069580078125, 1.7643909454345703, 1.4688756465911865, 0.6373081207275391, 1.148085355758667, 1.503009557723999, 0.9152307510375977, 2.3357961177825928, 1.1518611907958984, 0.37744998931884766, 0.9629635810852051, 0.6474151611328125, 2.6413955688476562, 1.4451723098754883, 0.5784416198730469, 2.176525115966797, 0.6101908683776855, 0.5961246490478516, 0.9145915508270264, 0.3924899101257324, 1.6933884620666504, 1.1239070892333984, 1.2608108520507812, 0.4096183776855469, 1.297281265258789, 0.6371030807495117, 2.1419334411621094, 2.8204598426818848, 0.20687341690063477, 0.2290668487548828, 5.540838718414307, 0.8704190254211426, 4.815704345703125, 1.0676298141479492, 1.1218819618225098, 1.1365857124328613, 0.9256491661071777, 4.673297882080078, 0.49481940269470215, 2.0140585899353027, 0.9730010032653809, 1.4406795501708984, 0.2654714584350586, 0.5576629638671875, 1.599369764328003, 0.9536492824554443, 0.787752628326416, 0.8329048156738281, 0.893207311630249, 2.112888813018799, 1.1892967224121094, 0.04567694664001465, 2.2358620166778564, 0.22020721435546875, 0.3187437057495117], "mean_td_error": 1.2016544342041016, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.355189323425293, "actor_loss": -14.114507675170898, "critic_loss": 0.3099086880683899, "alpha_loss": -0.2565946578979492, "alpha_value": 0.9809702634811401, "log_alpha_value": -0.019213104620575905, "target_entropy": -8.0, "policy_t": -0.001217464916408062, "mean_q": 8.962815284729004, "max_q": 15.307108879089355, "min_q": 6.2360920906066895}, "td_error": [2.128265380859375, 0.4223613739013672, 3.980562686920166, 0.15128040313720703, 2.1656575202941895, 2.7647581100463867, 4.724084377288818, 0.8971128463745117, 0.3988676071166992, 0.42255353927612305, 0.5051407814025879, 1.0649840831756592, 3.1310925483703613, 1.8765599727630615, 1.8559212684631348, 0.5109999179840088, 0.17128610610961914, 0.32125234603881836, 0.975557804107666, 0.36716628074645996, 1.4661102294921875, 0.6139135360717773, 0.8875308036804199, 0.42342567443847656, 0.4172077178955078, 0.9522280693054199, 1.2688846588134766, 0.652472972869873, 0.7026550769805908, 0.6933014392852783, 0.4309535026550293, 1.0985527038574219, 0.7506504058837891, 0.5288698673248291, 1.0470433235168457, 0.31480932235717773, 1.0439400672912598, 0.37822675704956055, 0.5554790496826172, 0.3160247802734375, 1.2335808277130127, 0.3379807472229004, 0.8056445121765137, 0.20735836029052734, 1.259922981262207, 0.5475950241088867, 0.27249836921691895, 1.3291049003601074, 0.509009838104248, 0.8242878913879395, 0.36235618591308594, 0.9601821899414062, 0.5680108070373535, 0.5820701122283936, 0.18657779693603516, 0.9423191547393799, 0.12503528594970703, 2.1547932624816895, 0.9713437557220459, 1.9254741668701172, 1.6255388259887695, 2.7590560913085938, 1.3425962924957275, 1.0512423515319824, 0.21386289596557617, 0.5001039505004883, 1.8263792991638184, 0.6353821754455566, 2.09138822555542, 0.27358293533325195, 0.34400105476379395, 0.4324526786804199, 0.5064067840576172, 0.2622709274291992, 1.2745532989501953, 1.7739534378051758, 0.3690810203552246, 0.1529397964477539, 0.5475020408630371, 0.1307363510131836, 1.293860912322998, 4.961783409118652, 0.7721519470214844, 0.6645548343658447, 1.9044852256774902, 0.711533784866333, 1.8013954162597656, 0.38367557525634766, 0.6115686893463135, 0.3855147361755371, 0.9958615303039551, 1.585129737854004, 0.36652708053588867, 3.9098639488220215, 0.7894258499145508, 0.2683138847351074, 0.8544111251831055, 3.131063938140869, 2.0334038734436035, 1.2865636348724365, 0.9631214141845703, 1.302961826324463, 0.6173341274261475, 0.16429471969604492, 1.1415948867797852, 5.149166584014893, 0.9334135055541992, 1.9877057075500488, 0.8948278427124023, 4.988056182861328, 0.37140870094299316, 4.29567289352417, 0.7557926177978516, 0.10669326782226562, 0.8242006301879883, 1.6049914360046387, 0.48261117935180664, 1.2565326690673828, 0.7365894317626953, 0.17674970626831055, 1.522334098815918, 2.5798635482788086, 2.6435458660125732, 0.33951759338378906, 0.7846908569335938, 0.2670116424560547, 1.0294651985168457, 1.1762394905090332], "mean_td_error": 1.135964035987854, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 64.0}}, "num_env_steps_sampled": 14400, "num_env_steps_trained": 16640, "num_agent_steps_sampled": 28800, "num_agent_steps_trained": 16640, "last_target_update_ts": 14400, "num_target_updates": 65}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3849.956975985487, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1922.1187380963358, "robot_1": 1927.8382378891515}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1922.1187380963358, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1927.8382378891515, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7750419324872891, "mean_inference_ms": 3.446813141198238, "mean_action_processing_ms": 0.4666143796908206, "mean_env_wait_ms": 0.4783025073687926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018362488065447127, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09202361106872559}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3849.956975985487, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1922.1187380963358, "robot_1": 1927.8382378891515}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7750419324872891, "mean_inference_ms": 3.446813141198238, "mean_action_processing_ms": 0.4666143796908206, "mean_env_wait_ms": 0.4783025073687926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018362488065447127, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09202361106872559}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28800, "num_agent_steps_trained": 16640, "num_env_steps_sampled": 14400, "num_env_steps_trained": 16640, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 411.4955989480839, "num_env_steps_trained_throughput_per_sec": 526.7143666535475, "timesteps_total": 14400, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 28800, "timers": {"training_iteration_time_ms": 536.023, "sample_time_ms": 292.443, "load_time_ms": 1.17, "load_throughput": 218880.835, "learn_time_ms": 39.803, "learn_throughput": 6431.652, "synch_weights_time_ms": 12.296}, "counters": {"num_env_steps_sampled": 14400, "num_env_steps_trained": 16640, "num_agent_steps_sampled": 28800, "num_agent_steps_trained": 16640, "last_target_update_ts": 14400, "num_target_updates": 65}, "done": false, "episodes_total": 28, "training_iteration": 31, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-52", "timestamp": 1742591212, "time_this_iter_s": 1.4746100902557373, "time_total_s": 37.885037899017334, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A25550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 37.885037899017334, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 28.65, "ram_util_percent": 76.8}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1922.1187380963358, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1927.8382378891515, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.420600891113281, "actor_loss": -14.465102195739746, "critic_loss": 0.30234599113464355, "alpha_loss": -0.26997140049934387, "alpha_value": 0.9800847768783569, "log_alpha_value": -0.02011619508266449, "target_entropy": -8.0, "policy_t": -0.004144907929003239, "mean_q": 9.42818832397461, "max_q": 16.49401092529297, "min_q": 5.795997619628906}, "td_error": [1.5786242485046387, 0.5036201477050781, 1.0120782852172852, 2.161993980407715, 0.4341588020324707, 0.31643056869506836, 0.09110307693481445, 1.4571256637573242, 1.7517294883728027, 0.6316828727722168, 0.39780116081237793, 0.39207935333251953, 0.5315790176391602, 0.8841352462768555, 0.6308774948120117, 1.434248685836792, 0.5208697319030762, 0.9431123733520508, 0.9352359771728516, 2.377666711807251, 1.408329725265503, 0.6804409027099609, 0.9984445571899414, 0.1089487075805664, 1.0139851570129395, 2.0438613891601562, 3.5376996994018555, 0.5368556976318359, 0.30480098724365234, 1.4712817668914795, 0.7593204975128174, 3.845613479614258, 0.5560965538024902, 1.0096392631530762, 2.1764278411865234, 0.07323884963989258, 0.4934244155883789, 0.7722225189208984, 1.3316245079040527, 6.265376567840576, 0.7976796627044678, 1.4493885040283203, 1.2551155090332031, 0.5462646484375, 0.2876310348510742, 0.4038548469543457, 0.8208231925964355, 0.546959400177002, 1.0997810363769531, 2.667774200439453, 1.994361400604248, 0.4418833255767822, 0.9762589931488037, 0.2960500717163086, 0.998018741607666, 0.7453439235687256, 0.8488564491271973, 5.415431022644043, 1.57275390625, 0.702183723449707, 0.8125720024108887, 5.314760684967041, 0.8916268348693848, 0.7807917594909668, 0.8712868690490723, 0.6863908767700195, 4.816794395446777, 0.0692434310913086, 0.707970142364502, 1.6008508205413818, 5.962905406951904, 0.22214269638061523, 0.20560050010681152, 0.04718637466430664, 2.159801959991455, 0.6959466934204102, 0.1708216667175293, 0.3248167037963867, 0.7695603370666504, 0.09761977195739746, 0.2026524543762207, 1.303285837173462, 0.5648822784423828, 0.3312070369720459, 1.3233084678649902, 0.3980832099914551, 2.857555866241455, 1.7504076957702637, 0.5479888916015625, 5.687302589416504, 2.1027727127075195, 0.8627033233642578, 0.8308968544006348, 0.5347743034362793, 0.825890064239502, 0.07441329956054688, 0.47745275497436523, 0.278977632522583, 1.5057697296142578, 1.6506643295288086, 0.950706958770752, 1.4001178741455078, 0.38706469535827637, 0.49849510192871094, 0.5398263931274414, 1.9103798866271973, 0.3687453269958496, 0.4785037040710449, 0.880030632019043, 0.6120009422302246, 0.3244500160217285, 1.6892619132995605, 6.836891174316406, 1.3251979351043701, 0.7473177909851074, 0.8429398536682129, 3.882472515106201, 1.1033930778503418, 1.199497938156128, 3.5553927421569824, 1.540515422821045, 0.8003482818603516, 1.7469482421875, 0.2909564971923828, 6.096770763397217, 0.6321487426757812, 0.5237889289855957, 5.551873207092285], "mean_td_error": 1.3302804231643677, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.442157745361328, "actor_loss": -15.059818267822266, "critic_loss": 0.4545113444328308, "alpha_loss": -0.2703497111797333, "alpha_value": 0.9800888299942017, "log_alpha_value": -0.02011207677423954, "target_entropy": -8.0, "policy_t": 0.041748616844415665, "mean_q": 9.998455047607422, "max_q": 15.382598876953125, "min_q": 6.364521026611328}, "td_error": [0.9479546546936035, 0.2777886390686035, 1.5921478271484375, 1.285876750946045, 5.558841705322266, 0.5732884407043457, 2.4247260093688965, 0.6761846542358398, 3.1644186973571777, 1.4128539562225342, 0.7752318382263184, 1.395465612411499, 2.4700927734375, 0.8564977645874023, 4.11693000793457, 0.32010984420776367, 1.4902005195617676, 3.6619272232055664, 2.798241138458252, 2.03548002243042, 2.2705039978027344, 1.2402706146240234, 1.4598770141601562, 2.5028977394104004, 5.187065124511719, 4.269654273986816, 3.5341944694519043, 0.29949474334716797, 0.9740200042724609, 5.284892559051514, 1.0508217811584473, 1.9519977569580078, 1.735548973083496, 3.3109045028686523, 1.6362223625183105, 1.5268173217773438, 0.3586280345916748, 0.2824678421020508, 0.1344165802001953, 1.0509676933288574, 0.9050383567810059, 1.2504549026489258, 1.0393400192260742, 2.533720016479492, 2.14931583404541, 1.2260031700134277, 1.1246771812438965, 0.9586601257324219, 0.743288516998291, 3.6000118255615234, 1.7289576530456543, 0.578596830368042, 0.8160629272460938, 1.470571517944336, 0.2836265563964844, 0.7261083126068115, 0.8270626068115234, 0.2753605842590332, 1.3996353149414062, 2.5963921546936035, 3.8057098388671875, 0.7588872909545898, 4.04750919342041, 2.8998632431030273, 1.8033251762390137, 0.5485734939575195, 1.9396491050720215, 0.6883640289306641, 0.6176199913024902, 1.1420650482177734, 1.1618752479553223, 0.17277288436889648, 5.072317123413086, 0.49242544174194336, 1.5401639938354492, 0.9900908470153809, 3.182864189147949, 4.281599521636963, 5.3986735343933105, 0.5836715698242188, 0.6750578880310059, 0.7185368537902832, 0.22251272201538086, 1.8079783916473389, 0.550865650177002, 0.4947338104248047, 1.1583328247070312, 0.2640399932861328, 0.2390880584716797, 0.14741182327270508, 2.723574638366699, 4.599338531494141, 0.25783491134643555, 4.8706488609313965, 0.5053005218505859, 1.8535714149475098, 3.0279197692871094, 4.843192100524902, 0.7488250732421875, 0.6165928840637207, 2.1387481689453125, 1.5710530281066895, 1.1046552658081055, 0.7697007656097412, 0.26157617568969727, 2.901186943054199, 1.7916302680969238, 0.2567882537841797, 1.075268030166626, 2.5107908248901367, 0.6378641128540039, 1.9523472785949707, 0.8039355278015137, 2.240767478942871, 2.2533483505249023, 0.1413435935974121, 1.8191258907318115, 2.23239803314209, 1.1581525802612305, 1.6447889804840088, 0.5637340545654297, 0.743100643157959, 0.29734230041503906, 1.4323415756225586, 0.6589064598083496, 0.21768760681152344, 0.18883800506591797, 0.6609764099121094], "mean_td_error": 1.6375826597213745, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 17408, "last_target_update_ts": 15000, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3849.956975985487, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1922.1187380963358, "robot_1": 1927.8382378891515}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1922.1187380963358, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1927.8382378891515, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7750419324872891, "mean_inference_ms": 3.446813141198238, "mean_action_processing_ms": 0.4666143796908206, "mean_env_wait_ms": 0.4783025073687926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018362488065447127, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09202361106872559}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3849.956975985487, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1922.1187380963358, "robot_1": 1927.8382378891515}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7750419324872891, "mean_inference_ms": 3.446813141198238, "mean_action_processing_ms": 0.4666143796908206, "mean_env_wait_ms": 0.4783025073687926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018362488065447127, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09202361106872559}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 15000, "num_env_steps_trained": 17408, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 411.42825753372165, "num_env_steps_trained_throughput_per_sec": 526.6281696431637, "timesteps_total": 15000, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 523.042, "sample_time_ms": 288.55, "load_time_ms": 1.066, "load_throughput": 240092.533, "learn_time_ms": 37.59, "learn_throughput": 6810.365, "synch_weights_time_ms": 12.38}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 17408, "last_target_update_ts": 15000, "num_target_updates": 68}, "done": false, "episodes_total": 28, "training_iteration": 32, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-53", "timestamp": 1742591213, "time_this_iter_s": 1.4745817184448242, "time_total_s": 39.35961961746216, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A25430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 39.35961961746216, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.35, "ram_util_percent": 76.9}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1922.1187380963358, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1927.8382378891515, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.44260025024414, "actor_loss": -14.766021728515625, "critic_loss": 0.38859042525291443, "alpha_loss": -0.27847281098365784, "alpha_value": 0.9794973731040955, "log_alpha_value": -0.02071569673717022, "target_entropy": -8.0, "policy_t": -0.025984376668930054, "mean_q": 9.77049446105957, "max_q": 17.76761817932129, "min_q": 4.121314525604248}, "td_error": [1.3967089653015137, 0.37955760955810547, 2.577202796936035, 0.023480892181396484, 0.32418084144592285, 0.8480212688446045, 2.8091344833374023, 0.27256035804748535, 3.56223201751709, 0.8092703819274902, 1.085918664932251, 1.9837274551391602, 0.11890268325805664, 6.586864471435547, 0.4943399429321289, 0.5680046081542969, 1.881392002105713, 4.438715934753418, 1.1718387603759766, 0.24108314514160156, 5.226931571960449, 1.0374679565429688, 0.4748258590698242, 0.5943455696105957, 1.548835277557373, 0.9595694541931152, 3.91678524017334, 2.653151512145996, 0.5518975257873535, 0.5197854042053223, 2.085151195526123, 0.30019140243530273, 0.9244723320007324, 0.4286050796508789, 0.6429386138916016, 2.117685317993164, 1.309596061706543, 5.032304286956787, 1.29887056350708, 0.8449287414550781, 0.24234676361083984, 0.9324116706848145, 0.46689939498901367, 0.6640157699584961, 1.9262166023254395, 1.8845405578613281, 0.41628551483154297, 0.3632693290710449, 1.9098491668701172, 1.162299633026123, 2.1874780654907227, 1.2006480693817139, 1.6359472274780273, 3.4188451766967773, 1.406693935394287, 1.256150722503662, 0.591062068939209, 1.869377613067627, 0.9969615936279297, 8.057652473449707, 1.1112174987792969, 1.069275140762329, 6.2758917808532715, 1.607269287109375, 0.08053064346313477, 1.0095653533935547, 0.27799534797668457, 1.0963335037231445, 0.6334757804870605, 6.3182454109191895, 1.0250968933105469, 1.6213526725769043, 0.2249288558959961, 0.7060182094573975, 0.7454237937927246, 1.075165033340454, 1.001204490661621, 2.29075288772583, 1.6571807861328125, 1.1476995944976807, 0.16105270385742188, 0.5740163326263428, 1.0411968231201172, 0.4294571876525879, 6.25566291809082, 0.6657531261444092, 1.37986159324646, 3.4032130241394043, 2.9794178009033203, 6.5676469802856445, 3.8449747562408447, 1.0889554023742676, 2.3838601112365723, 0.3019132614135742, 1.0356957912445068, 1.0064597129821777, 0.0588679313659668, 1.2340002059936523, 1.7176856994628906, 5.296168327331543, 0.26314830780029297, 0.9143714904785156, 0.4584007263183594, 0.5765299797058105, 0.8651740550994873, 2.419902801513672, 3.511003017425537, 0.20154666900634766, 0.8918161392211914, 4.789531230926514, 1.6679356098175049, 1.2149150371551514, 0.40410804748535156, 5.152458667755127, 0.5116972923278809, 0.8510720729827881, 0.7870345115661621, 3.017369270324707, 5.696084499359131, 1.2928409576416016, 1.9228911399841309, 3.564324378967285, 1.2720999717712402, 1.8534455299377441, 0.8267660140991211, 1.1240084171295166, 0.16600561141967773, 0.5367517471313477], "mean_td_error": 1.6858136653900146, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.446178436279297, "actor_loss": -14.987380027770996, "critic_loss": 0.39312130212783813, "alpha_loss": -0.27849259972572327, "alpha_value": 0.9795013666152954, "log_alpha_value": -0.020711656659841537, "target_entropy": -8.0, "policy_t": -0.02116287499666214, "mean_q": 9.874162673950195, "max_q": 15.726922035217285, "min_q": 5.5612688064575195}, "td_error": [5.403559684753418, 0.8462300300598145, 4.070441722869873, 0.5374636650085449, 1.0900344848632812, 1.0074520111083984, 1.9126033782958984, 1.350966453552246, 1.2534008026123047, 0.4318976402282715, 1.3595809936523438, 6.2210774421691895, 0.2237546443939209, 3.5561256408691406, 0.7649188041687012, 1.1133770942687988, 2.189514636993408, 2.978771209716797, 1.829660415649414, 1.4292693138122559, 4.6974101066589355, 0.23364019393920898, 0.5537278652191162, 0.09869146347045898, 0.2146453857421875, 1.2581901550292969, 3.447774887084961, 0.0860910415649414, 0.7644076347351074, 0.46313953399658203, 0.17437410354614258, 0.9053442478179932, 0.22949647903442383, 1.6100192070007324, 0.25810861587524414, 0.2451190948486328, 0.9599964618682861, 2.1162314414978027, 0.18209218978881836, 1.2472827434539795, 1.693835735321045, 0.5330805778503418, 0.25496959686279297, 0.7878093719482422, 0.09085226058959961, 5.901947021484375, 3.4500203132629395, 1.2009000778198242, 0.5881977081298828, 1.2937114238739014, 1.592489242553711, 2.2783117294311523, 0.38871097564697266, 0.9996252059936523, 5.075385093688965, 0.794374942779541, 0.7100119590759277, 0.6215081214904785, 0.9402437210083008, 1.4070072174072266, 1.3113059997558594, 0.4602370262145996, 1.2284846305847168, 2.1150941848754883, 0.024501323699951172, 1.1217007637023926, 0.5288472175598145, 0.35604190826416016, 1.3733243942260742, 2.7827343940734863, 1.6972322463989258, 1.8912391662597656, 0.32929325103759766, 0.5572347640991211, 0.3235306739807129, 0.7634849548339844, 1.7536091804504395, 0.10545587539672852, 1.2272744178771973, 1.6674585342407227, 1.7186012268066406, 0.44152259826660156, 2.833224296569824, 1.7405517101287842, 3.6078972816467285, 1.6097331047058105, 3.686610698699951, 1.8160185813903809, 1.1265249252319336, 0.05787086486816406, 0.2662351131439209, 1.3856632709503174, 0.833843469619751, 3.546462059020996, 2.421618938446045, 1.0662589073181152, 1.7413010597229004, 1.0179927349090576, 0.47511839866638184, 1.8916840553283691, 3.1196389198303223, 4.706212520599365, 0.6592803001403809, 0.34876251220703125, 1.1206841468811035, 0.3779010772705078, 0.7239923477172852, 2.680732250213623, 2.3257946968078613, 4.65749979019165, 2.505399703979492, 2.014068126678467, 1.9802465438842773, 0.822026252746582, 1.052762508392334, 0.9924726486206055, 0.567812442779541, 2.594794273376465, 0.2799372673034668, 3.9521098136901855, 0.39788174629211426, 2.496735095977783, 1.7495708465576172, 0.4894685745239258, 0.6970028877258301, 0.6956033706665039, 0.17061662673950195, 1.7619762420654297], "mean_td_error": 1.4903335571289062, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 69.0}}, "num_env_steps_sampled": 15400, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 30800, "num_agent_steps_trained": 17920, "last_target_update_ts": 15400, "num_target_updates": 70}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3849.956975985487, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1922.1187380963358, "robot_1": 1927.8382378891515}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1922.1187380963358, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1927.8382378891515, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7750419324872891, "mean_inference_ms": 3.446813141198238, "mean_action_processing_ms": 0.4666143796908206, "mean_env_wait_ms": 0.4783025073687926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018362488065447127, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09202361106872559}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3849.956975985487, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1922.1187380963358, "robot_1": 1927.8382378891515}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7750419324872891, "mean_inference_ms": 3.446813141198238, "mean_action_processing_ms": 0.4666143796908206, "mean_env_wait_ms": 0.4783025073687926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018362488065447127, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09202361106872559}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30800, "num_agent_steps_trained": 17920, "num_env_steps_sampled": 15400, "num_env_steps_trained": 17920, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 399.9414529676146, "num_env_steps_trained_throughput_per_sec": 511.9250597985467, "timesteps_total": 15400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30800, "timers": {"training_iteration_time_ms": 507.106, "sample_time_ms": 277.06, "load_time_ms": 0.834, "load_throughput": 307002.666, "learn_time_ms": 36.361, "learn_throughput": 7040.556, "synch_weights_time_ms": 12.466}, "counters": {"num_env_steps_sampled": 15400, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 30800, "num_agent_steps_trained": 17920, "last_target_update_ts": 15400, "num_target_updates": 70}, "done": false, "episodes_total": 28, "training_iteration": 33, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-55", "timestamp": 1742591215, "time_this_iter_s": 1.0085182189941406, "time_total_s": 40.3681378364563, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AAA310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 40.3681378364563, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 27.6, "ram_util_percent": 76.95}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1922.1187380963358, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1927.8382378891515, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.412692070007324, "actor_loss": -14.519399642944336, "critic_loss": 0.30283597111701965, "alpha_loss": -0.28589433431625366, "alpha_value": 0.9789103269577026, "log_alpha_value": -0.021315209567546844, "target_entropy": -8.0, "policy_t": 0.013473082333803177, "mean_q": 9.644665718078613, "max_q": 16.568803787231445, "min_q": 4.446518898010254}, "td_error": [1.2439188957214355, 0.4610557556152344, 1.3121216297149658, 0.8663058280944824, 0.36432409286499023, 0.7764582633972168, 3.1695666313171387, 2.476557731628418, 6.708970546722412, 0.09915876388549805, 0.2548246383666992, 0.7995686531066895, 0.20185232162475586, 2.3883414268493652, 1.0647273063659668, 0.5810239315032959, 0.2925095558166504, 2.0562744140625, 5.486797332763672, 2.5199737548828125, 0.8629012107849121, 1.4477787017822266, 1.953791618347168, 1.3769526481628418, 0.6624350547790527, 0.5625643730163574, 1.4225115776062012, 0.7622246742248535, 0.3727841377258301, 0.049857139587402344, 1.1303787231445312, 0.5910096168518066, 2.50618314743042, 0.4943199157714844, 0.31580257415771484, 0.6033596992492676, 1.7206430435180664, 5.0929155349731445, 0.6518702507019043, 2.821413040161133, 1.8298983573913574, 2.3316264152526855, 1.9346928596496582, 1.031304121017456, 2.252133369445801, 0.6813478469848633, 2.5089287757873535, 0.4655935764312744, 2.515712261199951, 0.9881482124328613, 0.288332462310791, 0.5386033058166504, 0.45704197883605957, 1.0492372512817383, 0.956463098526001, 2.076836109161377, 0.8863677978515625, 0.1628575325012207, 0.23610162734985352, 0.7160468101501465, 0.441619873046875, 2.1262550354003906, 1.8678317070007324, 1.0290708541870117, 0.49904680252075195, 1.4072556495666504, 0.7989354133605957, 1.7683110237121582, 0.7649292945861816, 1.290431022644043, 0.19183588027954102, 5.23982572555542, 1.3521411418914795, 2.789267063140869, 1.780655860900879, 0.3670186996459961, 3.2213988304138184, 6.4845871925354, 0.30123376846313477, 2.2925596237182617, 0.3158230781555176, 4.68414306640625, 1.173628807067871, 1.4187231063842773, 2.45084285736084, 0.6832542419433594, 0.27838850021362305, 0.20830392837524414, 0.7452516555786133, 0.8312749862670898, 0.40612077713012695, 1.7788491249084473, 1.1901860237121582, 0.33202600479125977, 0.5931272506713867, 0.3249523639678955, 0.4451889991760254, 0.526026725769043, 1.0560331344604492, 1.2521302700042725, 3.5565896034240723, 6.151431083679199, 0.8272247314453125, 1.2090771198272705, 0.5782437324523926, 0.6296234130859375, 1.1492552757263184, 0.386444091796875, 0.6513330936431885, 2.644822120666504, 3.075500011444092, 4.1502509117126465, 1.1057019233703613, 2.0394482612609863, 3.398883819580078, 0.48572540283203125, 0.5020520687103271, 0.30152440071105957, 1.931802749633789, 0.36144065856933594, 2.0911402702331543, 1.2349371910095215, 0.25251245498657227, 1.434652328491211, 0.811694860458374, 0.675757884979248, 0.8231701850891113, 2.537721633911133], "mean_td_error": 1.438591718673706, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.374307632446289, "actor_loss": -14.862834930419922, "critic_loss": 0.32370641827583313, "alpha_loss": -0.2850230038166046, "alpha_value": 0.9789142608642578, "log_alpha_value": -0.021311234682798386, "target_entropy": -8.0, "policy_t": 0.03148844465613365, "mean_q": 9.756766319274902, "max_q": 15.376522064208984, "min_q": 7.067240238189697}, "td_error": [0.3810901641845703, 2.4878382682800293, 0.5960583686828613, 0.5662617683410645, 2.121427536010742, 1.8990898132324219, 0.8843727111816406, 0.46637940406799316, 0.7923855781555176, 1.2953662872314453, 0.8947563171386719, 1.3430242538452148, 1.3293423652648926, 0.6357636451721191, 0.9418735504150391, 1.640176773071289, 0.23764371871948242, 1.0577201843261719, 0.8939261436462402, 2.0108180046081543, 1.1761727333068848, 0.3752307891845703, 1.3640642166137695, 2.256211757659912, 0.8898611068725586, 0.8400588035583496, 3.615377902984619, 4.102466583251953, 4.066135406494141, 1.7445931434631348, 1.1498918533325195, 1.7853789329528809, 2.1981143951416016, 0.6875832080841064, 1.1244029998779297, 0.8611428737640381, 0.4056859016418457, 0.17981195449829102, 1.6081886291503906, 1.211686611175537, 1.1263399124145508, 0.20338964462280273, 0.8627529144287109, 0.2199993133544922, 2.1406145095825195, 0.5166440010070801, 1.2434406280517578, 1.6039738655090332, 3.228255271911621, 1.2095973491668701, 0.8437838554382324, 2.638062000274658, 2.2260618209838867, 0.963129997253418, 0.8120040893554688, 1.431251049041748, 0.0934443473815918, 1.4499855041503906, 1.8915081024169922, 0.4183225631713867, 3.491391658782959, 2.487776756286621, 0.8754763603210449, 1.8070292472839355, 1.2690865993499756, 0.5271601676940918, 0.7470078468322754, 1.2411346435546875, 2.6914501190185547, 0.6393570899963379, 1.5383119583129883, 0.18731689453125, 1.1032395362854004, 1.1265754699707031, 1.816329002380371, 1.4192891120910645, 1.6198110580444336, 0.9682517051696777, 0.08515024185180664, 5.203127861022949, 0.8847932815551758, 1.8313407897949219, 0.6359424591064453, 0.8984284400939941, 0.24767446517944336, 1.420975685119629, 3.9056038856506348, 0.7788352966308594, 3.221778392791748, 0.23309612274169922, 0.5283465385437012, 1.631056308746338, 2.05897855758667, 0.8056824207305908, 0.37815427780151367, 0.8522219657897949, 0.8359136581420898, 0.9780097007751465, 0.5655460357666016, 0.41373634338378906, 1.3711824417114258, 1.034834384918213, 0.5993523597717285, 3.38560152053833, 1.1436853408813477, 0.8273313045501709, 2.1602916717529297, 0.550267219543457, 0.17885375022888184, 1.1216340065002441, 1.61934232711792, 2.661160469055176, 0.92694091796875, 0.5555539131164551, 2.5851659774780273, 1.4569506645202637, 0.4501509666442871, 3.963737964630127, 0.7030422687530518, 0.7030045986175537, 0.6955728530883789, 0.24010944366455078, 0.6230316162109375, 2.3415822982788086, 1.2146430015563965, 3.18914794921875, 1.007584571838379, 2.346710205078125], "mean_td_error": 1.3503655195236206, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72.0, "diff_num_grad_updates_vs_sampler_policy": 71.0}}, "num_env_steps_sampled": 15800, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 31600, "num_agent_steps_trained": 18432, "last_target_update_ts": 15800, "num_target_updates": 72}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3849.956975985487, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1922.1187380963358, "robot_1": 1927.8382378891515}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1922.1187380963358, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1927.8382378891515, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7750419324872891, "mean_inference_ms": 3.446813141198238, "mean_action_processing_ms": 0.4666143796908206, "mean_env_wait_ms": 0.4783025073687926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018362488065447127, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09202361106872559}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3849.956975985487, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1922.1187380963358, "robot_1": 1927.8382378891515}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7750419324872891, "mean_inference_ms": 3.446813141198238, "mean_action_processing_ms": 0.4666143796908206, "mean_env_wait_ms": 0.4783025073687926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018362488065447127, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.09202361106872559}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31600, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 15800, "num_env_steps_trained": 18432, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 383.9199190476474, "num_env_steps_trained_throughput_per_sec": 491.41749638098867, "timesteps_total": 15800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31600, "timers": {"training_iteration_time_ms": 495.846, "sample_time_ms": 272.202, "load_time_ms": 0.834, "load_throughput": 307002.666, "learn_time_ms": 35.819, "learn_throughput": 7146.991, "synch_weights_time_ms": 11.593}, "counters": {"num_env_steps_sampled": 15800, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 31600, "num_agent_steps_trained": 18432, "last_target_update_ts": 15800, "num_target_updates": 72}, "done": false, "episodes_total": 28, "training_iteration": 34, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-56", "timestamp": 1742591216, "time_this_iter_s": 1.0606098175048828, "time_total_s": 41.42874765396118, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A7D700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 41.42874765396118, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 37.0, "ram_util_percent": 77.1}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1926.465520874808, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1939.6882418967652, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.44805908203125, "actor_loss": -14.987320899963379, "critic_loss": 0.3719564378261566, "alpha_loss": -0.29470786452293396, "alpha_value": 0.9783238768577576, "log_alpha_value": -0.0219145305454731, "target_entropy": -8.0, "policy_t": -0.026525896042585373, "mean_q": 9.996955871582031, "max_q": 17.723894119262695, "min_q": 5.674851417541504}, "td_error": [0.32512712478637695, 0.8958497047424316, 0.6328368186950684, 0.8478376865386963, 1.4584970474243164, 1.2890291213989258, 2.7118616104125977, 1.4970784187316895, 0.19712591171264648, 0.13759422302246094, 0.6580519676208496, 0.8796117305755615, 3.6861701011657715, 0.17600202560424805, 0.22404193878173828, 1.852820873260498, 7.135035514831543, 3.874019145965576, 0.3013143539428711, 2.7925868034362793, 3.336477279663086, 0.9684996604919434, 3.2511682510375977, 0.3779115676879883, 0.7759943008422852, 0.9999442100524902, 0.3353853225708008, 0.45124340057373047, 1.113093376159668, 1.2333879470825195, 1.4853782653808594, 0.7544324398040771, 1.35996413230896, 1.9894731044769287, 0.6933722496032715, 5.1181321144104, 2.481534957885742, 1.7532267570495605, 0.30652666091918945, 1.0655403137207031, 5.072944641113281, 6.822364807128906, 1.1506032943725586, 1.5029921531677246, 1.0961675643920898, 0.5817599296569824, 1.178901195526123, 0.8603239059448242, 0.11725139617919922, 0.7699296474456787, 2.439302444458008, 7.029755592346191, 5.4451751708984375, 0.5860333442687988, 4.968452453613281, 0.15928268432617188, 3.162961959838867, 2.1776113510131836, 0.08957290649414062, 1.9181439876556396, 2.6866507530212402, 2.1595773696899414, 1.8176093101501465, 0.37445735931396484, 0.5932025909423828, 3.0060648918151855, 1.0415148735046387, 0.26989316940307617, 0.30013084411621094, 1.1726083755493164, 4.284098148345947, 0.054198265075683594, 1.0327067375183105, 2.451566219329834, 1.082287311553955, 1.2092671394348145, 0.7306320667266846, 1.3423047065734863, 1.903520107269287, 0.314882755279541, 3.3592095375061035, 0.8021609783172607, 0.6095762252807617, 1.098212718963623, 3.7861480712890625, 1.9541101455688477, 0.7148380279541016, 0.7612652778625488, 0.681220531463623, 0.616096019744873, 1.1690773963928223, 1.1833834648132324, 0.7216553688049316, 0.6997036933898926, 1.43599271774292, 1.797351360321045, 1.8376030921936035, 0.7929582595825195, 1.7334012985229492, 0.2719695568084717, 0.974184513092041, 0.09607267379760742, 0.27846550941467285, 4.434890270233154, 0.6576664447784424, 4.7481184005737305, 0.7997779846191406, 0.8927581310272217, 3.235011577606201, 0.9450302124023438, 0.5017883777618408, 1.2384653091430664, 0.3964219093322754, 0.562669038772583, 1.6616835594177246, 1.3263912200927734, 1.7820863723754883, 1.0684432983398438, 0.5545482635498047, 3.6861276626586914, 3.6370320320129395, 1.5475378036499023, 1.4513256549835205, 1.6192774772644043, 0.7155852317810059, 6.060007572174072, 1.1727204322814941, 1.8492345809936523], "mean_td_error": 1.6429622173309326, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.4376220703125, "actor_loss": -15.06218433380127, "critic_loss": 0.3449075222015381, "alpha_loss": -0.29442375898361206, "alpha_value": 0.9783278703689575, "log_alpha_value": -0.0219104066491127, "target_entropy": -8.0, "policy_t": 0.01386020053178072, "mean_q": 9.878999710083008, "max_q": 16.00356101989746, "min_q": 6.948259353637695}, "td_error": [0.4092292785644531, 0.30788278579711914, 1.2304325103759766, 3.7176513671875, 0.29838037490844727, 1.0749883651733398, 1.4417352676391602, 0.9169678688049316, 2.0198001861572266, 0.2901444435119629, 0.35749197006225586, 4.284602642059326, 2.0082616806030273, 2.1749701499938965, 0.5333127975463867, 0.2549433708190918, 0.4020557403564453, 0.17331981658935547, 0.40465497970581055, 1.144432544708252, 0.19945144653320312, 0.9614801406860352, 0.5130114555358887, 1.4225947856903076, 2.066929340362549, 4.5592851638793945, 0.6493642330169678, 0.20714473724365234, 0.9961948394775391, 1.217848777770996, 4.2266998291015625, 2.489895820617676, 1.4154558181762695, 0.9897003173828125, 1.5703692436218262, 0.578986644744873, 5.643805027008057, 0.15849637985229492, 1.951890468597412, 0.8136720657348633, 4.606505393981934, 3.6786155700683594, 0.9976732730865479, 0.11136913299560547, 0.6933908462524414, 0.6129388809204102, 0.6111483573913574, 1.7649805545806885, 1.2779173851013184, 1.128282070159912, 1.1818366050720215, 2.5252633094787598, 0.17934894561767578, 0.8609209060668945, 0.3411564826965332, 1.3728289604187012, 1.4218244552612305, 0.8551726341247559, 1.172743320465088, 0.7326865196228027, 0.5360097885131836, 1.80122709274292, 1.0022315979003906, 1.3448772430419922, 1.949211597442627, 0.15065431594848633, 0.8535995483398438, 1.9121544361114502, 0.2068486213684082, 1.4218840599060059, 1.4963464736938477, 1.6591267585754395, 0.11689186096191406, 1.3409056663513184, 0.13043689727783203, 0.4612908363342285, 3.3066773414611816, 2.449493408203125, 2.8362789154052734, 1.7716193199157715, 1.8187618255615234, 4.799353122711182, 1.8917245864868164, 5.2680182456970215, 1.2759604454040527, 1.3446722030639648, 3.94541597366333, 1.1004915237426758, 0.8365402221679688, 5.081881999969482, 1.7093076705932617, 3.8952503204345703, 0.9393348693847656, 1.9328160285949707, 0.25748348236083984, 3.7746877670288086, 0.5443148612976074, 3.6890225410461426, 1.7624578475952148, 0.8806982040405273, 0.5480918884277344, 0.5213789939880371, 1.101144790649414, 0.7661919593811035, 1.5529580116271973, 3.056626319885254, 0.3220396041870117, 0.8573346138000488, 0.22136211395263672, 0.9760026931762695, 0.16469335556030273, 0.5021443367004395, 0.10588645935058594, 2.613861083984375, 0.6714882850646973, 0.8344893455505371, 0.8677840232849121, 0.7641696929931641, 0.9959535598754883, 0.6207265853881836, 2.060471773147583, 0.20911359786987305, 0.47296762466430664, 1.397829532623291, 3.4900217056274414, 0.17398834228515625, 0.13380193710327148, 0.41257190704345703], "mean_td_error": 1.4227750301361084, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}}, "num_env_steps_sampled": 16200, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 32400, "num_agent_steps_trained": 18944, "last_target_update_ts": 16200, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3866.1537627715725, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1926.465520874808, "robot_1": 1939.6882418967652}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1926.465520874808, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1939.6882418967652, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7736706321008732, "mean_inference_ms": 3.4417826094452444, "mean_action_processing_ms": 0.4660878034254564, "mean_env_wait_ms": 0.4786748180377285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016067177057266235, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08052065968513489}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3866.1537627715725, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1926.465520874808, "robot_1": 1939.6882418967652}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7736706321008732, "mean_inference_ms": 3.4417826094452444, "mean_action_processing_ms": 0.4660878034254564, "mean_env_wait_ms": 0.4786748180377285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016067177057266235, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08052065968513489}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32400, "num_agent_steps_trained": 18944, "num_env_steps_sampled": 16200, "num_env_steps_trained": 18944, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 380.95559881943205, "num_env_steps_trained_throughput_per_sec": 487.62316648887304, "timesteps_total": 16200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32400, "timers": {"training_iteration_time_ms": 505.042, "sample_time_ms": 277.321, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 36.654, "learn_throughput": 6984.177, "synch_weights_time_ms": 10.721}, "counters": {"num_env_steps_sampled": 16200, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 32400, "num_agent_steps_trained": 18944, "last_target_update_ts": 16200, "num_target_updates": 74}, "done": false, "episodes_total": 32, "training_iteration": 35, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-57", "timestamp": 1742591217, "time_this_iter_s": 1.066640853881836, "time_total_s": 42.49538850784302, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 42.49538850784302, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 37.95, "ram_util_percent": 77.15}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1926.465520874808, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1939.6882418967652, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.330469131469727, "actor_loss": -15.23974609375, "critic_loss": 0.41564661264419556, "alpha_loss": -0.30411699414253235, "alpha_value": 0.977444589138031, "log_alpha_value": -0.02281367965042591, "target_entropy": -8.0, "policy_t": -0.007935558445751667, "mean_q": 10.147554397583008, "max_q": 16.53233528137207, "min_q": 6.526768684387207}, "td_error": [0.32418203353881836, 0.5949926376342773, 0.5305461883544922, 5.348351955413818, 1.8711087703704834, 0.4614267349243164, 2.2330942153930664, 3.97320556640625, 0.8859696388244629, 4.555417060852051, 1.9778096675872803, 0.19359207153320312, 0.4923875331878662, 0.3063826560974121, 0.43056821823120117, 1.4064345359802246, 0.9941959381103516, 1.5337393283843994, 3.2988972663879395, 1.8269672393798828, 0.864783763885498, 1.214461326599121, 0.9215502738952637, 0.6966261863708496, 0.5167231559753418, 4.151292324066162, 0.3512077331542969, 0.5458133220672607, 1.2606215476989746, 0.4853208065032959, 2.004837989807129, 3.691932201385498, 0.7032825946807861, 0.6598529815673828, 1.323169231414795, 4.033806324005127, 0.9232592582702637, 2.022620677947998, 1.16569185256958, 2.74190616607666, 0.32732391357421875, 0.8650083541870117, 3.086181163787842, 0.8358321189880371, 4.412615776062012, 0.7883620262145996, 0.7280659675598145, 0.7394814491271973, 4.445605278015137, 1.2246208190917969, 1.161980152130127, 0.807929515838623, 0.5848336219787598, 0.5468564033508301, 0.5104055404663086, 1.6471819877624512, 2.106779098510742, 0.8193650245666504, 1.3307075500488281, 1.1272287368774414, 0.8185615539550781, 1.7542715072631836, 1.2120270729064941, 0.6517243385314941, 2.564767360687256, 4.8238444328308105, 3.496199607849121, 4.844416618347168, 1.3000273704528809, 4.533329486846924, 1.2217607498168945, 0.8265323638916016, 1.5748205184936523, 0.6237177848815918, 0.5136051177978516, 0.9985690116882324, 0.32331275939941406, 2.0520668029785156, 0.6082406044006348, 3.5444507598876953, 1.9854543209075928, 0.36977386474609375, 1.0252838134765625, 7.715839385986328, 2.0004148483276367, 4.223955154418945, 3.739189624786377, 4.92576265335083, 4.671914577484131, 0.6936445236206055, 1.209205150604248, 0.5399603843688965, 2.4079623222351074, 1.8526520729064941, 1.7648048400878906, 0.8093223571777344, 6.709521293640137, 0.9472994804382324, 0.17006206512451172, 0.4960451126098633, 1.238624095916748, 1.1477274894714355, 2.3242111206054688, 0.35257482528686523, 0.7208356857299805, 2.1235451698303223, 1.977785587310791, 6.203470706939697, 3.493180751800537, 2.2170419692993164, 5.327993869781494, 1.4932146072387695, 0.6047773361206055, 0.30225324630737305, 0.6118764877319336, 1.337693214416504, 0.30982303619384766, 1.6840600967407227, 0.37477970123291016, 0.5468358993530273, 0.7966408729553223, 5.635743618011475, 0.7235753536224365, 3.593165874481201, 1.0202805995941162, 0.6773052215576172, 4.752844333648682, 0.746086597442627], "mean_td_error": 1.8007550239562988, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.470511436462402, "actor_loss": -14.867475509643555, "critic_loss": 0.29190659523010254, "alpha_loss": -0.30724865198135376, "alpha_value": 0.9774491786956787, "log_alpha_value": -0.0228089801967144, "target_entropy": -8.0, "policy_t": 0.018487021327018738, "mean_q": 9.747800827026367, "max_q": 15.210150718688965, "min_q": 5.013949394226074}, "td_error": [0.47252798080444336, 0.5087571144104004, 0.1696324348449707, 1.2230653762817383, 1.3327069282531738, 0.28548479080200195, 4.296455383300781, 1.3647160530090332, 0.8200712203979492, 0.4908919334411621, 1.4161343574523926, 2.225644588470459, 0.9478187561035156, 2.1000962257385254, 0.9229846000671387, 0.08640289306640625, 0.5962810516357422, 0.2161564826965332, 0.9182324409484863, 0.6962375640869141, 0.5638089179992676, 2.975614547729492, 0.7754006385803223, 4.265812397003174, 1.1520557403564453, 0.1614971160888672, 0.2707710266113281, 0.4777669906616211, 0.6456484794616699, 2.104140281677246, 0.8626112937927246, 1.9110007286071777, 2.484602928161621, 1.2898788452148438, 2.338789463043213, 0.47464752197265625, 3.781677722930908, 0.8558254241943359, 1.6026272773742676, 0.917302131652832, 0.011940479278564453, 0.47023677825927734, 1.6046056747436523, 3.0563740730285645, 1.796250343322754, 0.21270513534545898, 3.0718002319335938, 1.0070257186889648, 0.5276589393615723, 0.7068595886230469, 0.08834648132324219, 0.2686734199523926, 0.9172205924987793, 1.2258803844451904, 0.4659271240234375, 4.53297758102417, 0.5609784126281738, 1.3843302726745605, 0.8848328590393066, 1.098642349243164, 1.258829116821289, 1.8379030227661133, 0.9751129150390625, 0.6152210235595703, 4.079587459564209, 0.7215065956115723, 0.24182844161987305, 4.480499744415283, 2.1335630416870117, 1.6206450462341309, 1.6618099212646484, 0.7261853218078613, 0.2838621139526367, 0.034401893615722656, 0.908897876739502, 4.211622714996338, 0.3381192684173584, 2.4530367851257324, 2.5764288902282715, 0.33025169372558594, 1.6470417976379395, 1.2206149101257324, 1.9911775588989258, 0.5236363410949707, 1.446749210357666, 1.6471433639526367, 0.7728185653686523, 0.8900866508483887, 0.7748856544494629, 2.452363967895508, 0.11496973037719727, 0.7748322486877441, 0.621873140335083, 0.9991538524627686, 0.9435038566589355, 1.7150073051452637, 4.7424445152282715, 0.1518864631652832, 0.7979564666748047, 1.2420125007629395, 1.204315185546875, 0.30729055404663086, 1.1742539405822754, 3.015125274658203, 0.43205738067626953, 1.1315069198608398, 0.7904071807861328, 0.8296709060668945, 1.9336957931518555, 0.32814812660217285, 1.5295443534851074, 2.0944457054138184, 0.6347856521606445, 1.2784979343414307, 1.0727901458740234, 0.43384408950805664, 0.43201589584350586, 2.1161584854125977, 0.6360917091369629, 0.20364904403686523, 0.44884347915649414, 0.8438916206359863, 0.26695728302001953, 2.1524429321289062, 2.5825905799865723, 2.5777554512023926, 1.0518279075622559, 1.2679133415222168], "mean_td_error": 1.286133050918579, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 19712, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 19712, "last_target_update_ts": 16800, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3866.1537627715725, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1926.465520874808, "robot_1": 1939.6882418967652}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1926.465520874808, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1939.6882418967652, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7736706321008732, "mean_inference_ms": 3.4417826094452444, "mean_action_processing_ms": 0.4660878034254564, "mean_env_wait_ms": 0.4786748180377285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016067177057266235, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08052065968513489}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3866.1537627715725, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1926.465520874808, "robot_1": 1939.6882418967652}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7736706321008732, "mean_inference_ms": 3.4417826094452444, "mean_action_processing_ms": 0.4660878034254564, "mean_env_wait_ms": 0.4786748180377285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016067177057266235, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08052065968513489}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 19712, "num_env_steps_sampled": 16800, "num_env_steps_trained": 19712, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 395.6124844389396, "num_env_steps_trained_throughput_per_sec": 506.38398008184265, "timesteps_total": 16800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 510.059, "sample_time_ms": 282.546, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 37.501, "learn_throughput": 6826.554, "synch_weights_time_ms": 10.9}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 19712, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 19712, "last_target_update_ts": 16800, "num_target_updates": 77}, "done": false, "episodes_total": 32, "training_iteration": 36, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-58", "timestamp": 1742591218, "time_this_iter_s": 1.5330615043640137, "time_total_s": 44.02845001220703, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AAA310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 44.02845001220703, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 34.6, "ram_util_percent": 77.25}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1926.465520874808, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1939.6882418967652, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.386040687561035, "actor_loss": -14.888506889343262, "critic_loss": 0.35360172390937805, "alpha_loss": -0.3134046196937561, "alpha_value": 0.9768591523170471, "log_alpha_value": -0.0234127938747406, "target_entropy": -8.0, "policy_t": 0.03127490356564522, "mean_q": 9.790947914123535, "max_q": 15.904857635498047, "min_q": 4.875694274902344}, "td_error": [4.696743488311768, 3.500669479370117, 0.1378779411315918, 0.27098655700683594, 0.29049015045166016, 3.742741107940674, 0.8405356407165527, 5.737524032592773, 2.8022661209106445, 0.8912396430969238, 1.4533286094665527, 0.6670761108398438, 0.613429069519043, 0.6753034591674805, 1.6352663040161133, 1.767416000366211, 0.5826406478881836, 0.8113880157470703, 0.8345375061035156, 0.6560177803039551, 1.2226135730743408, 0.3920884132385254, 0.4476747512817383, 1.7114787101745605, 3.1623458862304688, 1.7528510093688965, 0.770759105682373, 1.810060977935791, 0.09570884704589844, 0.11484670639038086, 3.3332180976867676, 2.597498893737793, 2.9255871772766113, 2.731088876724243, 0.8686423301696777, 0.4760584831237793, 5.392334938049316, 1.6793169975280762, 2.652592658996582, 4.245739459991455, 1.032217025756836, 1.277590274810791, 3.1526665687561035, 0.2048811912536621, 3.4727487564086914, 0.39940595626831055, 0.3315768241882324, 1.6897728443145752, 4.581809043884277, 0.5493807792663574, 0.7094311714172363, 0.979794979095459, 6.33765983581543, 0.36005067825317383, 1.2757182121276855, 1.2158007621765137, 0.5197587013244629, 1.4511117935180664, 0.612037181854248, 2.8632993698120117, 4.8186492919921875, 1.6656723022460938, 0.3143467903137207, 1.0927090644836426, 0.358917236328125, 0.6061081886291504, 0.31930017471313477, 0.81424880027771, 0.5603909492492676, 0.6844429969787598, 2.264118194580078, 1.4625208377838135, 0.9729671478271484, 0.5490536689758301, 0.3437185287475586, 1.6746764183044434, 0.5839071273803711, 0.8002791404724121, 1.521864414215088, 1.2608842849731445, 0.5407009124755859, 1.1062569618225098, 2.169295310974121, 4.725642204284668, 1.0999741554260254, 1.43310546875, 0.34551429748535156, 0.41573190689086914, 1.4872932434082031, 1.2800867557525635, 1.269700527191162, 3.253004550933838, 0.48819756507873535, 0.35954833030700684, 0.3920297622680664, 1.953366756439209, 0.5279650688171387, 2.090421199798584, 1.22615385055542, 0.5360217094421387, 1.9466071128845215, 2.159097194671631, 2.1220622062683105, 0.6079106330871582, 4.038640022277832, 0.5049834251403809, 0.5807590484619141, 0.45220422744750977, 0.5094542503356934, 1.3453903198242188, 1.506744384765625, 1.003084659576416, 1.0402846336364746, 0.29684972763061523, 1.6259372234344482, 0.5396928787231445, 3.007815361022949, 3.8305892944335938, 1.4907751083374023, 0.9556498527526855, 0.5634417533874512, 0.4113631248474121, 1.2646846771240234, 0.4281482696533203, 1.0085859298706055, 2.144200325012207, 0.5708861351013184, 4.405267238616943], "mean_td_error": 1.5135669708251953, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.381592750549316, "actor_loss": -14.494717597961426, "critic_loss": 0.2410356104373932, "alpha_loss": -0.3132370710372925, "alpha_value": 0.9768638014793396, "log_alpha_value": -0.023408055305480957, "target_entropy": -8.0, "policy_t": 0.026141567155718803, "mean_q": 9.37503433227539, "max_q": 14.607800483703613, "min_q": 6.222843647003174}, "td_error": [1.0762896537780762, 1.1201958656311035, 0.3522782325744629, 2.0915145874023438, 0.6234903335571289, 0.05276918411254883, 0.335629940032959, 2.9717836380004883, 0.30896997451782227, 1.005387306213379, 2.1080331802368164, 3.7448110580444336, 1.484591007232666, 1.187148094177246, 1.254256248474121, 1.0881779193878174, 0.44353246688842773, 0.2680532932281494, 0.9915337562561035, 1.7726631164550781, 0.1482229232788086, 1.4552302360534668, 0.15828657150268555, 0.8642983436584473, 0.4541592597961426, 0.8312473297119141, 1.8180205821990967, 0.9853000640869141, 0.6319160461425781, 0.25055980682373047, 0.1591355800628662, 1.9250662326812744, 0.8082070350646973, 2.601166248321533, 0.574800968170166, 0.4586906433105469, 1.1957569122314453, 1.6701490879058838, 0.31394338607788086, 2.690514087677002, 2.0023746490478516, 0.6246728897094727, 0.3622760772705078, 1.427201747894287, 0.4502573013305664, 1.4900765419006348, 0.5440778732299805, 0.792597770690918, 1.048769474029541, 1.152705192565918, 0.35725879669189453, 0.9420509338378906, 1.9272842407226562, 1.1625685691833496, 1.0596675872802734, 0.35888242721557617, 1.9391560554504395, 0.9239089488983154, 0.2899596691131592, 0.5934486389160156, 0.9262886047363281, 0.2856483459472656, 0.9213666915893555, 1.3601303100585938, 0.2318711280822754, 1.7440171241760254, 1.2030839920043945, 1.457170009613037, 1.7702641487121582, 0.4615652561187744, 0.6845574378967285, 1.373145580291748, 0.8917732238769531, 0.9864840507507324, 1.6420722007751465, 0.36943626403808594, 1.7031621932983398, 4.935100555419922, 0.9675219058990479, 1.257044792175293, 0.7758255004882812, 0.6873817443847656, 3.483501434326172, 2.6618618965148926, 2.228243827819824, 1.825441837310791, 1.0259990692138672, 0.21030426025390625, 0.6650748252868652, 1.8883476257324219, 0.23525047302246094, 1.6239757537841797, 4.323929786682129, 0.22904491424560547, 0.8297345638275146, 0.8091473579406738, 1.6295504570007324, 0.07086849212646484, 0.24361133575439453, 0.2370162010192871, 0.8811841011047363, 1.5737504959106445, 0.3248460292816162, 0.21558856964111328, 1.4102087020874023, 2.455575466156006, 0.9257650375366211, 0.900754451751709, 1.2249407768249512, 1.8488240242004395, 2.5229597091674805, 0.2982916831970215, 1.0233354568481445, 0.23574519157409668, 0.5932750701904297, 0.6664395332336426, 0.2710847854614258, 2.5227184295654297, 2.230625629425049, 1.8369641304016113, 0.9847421646118164, 1.1676359176635742, 3.7256178855895996, 4.769289016723633, 0.7782025337219238, 1.9653615951538086, 4.52608585357666, 0.8241448402404785], "mean_td_error": 1.2287870645523071, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 17200, "num_env_steps_trained": 20224, "num_agent_steps_sampled": 34400, "num_agent_steps_trained": 20224, "last_target_update_ts": 17200, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3866.1537627715725, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1926.465520874808, "robot_1": 1939.6882418967652}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1926.465520874808, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1939.6882418967652, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7736706321008732, "mean_inference_ms": 3.4417826094452444, "mean_action_processing_ms": 0.4660878034254564, "mean_env_wait_ms": 0.4786748180377285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016067177057266235, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08052065968513489}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3866.1537627715725, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1926.465520874808, "robot_1": 1939.6882418967652}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7736706321008732, "mean_inference_ms": 3.4417826094452444, "mean_action_processing_ms": 0.4660878034254564, "mean_env_wait_ms": 0.4786748180377285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016067177057266235, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08052065968513489}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34400, "num_agent_steps_trained": 20224, "num_env_steps_sampled": 17200, "num_env_steps_trained": 20224, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 385.27588539745807, "num_env_steps_trained_throughput_per_sec": 493.1531333087463, "timesteps_total": 17200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34400, "timers": {"training_iteration_time_ms": 517.164, "sample_time_ms": 284.172, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 37.546, "learn_throughput": 6818.365, "synch_weights_time_ms": 9.266}, "counters": {"num_env_steps_sampled": 17200, "num_env_steps_trained": 20224, "num_agent_steps_sampled": 34400, "num_agent_steps_trained": 20224, "last_target_update_ts": 17200, "num_target_updates": 79}, "done": false, "episodes_total": 32, "training_iteration": 37, "trial_id": "46f72_00000", "date": "2025-03-21_21-06-59", "timestamp": 1742591219, "time_this_iter_s": 1.0568890571594238, "time_total_s": 45.085339069366455, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A7D700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 45.085339069366455, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 32.0, "ram_util_percent": 77.2}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1926.465520874808, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1939.6882418967652, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.355168342590332, "actor_loss": -14.68197250366211, "critic_loss": 0.3174821138381958, "alpha_loss": -0.32067936658859253, "alpha_value": 0.9762743711471558, "log_alpha_value": -0.024011630564928055, "target_entropy": -8.0, "policy_t": 0.018477220088243484, "mean_q": 9.759647369384766, "max_q": 15.420907020568848, "min_q": 5.785700798034668}, "td_error": [4.8440165519714355, 4.799519062042236, 0.505126953125, 0.5109710693359375, 0.694674015045166, 0.7921843528747559, 0.42006826400756836, 0.32477378845214844, 0.14619922637939453, 4.378568649291992, 1.0663774013519287, 5.268115043640137, 1.3654403686523438, 1.3397903442382812, 1.1082663536071777, 0.5520172119140625, 1.5629527568817139, 2.1719017028808594, 0.36182641983032227, 0.47822046279907227, 1.4147510528564453, 0.7560410499572754, 0.4851808547973633, 0.6395936012268066, 0.29838132858276367, 2.186397075653076, 0.6170940399169922, 0.11579418182373047, 2.8906421661376953, 0.22119665145874023, 0.133514404296875, 0.641608715057373, 0.05237150192260742, 5.849858283996582, 0.8062493801116943, 0.6964998245239258, 3.7142281532287598, 1.3022074699401855, 0.3778867721557617, 0.4125022888183594, 0.8579976558685303, 0.5262742042541504, 1.565906047821045, 0.8313350677490234, 0.920067310333252, 1.2005648612976074, 1.5792803764343262, 1.7180805206298828, 1.440091848373413, 0.5674445629119873, 0.4143695831298828, 1.4310836791992188, 0.2994046211242676, 0.6394391059875488, 0.5974307060241699, 0.4929680824279785, 1.435899257659912, 0.9523072242736816, 0.7517678737640381, 4.785289287567139, 2.93264102935791, 1.8021345138549805, 3.0926284790039062, 0.15941143035888672, 0.8101601600646973, 0.38528895378112793, 4.5384321212768555, 3.4325151443481445, 0.8426246643066406, 0.9099283218383789, 0.5055079460144043, 5.750920295715332, 0.508277416229248, 0.5384626388549805, 0.9690470695495605, 0.5117778778076172, 1.3297042846679688, 0.6609454154968262, 3.79013729095459, 1.9052495956420898, 2.2908568382263184, 1.563894271850586, 1.7097480297088623, 1.6073579788208008, 1.3290953636169434, 0.5848584175109863, 1.063894271850586, 0.48311805725097656, 3.342592716217041, 1.18473482131958, 1.146906852722168, 0.31702184677124023, 1.3547601699829102, 0.6047787666320801, 4.365044116973877, 0.7811341285705566, 3.6043314933776855, 0.5390145778656006, 1.4805822372436523, 0.22623682022094727, 2.0383052825927734, 2.2372608184814453, 1.6686458587646484, 0.6093041896820068, 3.6179699897766113, 0.8890376091003418, 1.5771734714508057, 0.749657154083252, 1.037947654724121, 1.180126667022705, 1.4354419708251953, 0.23179149627685547, 0.3814735412597656, 2.4515862464904785, 1.5117812156677246, 0.4930243492126465, 0.5634393692016602, 0.8579673767089844, 0.6304202079772949, 5.877468585968018, 0.5262742042541504, 2.1949052810668945, 2.341459035873413, 0.07043981552124023, 1.264514446258545, 2.2486214637756348, 1.0379900932312012, 0.2764291763305664], "mean_td_error": 1.4395798444747925, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.342402458190918, "actor_loss": -14.407205581665039, "critic_loss": 0.20947478711605072, "alpha_loss": -0.320308119058609, "alpha_value": 0.976279079914093, "log_alpha_value": -0.024006780236959457, "target_entropy": -8.0, "policy_t": 0.018476217985153198, "mean_q": 9.375690460205078, "max_q": 14.096975326538086, "min_q": 6.41413688659668}, "td_error": [0.41193628311157227, 3.7089715003967285, 1.79982328414917, 3.0400328636169434, 0.21338796615600586, 2.2443251609802246, 1.6614761352539062, 0.1402287483215332, 3.3357391357421875, 0.3461620807647705, 0.7127504348754883, 0.4502706527709961, 1.024263858795166, 1.2996330261230469, 0.3678441047668457, 1.5474905967712402, 2.8244872093200684, 0.09788179397583008, 0.2968330383300781, 0.10996818542480469, 0.7806344032287598, 0.1356825828552246, 2.79495906829834, 0.15645074844360352, 0.2448287010192871, 0.8219332695007324, 0.264148473739624, 1.3970146179199219, 0.5989992618560791, 0.47886013984680176, 0.6450424194335938, 1.7992758750915527, 0.9294099807739258, 0.9975695610046387, 0.12309408187866211, 0.8845257759094238, 1.6677286624908447, 0.6893048286437988, 1.478569507598877, 0.7730731964111328, 0.1552877426147461, 2.034663200378418, 1.965756893157959, 0.512340784072876, 0.34584760665893555, 0.8639473915100098, 2.013658046722412, 1.7171640396118164, 0.6159071922302246, 1.1587133407592773, 0.5477991104125977, 1.3964476585388184, 0.2060704231262207, 0.8186349868774414, 1.2120890617370605, 0.649442195892334, 0.4357490539550781, 1.3254637718200684, 0.8424139022827148, 1.3766956329345703, 1.0939216613769531, 0.4436469078063965, 0.2844252586364746, 1.690558910369873, 1.398630142211914, 0.5734081268310547, 1.0011255741119385, 1.4265375137329102, 0.10452890396118164, 0.9465212821960449, 0.43316173553466797, 1.808946132659912, 0.7491919994354248, 2.079524517059326, 0.21721172332763672, 1.122847080230713, 1.3840322494506836, 0.45282411575317383, 1.1507225036621094, 3.453157901763916, 0.9128575325012207, 0.3577408790588379, 2.8122801780700684, 1.0984158515930176, 1.2720403671264648, 0.6630897521972656, 0.5323200225830078, 0.21338939666748047, 1.1169824600219727, 0.8078384399414062, 0.4788393974304199, 0.3195765018463135, 0.746915340423584, 0.40891456604003906, 2.188255548477173, 2.352078437805176, 1.2230055332183838, 1.2159874439239502, 2.3881282806396484, 1.7626042366027832, 0.7477936744689941, 1.7075281143188477, 1.2864060401916504, 0.9609708786010742, 3.4088330268859863, 0.8496556282043457, 0.9407029151916504, 1.195908546447754, 1.058145523071289, 2.49583101272583, 2.4580039978027344, 0.38977980613708496, 0.21329355239868164, 0.9996953010559082, 0.14763259887695312, 2.2312560081481934, 1.0745959281921387, 0.5934677124023438, 1.2196335792541504, 0.45230817794799805, 0.5939192771911621, 0.7429041862487793, 0.5167412757873535, 1.5971012115478516, 0.9479947090148926, 1.1322860717773438, 2.571382999420166, 0.0348048210144043], "mean_td_error": 1.0995582342147827, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 80.0}}, "num_env_steps_sampled": 17600, "num_env_steps_trained": 20736, "num_agent_steps_sampled": 35200, "num_agent_steps_trained": 20736, "last_target_update_ts": 17600, "num_target_updates": 81}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3866.1537627715725, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1926.465520874808, "robot_1": 1939.6882418967652}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1926.465520874808, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1939.6882418967652, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7736706321008732, "mean_inference_ms": 3.4417826094452444, "mean_action_processing_ms": 0.4660878034254564, "mean_env_wait_ms": 0.4786748180377285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016067177057266235, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08052065968513489}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3866.1537627715725, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1926.465520874808, "robot_1": 1939.6882418967652}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7736706321008732, "mean_inference_ms": 3.4417826094452444, "mean_action_processing_ms": 0.4660878034254564, "mean_env_wait_ms": 0.4786748180377285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016067177057266235, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08052065968513489}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35200, "num_agent_steps_trained": 20736, "num_env_steps_sampled": 17600, "num_env_steps_trained": 20736, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 389.414523254783, "num_env_steps_trained_throughput_per_sec": 498.45058976612216, "timesteps_total": 17600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35200, "timers": {"training_iteration_time_ms": 516.542, "sample_time_ms": 284.942, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 36.784, "learn_throughput": 6959.506, "synch_weights_time_ms": 9.522}, "counters": {"num_env_steps_sampled": 17600, "num_env_steps_trained": 20736, "num_agent_steps_sampled": 35200, "num_agent_steps_trained": 20736, "last_target_update_ts": 17600, "num_target_updates": 81}, "done": false, "episodes_total": 32, "training_iteration": 38, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-01", "timestamp": 1742591221, "time_this_iter_s": 1.0416531562805176, "time_total_s": 46.12699222564697, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 46.12699222564697, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 36.55, "ram_util_percent": 77.4}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.408862113952637, "actor_loss": -14.373711585998535, "critic_loss": 0.27079373598098755, "alpha_loss": -0.3299914598464966, "alpha_value": 0.9756904244422913, "log_alpha_value": -0.02460995689034462, "target_entropy": -8.0, "policy_t": -0.024558261036872864, "mean_q": 9.25539779663086, "max_q": 14.70760726928711, "min_q": 5.315274715423584}, "td_error": [0.36240625381469727, 0.4892878532409668, 4.698207378387451, 1.9003167152404785, 0.8327555656433105, 0.8698134422302246, 1.2091948986053467, 1.0130963325500488, 0.8848881721496582, 0.9291977882385254, 0.5946121215820312, 0.18781805038452148, 1.7711844444274902, 2.1138195991516113, 2.6218390464782715, 1.0442876815795898, 0.8046283721923828, 0.2556009292602539, 1.719296932220459, 2.1753015518188477, 0.7756648063659668, 1.2534542083740234, 2.2443552017211914, 0.25174999237060547, 1.8080010414123535, 0.6305227279663086, 0.5026469230651855, 0.37171316146850586, 1.3484773635864258, 0.5239543914794922, 1.0795702934265137, 0.4801340103149414, 0.6145479679107666, 0.8795857429504395, 1.3363609313964844, 0.6042189598083496, 0.37914609909057617, 3.2827706336975098, 0.5290970802307129, 2.6686558723449707, 1.8371248245239258, 0.2290201187133789, 2.264962673187256, 0.05980634689331055, 1.811941146850586, 1.8775076866149902, 0.18755531311035156, 0.36446380615234375, 1.9223265647888184, 1.1482136249542236, 0.4017481803894043, 0.5431966781616211, 0.12868976593017578, 4.598626613616943, 1.3048782348632812, 0.5895133018493652, 0.6936733722686768, 1.4084997177124023, 0.9852166175842285, 1.6363844871520996, 1.5310401916503906, 0.09611034393310547, 2.8408823013305664, 0.19148921966552734, 2.1117100715637207, 0.9083566665649414, 0.4658222198486328, 0.34056997299194336, 1.1206114292144775, 0.6807565689086914, 1.0946779251098633, 0.1762704849243164, 0.5515809059143066, 0.28200674057006836, 0.9742391109466553, 0.9681096076965332, 0.560204029083252, 1.293428897857666, 0.1667637825012207, 0.8423628807067871, 1.1000900268554688, 1.250467300415039, 0.6147046089172363, 2.299057960510254, 0.43493151664733887, 0.34009313583374023, 0.2051095962524414, 1.9892053604125977, 1.576615333557129, 2.321683883666992, 0.46993017196655273, 4.547818660736084, 1.9327392578125, 0.5011000633239746, 0.7348294258117676, 0.7440357208251953, 2.1786766052246094, 1.0559639930725098, 0.6698508262634277, 1.7977895736694336, 0.7232813835144043, 0.6536197662353516, 4.187814235687256, 0.45305919647216797, 0.8416571617126465, 2.518580436706543, 2.2821760177612305, 0.23838186264038086, 2.447506904602051, 1.9971332550048828, 2.256558656692505, 1.6881697177886963, 5.910410404205322, 0.8683443069458008, 0.625457763671875, 0.29779911041259766, 2.5318470001220703, 2.646437644958496, 0.7451686859130859, 1.0187277793884277, 3.974111557006836, 1.0856008529663086, 0.16507720947265625, 0.624051570892334, 0.727592945098877, 0.6947941780090332, 0.42809343338012695, 1.0679774284362793], "mean_td_error": 1.2476301193237305, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.398574829101562, "actor_loss": -14.110111236572266, "critic_loss": 0.22693754732608795, "alpha_loss": -0.3296748995780945, "alpha_value": 0.975695013999939, "log_alpha_value": -0.024605222046375275, "target_entropy": -8.0, "policy_t": 0.003858676180243492, "mean_q": 8.946752548217773, "max_q": 13.979146003723145, "min_q": 5.748529434204102}, "td_error": [4.8624773025512695, 0.5610227584838867, 0.7737994194030762, 1.1214232444763184, 1.0442683696746826, 0.8264322280883789, 0.9622559547424316, 0.428497314453125, 0.17131662368774414, 0.9186978340148926, 0.38454484939575195, 0.535163402557373, 1.0183024406433105, 0.7081766128540039, 1.5668339729309082, 0.4619455337524414, 0.28548383712768555, 1.7276015281677246, 1.0337128639221191, 0.4926729202270508, 2.5395681858062744, 1.6003224849700928, 0.4682626724243164, 0.7415409088134766, 1.9630687236785889, 4.422683238983154, 0.3095970153808594, 0.8962249755859375, 0.834357738494873, 0.9063549041748047, 0.4229440689086914, 2.385014533996582, 1.7987537384033203, 0.2077469825744629, 1.4349961280822754, 0.9530835151672363, 1.1779861450195312, 0.5639729499816895, 0.9437589645385742, 0.5975284576416016, 0.16810941696166992, 1.3230552673339844, 0.20831918716430664, 0.3379831314086914, 3.597909927368164, 0.4136064052581787, 0.5738394260406494, 3.3536038398742676, 0.22386741638183594, 5.1221537590026855, 0.3664102554321289, 1.397686243057251, 1.0155506134033203, 0.5276532173156738, 1.0673844814300537, 0.26242494583129883, 1.0362486839294434, 1.1168880462646484, 4.18935489654541, 2.0964043140411377, 0.9331865310668945, 0.4945683479309082, 0.6945943832397461, 1.2554125785827637, 0.8191485404968262, 0.4346952438354492, 1.2321388721466064, 0.2898545265197754, 2.680278778076172, 3.670297145843506, 3.2966418266296387, 0.1155238151550293, 0.31578874588012695, 0.20045948028564453, 0.44130563735961914, 0.20861339569091797, 0.49918651580810547, 1.5013189315795898, 1.331895112991333, 0.43567848205566406, 1.35367751121521, 0.48767518997192383, 0.3003873825073242, 1.3302786350250244, 1.8589510917663574, 0.25139856338500977, 0.523503303527832, 2.1314921379089355, 0.9707112312316895, 0.6231813430786133, 0.9020824432373047, 0.6725540161132812, 1.7149081230163574, 0.27768850326538086, 1.5466794967651367, 0.7855279445648193, 2.162445068359375, 2.660554885864258, 0.6950035095214844, 1.8222155570983887, 1.2490074634552002, 0.4002342224121094, 0.296630859375, 0.1288304328918457, 0.7686352729797363, 0.15251970291137695, 0.2703886032104492, 0.42005062103271484, 2.7053041458129883, 0.7497429847717285, 1.703549861907959, 0.9837856292724609, 3.3177013397216797, 0.3791623115539551, 1.0123841762542725, 0.3757448196411133, 0.5860381126403809, 1.0200519561767578, 0.20113468170166016, 1.984522819519043, 1.3746390342712402, 1.0404696464538574, 1.1934552192687988, 0.6269404888153076, 1.4266119003295898, 0.8125572204589844, 3.2451038360595703, 0.21735358238220215], "mean_td_error": 1.1407414674758911, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 21248, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 21248, "last_target_update_ts": 18000, "num_target_updates": 83}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 21248, "num_env_steps_sampled": 18000, "num_env_steps_trained": 21248, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 395.62374136345414, "num_env_steps_trained_throughput_per_sec": 506.3983889452213, "timesteps_total": 18000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 513.567, "sample_time_ms": 281.63, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 37.576, "learn_throughput": 6812.936, "synch_weights_time_ms": 9.05}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 21248, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 21248, "last_target_update_ts": 18000, "num_target_updates": 83}, "done": false, "episodes_total": 36, "training_iteration": 39, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-02", "timestamp": 1742591222, "time_this_iter_s": 1.0250463485717773, "time_total_s": 47.15203857421875, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AAA310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 47.15203857421875, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 31.1, "ram_util_percent": 77.5}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.424356460571289, "actor_loss": -14.452469825744629, "critic_loss": 0.2793080806732178, "alpha_loss": -0.33840450644493103, "alpha_value": 0.9751068353652954, "log_alpha_value": -0.02520824782550335, "target_entropy": -8.0, "policy_t": 0.023936636745929718, "mean_q": 9.387033462524414, "max_q": 15.112247467041016, "min_q": 5.884176254272461}, "td_error": [2.147213935852051, 0.8238525390625, 2.0620150566101074, 2.4896674156188965, 0.30496978759765625, 1.0721783638000488, 0.5817842483520508, 0.8735480308532715, 0.7717063426971436, 0.13280296325683594, 0.613760232925415, 0.8915867805480957, 0.8207297325134277, 2.1272053718566895, 0.9907159805297852, 1.335557222366333, 0.9187302589416504, 1.1032977104187012, 3.1006393432617188, 0.6501855850219727, 1.7700507640838623, 0.45159268379211426, 2.289055347442627, 2.567523956298828, 1.1022944450378418, 1.025752305984497, 0.22443675994873047, 0.7762665748596191, 2.1000537872314453, 2.4801535606384277, 0.7243285179138184, 0.9071841239929199, 0.6512365341186523, 2.0353522300720215, 0.307373046875, 0.3561253547668457, 1.2606196403503418, 0.38142871856689453, 3.884835720062256, 1.4084177017211914, 0.18625354766845703, 0.521141529083252, 1.70672607421875, 1.948038101196289, 0.6893577575683594, 1.6811141967773438, 0.7533817291259766, 1.368847370147705, 2.217372417449951, 0.6411154270172119, 1.9703457355499268, 2.9128942489624023, 1.7886648178100586, 0.2843284606933594, 0.3368964195251465, 3.126638412475586, 1.5102624893188477, 0.07411694526672363, 3.3826069831848145, 0.2812235355377197, 0.7508668899536133, 0.6103706359863281, 3.1168603897094727, 0.6417207717895508, 2.0269360542297363, 1.5721514225006104, 1.4737846851348877, 0.39084625244140625, 1.0169997215270996, 0.27668190002441406, 3.5199499130249023, 1.5902745723724365, 1.5351498126983643, 0.4923992156982422, 1.6098175048828125, 0.9117369651794434, 0.21379899978637695, 1.1606032848358154, 0.8664016723632812, 0.6743512153625488, 1.227311611175537, 1.4791626930236816, 0.11121559143066406, 2.4504876136779785, 0.7947125434875488, 1.1099042892456055, 0.2257366180419922, 0.2892904281616211, 1.0602736473083496, 0.7414207458496094, 0.4921903610229492, 0.39765262603759766, 0.6148834228515625, 2.7059359550476074, 1.151498794555664, 0.33346986770629883, 0.9297738075256348, 1.020951271057129, 2.0873866081237793, 0.5546102523803711, 0.32304906845092773, 0.3663811683654785, 1.3827848434448242, 1.3508257865905762, 1.736706256866455, 3.577906608581543, 5.6955246925354, 2.312894821166992, 0.49565649032592773, 0.4929964542388916, 1.7026443481445312, 1.2445001602172852, 1.269477128982544, 1.891571044921875, 2.598550796508789, 0.6512987613677979, 3.759993553161621, 1.570521354675293, 1.0533480644226074, 0.6697969436645508, 1.0906949043273926, 2.3114917278289795, 0.4568667411804199, 0.45187854766845703, 0.6706140041351318, 1.1988630294799805, 0.8575000762939453, 2.2022361755371094], "mean_td_error": 1.293075680732727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.35409164428711, "actor_loss": -14.457405090332031, "critic_loss": 0.2321588546037674, "alpha_loss": -0.3365730047225952, "alpha_value": 0.9751112461090088, "log_alpha_value": -0.025203734636306763, "target_entropy": -8.0, "policy_t": 0.03438306972384453, "mean_q": 9.294683456420898, "max_q": 13.968659400939941, "min_q": 6.070395469665527}, "td_error": [2.29813289642334, 0.15604209899902344, 0.3019075393676758, 1.2033076286315918, 3.138583183288574, 1.5465755462646484, 0.6761283874511719, 0.7031502723693848, 1.235180139541626, 0.18993854522705078, 3.0745739936828613, 1.4800677299499512, 1.7447872161865234, 1.2164306640625, 0.22603988647460938, 1.2274959087371826, 1.478224754333496, 3.508716583251953, 0.3238554000854492, 0.7140343189239502, 2.9978551864624023, 2.5261735916137695, 0.945465087890625, 0.611567497253418, 0.5642602443695068, 0.8966774940490723, 1.1047158241271973, 2.664577007293701, 1.6769049167633057, 0.4452633857727051, 2.441255569458008, 0.18258428573608398, 3.9098315238952637, 2.6376090049743652, 1.744283676147461, 1.232483148574829, 0.7870492935180664, 3.3567938804626465, 1.1284198760986328, 1.2420930862426758, 2.5026819705963135, 0.11402297019958496, 2.172067642211914, 0.16376495361328125, 0.43774938583374023, 0.41173267364501953, 1.6823821067810059, 0.2693047523498535, 0.4373173713684082, 1.9466180801391602, 0.8319292068481445, 2.3007984161376953, 2.7519638538360596, 0.6107654571533203, 0.21573638916015625, 0.31619739532470703, 0.45059967041015625, 1.4359593391418457, 1.8062238693237305, 0.9549651145935059, 0.2627449035644531, 2.1881842613220215, 1.0502490997314453, 0.24472904205322266, 1.0382099151611328, 0.4439253807067871, 1.2174482345581055, 1.444075345993042, 0.7089505195617676, 1.0860376358032227, 0.7428088188171387, 0.7596025466918945, 0.9295201301574707, 2.1889100074768066, 1.9249205589294434, 1.9230389595031738, 1.5354294776916504, 1.5852513313293457, 1.3230314254760742, 0.5187540054321289, 0.461838960647583, 1.6339936256408691, 1.5310673713684082, 1.0794010162353516, 0.3235650062561035, 0.32106685638427734, 1.9675178527832031, 0.37888336181640625, 2.8655760288238525, 0.5104007720947266, 1.7020397186279297, 1.4180071353912354, 2.00714111328125, 0.5359587669372559, 0.7771763801574707, 0.22453975677490234, 0.1332864761352539, 0.9007887840270996, 0.5472636222839355, 2.4425196647644043, 0.08234548568725586, 1.6387615203857422, 1.5371053218841553, 0.7430291175842285, 1.2300834655761719, 0.3133840560913086, 0.3334207534790039, 0.19573307037353516, 2.663137912750244, 0.594907283782959, 0.8534345626831055, 0.4904651641845703, 0.3540611267089844, 1.4381766319274902, 0.8111715316772461, 0.24463891983032227, 0.5441684722900391, 0.8890552520751953, 0.16155385971069336, 0.6785571575164795, 1.5040690898895264, 0.995215892791748, 1.0397768020629883, 0.4752640724182129, 2.000624179840088, 1.22890043258667, 1.306396484375, 1.6839900016784668], "mean_td_error": 1.1895397901535034, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}}, "num_env_steps_sampled": 18400, "num_env_steps_trained": 21760, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 21760, "last_target_update_ts": 18400, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 21760, "num_env_steps_sampled": 18400, "num_env_steps_trained": 21760, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 380.9351853155316, "num_env_steps_trained_throughput_per_sec": 487.59703720388046, "timesteps_total": 18400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36800, "timers": {"training_iteration_time_ms": 516.008, "sample_time_ms": 281.556, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 39.229, "learn_throughput": 6525.727, "synch_weights_time_ms": 9.034}, "counters": {"num_env_steps_sampled": 18400, "num_env_steps_trained": 21760, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 21760, "last_target_update_ts": 18400, "num_target_updates": 85}, "done": false, "episodes_total": 36, "training_iteration": 40, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-03", "timestamp": 1742591223, "time_this_iter_s": 1.0668692588806152, "time_total_s": 48.218907833099365, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A8E820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 48.218907833099365, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 34.1, "ram_util_percent": 77.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.347296714782715, "actor_loss": -14.418022155761719, "critic_loss": 0.2847819924354553, "alpha_loss": -0.34444770216941833, "alpha_value": 0.9745236039161682, "log_alpha_value": -0.025806549936532974, "target_entropy": -8.0, "policy_t": -0.01903185434639454, "mean_q": 9.349342346191406, "max_q": 14.025779724121094, "min_q": 6.467400074005127}, "td_error": [1.0384783744812012, 0.6995854377746582, 0.49253010749816895, 1.0406394004821777, 1.1775636672973633, 0.48196935653686523, 3.1928296089172363, 1.2191929817199707, 0.7748932838439941, 2.3908064365386963, 1.9199652671813965, 2.207641124725342, 0.45107388496398926, 0.7230195999145508, 2.9897665977478027, 0.527961254119873, 1.001657485961914, 1.3101606369018555, 2.3298568725585938, 1.5429987907409668, 1.4519357681274414, 3.0339879989624023, 0.47464561462402344, 0.9428195953369141, 0.5826935768127441, 0.45444250106811523, 0.3247642517089844, 0.4794893264770508, 1.0436713695526123, 2.1944875717163086, 1.1622538566589355, 0.5387907028198242, 1.8545141220092773, 0.3457622528076172, 0.9187419414520264, 0.23226022720336914, 0.6014394760131836, 1.9887804985046387, 1.5363540649414062, 1.6966676712036133, 0.6105141639709473, 2.0357627868652344, 0.36028146743774414, 0.20907831192016602, 0.6227822303771973, 1.4653589725494385, 0.6271238327026367, 0.9476776123046875, 2.3965697288513184, 0.4398348331451416, 1.8186511993408203, 4.627830505371094, 0.9776792526245117, 1.6239514350891113, 1.4955828189849854, 0.4623994827270508, 0.2741975784301758, 0.19975709915161133, 1.4757752418518066, 0.8704752922058105, 1.0173792839050293, 4.537583827972412, 0.16376447677612305, 0.5557026863098145, 0.3165597915649414, 0.3174295425415039, 0.35449790954589844, 3.844870090484619, 0.37329721450805664, 1.2461681365966797, 0.9367918968200684, 4.086345195770264, 0.2717552185058594, 0.5044951438903809, 0.5065064430236816, 1.8205490112304688, 1.2737164497375488, 0.36548805236816406, 1.7715215682983398, 0.4934077262878418, 1.1026020050048828, 1.6060822010040283, 2.234714984893799, 0.8778250217437744, 0.5742993354797363, 0.7142951488494873, 3.219359874725342, 1.775223731994629, 2.853605270385742, 0.6680293083190918, 0.5245428085327148, 1.0659332275390625, 0.3010239601135254, 2.818265438079834, 2.4830760955810547, 0.9248123168945312, 1.0611286163330078, 0.488311767578125, 1.1230642795562744, 0.1078939437866211, 2.5869369506835938, 2.481022834777832, 1.6665458679199219, 0.8698549270629883, 1.534470558166504, 1.2599623203277588, 0.5245490074157715, 0.477508544921875, 0.09940719604492188, 1.8241167068481445, 0.9642891883850098, 1.2521710395812988, 1.4393401145935059, 0.4216904640197754, 2.2736940383911133, 0.6030645370483398, 4.076286792755127, 2.821308135986328, 0.3302011489868164, 0.612116813659668, 1.365407943725586, 1.105128526687622, 1.1498703956604004, 1.325098991394043, 0.486147403717041, 1.9171533584594727, 1.260648250579834, 3.402513027191162], "mean_td_error": 1.283787488937378, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.311186790466309, "actor_loss": -13.95157527923584, "critic_loss": 0.26165860891342163, "alpha_loss": -0.3434549868106842, "alpha_value": 0.9745280146598816, "log_alpha_value": -0.02580198273062706, "target_entropy": -8.0, "policy_t": 0.03331759572029114, "mean_q": 8.838286399841309, "max_q": 14.074467658996582, "min_q": 5.845958709716797}, "td_error": [0.710078239440918, 2.5480825901031494, 0.29036450386047363, 1.8714730739593506, 2.039285182952881, 0.18418502807617188, 2.8177313804626465, 0.30963993072509766, 0.774113655090332, 2.201977491378784, 1.9441733360290527, 1.2489445209503174, 0.9625015258789062, 3.8353257179260254, 1.0027456283569336, 0.6810741424560547, 2.584070920944214, 0.16180801391601562, 3.1984305381774902, 1.8401079177856445, 0.888085126876831, 0.7344794273376465, 1.0390100479125977, 1.3445336818695068, 1.4757580757141113, 2.6053528785705566, 1.1398406028747559, 0.26505374908447266, 0.44548797607421875, 2.0272200107574463, 0.2584266662597656, 1.1459765434265137, 1.2245590686798096, 1.1931047439575195, 0.9112207889556885, 0.9189023971557617, 1.2637553215026855, 1.3304023742675781, 0.6422028541564941, 0.5536057949066162, 1.5482513904571533, 0.5365519523620605, 0.15931224822998047, 2.215803861618042, 0.973261833190918, 0.9200725555419922, 0.5375514030456543, 1.279292106628418, 3.645162582397461, 0.8334441184997559, 0.39630937576293945, 1.2662885189056396, 0.2382216453552246, 0.6963911056518555, 0.43877363204956055, 0.9577732086181641, 2.4603090286254883, 0.8316531181335449, 1.1683216094970703, 0.7206077575683594, 0.9150209426879883, 1.836223840713501, 0.44818973541259766, 0.6212992668151855, 1.8289251327514648, 1.947584629058838, 0.39124155044555664, 1.1632542610168457, 2.147479772567749, 1.397845983505249, 0.355466365814209, 2.738847255706787, 2.1799678802490234, 3.706111431121826, 0.7829914093017578, 0.4955887794494629, 0.8448729515075684, 1.404118537902832, 1.9814629554748535, 2.383474349975586, 0.2767214775085449, 2.023082733154297, 1.2932965755462646, 0.28105735778808594, 2.843743324279785, 0.8012452125549316, 2.1062769889831543, 1.0554256439208984, 1.380488395690918, 1.7357892990112305, 0.4278392791748047, 0.39918947219848633, 0.6876134872436523, 0.1197361946105957, 1.412339210510254, 1.480736255645752, 0.14102602005004883, 0.45946264266967773, 0.30713558197021484, 0.8634176254272461, 2.548255681991577, 0.9865269660949707, 1.2206711769104004, 0.26842498779296875, 0.9593067169189453, 1.2503318786621094, 0.06807518005371094, 0.6699919700622559, 0.8709831237792969, 2.247134208679199, 0.5836348533630371, 0.9690008163452148, 0.6462283134460449, 0.3758673667907715, 2.2765581607818604, 1.2112631797790527, 2.473857879638672, 0.25301504135131836, 2.3673830032348633, 1.6929986476898193, 2.8048572540283203, 2.7963929176330566, 0.30786705017089844, 0.5333664417266846, 0.8770051002502441, 2.433228015899658, 0.20734930038452148, 0.7034430503845215], "mean_td_error": 1.239883303642273, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 18800, "num_env_steps_trained": 22272, "num_agent_steps_sampled": 37600, "num_agent_steps_trained": 22272, "last_target_update_ts": 18800, "num_target_updates": 87}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37600, "num_agent_steps_trained": 22272, "num_env_steps_sampled": 18800, "num_env_steps_trained": 22272, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 321.050249639811, "num_env_steps_trained_throughput_per_sec": 410.9443195389581, "timesteps_total": 18800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37600, "timers": {"training_iteration_time_ms": 537.242, "sample_time_ms": 279.885, "load_time_ms": 0.836, "load_throughput": 306345.742, "learn_time_ms": 37.522, "learn_throughput": 6822.745, "synch_weights_time_ms": 9.31}, "counters": {"num_env_steps_sampled": 18800, "num_env_steps_trained": 22272, "num_agent_steps_sampled": 37600, "num_agent_steps_trained": 22272, "last_target_update_ts": 18800, "num_target_updates": 87}, "done": false, "episodes_total": 36, "training_iteration": 41, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-04", "timestamp": 1742591224, "time_this_iter_s": 1.2583997249603271, "time_total_s": 49.47730755805969, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 49.47730755805969, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 32.05, "ram_util_percent": 77.5}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.385146141052246, "actor_loss": -14.031126022338867, "critic_loss": 0.22152113914489746, "alpha_loss": -0.3534280061721802, "alpha_value": 0.9739410281181335, "log_alpha_value": -0.026404496282339096, "target_entropy": -8.0, "policy_t": -0.038277484476566315, "mean_q": 9.102409362792969, "max_q": 13.906045913696289, "min_q": 6.013908386230469}, "td_error": [0.10955619812011719, 0.9375455379486084, 3.132946491241455, 0.43155336380004883, 1.379565715789795, 3.5392379760742188, 0.7255516052246094, 1.6553230285644531, 1.2258782386779785, 1.3179330825805664, 0.8094644546508789, 1.0496878623962402, 1.0692987442016602, 1.532348871231079, 1.573005199432373, 2.164564609527588, 0.4474215507507324, 3.235715866088867, 1.388869285583496, 0.86590576171875, 0.4283151626586914, 1.062389850616455, 0.4758009910583496, 0.6662423610687256, 0.3214550018310547, 1.859598159790039, 0.9531240463256836, 0.7719411849975586, 0.12084197998046875, 1.3978159427642822, 1.672764778137207, 1.3734869956970215, 1.3196477890014648, 0.5987424850463867, 0.28188395500183105, 0.4206242561340332, 0.4535255432128906, 2.8774237632751465, 2.5055742263793945, 1.2938528060913086, 1.32700777053833, 1.7390766143798828, 0.6675505638122559, 1.0423169136047363, 0.7475416660308838, 0.4131193161010742, 0.3997371196746826, 0.7872314453125, 0.40092992782592773, 0.4615306854248047, 1.1574630737304688, 0.726435661315918, 0.6954131126403809, 1.01054048538208, 0.7050843238830566, 2.0489625930786133, 0.2115788459777832, 1.538395643234253, 0.9601671695709229, 1.3083181381225586, 0.8412055969238281, 0.6712346076965332, 2.0736565589904785, 2.072906494140625, 1.0537433624267578, 1.7496747970581055, 1.1038508415222168, 0.933272123336792, 1.4214606285095215, 3.9951963424682617, 2.9533605575561523, 0.8294610977172852, 1.1806550025939941, 1.162463903427124, 1.1663365364074707, 0.462526798248291, 0.5877809524536133, 0.7409625053405762, 1.158186435699463, 2.220245838165283, 0.6596131324768066, 0.35979175567626953, 0.2602243423461914, 0.5402657985687256, 0.5123472213745117, 1.9759407043457031, 2.1308646202087402, 1.672821283340454, 0.9416375160217285, 2.1359188556671143, 0.41968441009521484, 1.4401307106018066, 0.4101705551147461, 1.4251127243041992, 1.6450214385986328, 1.6902170181274414, 0.7085275650024414, 1.605320930480957, 0.5192761421203613, 0.7039890289306641, 2.1414217948913574, 1.4163732528686523, 1.1557989120483398, 1.9049086570739746, 1.6975536346435547, 0.4613652229309082, 0.4564356803894043, 0.46294379234313965, 1.2043108940124512, 0.8544740676879883, 1.5506277084350586, 2.577327013015747, 0.557680606842041, 1.356255054473877, 0.2586507797241211, 0.358370304107666, 1.0860371589660645, 1.3668537139892578, 0.300260066986084, 0.7647922039031982, 0.5510320663452148, 0.9123005867004395, 1.295926570892334, 0.9763836860656738, 2.71720552444458, 2.1585888862609863, 0.9984421730041504, 1.0589351654052734], "mean_td_error": 1.1760245561599731, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.471942901611328, "actor_loss": -13.896761894226074, "critic_loss": 0.21658653020858765, "alpha_loss": -0.3556573987007141, "alpha_value": 0.9739455580711365, "log_alpha_value": -0.02639986388385296, "target_entropy": -8.0, "policy_t": 0.006505908910185099, "mean_q": 8.617984771728516, "max_q": 12.536949157714844, "min_q": 5.387642860412598}, "td_error": [2.4383084774017334, 0.22939825057983398, 0.4543793201446533, 0.34746742248535156, 0.937748908996582, 0.22082757949829102, 0.572174072265625, 1.7176406383514404, 0.6385364532470703, 1.0483415126800537, 0.27973508834838867, 3.068211555480957, 2.0047905445098877, 0.6434447765350342, 0.7748498916625977, 0.21763324737548828, 0.43373632431030273, 0.6700434684753418, 0.4333782196044922, 1.2391817569732666, 2.0201358795166016, 0.7935895919799805, 0.3902602195739746, 1.6583764553070068, 0.5834240913391113, 1.2926454544067383, 2.5444464683532715, 0.10751008987426758, 1.8091473579406738, 1.2402467727661133, 1.8034858703613281, 0.5810565948486328, 0.9993784427642822, 1.2649085521697998, 0.5549445152282715, 3.049130439758301, 0.514723539352417, 2.771332263946533, 1.0298686027526855, 0.5844011306762695, 1.1206388473510742, 0.7890946865081787, 0.6088719367980957, 2.0275216102600098, 0.7171182632446289, 1.9933738708496094, 0.5695652961730957, 0.4395484924316406, 1.1774446964263916, 1.10821533203125, 2.9598288536071777, 0.39230966567993164, 0.8503322601318359, 1.170044183731079, 2.1804451942443848, 0.5435266494750977, 1.609891414642334, 1.8581888675689697, 2.4480810165405273, 0.9215750694274902, 1.1738054752349854, 1.5228967666625977, 0.824458122253418, 0.473177433013916, 1.49076247215271, 1.9401061534881592, 0.37442851066589355, 1.308741569519043, 2.477860927581787, 0.6832995414733887, 1.7732014656066895, 0.871943473815918, 0.4439401626586914, 1.5740036964416504, 1.4024684429168701, 0.46790599822998047, 0.97418212890625, 1.2390239238739014, 1.214235782623291, 2.2206153869628906, 2.1524806022644043, 1.1220340728759766, 1.8832931518554688, 0.647803783416748, 2.7769980430603027, 0.6260600090026855, 0.8102898597717285, 1.7908554077148438, 0.31691932678222656, 0.9219741821289062, 0.6949515342712402, 1.8664579391479492, 0.3512411117553711, 0.5544195175170898, 2.509450912475586, 1.3667454719543457, 0.8432352542877197, 0.5454673767089844, 2.546205520629883, 1.8435983657836914, 1.772470474243164, 0.0656595230102539, 0.7670650482177734, 0.970994234085083, 0.9099082946777344, 0.8140411376953125, 1.0643234252929688, 0.27912425994873047, 1.0890707969665527, 1.3723783493041992, 1.1617717742919922, 1.2727689743041992, 0.46396636962890625, 1.5748748779296875, 1.914947748184204, 0.2849588394165039, 1.3145251274108887, 0.030611038208007812, 0.5197334289550781, 0.6915054321289062, 0.8741815090179443, 0.38797473907470703, 0.19098711013793945, 0.3304319381713867, 0.7787561416625977, 2.1289992332458496, 1.0653767585754395, 1.3378021717071533], "mean_td_error": 1.1367125511169434, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 88.0}}, "num_env_steps_sampled": 19200, "num_env_steps_trained": 22784, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 22784, "last_target_update_ts": 19200, "num_target_updates": 89}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 22784, "num_env_steps_sampled": 19200, "num_env_steps_trained": 22784, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 387.61720261673474, "num_env_steps_trained_throughput_per_sec": 496.1500193494205, "timesteps_total": 19200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 536.615, "sample_time_ms": 280.74, "load_time_ms": 0.836, "load_throughput": 306345.742, "learn_time_ms": 37.505, "learn_throughput": 6825.69, "synch_weights_time_ms": 9.925}, "counters": {"num_env_steps_sampled": 19200, "num_env_steps_trained": 22784, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 22784, "last_target_update_ts": 19200, "num_target_updates": 89}, "done": false, "episodes_total": 36, "training_iteration": 42, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-05", "timestamp": 1742591225, "time_this_iter_s": 1.0418787002563477, "time_total_s": 50.51918625831604, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A7D280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 50.51918625831604, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 33.25, "ram_util_percent": 77.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.349637985229492, "actor_loss": -14.056862831115723, "critic_loss": 0.21412524580955505, "alpha_loss": -0.3604732155799866, "alpha_value": 0.9733588099479675, "log_alpha_value": -0.027002472430467606, "target_entropy": -8.0, "policy_t": -0.01324739120900631, "mean_q": 9.083473205566406, "max_q": 13.601436614990234, "min_q": 6.3114728927612305}, "td_error": [0.5660700798034668, 1.5389633178710938, 0.9958670139312744, 0.11688566207885742, 0.2066338062286377, 0.5230879783630371, 0.5185918807983398, 1.114344596862793, 0.5464687347412109, 3.2123255729675293, 1.285151481628418, 1.9129700660705566, 0.43453407287597656, 0.5680909156799316, 1.3540079593658447, 0.7020831108093262, 1.2711176872253418, 1.7999019622802734, 1.001969814300537, 0.15881919860839844, 0.2272963523864746, 2.9879250526428223, 1.2845141887664795, 0.568817138671875, 0.12364053726196289, 1.7170054912567139, 2.7012343406677246, 1.8727164268493652, 1.1433138847351074, 0.6926436424255371, 1.659013271331787, 0.31973981857299805, 0.6043024063110352, 0.7305288314819336, 0.37070322036743164, 1.7735776901245117, 1.313549518585205, 0.21593689918518066, 0.24538087844848633, 2.4005703926086426, 1.214822769165039, 1.0274577140808105, 3.04160737991333, 0.9644298553466797, 0.28936052322387695, 0.18850421905517578, 1.7534496784210205, 0.4968900680541992, 3.327932834625244, 0.41974592208862305, 1.5929219722747803, 2.934591770172119, 0.5914480686187744, 0.3890376091003418, 0.5174965858459473, 0.6244816780090332, 0.3480043411254883, 0.6346530914306641, 1.5078649520874023, 1.4183542728424072, 3.0376758575439453, 1.4947481155395508, 0.16573667526245117, 0.8039834499359131, 0.10110354423522949, 2.91748046875, 0.49761033058166504, 1.825155258178711, 0.6933095455169678, 0.6895177364349365, 0.9714593887329102, 0.6375489234924316, 0.33016467094421387, 1.687047004699707, 0.42351698875427246, 0.7970535755157471, 2.4049525260925293, 1.0389316082000732, 2.2387914657592773, 1.4673805236816406, 0.31899309158325195, 0.7338700294494629, 0.6630187034606934, 0.4129772186279297, 0.9529619216918945, 0.6088910102844238, 1.2313594818115234, 1.5458989143371582, 0.2997870445251465, 2.3878965377807617, 0.5726318359375, 4.0948710441589355, 0.4323296546936035, 2.3449084758758545, 2.403334617614746, 0.7224416732788086, 1.2858819961547852, 1.33998441696167, 0.4487955570220947, 0.986424446105957, 0.17892789840698242, 0.043474674224853516, 0.7089738845825195, 0.5207197666168213, 1.181675910949707, 1.90142822265625, 1.8135738372802734, 0.8625125885009766, 0.2991526126861572, 1.5580830574035645, 1.1884305477142334, 1.6425867080688477, 0.6478302478790283, 0.7201929092407227, 2.760343074798584, 0.8682541847229004, 0.5717105865478516, 0.872316837310791, 2.068312644958496, 0.98760986328125, 0.7377924919128418, 0.22260665893554688, 2.865656852722168, 0.6871395111083984, 0.644920825958252, 1.5219364166259766, 0.37581300735473633, 1.0175328254699707], "mean_td_error": 1.121431827545166, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.358419418334961, "actor_loss": -13.775012016296387, "critic_loss": 0.2184525728225708, "alpha_loss": -0.3606506884098053, "alpha_value": 0.9733631610870361, "log_alpha_value": -0.026998009532690048, "target_entropy": -8.0, "policy_t": 0.02361297607421875, "mean_q": 8.591411590576172, "max_q": 12.8218355178833, "min_q": 6.253011703491211}, "td_error": [1.8019280433654785, 1.9994935989379883, 0.9357340335845947, 0.609199047088623, 0.46820640563964844, 2.337794542312622, 1.4833123683929443, 0.05037641525268555, 1.2540857791900635, 0.4910879135131836, 2.2785937786102295, 0.5779478549957275, 0.32773733139038086, 1.0205254554748535, 0.5722923278808594, 1.0182838439941406, 1.1923832893371582, 2.1828794479370117, 0.9087958335876465, 0.11962699890136719, 2.712048292160034, 0.8733100891113281, 0.8812243938446045, 0.3408989906311035, 1.3113093376159668, 1.125976800918579, 0.11721229553222656, 1.9640274047851562, 1.1054913997650146, 2.2992403507232666, 0.31001806259155273, 1.5075933933258057, 2.7346415519714355, 0.2608814239501953, 0.4660983085632324, 1.7209811210632324, 2.0480713844299316, 2.2352402210235596, 1.3555665016174316, 0.4712376594543457, 1.1590423583984375, 1.3464908599853516, 1.2004337310791016, 1.0623648166656494, 2.7417516708374023, 0.1254901885986328, 1.606898307800293, 0.7460355758666992, 0.23673009872436523, 0.21841049194335938, 0.6998910903930664, 1.624539852142334, 2.363319158554077, 3.027118682861328, 0.8101468086242676, 1.3634648323059082, 1.990875482559204, 1.6740663051605225, 2.481039524078369, 2.741804838180542, 0.3934750556945801, 1.0214357376098633, 1.7190818786621094, 0.9406709671020508, 0.9264123439788818, 1.1470754146575928, 1.702070713043213, 0.8437650203704834, 1.4679203033447266, 1.270853042602539, 1.777186393737793, 2.157534599304199, 0.6320624351501465, 1.4926152229309082, 0.3450455665588379, 0.979935884475708, 0.3752622604370117, 0.43533945083618164, 0.7256293296813965, 0.38216066360473633, 1.0295133590698242, 1.7720046043395996, 1.0072555541992188, 0.39057254791259766, 1.196690559387207, 0.05051279067993164, 1.2460112571716309, 0.10933446884155273, 0.37204456329345703, 0.14061450958251953, 1.372917652130127, 0.35956907272338867, 1.7217261791229248, 2.2610535621643066, 1.5645866394042969, 0.3463602066040039, 0.5269155502319336, 0.6759915351867676, 1.4050657749176025, 0.9479432106018066, 2.0190563201904297, 0.6057538986206055, 0.6393795013427734, 0.584679365158081, 0.2061777114868164, 0.3989720344543457, 0.4260220527648926, 0.8918251991271973, 0.9842324256896973, 1.2866320610046387, 0.5437579154968262, 0.4029386043548584, 1.0473837852478027, 0.1252155303955078, 1.2853751182556152, 2.297553062438965, 1.0699334144592285, 1.1216773986816406, 0.6467204093933105, 0.40546417236328125, 1.3792238235473633, 0.4173312187194824, 0.44661617279052734, 2.4147634506225586, 0.6701934337615967, 0.35356664657592773, 1.6345841884613037, 0.4849724769592285], "mean_td_error": 1.0993242263793945, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 19600, "num_env_steps_trained": 23296, "num_agent_steps_sampled": 39200, "num_agent_steps_trained": 23296, "last_target_update_ts": 19600, "num_target_updates": 91}, "sampler_results": {"episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1937.336576536227, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1948.2284394279782, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2144.771681491745}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}}, "episode_reward_max": 4200.407549987731, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3885.5650159642046, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2144.771681491745}, "policy_reward_mean": {"robot_0": 1937.336576536227, "robot_1": 1948.2284394279782}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733213353698586, "mean_inference_ms": 3.4369791117230166, "mean_action_processing_ms": 0.4651516069812772, "mean_env_wait_ms": 0.4786167355446386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281935162014432, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08310543166266547}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39200, "num_agent_steps_trained": 23296, "num_env_steps_sampled": 19600, "num_env_steps_trained": 23296, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 394.9708431131127, "num_env_steps_trained_throughput_per_sec": 505.56267918478426, "timesteps_total": 19600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39200, "timers": {"training_iteration_time_ms": 535.17, "sample_time_ms": 282.055, "load_time_ms": 0.836, "load_throughput": 306345.742, "learn_time_ms": 37.44, "learn_throughput": 6837.683, "synch_weights_time_ms": 9.698}, "counters": {"num_env_steps_sampled": 19600, "num_env_steps_trained": 23296, "num_agent_steps_sampled": 39200, "num_agent_steps_trained": 23296, "last_target_update_ts": 19600, "num_target_updates": 91}, "done": false, "episodes_total": 36, "training_iteration": 43, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-06", "timestamp": 1742591226, "time_this_iter_s": 1.0292723178863525, "time_total_s": 51.54845857620239, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFDE960940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 51.54845857620239, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.0, "ram_util_percent": 77.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.325332641601562, "actor_loss": -13.799993515014648, "critic_loss": 0.1833307147026062, "alpha_loss": -0.3677848279476166, "alpha_value": 0.9727770090103149, "log_alpha_value": -0.027600422501564026, "target_entropy": -8.0, "policy_t": -0.0048142378218472, "mean_q": 8.736227989196777, "max_q": 12.465476036071777, "min_q": 5.7529473304748535}, "td_error": [1.022202730178833, 1.1670584678649902, 1.2195234298706055, 0.7764773368835449, 0.20686912536621094, 0.7122654914855957, 0.5247912406921387, 0.6653928756713867, 0.47168827056884766, 0.7205510139465332, 0.48004984855651855, 0.6713438034057617, 0.49904537200927734, 0.7405800819396973, 1.7733709812164307, 0.4391508102416992, 2.730013370513916, 0.9237945079803467, 0.39215755462646484, 1.41508150100708, 1.3713696002960205, 0.34967613220214844, 0.2716035842895508, 0.7356452941894531, 0.25366830825805664, 1.004621982574463, 1.653395652770996, 0.9621143341064453, 0.2965660095214844, 1.4003913402557373, 1.4654173851013184, 0.7700691223144531, 0.7359538078308105, 1.5812442302703857, 0.4430050849914551, 1.6593046188354492, 0.2234361171722412, 2.3192758560180664, 0.6475484371185303, 0.5935485363006592, 1.0704216957092285, 0.41640663146972656, 0.31665515899658203, 2.3376259803771973, 1.9764108657836914, 0.2703590393066406, 3.125953197479248, 0.21468544006347656, 1.2511835098266602, 0.8325204849243164, 1.6107769012451172, 0.531123161315918, 0.35233116149902344, 1.6457855701446533, 0.8270053863525391, 1.3662834167480469, 0.6989710330963135, 1.181060791015625, 0.6166877746582031, 0.458385705947876, 0.5031466484069824, 3.4316487312316895, 0.9756250381469727, 0.6105852127075195, 0.41233110427856445, 1.0317363739013672, 0.31885623931884766, 0.2583305835723877, 0.5475363731384277, 0.5383315086364746, 2.457890748977661, 0.18340015411376953, 2.248300075531006, 0.19258928298950195, 0.8781404495239258, 0.14125967025756836, 1.2451560497283936, 3.093738079071045, 1.166834831237793, 1.0789685249328613, 1.8278045654296875, 0.4252784252166748, 0.349489688873291, 1.1816678047180176, 1.2213640213012695, 1.4457640647888184, 0.5473532676696777, 1.60624361038208, 0.5288295745849609, 0.301971435546875, 0.6715278625488281, 0.2522616386413574, 0.28904271125793457, 1.1294159889221191, 0.42641639709472656, 2.0854814052581787, 0.3206057548522949, 0.9282240867614746, 1.446122646331787, 1.241647720336914, 0.390718936920166, 1.2172389030456543, 1.885401725769043, 1.2122082710266113, 0.5758659839630127, 2.785365581512451, 1.0055665969848633, 3.1235275268554688, 0.4143409729003906, 1.2175970077514648, 0.4278249740600586, 1.7732248306274414, 2.4137606620788574, 2.2593822479248047, 0.5726189613342285, 1.604480266571045, 0.6984767913818359, 0.21602535247802734, 1.0044398307800293, 0.4405527114868164, 1.1753273010253906, 2.4351534843444824, 1.5698192119598389, 1.1502528190612793, 0.31729698181152344, 1.128735065460205, 1.543985366821289, 0.3442058563232422], "mean_td_error": 1.0299547910690308, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.37027359008789, "actor_loss": -13.693398475646973, "critic_loss": 0.23230020701885223, "alpha_loss": -0.36896634101867676, "alpha_value": 0.972781240940094, "log_alpha_value": -0.027596021071076393, "target_entropy": -8.0, "policy_t": 0.037011679261922836, "mean_q": 8.48196029663086, "max_q": 12.32898998260498, "min_q": 6.181219100952148}, "td_error": [1.1893901824951172, 1.7747230529785156, 0.7145843505859375, 1.4935874938964844, 1.5830316543579102, 0.11294174194335938, 1.983567237854004, 1.9506144523620605, 1.1927881240844727, 0.5123846530914307, 4.255017280578613, 0.06318926811218262, 0.2729802131652832, 1.6156344413757324, 0.17563438415527344, 1.3571686744689941, 2.7501728534698486, 0.9463510513305664, 1.0539288520812988, 0.35781264305114746, 0.5883297920227051, 0.7891817092895508, 1.1820614337921143, 0.47026491165161133, 1.0956337451934814, 0.5642175674438477, 0.5086297988891602, 1.781778335571289, 1.0306086540222168, 1.9910964965820312, 1.2609519958496094, 0.847743034362793, 1.0979499816894531, 2.0169262886047363, 2.573241949081421, 0.016693115234375, 0.5151739120483398, 1.2309637069702148, 0.38110780715942383, 0.7647857666015625, 1.0029573440551758, 1.5824615955352783, 0.5713348388671875, 1.3362030982971191, 1.0339066982269287, 1.5769248008728027, 0.6908206939697266, 0.7986049652099609, 1.939215898513794, 0.5888400077819824, 1.8469734191894531, 1.1024208068847656, 0.40647006034851074, 0.27227115631103516, 1.249974250793457, 0.1896505355834961, 2.443497657775879, 1.095426082611084, 0.5085563659667969, 0.6409773826599121, 0.6921234130859375, 0.4599795341491699, 0.42555713653564453, 0.4509553909301758, 1.0121521949768066, 0.8423442840576172, 4.091479778289795, 0.16229486465454102, 1.1973514556884766, 0.42618703842163086, 1.6915249824523926, 1.1524419784545898, 0.6650128364562988, 0.4194455146789551, 0.2867155075073242, 0.5511751174926758, 3.4662461280822754, 0.6570391654968262, 0.42278337478637695, 2.7158126831054688, 0.782928466796875, 3.1875569820404053, 0.21030139923095703, 1.114781379699707, 1.1310157775878906, 0.5574486255645752, 1.1718776226043701, 1.3615450859069824, 1.391427993774414, 2.3102879524230957, 2.915419816970825, 0.26476049423217773, 1.4046716690063477, 0.8722481727600098, 0.7800602912902832, 0.7236433029174805, 0.8112797737121582, 3.6942358016967773, 0.47037410736083984, 0.7321867942810059, 0.6459164619445801, 1.363602876663208, 0.6695060729980469, 2.0659639835357666, 1.6589560508728027, 0.5279402732849121, 0.7319643497467041, 1.458108901977539, 0.5064606666564941, 0.1099848747253418, 0.41453027725219727, 1.6261510848999023, 1.3032481670379639, 2.101369857788086, 2.229743242263794, 0.09633541107177734, 2.1180450916290283, 0.17778968811035156, 0.847435474395752, 2.3372726440429688, 1.738502025604248, 0.4093742370605469, 0.728405237197876, 2.2308762073516846, 1.0931286811828613, 1.2006628513336182, 1.2101571559906006, 1.6521949768066406], "mean_td_error": 1.1552393436431885, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 23808, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 23808, "last_target_update_ts": 20000, "num_target_updates": 93}, "sampler_results": {"episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}}, "episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 23808, "num_env_steps_sampled": 20000, "num_env_steps_trained": 23808, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 371.96340585236766, "num_env_steps_trained_throughput_per_sec": 476.1131594910306, "timesteps_total": 20000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 541.601, "sample_time_ms": 284.534, "load_time_ms": 0.836, "load_throughput": 306345.742, "learn_time_ms": 36.639, "learn_throughput": 6987.009, "synch_weights_time_ms": 10.259}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 23808, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 23808, "last_target_update_ts": 20000, "num_target_updates": 93}, "done": false, "episodes_total": 40, "training_iteration": 44, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-07", "timestamp": 1742591227, "time_this_iter_s": 1.091651201248169, "time_total_s": 52.64010977745056, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 52.64010977745056, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 36.05, "ram_util_percent": 77.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.386489868164062, "actor_loss": -13.43212890625, "critic_loss": 0.21968111395835876, "alpha_loss": -0.3774748742580414, "alpha_value": 0.9721956849098206, "log_alpha_value": -0.02819819562137127, "target_entropy": -8.0, "policy_t": 0.007849881425499916, "mean_q": 8.316490173339844, "max_q": 12.45775032043457, "min_q": 5.603795528411865}, "td_error": [0.530667781829834, 0.8033132553100586, 0.9206104278564453, 0.33231687545776367, 2.4792540073394775, 1.198749303817749, 0.13880586624145508, 1.4883570671081543, 1.389516830444336, 1.5699365139007568, 1.8886938095092773, 1.1345679759979248, 0.7381010055541992, 1.2430837154388428, 0.8806765079498291, 0.4249105453491211, 0.6284337043762207, 1.3865911960601807, 3.247648239135742, 0.1147313117980957, 0.4747180938720703, 0.6286988258361816, 1.1486353874206543, 0.7827057838439941, 2.262233257293701, 1.0775532722473145, 0.3885307312011719, 1.3406250476837158, 1.0661406517028809, 1.2512903213500977, 2.217590570449829, 0.28318262100219727, 1.5490293502807617, 1.388420581817627, 0.47538089752197266, 0.4058976173400879, 0.4229869842529297, 1.086238145828247, 0.7882623672485352, 0.24480390548706055, 1.27360200881958, 1.6737852096557617, 3.1163320541381836, 0.9076924324035645, 1.2996025085449219, 1.6535418033599854, 1.6131911277770996, 0.3260691165924072, 1.9860148429870605, 0.3444032669067383, 3.1219382286071777, 0.15427255630493164, 1.7567577362060547, 0.7103638648986816, 0.07480049133300781, 0.6216163635253906, 0.5644681453704834, 0.17841815948486328, 0.6120445728302002, 2.6995959281921387, 0.7600255012512207, 1.0006704330444336, 1.3265676498413086, 1.0508368015289307, 0.7962896823883057, 0.9692215919494629, 0.6512236595153809, 3.12066650390625, 0.367673397064209, 0.39449501037597656, 0.8031032085418701, 0.9532942771911621, 2.3402111530303955, 1.5659384727478027, 1.3520491123199463, 2.9919025897979736, 0.08744525909423828, 0.533118724822998, 1.0203971862792969, 0.6410644054412842, 1.534315586090088, 0.6716287136077881, 1.802055835723877, 1.5510778427124023, 0.6735067367553711, 0.7234337329864502, 1.8286020755767822, 0.4485650062561035, 1.08066987991333, 1.342803716659546, 0.3335757255554199, 2.086760997772217, 0.28937387466430664, 1.040283203125, 1.5600476264953613, 0.6591382026672363, 2.4745187759399414, 0.39277172088623047, 0.4917130470275879, 0.5625667572021484, 2.0701534748077393, 1.409111738204956, 0.11484718322753906, 1.6839423179626465, 2.8715686798095703, 0.8555223941802979, 0.2836894989013672, 0.4635758399963379, 0.21869277954101562, 0.7228198051452637, 2.5149128437042236, 0.21869277954101562, 2.5185234546661377, 0.9165709018707275, 3.226238489151001, 2.6244163513183594, 2.762155532836914, 1.607006549835205, 0.6713347434997559, 0.932889461517334, 0.8061957359313965, 0.5938506126403809, 0.5546936988830566, 1.0209479331970215, 0.42465853691101074, 0.9629473686218262, 0.7729644775390625, 0.7548630237579346], "mean_td_error": 1.135638952255249, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.374858856201172, "actor_loss": -13.572379112243652, "critic_loss": 0.19404718279838562, "alpha_loss": -0.37709444761276245, "alpha_value": 0.9721994996070862, "log_alpha_value": -0.028194274753332138, "target_entropy": -8.0, "policy_t": 0.014264152385294437, "mean_q": 8.438617706298828, "max_q": 12.094110488891602, "min_q": 5.9937825202941895}, "td_error": [1.7051501274108887, 0.07187366485595703, 0.9542121887207031, 2.1544835567474365, 2.0332188606262207, 0.3718423843383789, 0.7413620948791504, 2.0370829105377197, 1.4344062805175781, 2.0739781856536865, 1.9404890537261963, 0.3724803924560547, 0.26244449615478516, 1.9125452041625977, 0.9836587905883789, 1.424933910369873, 0.8427915573120117, 0.5546388626098633, 0.34851932525634766, 3.5840697288513184, 0.8225839138031006, 0.3953094482421875, 0.41631555557250977, 0.06335783004760742, 1.123328685760498, 1.2037081718444824, 1.3210082054138184, 2.3778562545776367, 1.4596476554870605, 0.4085216522216797, 1.6840953826904297, 2.0486180782318115, 0.5791130065917969, 1.2412452697753906, 0.5249366760253906, 1.31221342086792, 1.18214750289917, 1.3753042221069336, 0.9123318195343018, 0.7185161113739014, 2.259596586227417, 0.5977377891540527, 1.039771556854248, 2.5368990898132324, 0.8466830253601074, 0.39008283615112305, 0.3166196346282959, 1.322896957397461, 0.2972908020019531, 1.2966923713684082, 0.05391550064086914, 0.31734180450439453, 0.5574502944946289, 0.9487967491149902, 0.6107230186462402, 0.8701324462890625, 0.8444194793701172, 1.6074144840240479, 1.2169864177703857, 1.4290363788604736, 0.23492717742919922, 0.5831851959228516, 1.2385854721069336, 0.3783860206604004, 1.3788156509399414, 0.8072733879089355, 0.09955120086669922, 0.33651232719421387, 0.9718618392944336, 2.5973098278045654, 0.27741479873657227, 1.0021967887878418, 0.956507682800293, 0.46469593048095703, 0.6411442756652832, 0.7927634716033936, 0.8739452362060547, 1.5138118267059326, 1.8364312648773193, 0.31029415130615234, 0.11555957794189453, 1.5707285404205322, 1.6719117164611816, 2.1999969482421875, 1.1588006019592285, 1.2516062259674072, 1.7069201469421387, 0.031607627868652344, 1.9627923965454102, 0.5932865142822266, 1.7245476245880127, 0.46323680877685547, 1.50272798538208, 0.37490415573120117, 1.61264967918396, 0.7000274658203125, 0.729182243347168, 1.4868249893188477, 0.6501057147979736, 1.1289122104644775, 0.8736302852630615, 1.5863447189331055, 0.33380699157714844, 0.5918183326721191, 0.2029726505279541, 0.7810907363891602, 1.5977320671081543, 0.7069187164306641, 1.1100883483886719, 0.8665025234222412, 1.0979194641113281, 0.7104063034057617, 0.8822994232177734, 0.8085908889770508, 0.9303634166717529, 0.6501889228820801, 0.24941325187683105, 0.7391610145568848, 0.5344991683959961, 0.43851518630981445, 1.451418161392212, 0.943925142288208, 0.496182918548584, 1.4383339881896973, 1.742260456085205, 0.4590914249420166, 0.660926342010498, 0.9223356246948242], "mean_td_error": 1.0161993503570557, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 20400, "num_env_steps_trained": 24320, "num_agent_steps_sampled": 40800, "num_agent_steps_trained": 24320, "last_target_update_ts": 20400, "num_target_updates": 95}, "sampler_results": {"episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}}, "episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40800, "num_agent_steps_trained": 24320, "num_env_steps_sampled": 20400, "num_env_steps_trained": 24320, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 324.832764684858, "num_env_steps_trained_throughput_per_sec": 415.7859387966182, "timesteps_total": 20400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40800, "timers": {"training_iteration_time_ms": 559.737, "sample_time_ms": 292.56, "load_time_ms": 0.836, "load_throughput": 306345.742, "learn_time_ms": 39.574, "learn_throughput": 6468.959, "synch_weights_time_ms": 11.452}, "counters": {"num_env_steps_sampled": 20400, "num_env_steps_trained": 24320, "num_agent_steps_sampled": 40800, "num_agent_steps_trained": 24320, "last_target_update_ts": 20400, "num_target_updates": 95}, "done": false, "episodes_total": 40, "training_iteration": 45, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-09", "timestamp": 1742591229, "time_this_iter_s": 1.252321481704712, "time_total_s": 53.89243125915527, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A7D550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 53.89243125915527, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 45.3, "ram_util_percent": 77.85}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.262290000915527, "actor_loss": -13.614781379699707, "critic_loss": 0.23115834593772888, "alpha_loss": -0.38190242648124695, "alpha_value": 0.9716145396232605, "log_alpha_value": -0.028796114027500153, "target_entropy": -8.0, "policy_t": -0.004704331047832966, "mean_q": 8.656920433044434, "max_q": 13.365513801574707, "min_q": 4.913744926452637}, "td_error": [1.2884721755981445, 0.4928319454193115, 0.21424436569213867, 0.9513976573944092, 0.6041545867919922, 2.286252021789551, 2.235978364944458, 0.6423172950744629, 2.3204736709594727, 1.2044782638549805, 1.855506181716919, 0.5318551063537598, 0.3150515556335449, 3.0926880836486816, 1.7913620471954346, 1.5967130661010742, 0.7965595722198486, 1.0828828811645508, 0.1919083595275879, 0.4297604560852051, 2.031186580657959, 0.5041770935058594, 0.30707263946533203, 0.25312328338623047, 0.7154560089111328, 0.7386579513549805, 0.5063612461090088, 1.994215488433838, 1.039808988571167, 2.1222012042999268, 0.321835994720459, 2.9140334129333496, 0.2858562469482422, 1.1176471710205078, 0.42790770530700684, 1.1877543926239014, 2.4125428199768066, 0.8974578380584717, 2.509284257888794, 0.4471316337585449, 2.620075225830078, 1.944974422454834, 0.9772710800170898, 0.9592037200927734, 2.455319404602051, 2.2653613090515137, 1.157088279724121, 0.41945505142211914, 0.43630075454711914, 0.8748831748962402, 1.6927518844604492, 0.32405805587768555, 1.5148563385009766, 1.7555503845214844, 0.10702943801879883, 0.6904921531677246, 2.0582737922668457, 1.0028150081634521, 1.7974448204040527, 1.5091915130615234, 0.7900338172912598, 1.9932587146759033, 1.515172004699707, 0.21712589263916016, 1.2802989482879639, 1.5338168144226074, 0.5644159317016602, 1.4047658443450928, 0.579127311706543, 1.6978254318237305, 0.25044918060302734, 1.9729747772216797, 0.1983017921447754, 2.0688438415527344, 0.6456990242004395, 1.2446627616882324, 2.741387367248535, 1.8480165004730225, 1.6283783912658691, 0.9829401969909668, 2.4085285663604736, 1.6358399391174316, 0.6997833251953125, 0.18798112869262695, 1.4828391075134277, 2.255441904067993, 2.5710649490356445, 0.7749083042144775, 0.24883413314819336, 1.2275238037109375, 0.7420163154602051, 1.6018855571746826, 0.5075411796569824, 0.9519758224487305, 0.9890708923339844, 1.150601863861084, 2.920435905456543, 0.18027544021606445, 0.5360441207885742, 2.5570359230041504, 0.4203619956970215, 0.5129632949829102, 0.9015755653381348, 1.1237518787384033, 0.5746245384216309, 0.6238393783569336, 0.3623771667480469, 1.6138982772827148, 1.3109760284423828, 0.2545614242553711, 1.6158137321472168, 1.322014570236206, 0.6413359642028809, 2.1396026611328125, 0.38828372955322266, 0.7327346801757812, 2.076819658279419, 1.9270110130310059, 1.9020233154296875, 1.2582571506500244, 0.4785003662109375, 0.7613306045532227, 0.13127708435058594, 0.24129629135131836, 2.094404935836792, 2.1269519329071045, 0.9992856979370117, 0.8839426040649414], "mean_td_error": 1.1986557245254517, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.390222549438477, "actor_loss": -13.779833793640137, "critic_loss": 0.20253854990005493, "alpha_loss": -0.3855385184288025, "alpha_value": 0.9716179966926575, "log_alpha_value": -0.028792541474103928, "target_entropy": -8.0, "policy_t": 0.020663708448410034, "mean_q": 8.63166618347168, "max_q": 13.131875038146973, "min_q": 6.239365577697754}, "td_error": [0.5969643592834473, 0.31191110610961914, 0.5044817924499512, 0.7906179428100586, 1.312234878540039, 0.409423828125, 1.8507134914398193, 0.4510636329650879, 0.14223670959472656, 0.21370887756347656, 1.3434884548187256, 0.7958950996398926, 2.022970199584961, 0.22674274444580078, 1.6417744159698486, 1.7284278869628906, 2.224088191986084, 0.2893490791320801, 2.3031749725341797, 1.9014596939086914, 2.3129265308380127, 0.8332509994506836, 1.4331350326538086, 1.0416157245635986, 1.0621728897094727, 1.861508846282959, 0.8843770027160645, 0.778111457824707, 1.142247200012207, 1.3020949363708496, 2.11498761177063, 0.6106479167938232, 0.40233373641967773, 3.341325521469116, 0.34918785095214844, 0.1227254867553711, 1.2326440811157227, 0.7653694152832031, 0.08266448974609375, 0.09900093078613281, 1.1518774032592773, 1.2277641296386719, 0.768110990524292, 2.6560213565826416, 1.3642983436584473, 0.6662859916687012, 1.3490195274353027, 1.7733173370361328, 0.9170181751251221, 0.6895990371704102, 0.7842440605163574, 0.7316021919250488, 1.5013689994812012, 0.8441438674926758, 2.085568428039551, 0.7326970100402832, 0.33408164978027344, 2.1325254440307617, 0.39009618759155273, 1.6696701049804688, 1.9989187717437744, 1.7686855792999268, 1.2577741146087646, 2.443596363067627, 2.588644504547119, 1.0301315784454346, 1.1134257316589355, 1.4210410118103027, 0.3880295753479004, 0.8425889015197754, 0.10434150695800781, 1.357867956161499, 1.624868392944336, 1.1548454761505127, 1.5784482955932617, 1.273712396621704, 0.06824636459350586, 0.5995240211486816, 0.17798614501953125, 0.8262801170349121, 0.9710774421691895, 0.5313076972961426, 0.8263847827911377, 0.4372437000274658, 0.2797129154205322, 0.43314456939697266, 1.2599725723266602, 0.16586732864379883, 2.4699177742004395, 0.6400880813598633, 0.6523523330688477, 0.49802732467651367, 1.6966660022735596, 0.7560489177703857, 1.8377223014831543, 1.0124518871307373, 1.2603943347930908, 0.6647965908050537, 0.37204933166503906, 0.6436667442321777, 0.8728663921356201, 0.5632879734039307, 1.1372876167297363, 0.3831899166107178, 2.095444679260254, 1.665198564529419, 0.2953042984008789, 1.0660622119903564, 0.04318714141845703, 0.7340192794799805, 0.7311835289001465, 0.7485284805297852, 0.8514699935913086, 1.2053487300872803, 0.20267677307128906, 2.250844955444336, 0.32827281951904297, 0.7807245254516602, 1.2695419788360596, 3.622783660888672, 0.6279962062835693, 0.16367292404174805, 1.3256371021270752, 1.164330005645752, 0.4830489158630371, 0.5532536506652832, 1.2566285133361816, 0.39795637130737305], "mean_td_error": 1.0503902435302734, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 97.0, "diff_num_grad_updates_vs_sampler_policy": 96.0}}, "num_env_steps_sampled": 20800, "num_env_steps_trained": 24832, "num_agent_steps_sampled": 41600, "num_agent_steps_trained": 24832, "last_target_update_ts": 20800, "num_target_updates": 97}, "sampler_results": {"episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}}, "episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41600, "num_agent_steps_trained": 24832, "num_env_steps_sampled": 20800, "num_env_steps_trained": 24832, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 366.58922149355925, "num_env_steps_trained_throughput_per_sec": 469.2342035117559, "timesteps_total": 20800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41600, "timers": {"training_iteration_time_ms": 544.26, "sample_time_ms": 294.872, "load_time_ms": 0.478, "load_throughput": 536040.05, "learn_time_ms": 42.973, "learn_throughput": 5957.17, "synch_weights_time_ms": 11.583}, "counters": {"num_env_steps_sampled": 20800, "num_env_steps_trained": 24832, "num_agent_steps_sampled": 41600, "num_agent_steps_trained": 24832, "last_target_update_ts": 20800, "num_target_updates": 97}, "done": false, "episodes_total": 40, "training_iteration": 46, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-10", "timestamp": 1742591230, "time_this_iter_s": 1.118621587753296, "time_total_s": 55.01105284690857, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A7DEE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 55.01105284690857, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 38.6, "ram_util_percent": 78.1}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.381673812866211, "actor_loss": -13.539826393127441, "critic_loss": 0.2156953513622284, "alpha_loss": -0.39333832263946533, "alpha_value": 0.9710339903831482, "log_alpha_value": -0.02939380705356598, "target_entropy": -8.0, "policy_t": -0.06119510158896446, "mean_q": 8.439475059509277, "max_q": 12.302278518676758, "min_q": 5.4001946449279785}, "td_error": [0.358090877532959, 1.6098732948303223, 1.4791200160980225, 0.30730581283569336, 0.9234232902526855, 1.5218713283538818, 0.8152108192443848, 1.4387798309326172, 0.8868134021759033, 0.9661753177642822, 3.084310293197632, 0.7372055053710938, 0.27080583572387695, 0.19464778900146484, 1.2129201889038086, 0.16119909286499023, 0.46109724044799805, 2.3759989738464355, 0.5761260986328125, 0.5148122310638428, 0.5009512901306152, 1.1835877895355225, 0.32559967041015625, 0.22594165802001953, 0.6527495384216309, 0.32019948959350586, 1.0199990272521973, 0.052989959716796875, 0.38038063049316406, 0.13775157928466797, 0.329866886138916, 0.792996883392334, 1.5543036460876465, 1.509098768234253, 0.4039134979248047, 1.6327061653137207, 2.1429214477539062, 0.3225224018096924, 0.4781951904296875, 0.49445533752441406, 1.1667656898498535, 1.7912092208862305, 0.21120166778564453, 0.7428333759307861, 1.1208677291870117, 0.19540071487426758, 1.407815933227539, 0.6045725345611572, 0.31194162368774414, 1.895869255065918, 0.1645965576171875, 2.3912014961242676, 1.4118738174438477, 3.5454232692718506, 1.5779774188995361, 1.2952444553375244, 0.7257676124572754, 0.26632118225097656, 2.6529860496520996, 1.3831439018249512, 3.007052421569824, 0.5436205863952637, 2.2063753604888916, 0.23386144638061523, 0.9996669292449951, 0.58622145652771, 0.608095645904541, 1.762406349182129, 0.11168408393859863, 0.2842440605163574, 1.6017117500305176, 0.45660924911499023, 0.24693059921264648, 2.944100856781006, 3.3543295860290527, 0.723996639251709, 1.8000593185424805, 1.6750288009643555, 0.5871341228485107, 1.428478717803955, 0.602879524230957, 1.8065814971923828, 1.092531681060791, 0.7292413711547852, 0.280789852142334, 2.5475656986236572, 0.4620833396911621, 0.4385361671447754, 1.1895041465759277, 1.204118251800537, 0.42715883255004883, 2.391167640686035, 1.3371052742004395, 2.1569418907165527, 1.6174416542053223, 0.41121578216552734, 0.30956411361694336, 0.4561500549316406, 1.8086633682250977, 0.37224769592285156, 1.3941919803619385, 1.2095351219177246, 1.308767557144165, 1.6656262874603271, 1.158158302307129, 0.5333294868469238, 0.3181471824645996, 1.3435277938842773, 0.7442545890808105, 1.9227781295776367, 2.5925991535186768, 0.7126471996307373, 2.0909619331359863, 1.3603310585021973, 0.24895310401916504, 2.5271387100219727, 1.6446185111999512, 0.8972439765930176, 1.2140250205993652, 0.2693319320678711, 1.4228448867797852, 0.7459065914154053, 1.5689597129821777, 1.045746088027954, 1.9339566230773926, 1.2904157638549805, 0.8307895660400391, 1.2135310173034668], "mean_td_error": 1.1033698320388794, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.415915489196777, "actor_loss": -13.864594459533691, "critic_loss": 0.1986476331949234, "alpha_loss": -0.3943021893501282, "alpha_value": 0.9710370898246765, "log_alpha_value": -0.02939062938094139, "target_entropy": -8.0, "policy_t": 0.0523749515414238, "mean_q": 8.662718772888184, "max_q": 11.41652774810791, "min_q": 4.284905910491943}, "td_error": [0.3013577461242676, 4.236310958862305, 1.4849262237548828, 2.419605016708374, 1.1547257900238037, 0.5089306831359863, 0.6691451072692871, 0.04421854019165039, 2.007704496383667, 1.9572844505310059, 1.699324607849121, 1.13149094581604, 1.143707513809204, 1.6476283073425293, 1.7941923141479492, 0.8766403198242188, 0.2555088996887207, 1.8040008544921875, 0.5290045738220215, 1.6660547256469727, 1.268552303314209, 0.8323378562927246, 0.9957139492034912, 0.9966812133789062, 0.556734561920166, 0.9676110744476318, 0.6841161251068115, 0.3723752498626709, 0.662245512008667, 0.49520015716552734, 0.17701292037963867, 1.2573585510253906, 1.0426902770996094, 1.730454921722412, 1.7513432502746582, 1.0761923789978027, 0.7474551200866699, 0.4398188591003418, 1.4078359603881836, 0.7772359848022461, 0.12313270568847656, 0.5965390205383301, 0.40949201583862305, 1.22678804397583, 0.8981156349182129, 0.48206567764282227, 0.20667266845703125, 0.2618751525878906, 0.7924590110778809, 0.42926931381225586, 0.5872197151184082, 0.34257936477661133, 0.13134098052978516, 0.40619564056396484, 0.0393834114074707, 0.33640456199645996, 1.585400104522705, 0.1558835506439209, 0.6481235027313232, 1.5298657417297363, 1.0880937576293945, 0.7335271835327148, 0.16790008544921875, 0.5769286155700684, 0.6124248504638672, 0.4008364677429199, 1.1369547843933105, 0.5871720314025879, 2.232225179672241, 0.464510440826416, 1.6662993431091309, 0.1747736930847168, 0.692345142364502, 1.2075474262237549, 1.0750222206115723, 1.6196072101593018, 1.1622412204742432, 0.640751838684082, 1.553523063659668, 0.45755434036254883, 1.452604055404663, 0.37905120849609375, 2.2716259956359863, 0.2840249538421631, 1.1607387065887451, 2.8839001655578613, 2.1758651733398438, 1.387284278869629, 2.607017993927002, 0.1852407455444336, 0.9045486450195312, 1.5779528617858887, 0.36016082763671875, 0.35325050354003906, 0.2950167655944824, 2.2098333835601807, 2.1297109127044678, 1.3392786979675293, 0.5234346389770508, 0.2795863151550293, 2.8109304904937744, 1.2552480697631836, 0.7655267715454102, 0.11507129669189453, 0.22414875030517578, 2.66131854057312, 1.5217397212982178, 0.6178154945373535, 1.566230297088623, 0.4411342144012451, 1.5742387771606445, 0.589003324508667, 2.6364707946777344, 0.8286128044128418, 0.34514880180358887, 0.3052799701690674, 1.643611192703247, 1.7763113975524902, 0.683527946472168, 0.43709516525268555, 0.5450072288513184, 0.41619062423706055, 1.189333200454712, 0.4768791198730469, 0.24727249145507812, 0.42170286178588867, 1.8475511074066162, 1.106858253479004], "mean_td_error": 1.0063996315002441, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}}, "num_env_steps_sampled": 21200, "num_env_steps_trained": 25344, "num_agent_steps_sampled": 42400, "num_agent_steps_trained": 25344, "last_target_update_ts": 21200, "num_target_updates": 99}, "sampler_results": {"episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}}, "episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42400, "num_agent_steps_trained": 25344, "num_env_steps_sampled": 21200, "num_env_steps_trained": 25344, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 299.06321352360806, "num_env_steps_trained_throughput_per_sec": 382.80091331021833, "timesteps_total": 21200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 42400, "timers": {"training_iteration_time_ms": 574.816, "sample_time_ms": 298.92, "load_time_ms": 0.595, "load_throughput": 430133.327, "learn_time_ms": 42.427, "learn_throughput": 6033.942, "synch_weights_time_ms": 41.885}, "counters": {"num_env_steps_sampled": 21200, "num_env_steps_trained": 25344, "num_agent_steps_sampled": 42400, "num_agent_steps_trained": 25344, "last_target_update_ts": 21200, "num_target_updates": 99}, "done": false, "episodes_total": 40, "training_iteration": 47, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-11", "timestamp": 1742591231, "time_this_iter_s": 1.3451991081237793, "time_total_s": 56.35625195503235, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE29F6C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 56.35625195503235, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 37.900000000000006, "ram_util_percent": 78.5}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.354918479919434, "actor_loss": -13.485189437866211, "critic_loss": 0.20123514533042908, "alpha_loss": -0.404522180557251, "alpha_value": 0.9701640009880066, "log_alpha_value": -0.03029012866318226, "target_entropy": -8.0, "policy_t": -0.006490811705589294, "mean_q": 8.380352973937988, "max_q": 12.207743644714355, "min_q": 5.786933422088623}, "td_error": [0.8182773590087891, 1.1570584774017334, 0.22148370742797852, 0.14387941360473633, 0.16274595260620117, 1.7596454620361328, 0.981752872467041, 1.0331153869628906, 0.7178566455841064, 1.0200209617614746, 1.6126673221588135, 2.0602471828460693, 0.8270397186279297, 1.1305608749389648, 0.46088266372680664, 0.3303351402282715, 1.6989457607269287, 1.261354684829712, 0.6341679096221924, 0.8405041694641113, 0.13331937789916992, 0.5278658866882324, 0.5338222980499268, 0.7505278587341309, 0.3088655471801758, 0.21935462951660156, 0.8005704879760742, 1.6560356616973877, 0.41323089599609375, 2.2053537368774414, 0.5756101608276367, 1.773054838180542, 0.36332178115844727, 1.4241909980773926, 3.5415496826171875, 1.6945645809173584, 0.7319386005401611, 0.5359587669372559, 1.065838098526001, 0.6672019958496094, 1.291785478591919, 1.1551389694213867, 1.59132719039917, 1.5155510902404785, 1.3585724830627441, 2.654541015625, 0.9308838844299316, 0.1518864631652832, 1.5835292339324951, 1.005307674407959, 1.109466791152954, 0.354083776473999, 0.4635806083679199, 1.499464750289917, 0.6009597778320312, 0.501950740814209, 3.1555681228637695, 1.2893977165222168, 0.19870328903198242, 1.689462661743164, 1.03558349609375, 1.9561610221862793, 0.3443875312805176, 0.25655508041381836, 0.3845202922821045, 0.7945041656494141, 1.4006145000457764, 0.22623538970947266, 3.2605526447296143, 1.6190104484558105, 1.6072132587432861, 1.7473468780517578, 0.8616993427276611, 1.1346044540405273, 1.306772232055664, 1.276782512664795, 0.8207001686096191, 0.35218119621276855, 0.6376807689666748, 0.5019702911376953, 0.7313888072967529, 1.1156730651855469, 0.3196444511413574, 0.5182251930236816, 1.2545452117919922, 0.572394847869873, 0.9447617530822754, 1.0863819122314453, 1.0317387580871582, 0.43245363235473633, 0.29614877700805664, 2.720412015914917, 0.20564532279968262, 0.1513373851776123, 2.7738757133483887, 2.157931089401245, 0.8264796733856201, 0.9326672554016113, 2.238201856613159, 0.5699713230133057, 0.32296323776245117, 0.4687056541442871, 1.18778395652771, 0.5611615180969238, 0.20957279205322266, 1.2781951427459717, 0.1414027214050293, 0.9223232269287109, 1.661175012588501, 1.616030216217041, 0.662926435470581, 1.0550568103790283, 0.6938018798828125, 2.7192513942718506, 1.9208712577819824, 0.39292001724243164, 0.41672515869140625, 1.3106215000152588, 0.13697004318237305, 1.145735263824463, 1.9758403301239014, 0.46431684494018555, 0.3911762237548828, 0.880986213684082, 0.6651511192321777, 1.5626659393310547, 3.386894941329956, 2.035264015197754], "mean_td_error": 1.0584946870803833, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.353456497192383, "actor_loss": -13.777740478515625, "critic_loss": 0.18738849461078644, "alpha_loss": -0.40444913506507874, "alpha_value": 0.9701660871505737, "log_alpha_value": -0.0302879735827446, "target_entropy": -8.0, "policy_t": 0.007085846271365881, "mean_q": 8.701373100280762, "max_q": 12.004761695861816, "min_q": 6.186030864715576}, "td_error": [0.4729337692260742, 0.6020674705505371, 1.469637393951416, 1.625788927078247, 0.3736999034881592, 0.6586523056030273, 1.5401782989501953, 1.088869571685791, 1.0401372909545898, 0.835906982421875, 0.13153553009033203, 0.4045867919921875, 1.2905941009521484, 1.2246370315551758, 1.0215401649475098, 1.9624896049499512, 1.4518907070159912, 0.4811677932739258, 0.5061345100402832, 0.6769871711730957, 0.47259521484375, 0.013830184936523438, 0.15990018844604492, 0.3464045524597168, 0.7718772888183594, 1.4861602783203125, 0.46567344665527344, 0.4927968978881836, 2.7295005321502686, 0.7438406944274902, 1.3505902290344238, 0.23220348358154297, 0.6978969573974609, 1.0937204360961914, 1.1385040283203125, 1.2141554355621338, 0.8453559875488281, 0.04012775421142578, 0.6535549163818359, 1.4562125205993652, 0.05861473083496094, 0.9829628467559814, 1.8687140941619873, 1.2083940505981445, 0.5517096519470215, 0.3640279769897461, 0.1648416519165039, 0.5315089225769043, 0.44502973556518555, 1.8499302864074707, 1.062601089477539, 0.9658923149108887, 0.5255613327026367, 0.8420505523681641, 0.3316192626953125, 2.3506102561950684, 0.13808107376098633, 0.23723077774047852, 1.1015000343322754, 1.518432855606079, 0.19808197021484375, 0.6574840545654297, 2.0461528301239014, 0.2086167335510254, 0.4253871440887451, 2.211026906967163, 0.7047100067138672, 0.606043815612793, 2.1137924194335938, 1.3452329635620117, 0.893998384475708, 1.1162891387939453, 0.062375545501708984, 0.15329599380493164, 0.2958192825317383, 1.133815050125122, 1.469437837600708, 1.8731553554534912, 0.08089256286621094, 1.8333978652954102, 1.7143633365631104, 1.4315714836120605, 2.4363303184509277, 2.9858627319335938, 0.5139884948730469, 0.3370680809020996, 2.758322238922119, 1.265540599822998, 0.29021644592285156, 0.5470762252807617, 0.4555983543395996, 0.5161371231079102, 3.2345798015594482, 2.0843849182128906, 2.4289960861206055, 1.7693898677825928, 0.4765944480895996, 0.5746183395385742, 0.625584602355957, 1.9863970279693604, 1.168492317199707, 0.5306491851806641, 0.8871293067932129, 0.35983800888061523, 1.8652219772338867, 1.0788211822509766, 1.8136816024780273, 0.7378296852111816, 0.2993640899658203, 1.1262786388397217, 0.32329511642456055, 1.6060130596160889, 0.2816195487976074, 1.156325340270996, 0.5588910579681396, 1.4707436561584473, 0.8456292152404785, 0.3707003593444824, 0.059073448181152344, 1.8659780025482178, 1.4369211196899414, 2.6866893768310547, 0.2279205322265625, 0.25788164138793945, 0.7536888122558594, 0.11334991455078125, 0.7754793167114258, 1.9895920753479004], "mean_td_error": 0.9911904335021973, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 102.0, "diff_num_grad_updates_vs_sampler_policy": 101.0}}, "num_env_steps_sampled": 21800, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 43600, "num_agent_steps_trained": 26112, "last_target_update_ts": 21800, "num_target_updates": 102}, "sampler_results": {"episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1942.1334856569715, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1962.850002344991, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}}, "episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3904.9834880019616, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1942.1334856569715, "robot_1": 1962.850002344991}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7733235193436074, "mean_inference_ms": 3.433429346239342, "mean_action_processing_ms": 0.4646861772244124, "mean_env_wait_ms": 0.4782344033640265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012853741645812988, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.0856250524520874}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43600, "num_agent_steps_trained": 26112, "num_env_steps_sampled": 21800, "num_env_steps_trained": 26112, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 406.7556235982624, "num_env_steps_trained_throughput_per_sec": 520.6471982057759, "timesteps_total": 21800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 43600, "timers": {"training_iteration_time_ms": 571.883, "sample_time_ms": 295.188, "load_time_ms": 0.595, "load_throughput": 430133.327, "learn_time_ms": 43.167, "learn_throughput": 5930.414, "synch_weights_time_ms": 42.574}, "counters": {"num_env_steps_sampled": 21800, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 43600, "num_agent_steps_trained": 26112, "last_target_update_ts": 21800, "num_target_updates": 102}, "done": false, "episodes_total": 40, "training_iteration": 48, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-13", "timestamp": 1742591233, "time_this_iter_s": 1.4916722774505615, "time_total_s": 57.84792423248291, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2AAA670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 57.84792423248291, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 23.85, "ram_util_percent": 78.8}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1946.7140130680325, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1975.573686876525, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.425043106079102, "actor_loss": -13.520281791687012, "critic_loss": 0.1995929777622223, "alpha_loss": -0.41868212819099426, "alpha_value": 0.9692946076393127, "log_alpha_value": -0.031186653301119804, "target_entropy": -8.0, "policy_t": -0.027555810287594795, "mean_q": 8.387724876403809, "max_q": 12.512811660766602, "min_q": 5.628095626831055}, "td_error": [0.8373980522155762, 1.159336805343628, 2.131708860397339, 0.5441675186157227, 0.5161690711975098, 0.6448626518249512, 0.5495743751525879, 0.2614598274230957, 0.8552398681640625, 1.1395537853240967, 0.32027673721313477, 0.9346938133239746, 0.6633822917938232, 1.3302662372589111, 0.4437897205352783, 1.5534167289733887, 0.6949515342712402, 0.5130424499511719, 0.30578160285949707, 0.33452415466308594, 2.6282248497009277, 0.8193845748901367, 0.4086027145385742, 0.6424689292907715, 1.3789639472961426, 0.7730119228363037, 0.9639697074890137, 0.4133138656616211, 0.7652764320373535, 2.3165671825408936, 0.1837916374206543, 0.6316838264465332, 1.101107120513916, 2.652761220932007, 0.6638622283935547, 0.6720409393310547, 2.2580742835998535, 1.891075849533081, 0.6203324794769287, 0.30826473236083984, 1.0272889137268066, 1.6198344230651855, 0.6187915802001953, 0.974785327911377, 1.9631853103637695, 0.21182012557983398, 1.6869299411773682, 1.9290714263916016, 1.893617868423462, 1.6912832260131836, 1.4022834300994873, 0.6401090621948242, 0.24402093887329102, 1.7096118927001953, 1.0615873336791992, 3.4527485370635986, 2.3710358142852783, 0.2888305187225342, 0.5652775764465332, 2.394054412841797, 2.7898683547973633, 0.9607357978820801, 2.3528380393981934, 0.6981816291809082, 2.001729965209961, 2.4328842163085938, 2.2981913089752197, 1.4463496208190918, 0.6613850593566895, 1.4235520362854004, 1.8159410953521729, 0.5746006965637207, 1.842886209487915, 0.7316527366638184, 0.7030782699584961, 0.9639706611633301, 0.8761305809020996, 2.0705862045288086, 0.987734317779541, 0.4495849609375, 0.14622926712036133, 0.249786376953125, 0.253237247467041, 0.536034107208252, 0.5480704307556152, 1.7493078708648682, 0.6852097511291504, 0.5304675102233887, 2.0726370811462402, 0.24753046035766602, 0.23517465591430664, 0.22701334953308105, 0.49744653701782227, 0.5033149719238281, 0.46374964714050293, 0.22981786727905273, 1.3744029998779297, 0.8286190032958984, 0.25849056243896484, 0.8511340618133545, 1.2397313117980957, 0.3743247985839844, 1.261315107345581, 0.5078420639038086, 0.27674341201782227, 1.5761451721191406, 0.5176591873168945, 1.194601058959961, 0.894460916519165, 2.9585986137390137, 1.3445298671722412, 1.6118955612182617, 2.146374464035034, 1.5793426036834717, 0.517815351486206, 2.4842922687530518, 0.9115886688232422, 1.5039482116699219, 0.5157251358032227, 0.6514482498168945, 0.48930835723876953, 1.1382908821105957, 1.5691602230072021, 1.3920567035675049, 0.48731112480163574, 0.8118252754211426, 0.4687306880950928, 2.3264341354370117], "mean_td_error": 1.0851062536239624, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 105.0, "diff_num_grad_updates_vs_sampler_policy": 104.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.350666999816895, "actor_loss": -13.743744850158691, "critic_loss": 0.20182397961616516, "alpha_loss": -0.41634783148765564, "alpha_value": 0.9692956805229187, "log_alpha_value": -0.031185543164610863, "target_entropy": -8.0, "policy_t": 0.04328356310725212, "mean_q": 8.59144115447998, "max_q": 11.85524845123291, "min_q": 5.987546920776367}, "td_error": [0.9534978866577148, 1.4656379222869873, 0.5750293731689453, 0.9510836601257324, 0.997321367263794, 1.3116962909698486, 2.0049402713775635, 0.16757726669311523, 0.3984522819519043, 1.4305627346038818, 1.4340190887451172, 0.11413049697875977, 1.616196632385254, 0.9462175369262695, 1.282031536102295, 0.7707977294921875, 0.5253872871398926, 0.9460301399230957, 2.370994806289673, 1.9585661888122559, 0.788815975189209, 2.2046921253204346, 2.158400535583496, 0.024071216583251953, 0.24566125869750977, 2.4496963024139404, 0.11876201629638672, 2.0648140907287598, 1.0537829399108887, 0.0541386604309082, 1.661109447479248, 0.3140249252319336, 1.0539283752441406, 0.6570267677307129, 0.10373830795288086, 2.2398197650909424, 2.9043571949005127, 0.766021728515625, 0.22348499298095703, 1.5897493362426758, 0.22412347793579102, 1.645942211151123, 0.22910118103027344, 1.8507819175720215, 1.4763820171356201, 0.867995023727417, 0.5209980010986328, 0.07464218139648438, 2.2806272506713867, 0.050296783447265625, 0.6145434379577637, 0.5224080085754395, 1.4584803581237793, 0.9368133544921875, 0.6379742622375488, 2.6105432510375977, 1.2469048500061035, 0.808039665222168, 0.5389096736907959, 0.40897321701049805, 0.6329450607299805, 1.2184925079345703, 1.254751205444336, 0.19152116775512695, 0.703117847442627, 1.5063166618347168, 0.43460798263549805, 1.3447327613830566, 1.0233302116394043, 2.1844348907470703, 0.17845869064331055, 2.9842498302459717, 1.851353406906128, 0.1159825325012207, 0.24431276321411133, 0.546027660369873, 0.33768510818481445, 1.0170001983642578, 0.8087153434753418, 1.989717960357666, 1.3653028011322021, 1.1950993537902832, 1.0552241802215576, 1.899686574935913, 2.038435935974121, 0.705756664276123, 0.8716826438903809, 0.6290073394775391, 0.4294910430908203, 0.05061483383178711, 1.7308282852172852, 1.272831916809082, 0.24808979034423828, 1.265242576599121, 0.25397300720214844, 1.8513712882995605, 1.4115400314331055, 0.18717718124389648, 1.298668384552002, 3.0108816623687744, 1.6208066940307617, 1.6377429962158203, 1.4310450553894043, 0.912677526473999, 0.5387091636657715, 0.5366992950439453, 2.08963680267334, 1.477024793624878, 0.7324018478393555, 1.7735896110534668, 0.41030001640319824, 1.3661470413208008, 0.3990645408630371, 0.18716764450073242, 2.496722459793091, 1.6915171146392822, 0.5550098419189453, 1.0860276222229004, 1.05190110206604, 1.7643423080444336, 0.4739799499511719, 0.10701847076416016, 0.6992580890655518, 1.187084674835205, 1.5453288555145264, 2.107814311981201, 0.9466147422790527, 1.1673898696899414], "mean_td_error": 1.0877532958984375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 105.0, "diff_num_grad_updates_vs_sampler_policy": 104.0}}, "num_env_steps_sampled": 22400, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 26880, "last_target_update_ts": 22400, "num_target_updates": 105}, "sampler_results": {"episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3922.2876999445575, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1946.7140130680325, "robot_1": 1975.573686876525}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1946.7140130680325, "('robot_0', 'robot_0')_total_reward_min": 1762.02892240207, "('robot_0', 'robot_0')_total_reward_max": 2138.39524956441, "('robot_1', 'robot_1')_total_reward_mean": 1975.573686876525, "('robot_1', 'robot_1')_total_reward_min": 1775.120728850888, "('robot_1', 'robot_1')_total_reward_max": 2205.7203405544724}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237, 4110.210247714748, 4123.648209120361, 4113.66821583695, 4033.7926048100103], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419, 1980.4688278366575, 2038.4408023999347, 2004.649479943726, 1946.5180385342715], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698, 2129.741419878094, 2085.20740672042, 2109.0187358932208, 2087.2745662757416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7734834883593676, "mean_inference_ms": 3.4317944953874435, "mean_action_processing_ms": 0.4646313534520154, "mean_env_wait_ms": 0.4777041841118702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011685219678011808, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10651133277199486}}, "episode_reward_max": 4319.894362815009, "episode_reward_min": 3617.8334222468184, "episode_reward_mean": 3922.2876999445575, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1762.02892240207, "robot_1": 1775.120728850888}, "policy_reward_max": {"robot_0": 2138.39524956441, "robot_1": 2205.7203405544724}, "policy_reward_mean": {"robot_0": 1946.7140130680325, "robot_1": 1975.573686876525}, "hist_stats": {"episode_reward": [3983.8981990545126, 3686.56690283832, 3719.414885013353, 3878.7446495852214, 4011.5265903324944, 3902.2750844564093, 3980.8189937459906, 3783.015736643068, 3830.3052851477, 3757.566423933666, 4085.5011446780477, 3675.06241296529, 3617.8334222468184, 3889.3183575667017, 3633.3982034227315, 3852.0100235247014, 3825.566319982076, 3872.3379514670205, 3775.2356945973274, 3877.0467946109966, 3773.3561861338744, 3964.2501865043723, 3799.327973182611, 3631.112126996162, 3917.254618054542, 4200.407549987731, 3988.697742205712, 3886.9458687161846, 4141.4467072525285, 3838.5939903003473, 4089.5898557570886, 3848.4945277867287, 3938.683414362178, 4001.059977084633, 4046.08012717293, 4177.596647401289, 4025.351249421923, 4319.894362815009, 3874.352344557963, 4099.400988572237, 4110.210247714748, 4123.648209120361, 4113.66821583695, 4033.7926048100103], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [2011.1232764458748, 1886.610794353596, 1815.3649752723447, 1916.2383470464401, 2111.394451755958, 1909.328922863665, 1999.3591664414107, 1891.5406565770973, 1945.0944943730046, 1886.5452828323807, 2138.39524956441, 1899.9416841143984, 1831.4046143514186, 1941.5552957800544, 1762.02892240207, 1835.0251362659378, 1898.6322871851933, 2006.040587322587, 1903.3440614617623, 1886.564114272068, 1925.8806431233268, 1996.4485883913721, 1834.7260863872675, 1776.1883855570145, 1875.3211871557712, 2055.635868495993, 1990.7854311570318, 1888.8061557479468, 2050.2948266945205, 1849.3004408717902, 1987.6708561625637, 1940.3058775675788, 1951.523114005279, 2058.547691794961, 1967.2104912294885, 2119.9387902805893, 1949.0468943743754, 2114.1740222605313, 1882.1000208772564, 1995.9017334625419, 1980.4688278366575, 2038.4408023999347, 2004.649479943726, 1946.5180385342715], "policy_robot_1_reward": [1972.7749226086364, 1799.9561084847237, 1904.0499097410045, 1962.5063025387794, 1900.1321385765373, 1992.9461615927437, 1981.459827304575, 1891.4750800659729, 1885.2107907746977, 1871.0211411012913, 1947.1058951136347, 1775.120728850888, 1786.4288078953978, 1947.7630617866503, 1871.3692810206667, 2016.984887258763, 1926.9340327968844, 1866.2973641444307, 1871.891633135561, 1990.4826803389335, 1847.475543010544, 1967.801598113005, 1964.6018867953487, 1854.9237414391516, 2041.9334308987677, 2144.771681491745, 1997.912311048678, 1998.1397129682373, 2091.1518805580076, 1989.2935494285605, 2101.9189995945267, 1908.1886502191503, 1987.160300356905, 1942.5122852896764, 2078.869635943444, 2057.657857120701, 2076.3043550475413, 2205.7203405544724, 1992.252323680708, 2103.499255109698, 2129.741419878094, 2085.20740672042, 2109.0187358932208, 2087.2745662757416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7734834883593676, "mean_inference_ms": 3.4317944953874435, "mean_action_processing_ms": 0.4646313534520154, "mean_env_wait_ms": 0.4777041841118702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011685219678011808, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10651133277199486}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 26880, "num_env_steps_sampled": 22400, "num_env_steps_trained": 26880, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 418.6379880615974, "num_env_steps_trained_throughput_per_sec": 535.8566247188447, "timesteps_total": 22400, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 44800, "timers": {"training_iteration_time_ms": 533.696, "sample_time_ms": 278.827, "load_time_ms": 1.405, "load_throughput": 182206.317, "learn_time_ms": 37.721, "learn_throughput": 6786.737, "synch_weights_time_ms": 42.988}, "counters": {"num_env_steps_sampled": 22400, "num_env_steps_trained": 26880, "num_agent_steps_sampled": 44800, "num_agent_steps_trained": 26880, "last_target_update_ts": 22400, "num_target_updates": 105}, "done": false, "episodes_total": 44, "training_iteration": 49, "trial_id": "46f72_00000", "date": "2025-03-21_21-07-14", "timestamp": 1742591234, "time_this_iter_s": 1.449838399887085, "time_total_s": 59.297762632369995, "pid": 16608, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002CFE2A8E550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 59.297762632369995, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 25.833333333333332, "ram_util_percent": 79.10000000000001}}
