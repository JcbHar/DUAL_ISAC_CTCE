{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400, "num_agent_steps_trained": 0, "num_env_steps_sampled": 200, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 200, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 184.31668355967327, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 200, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 400, "timers": {"training_iteration_time_ms": 1085.089, "sample_time_ms": 292.683}, "counters": {"num_env_steps_sampled": 200, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-30", "timestamp": 1742662530, "time_this_iter_s": 1.0892200469970703, "time_total_s": 1.0892200469970703, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A5DE4C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1.0892200469970703, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.95, "ram_util_percent": 91.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 0, "num_env_steps_sampled": 800, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 563.409639463219, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 800, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1600, "timers": {"training_iteration_time_ms": 537.508, "sample_time_ms": 294.791}, "counters": {"num_env_steps_sampled": 800, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-31", "timestamp": 1742662531, "time_this_iter_s": 1.0690762996673584, "time_total_s": 2.1582963466644287, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6B7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 2.1582963466644287, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.55, "ram_util_percent": 90.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.415786743164062, "actor_loss": -5.415156841278076, "critic_loss": 8.245196342468262, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -8.0, "policy_t": -0.03791169449687004, "mean_q": 0.002232635160908103, "max_q": 0.006671244278550148, "min_q": -0.002763552125543356}, "td_error": [9.671934127807617, 8.922330856323242, 8.064638137817383, 8.597143173217773, 9.709563255310059, 8.013116836547852, 8.551234245300293, 8.168188095092773, 8.325977325439453, 9.290042877197266, 9.160594940185547, 8.578298568725586, 8.847203254699707, 7.767785549163818, 10.160502433776855, 8.98202896118164, 8.860947608947754, 10.599780082702637, 8.790016174316406, 9.093591690063477, 7.765785217285156, 7.434964656829834, 8.448639869689941, 7.369401454925537, 9.762876510620117, 8.881808280944824, 9.515910148620605, 7.84221076965332, 7.713139533996582, 9.713239669799805, 8.883316040039062, 8.205944061279297, 9.955886840820312, 9.08373737335205, 7.606695175170898, 9.38568115234375, 8.52606201171875, 7.274318218231201, 9.548952102661133, 8.979883193969727, 9.22227668762207, 8.768648147583008, 9.746994018554688, 8.8414306640625, 8.56242561340332, 9.626886367797852, 8.770707130432129, 8.437241554260254, 8.796783447265625, 7.789693832397461, 8.434667587280273, 7.334939479827881, 8.828706741333008, 9.357030868530273, 8.563791275024414, 8.174457550048828, 7.3061370849609375, 7.48429536819458, 9.67719554901123, 9.34723949432373, 9.326480865478516, 9.770898818969727, 8.094779968261719, 8.728137969970703, 9.05120849609375, 8.122594833374023, 8.840047836303711, 8.63338565826416, 7.558228492736816, 9.432537078857422, 9.539430618286133, 7.898443222045898, 7.612123489379883, 9.939148902893066, 9.035425186157227, 8.59565544128418, 9.427913665771484, 8.901674270629883, 9.488418579101562, 8.289912223815918, 9.452268600463867, 8.744653701782227, 7.263379096984863, 8.859851837158203, 8.767675399780273, 7.788290977478027, 9.507257461547852, 9.057969093322754, 9.189966201782227, 9.181387901306152, 8.452739715576172, 8.986724853515625, 8.276790618896484, 8.043503761291504, 7.704370498657227, 9.256673812866211, 7.899316310882568, 7.611460208892822, 8.640878677368164, 9.879328727722168, 9.76852035522461, 8.290843963623047, 9.086833953857422, 8.660881996154785, 8.754944801330566, 8.699941635131836, 8.598894119262695, 10.25273323059082, 9.788918495178223, 8.878677368164062, 7.899387359619141, 8.468542098999023, 8.138204574584961, 9.618034362792969, 9.826635360717773, 8.96216106414795, 8.944869995117188, 10.143012046813965, 9.00554084777832, 9.132855415344238, 7.745439529418945, 9.194950103759766, 7.939092636108398, 8.458284378051758, 8.449224472045898, 7.812564373016357, 8.709573745727539, 8.179652214050293], "mean_td_error": 8.745196342468262, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.395944595336914, "actor_loss": -5.3940534591674805, "critic_loss": 8.165329933166504, "alpha_loss": 0.0, "alpha_value": 1.0, "log_alpha_value": 0.0, "target_entropy": -8.0, "policy_t": -0.0002600383013486862, "mean_q": -0.0018210271373391151, "max_q": 0.0021306127309799194, "min_q": -0.010376492515206337}, "td_error": [9.471929550170898, 10.038793563842773, 8.384015083312988, 8.923988342285156, 8.781757354736328, 7.956856727600098, 8.533143997192383, 9.19456672668457, 9.224851608276367, 8.120779037475586, 8.465873718261719, 8.625865936279297, 7.868271827697754, 8.218746185302734, 8.540552139282227, 8.937358856201172, 8.003256797790527, 8.86335563659668, 9.462181091308594, 7.558821678161621, 8.939992904663086, 8.283778190612793, 8.590567588806152, 8.032093048095703, 9.234753608703613, 8.963468551635742, 9.337255477905273, 10.110801696777344, 7.868403434753418, 8.785795211791992, 8.867045402526855, 7.924066543579102, 8.892474174499512, 9.572513580322266, 9.30086898803711, 8.12287425994873, 10.358007431030273, 8.299114227294922, 8.668936729431152, 6.943868637084961, 7.093745708465576, 9.496963500976562, 8.556856155395508, 8.741950988769531, 9.610445976257324, 9.460416793823242, 8.503669738769531, 8.915481567382812, 9.136653900146484, 8.642160415649414, 8.715457916259766, 8.811544418334961, 9.0, 8.23411750793457, 8.345596313476562, 8.781158447265625, 7.680447578430176, 9.422310829162598, 8.781387329101562, 9.277223587036133, 9.761198043823242, 7.83023738861084, 9.622579574584961, 8.959736824035645, 8.147933006286621, 8.302507400512695, 9.762187957763672, 7.510969161987305, 9.342215538024902, 8.739551544189453, 8.091638565063477, 8.567079544067383, 8.986404418945312, 8.310944557189941, 8.64819622039795, 7.732926368713379, 8.353744506835938, 8.10024642944336, 7.5702409744262695, 8.098075866699219, 9.22535514831543, 8.082097053527832, 8.357056617736816, 8.319784164428711, 9.44199275970459, 8.770891189575195, 8.8082275390625, 8.794696807861328, 7.514077186584473, 7.8684186935424805, 8.185697555541992, 7.4876708984375, 8.56559944152832, 7.862307071685791, 8.15230655670166, 8.705010414123535, 8.478414535522461, 8.674962043762207, 8.525131225585938, 8.220309257507324, 8.37460994720459, 8.695884704589844, 8.071907043457031, 9.046167373657227, 9.218669891357422, 9.456489562988281, 9.304798126220703, 9.212053298950195, 7.450733184814453, 7.968168258666992, 8.738128662109375, 9.233156204223633, 9.095565795898438, 9.606710433959961, 10.071199417114258, 10.912567138671875, 7.423336505889893, 9.250150680541992, 7.9770660400390625, 9.181673049926758, 7.8738603591918945, 9.216333389282227, 8.977834701538086, 9.210118293762207, 7.9260454177856445, 8.403066635131836, 8.75101375579834, 8.557065963745117], "mean_td_error": 8.665329933166504, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1.0, "diff_num_grad_updates_vs_sampler_policy": 0.0}}, "num_env_steps_sampled": 1600, "num_env_steps_trained": 256, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 256, "last_target_update_ts": 1600, "num_target_updates": 1}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 256, "num_env_steps_sampled": 1600, "num_env_steps_trained": 256, "num_env_steps_sampled_this_iter": 800, "num_env_steps_trained_this_iter": 256, "num_env_steps_sampled_throughput_per_sec": 526.2722932356359, "num_env_steps_trained_throughput_per_sec": 168.40713383540344, "timesteps_total": 1600, "num_steps_trained_this_iter": 256, "agent_timesteps_total": 3200, "timers": {"training_iteration_time_ms": 458.77, "sample_time_ms": 283.799, "load_time_ms": 1.126, "load_throughput": 227295.052, "learn_time_ms": 79.794, "learn_throughput": 3208.245, "synch_weights_time_ms": 12.09}, "counters": {"num_env_steps_sampled": 1600, "num_env_steps_trained": 256, "num_agent_steps_sampled": 3200, "num_agent_steps_trained": 256, "last_target_update_ts": 1600, "num_target_updates": 1}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-33", "timestamp": 1742662533, "time_this_iter_s": 1.5381197929382324, "time_total_s": 3.696416139602661, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A650310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 3.696416139602661, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.150000000000006, "ram_util_percent": 90.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.41277027130127, "actor_loss": -5.43682336807251, "critic_loss": 7.096656322479248, "alpha_loss": -0.008046917617321014, "alpha_value": 0.99940025806427, "log_alpha_value": -0.0005999444401822984, "target_entropy": -8.0, "policy_t": 0.030633680522441864, "mean_q": 0.030460165813565254, "max_q": 0.05878112465143204, "min_q": 0.020613517612218857}, "td_error": [8.428794860839844, 9.314533233642578, 9.500333786010742, 8.847982406616211, 9.469862937927246, 7.515145778656006, 9.046823501586914, 9.068328857421875, 8.268793106079102, 9.210748672485352, 8.522733688354492, 9.122905731201172, 8.33123779296875, 8.092533111572266, 9.1910400390625, 9.28986930847168, 8.760744094848633, 8.345629692077637, 9.142768859863281, 7.47781229019165, 7.335959434509277, 7.917935371398926, 8.426502227783203, 8.04438591003418, 9.436172485351562, 8.690671920776367, 8.073460578918457, 8.388330459594727, 7.805522441864014, 8.497383117675781, 9.250643730163574, 8.706708908081055, 10.510825157165527, 7.704729080200195, 9.53796672821045, 7.938141822814941, 8.320401191711426, 9.383853912353516, 8.965948104858398, 8.484832763671875, 9.421822547912598, 8.413735389709473, 9.39592456817627, 8.377531051635742, 8.502002716064453, 8.43198299407959, 9.242130279541016, 9.995453834533691, 8.905281066894531, 7.731481552124023, 8.149358749389648, 8.392206192016602, 8.668417930603027, 8.395109176635742, 7.701603412628174, 9.721476554870605, 9.464754104614258, 8.006750106811523, 9.027021408081055, 8.938226699829102, 9.537508964538574, 8.824816703796387, 7.186278820037842, 8.029176712036133, 8.623061180114746, 9.375632286071777, 8.254755020141602, 9.125162124633789, 8.658843994140625, 9.240093231201172, 7.637989044189453, 8.036809921264648, 8.508386611938477, 7.603865146636963, 8.851041793823242, 8.653573989868164, 9.203042984008789, 8.457481384277344, 8.379179000854492, 8.095420837402344, 8.722607612609863, 9.23391056060791, 7.834028244018555, 8.503288269042969, 9.435646057128906, 9.081829071044922, 9.347091674804688, 8.554043769836426, 7.947236061096191, 8.74331283569336, 7.947099208831787, 8.810572624206543, 9.337301254272461, 7.74252986907959, 8.487621307373047, 8.450662612915039, 7.911769390106201, 9.512799263000488, 8.388976097106934, 10.095176696777344, 9.008188247680664, 8.307737350463867, 8.874614715576172, 8.008822441101074, 8.56891918182373, 8.346138000488281, 9.500001907348633, 8.515960693359375, 7.471212387084961, 8.203134536743164, 8.24555778503418, 9.654777526855469, 8.351593017578125, 8.53982162475586, 7.6271562576293945, 9.695196151733398, 8.714517593383789, 8.99382209777832, 9.604425430297852, 7.741021633148193, 7.7960405349731445, 8.131226539611816, 8.841398239135742, 10.10731315612793, 8.859518051147461, 8.020181655883789, 8.676416397094727, 8.11931037902832], "mean_td_error": 8.64175796508789, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.264364242553711, "actor_loss": -5.2845916748046875, "critic_loss": 7.123189926147461, "alpha_loss": -0.007958386093378067, "alpha_value": 0.9994001984596252, "log_alpha_value": -0.0005999825079925358, "target_entropy": -8.0, "policy_t": 0.019841283559799194, "mean_q": 0.02291182614862919, "max_q": 0.035093147307634354, "min_q": 0.015018342062830925}, "td_error": [10.04726505279541, 9.11967658996582, 9.322641372680664, 9.080984115600586, 8.266435623168945, 9.618331909179688, 8.297767639160156, 8.849004745483398, 8.810918807983398, 8.471311569213867, 10.312829971313477, 8.666170120239258, 9.02453327178955, 9.865340232849121, 8.757587432861328, 8.516889572143555, 9.562387466430664, 8.500007629394531, 8.16590690612793, 8.873222351074219, 9.53762435913086, 7.409490585327148, 7.883030891418457, 9.860692977905273, 9.335559844970703, 8.838241577148438, 8.162102699279785, 9.975692749023438, 8.323389053344727, 8.196222305297852, 8.976774215698242, 8.524402618408203, 7.898831367492676, 8.681713104248047, 7.860734939575195, 7.774898052215576, 8.67635440826416, 8.560503005981445, 8.28705883026123, 8.900737762451172, 9.394758224487305, 9.669645309448242, 9.541379928588867, 8.035504341125488, 8.080301284790039, 8.454814910888672, 10.033002853393555, 8.083565711975098, 9.039044380187988, 8.845568656921387, 8.938555717468262, 8.810863494873047, 8.333948135375977, 8.61639404296875, 8.574102401733398, 8.71072769165039, 8.505777359008789, 8.096992492675781, 7.659736633300781, 8.226309776306152, 9.128042221069336, 8.607110977172852, 8.941802978515625, 9.459859848022461, 8.905153274536133, 9.151594161987305, 8.626028060913086, 8.963062286376953, 8.614917755126953, 8.975664138793945, 7.917536735534668, 8.633930206298828, 7.779830455780029, 9.056257247924805, 8.075421333312988, 9.015509605407715, 8.38087272644043, 8.402637481689453, 9.467206954956055, 8.224565505981445, 9.208375930786133, 10.162532806396484, 9.449972152709961, 8.893351554870605, 8.890874862670898, 8.419798851013184, 8.37998104095459, 10.10914134979248, 9.169557571411133, 9.533586502075195, 7.536879539489746, 10.016334533691406, 8.616548538208008, 9.199491500854492, 8.321481704711914, 8.69186782836914, 8.959718704223633, 8.093544006347656, 8.995410919189453, 8.731093406677246, 8.49514102935791, 8.505794525146484, 8.502172470092773, 8.110636711120605, 10.070000648498535, 9.330219268798828, 9.026937484741211, 8.285543441772461, 9.220157623291016, 8.47020435333252, 8.556575775146484, 9.449609756469727, 8.672494888305664, 8.180315017700195, 7.221220970153809, 8.687881469726562, 8.930099487304688, 8.757034301757812, 8.9342041015625, 9.127704620361328, 8.2982177734375, 8.932381629943848, 8.559806823730469, 8.1470947265625, 8.968103408813477, 8.769579887390137, 7.606265544891357, 7.469170570373535], "mean_td_error": 8.753401756286621, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 768, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 768, "last_target_update_ts": 2000, "num_target_updates": 3}, "sampler_results": {"episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}}, "episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 768, "num_env_steps_sampled": 2000, "num_env_steps_trained": 768, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 395.84365969350296, "num_env_steps_trained_throughput_per_sec": 506.67988440768374, "timesteps_total": 2000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 468.066, "sample_time_ms": 282.824, "load_time_ms": 0.375, "load_throughput": 681885.155, "learn_time_ms": 49.141, "learn_throughput": 5209.54, "synch_weights_time_ms": 12.513}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 768, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 768, "last_target_update_ts": 2000, "num_target_updates": 3}, "done": false, "episodes_total": 4, "training_iteration": 4, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-34", "timestamp": 1742662534, "time_this_iter_s": 1.0260369777679443, "time_total_s": 4.7224531173706055, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6509D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 4.7224531173706055, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.0, "ram_util_percent": 91.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.348877906799316, "actor_loss": -5.401324272155762, "critic_loss": 6.577802658081055, "alpha_loss": -0.016017327085137367, "alpha_value": 0.9988008141517639, "log_alpha_value": -0.0011999006383121014, "target_entropy": -8.0, "policy_t": 0.05058841407299042, "mean_q": 0.0646977648139, "max_q": 0.11915264278650284, "min_q": 0.04680038243532181}, "td_error": [7.778103351593018, 7.378957748413086, 8.854692459106445, 9.344799041748047, 9.387029647827148, 8.856942176818848, 8.723014831542969, 9.59112548828125, 9.20748519897461, 8.428622245788574, 8.39037036895752, 8.269039154052734, 7.994933128356934, 8.103759765625, 7.843057632446289, 7.718923568725586, 8.763249397277832, 7.691985607147217, 9.36346435546875, 7.3314104080200195, 9.651762962341309, 8.897465705871582, 7.746328830718994, 8.563654899597168, 8.862658500671387, 8.29262924194336, 9.3934907913208, 7.442529678344727, 8.447248458862305, 7.762172698974609, 8.265567779541016, 7.694647789001465, 8.307012557983398, 9.151317596435547, 9.153409957885742, 9.349870681762695, 8.862187385559082, 8.826904296875, 8.705633163452148, 8.943693161010742, 7.839118003845215, 9.270730972290039, 9.608678817749023, 8.54289436340332, 9.2799072265625, 8.717714309692383, 8.461511611938477, 9.332365036010742, 8.957879066467285, 8.747293472290039, 8.899158477783203, 9.23487663269043, 9.411904335021973, 8.253763198852539, 7.665718078613281, 8.985990524291992, 8.323177337646484, 8.924615859985352, 8.931694030761719, 10.002396583557129, 8.858514785766602, 8.627321243286133, 8.79204273223877, 8.931015014648438, 8.253230094909668, 8.931818008422852, 7.652338027954102, 9.833664894104004, 8.545570373535156, 8.043312072753906, 7.975090026855469, 8.058351516723633, 8.65684700012207, 8.99329948425293, 8.939704895019531, 9.441360473632812, 8.206329345703125, 9.559752464294434, 8.579524993896484, 7.800749778747559, 8.82052993774414, 9.609560012817383, 9.036571502685547, 9.403511047363281, 7.58306360244751, 9.292268753051758, 8.056768417358398, 8.615060806274414, 8.74919319152832, 8.227775573730469, 9.238977432250977, 8.207158088684082, 9.116338729858398, 7.64932918548584, 9.05909252166748, 8.731643676757812, 8.766058921813965, 8.399615287780762, 9.661096572875977, 8.207717895507812, 8.975111961364746, 9.156968116760254, 9.540321350097656, 9.52694320678711, 8.27259635925293, 7.884922504425049, 9.536392211914062, 7.842511177062988, 9.020544052124023, 9.155698776245117, 9.566228866577148, 10.162599563598633, 8.120614051818848, 8.692039489746094, 7.360151290893555, 8.697183609008789, 8.838093757629395, 8.611326217651367, 9.297914505004883, 9.542433738708496, 8.430466651916504, 7.69260311126709, 9.184009552001953, 9.58863639831543, 8.220130920410156, 8.43531608581543, 8.44910717010498, 7.922439098358154], "mean_td_error": 8.684117317199707, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.44107723236084, "actor_loss": -5.486141681671143, "critic_loss": 6.976386070251465, "alpha_loss": -0.016127262264490128, "alpha_value": 0.9988008737564087, "log_alpha_value": -0.0011998489499092102, "target_entropy": -8.0, "policy_t": -0.010395139455795288, "mean_q": 0.05144009739160538, "max_q": 0.0944572314620018, "min_q": 0.03222866728901863}, "td_error": [7.791484355926514, 8.80766487121582, 8.079986572265625, 7.980841636657715, 9.480058670043945, 8.534618377685547, 7.453906059265137, 8.029977798461914, 8.597739219665527, 9.277040481567383, 9.073333740234375, 8.861322402954102, 8.563102722167969, 8.07103157043457, 8.188722610473633, 8.426017761230469, 9.21760368347168, 8.249244689941406, 8.549625396728516, 7.940541744232178, 8.473554611206055, 8.392367362976074, 8.691164016723633, 9.303136825561523, 8.887611389160156, 9.2342529296875, 9.628167152404785, 9.022567749023438, 8.30055046081543, 9.16933822631836, 8.243053436279297, 8.841275215148926, 9.347759246826172, 8.079132080078125, 8.708465576171875, 8.625590324401855, 9.595174789428711, 8.190014839172363, 8.842281341552734, 9.364834785461426, 9.611039161682129, 7.672491073608398, 9.448629379272461, 9.438335418701172, 8.89731216430664, 8.164796829223633, 8.888551712036133, 8.43889045715332, 8.611211776733398, 9.209539413452148, 9.150345802307129, 8.260480880737305, 8.771312713623047, 8.950592041015625, 9.068669319152832, 8.515220642089844, 9.025245666503906, 9.200448036193848, 8.713777542114258, 8.010995864868164, 8.339868545532227, 8.96689224243164, 8.445672988891602, 8.637516021728516, 8.664390563964844, 9.764909744262695, 8.73694133758545, 7.655055046081543, 9.718269348144531, 8.597084045410156, 9.498783111572266, 8.533600807189941, 9.270509719848633, 9.648256301879883, 8.793514251708984, 8.155981063842773, 9.70283317565918, 10.227153778076172, 8.390054702758789, 8.088436126708984, 8.74972915649414, 7.976062774658203, 9.745498657226562, 9.288351058959961, 9.197751998901367, 8.05038070678711, 9.688626289367676, 8.761905670166016, 8.407379150390625, 8.094589233398438, 7.895411968231201, 8.407997131347656, 9.430290222167969, 8.653148651123047, 10.033879280090332, 8.088255882263184, 8.749223709106445, 9.380455017089844, 8.56879997253418, 9.139659881591797, 8.597272872924805, 9.138072967529297, 9.107229232788086, 9.076040267944336, 8.54343032836914, 9.20767593383789, 9.925278663635254, 8.124855041503906, 8.243727684020996, 8.999095916748047, 8.858309745788574, 8.914957046508789, 7.596190452575684, 7.932901382446289, 8.780570983886719, 7.349336624145508, 9.251304626464844, 8.90057373046875, 7.946980953216553, 8.857324600219727, 7.368236064910889, 8.058565139770508, 8.312610626220703, 8.571004867553711, 8.501962661743164, 8.552888870239258, 7.741512298583984, 9.201749801635742], "mean_td_error": 8.718475341796875, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 2400, "num_env_steps_trained": 1280, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 1280, "last_target_update_ts": 2400, "num_target_updates": 5}, "sampler_results": {"episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}}, "episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 1280, "num_env_steps_sampled": 2400, "num_env_steps_trained": 1280, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 344.38990585387563, "num_env_steps_trained_throughput_per_sec": 440.8190794929608, "timesteps_total": 2400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4800, "timers": {"training_iteration_time_ms": 437.466, "sample_time_ms": 278.251, "load_time_ms": 0.43, "load_throughput": 595927.308, "learn_time_ms": 43.518, "learn_throughput": 5882.608, "synch_weights_time_ms": 12.469}, "counters": {"num_env_steps_sampled": 2400, "num_env_steps_trained": 1280, "num_agent_steps_sampled": 4800, "num_agent_steps_trained": 1280, "last_target_update_ts": 2400, "num_target_updates": 5}, "done": false, "episodes_total": 4, "training_iteration": 5, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-35", "timestamp": 1742662535, "time_this_iter_s": 1.1810736656188965, "time_total_s": 5.903526782989502, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6CAEE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 5.903526782989502, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.75, "ram_util_percent": 91.35}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.492002487182617, "actor_loss": -5.575656414031982, "critic_loss": 6.591118812561035, "alpha_loss": -0.02428455464541912, "alpha_value": 0.9982016682624817, "log_alpha_value": -0.0017999222036451101, "target_entropy": -8.0, "policy_t": 0.0013260047417134047, "mean_q": 0.10414023697376251, "max_q": 0.1968657225370407, "min_q": 0.057880498468875885}, "td_error": [7.990572929382324, 8.217496871948242, 8.296056747436523, 8.988578796386719, 9.367311477661133, 8.224864959716797, 9.01073932647705, 8.465194702148438, 9.70649242401123, 8.65372371673584, 8.710954666137695, 8.691277503967285, 8.320037841796875, 8.86325454711914, 8.257184982299805, 9.646770477294922, 9.565289497375488, 8.150291442871094, 9.053912162780762, 8.996938705444336, 7.9698686599731445, 9.31649398803711, 8.921364784240723, 8.439033508300781, 8.554411888122559, 8.33302116394043, 9.05917739868164, 9.262947082519531, 8.514227867126465, 8.631823539733887, 8.01986312866211, 9.064745903015137, 9.003171920776367, 8.643793106079102, 9.509096145629883, 7.220003128051758, 8.516876220703125, 9.467315673828125, 8.477023124694824, 8.899275779724121, 8.738897323608398, 9.56857967376709, 9.09469223022461, 7.9935688972473145, 9.239350318908691, 9.203843116760254, 8.431978225708008, 7.047863006591797, 10.079272270202637, 9.456451416015625, 8.332748413085938, 8.757698059082031, 8.45064926147461, 8.485590934753418, 9.615028381347656, 9.706430435180664, 8.353862762451172, 8.948930740356445, 8.258201599121094, 7.912503242492676, 10.063820838928223, 8.594791412353516, 9.105932235717773, 8.973071098327637, 7.394559860229492, 8.174352645874023, 8.374117851257324, 8.214714050292969, 9.472084045410156, 8.519196510314941, 8.813827514648438, 8.136251449584961, 8.325578689575195, 8.43560791015625, 9.984161376953125, 8.836650848388672, 9.002955436706543, 9.080408096313477, 8.611488342285156, 8.305622100830078, 8.487595558166504, 8.354514122009277, 9.17527961730957, 7.840409755706787, 8.358074188232422, 7.43068265914917, 7.751767158508301, 8.88669204711914, 8.895217895507812, 8.940340042114258, 9.235374450683594, 9.331602096557617, 8.077720642089844, 8.294001579284668, 7.7471818923950195, 8.479114532470703, 9.71796989440918, 9.301025390625, 9.27531623840332, 8.087383270263672, 9.604331970214844, 8.008749008178711, 9.127517700195312, 8.603982925415039, 7.9873199462890625, 8.258108139038086, 9.101215362548828, 9.20124626159668, 8.519299507141113, 8.766151428222656, 8.194623947143555, 8.732236862182617, 9.237955093383789, 9.305601119995117, 8.488626480102539, 8.419817924499512, 8.545804977416992, 8.635241508483887, 8.250038146972656, 8.994028091430664, 9.859253883361816, 9.498556137084961, 9.0354585647583, 8.83228588104248, 8.353536605834961, 7.938884258270264, 7.96872615814209, 8.844801902770996], "mean_td_error": 8.711535453796387, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.390894889831543, "actor_loss": -5.465394973754883, "critic_loss": 6.618188858032227, "alpha_loss": -0.024104123935103416, "alpha_value": 0.9982016086578369, "log_alpha_value": -0.0018000383861362934, "target_entropy": -8.0, "policy_t": 0.008022879250347614, "mean_q": 0.08435201644897461, "max_q": 0.15528817474842072, "min_q": 0.05434481054544449}, "td_error": [8.856732368469238, 8.200576782226562, 8.250402450561523, 8.799525260925293, 7.8743181228637695, 8.332267761230469, 8.072781562805176, 7.923210620880127, 8.589192390441895, 8.772584915161133, 9.305253982543945, 7.847043991088867, 9.565069198608398, 8.709136009216309, 8.078206062316895, 8.95092487335205, 9.533416748046875, 8.451919555664062, 9.126974105834961, 8.122505187988281, 9.068523406982422, 8.704289436340332, 7.704150676727295, 9.173596382141113, 7.787597179412842, 7.6199750900268555, 7.782315731048584, 8.193443298339844, 7.870818138122559, 7.979870796203613, 8.310989379882812, 8.810096740722656, 8.226690292358398, 8.547924041748047, 7.422370433807373, 8.123077392578125, 7.89531946182251, 8.593475341796875, 8.809752464294434, 9.124608993530273, 8.40692138671875, 8.011996269226074, 9.260749816894531, 8.625736236572266, 9.197134017944336, 8.061508178710938, 9.48806095123291, 8.408452987670898, 8.42953109741211, 9.131006240844727, 8.243706703186035, 8.231801986694336, 8.937902450561523, 7.900713920593262, 8.700957298278809, 7.808007717132568, 8.335206031799316, 8.309518814086914, 8.807559967041016, 8.376846313476562, 8.211559295654297, 9.49948501586914, 9.37645149230957, 7.991025924682617, 8.91004753112793, 8.597928047180176, 9.722293853759766, 8.43208122253418, 8.36906623840332, 7.770449638366699, 9.641146659851074, 9.347793579101562, 7.625537872314453, 8.416402816772461, 9.125450134277344, 9.193180084228516, 9.358977317810059, 8.746223449707031, 8.866544723510742, 7.912117958068848, 8.898625373840332, 7.904191493988037, 9.143905639648438, 9.005500793457031, 7.376079559326172, 8.368551254272461, 8.181995391845703, 9.046979904174805, 8.385015487670898, 8.554574966430664, 8.464788436889648, 9.030853271484375, 9.37228775024414, 8.766691207885742, 8.314516067504883, 8.30554485321045, 8.146469116210938, 8.131036758422852, 8.206099510192871, 9.090410232543945, 8.83503532409668, 8.492172241210938, 9.204364776611328, 8.87066650390625, 8.70476245880127, 8.637872695922852, 8.492183685302734, 10.101783752441406, 9.342987060546875, 9.230083465576172, 8.557973861694336, 8.553760528564453, 8.415634155273438, 8.105743408203125, 7.67254638671875, 8.896587371826172, 8.728373527526855, 8.645627975463867, 9.020187377929688, 8.783411026000977, 8.104564666748047, 7.66248893737793, 8.40405559539795, 9.227579116821289, 8.304643630981445, 8.717361450195312, 9.284414291381836, 9.43309211730957], "mean_td_error": 8.57829761505127, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 2800, "num_env_steps_trained": 1792, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 1792, "last_target_update_ts": 2800, "num_target_updates": 7}, "sampler_results": {"episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}}, "episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 1792, "num_env_steps_sampled": 2800, "num_env_steps_trained": 1792, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 397.7526800603698, "num_env_steps_trained_throughput_per_sec": 509.12343047727336, "timesteps_total": 2800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5600, "timers": {"training_iteration_time_ms": 469.775, "sample_time_ms": 279.899, "load_time_ms": 0.452, "load_throughput": 565807.947, "learn_time_ms": 41.276, "learn_throughput": 6202.165, "synch_weights_time_ms": 12.087}, "counters": {"num_env_steps_sampled": 2800, "num_env_steps_trained": 1792, "num_agent_steps_sampled": 5600, "num_agent_steps_trained": 1792, "last_target_update_ts": 2800, "num_target_updates": 7}, "done": false, "episodes_total": 4, "training_iteration": 6, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-42", "timestamp": 1742662542, "time_this_iter_s": 1.0222055912017822, "time_total_s": 6.925732374191284, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6CA280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 6.925732374191284, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.679999999999998, "ram_util_percent": 91.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.445991516113281, "actor_loss": -5.56600284576416, "critic_loss": 6.331571578979492, "alpha_loss": -0.0322742760181427, "alpha_value": 0.9976025819778442, "log_alpha_value": -0.0024002897553145885, "target_entropy": -8.0, "policy_t": 0.0036609589587897062, "mean_q": 0.14474332332611084, "max_q": 0.2705554664134979, "min_q": 0.09157302230596542}, "td_error": [9.233516693115234, 8.87839412689209, 8.794899940490723, 8.62307357788086, 8.968591690063477, 6.935121536254883, 8.078611373901367, 8.118640899658203, 7.370554447174072, 9.358633041381836, 8.377260208129883, 8.420377731323242, 9.604269027709961, 8.745288848876953, 9.482908248901367, 8.02463150024414, 8.677867889404297, 8.185674667358398, 8.021156311035156, 8.910484313964844, 9.210567474365234, 8.969758987426758, 9.343749046325684, 9.282455444335938, 7.8353729248046875, 9.148981094360352, 9.261795043945312, 9.094270706176758, 8.816354751586914, 8.74921989440918, 8.139848709106445, 7.730711936950684, 8.364124298095703, 9.006965637207031, 8.559209823608398, 9.414331436157227, 8.829204559326172, 8.67175579071045, 8.29537582397461, 8.663229942321777, 9.166830062866211, 9.506417274475098, 8.686643600463867, 8.765031814575195, 9.633279800415039, 9.247735977172852, 7.969552040100098, 8.13877010345459, 9.259004592895508, 8.921758651733398, 8.349588394165039, 8.217605590820312, 8.933040618896484, 8.066554069519043, 7.958390235900879, 9.201360702514648, 8.673341751098633, 9.116071701049805, 9.75114917755127, 8.152393341064453, 8.663785934448242, 8.000431060791016, 8.467856407165527, 8.042378425598145, 7.803107261657715, 7.910266876220703, 8.999988555908203, 8.12350845336914, 8.354496002197266, 8.803282737731934, 7.767046928405762, 8.144463539123535, 8.606825828552246, 9.268672943115234, 8.150457382202148, 9.354957580566406, 8.606891632080078, 8.561798095703125, 9.442436218261719, 8.1016206741333, 8.915192604064941, 9.024770736694336, 8.507532119750977, 8.385702133178711, 7.694191932678223, 9.507680892944336, 8.736037254333496, 8.06216812133789, 9.056747436523438, 9.107934951782227, 8.769889831542969, 8.572158813476562, 8.015361785888672, 9.827902793884277, 8.0336332321167, 8.48421573638916, 8.38347053527832, 7.2877726554870605, 9.065757751464844, 8.410186767578125, 9.206413269042969, 8.411283493041992, 9.571430206298828, 7.204392433166504, 9.520235061645508, 8.225439071655273, 8.423913955688477, 8.603836059570312, 7.945897102355957, 8.167684555053711, 9.219411849975586, 8.536384582519531, 8.868158340454102, 8.997631072998047, 9.078309059143066, 9.31439208984375, 9.561567306518555, 8.60615062713623, 8.395814895629883, 8.099614143371582, 8.561990737915039, 7.928791046142578, 8.360785484313965, 8.698826789855957, 8.19930648803711, 9.027132034301758, 9.633340835571289, 8.272285461425781], "mean_td_error": 8.637303352355957, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.429708480834961, "actor_loss": -5.535538196563721, "critic_loss": 6.775773048400879, "alpha_loss": -0.03223499283194542, "alpha_value": 0.9976025819778442, "log_alpha_value": -0.002400275319814682, "target_entropy": -8.0, "policy_t": -0.010558908805251122, "mean_q": 0.12094275653362274, "max_q": 0.19902876019477844, "min_q": 0.07083377242088318}, "td_error": [8.231014251708984, 8.575605392456055, 7.970661163330078, 9.507342338562012, 9.107048034667969, 9.579303741455078, 8.143978118896484, 7.838634490966797, 8.793292999267578, 8.441629409790039, 8.573447227478027, 8.93126106262207, 8.447355270385742, 8.89449691772461, 8.390297889709473, 8.842325210571289, 8.252668380737305, 8.149518966674805, 9.354938507080078, 7.728592872619629, 8.060590744018555, 8.869014739990234, 8.328454971313477, 8.613805770874023, 8.476089477539062, 8.859126091003418, 8.35844612121582, 9.106771469116211, 8.59403133392334, 9.058023452758789, 9.241525650024414, 8.36042308807373, 7.695370674133301, 8.986781120300293, 7.918673038482666, 8.901603698730469, 10.113737106323242, 8.256453514099121, 8.276484489440918, 7.986742973327637, 8.340571403503418, 8.431694984436035, 9.3418607711792, 8.4490385055542, 8.681303024291992, 8.006423950195312, 7.763554573059082, 8.739803314208984, 8.504312515258789, 8.256176948547363, 8.577459335327148, 8.691433906555176, 9.135503768920898, 9.243929862976074, 7.661860466003418, 9.339852333068848, 8.667680740356445, 9.154867172241211, 8.94876766204834, 9.066825866699219, 9.616779327392578, 8.750129699707031, 8.185302734375, 10.010955810546875, 7.610630035400391, 8.90834903717041, 9.213912963867188, 8.676998138427734, 8.51039981842041, 9.307304382324219, 8.275556564331055, 8.28066635131836, 8.972070693969727, 10.126714706420898, 8.997282028198242, 8.861721992492676, 8.306780815124512, 8.803495407104492, 9.389662742614746, 10.37794303894043, 8.255943298339844, 7.7070817947387695, 8.750948905944824, 8.842292785644531, 8.116476058959961, 8.485124588012695, 9.575157165527344, 8.635843276977539, 7.876308441162109, 8.034283638000488, 9.180888175964355, 8.941997528076172, 9.354084014892578, 7.864764213562012, 9.76762866973877, 8.480939865112305, 8.541471481323242, 7.465700626373291, 8.672077178955078, 8.353033065795898, 9.16628360748291, 8.207511901855469, 8.563301086425781, 8.453411102294922, 7.845213890075684, 7.991703987121582, 8.70213508605957, 8.800929069519043, 9.545909881591797, 8.527015686035156, 8.486799240112305, 8.842009544372559, 8.891273498535156, 9.264673233032227, 8.348672866821289, 8.7559814453125, 9.264226913452148, 8.096029281616211, 8.980535507202148, 9.117635726928711, 8.747856140136719, 8.182506561279297, 8.933544158935547, 8.803020477294922, 8.51527214050293, 7.861721038818359, 8.812766075134277, 8.711968421936035], "mean_td_error": 8.666585922241211, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9.0, "diff_num_grad_updates_vs_sampler_policy": 8.0}}, "num_env_steps_sampled": 3200, "num_env_steps_trained": 2304, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 2304, "last_target_update_ts": 3200, "num_target_updates": 9}, "sampler_results": {"episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}}, "episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 2304, "num_env_steps_sampled": 3200, "num_env_steps_trained": 2304, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 393.57609137547644, "num_env_steps_trained_throughput_per_sec": 503.7773969606098, "timesteps_total": 3200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6400, "timers": {"training_iteration_time_ms": 506.934, "sample_time_ms": 282.886, "load_time_ms": 0.464, "load_throughput": 551170.73, "learn_time_ms": 40.911, "learn_throughput": 6257.415, "synch_weights_time_ms": 11.926}, "counters": {"num_env_steps_sampled": 3200, "num_env_steps_trained": 2304, "num_agent_steps_sampled": 6400, "num_agent_steps_trained": 2304, "last_target_update_ts": 3200, "num_target_updates": 9}, "done": false, "episodes_total": 4, "training_iteration": 7, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-43", "timestamp": 1742662543, "time_this_iter_s": 1.0363357067108154, "time_total_s": 7.9620680809021, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6CAF70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 7.9620680809021, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 92.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.523391723632812, "actor_loss": -5.716668128967285, "critic_loss": 6.3350830078125, "alpha_loss": -0.04463832080364227, "alpha_value": 0.996704638004303, "log_alpha_value": -0.003300823038443923, "target_entropy": -8.0, "policy_t": 0.035162072628736496, "mean_q": 0.23207496106624603, "max_q": 0.42190688848495483, "min_q": 0.10891671478748322}, "td_error": [8.636432647705078, 7.824283599853516, 8.991189956665039, 8.228662490844727, 7.924096584320068, 7.719757080078125, 8.152809143066406, 8.244905471801758, 8.956448554992676, 8.419082641601562, 9.26559829711914, 8.352554321289062, 8.141613006591797, 8.333715438842773, 9.018193244934082, 10.001716613769531, 8.864673614501953, 8.56782341003418, 8.973587036132812, 8.727655410766602, 9.165058135986328, 7.273439407348633, 8.58917236328125, 8.8541259765625, 8.326332092285156, 9.116608619689941, 8.139135360717773, 8.278839111328125, 9.006523132324219, 7.894509315490723, 9.255195617675781, 9.341867446899414, 8.826495170593262, 8.245309829711914, 7.876175880432129, 8.860690116882324, 9.472042083740234, 8.324084281921387, 9.110200881958008, 8.684080123901367, 9.036991119384766, 8.609098434448242, 8.841985702514648, 8.621990203857422, 9.885046005249023, 8.716802597045898, 8.92824935913086, 9.64816665649414, 8.645238876342773, 8.379730224609375, 8.74462890625, 8.897300720214844, 8.586318969726562, 8.594925880432129, 8.827935218811035, 8.63117790222168, 8.253828048706055, 8.608421325683594, 8.044086456298828, 8.527498245239258, 8.670622825622559, 8.197166442871094, 8.254541397094727, 8.382881164550781, 8.307052612304688, 8.419225692749023, 8.940103530883789, 7.990796089172363, 8.46705436706543, 9.034994125366211, 8.746070861816406, 9.148815155029297, 7.934487819671631, 8.126809120178223, 8.933611869812012, 8.067649841308594, 7.939799785614014, 8.022123336791992, 8.34349250793457, 8.13369369506836, 8.064994812011719, 8.688436508178711, 7.408559322357178, 8.369119644165039, 8.251729011535645, 8.576202392578125, 8.836610794067383, 8.575422286987305, 8.14108657836914, 7.966097354888916, 8.69709587097168, 9.449358940124512, 9.460933685302734, 8.551572799682617, 9.09970474243164, 7.73482608795166, 9.390771865844727, 9.470329284667969, 7.629385948181152, 8.43604850769043, 8.060263633728027, 9.185404777526855, 8.803497314453125, 8.44876480102539, 8.792223930358887, 8.203624725341797, 10.213735580444336, 9.75442123413086, 9.088805198669434, 8.457860946655273, 8.420854568481445, 8.766762733459473, 8.137951850891113, 8.485687255859375, 8.474807739257812, 7.488522529602051, 9.60318660736084, 8.24832534790039, 8.439911842346191, 9.089529037475586, 7.7818779945373535, 7.9246721267700195, 9.16604995727539, 8.274551391601562, 8.467913627624512, 8.70413589477539, 7.918929100036621, 8.27415943145752], "mean_td_error": 8.582420349121094, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.4305419921875, "actor_loss": -5.603432655334473, "critic_loss": 6.559886932373047, "alpha_loss": -0.044332437217235565, "alpha_value": 0.9967045783996582, "log_alpha_value": -0.003300867974758148, "target_entropy": -8.0, "policy_t": 0.002347883302718401, "mean_q": 0.19443990290164948, "max_q": 0.33470869064331055, "min_q": 0.12773914635181427}, "td_error": [9.244750022888184, 8.55021858215332, 8.549524307250977, 8.35238265991211, 8.861310958862305, 8.422723770141602, 9.128273010253906, 8.48448371887207, 8.468229293823242, 8.682207107543945, 8.182273864746094, 8.278942108154297, 9.538524627685547, 8.33437728881836, 8.02746868133545, 7.9711456298828125, 8.726046562194824, 8.48947525024414, 8.924169540405273, 8.851510047912598, 8.287920951843262, 8.66884994506836, 8.692218780517578, 8.521512031555176, 8.626373291015625, 8.230825424194336, 8.882278442382812, 9.32133674621582, 8.621057510375977, 9.4808988571167, 8.19029426574707, 8.003321647644043, 8.126214981079102, 8.231365203857422, 9.682052612304688, 8.323884963989258, 8.90915584564209, 8.793546676635742, 7.829500198364258, 8.80868911743164, 8.636509895324707, 7.874452590942383, 8.496326446533203, 7.900134563446045, 8.558380126953125, 9.110292434692383, 8.501420021057129, 9.17165756225586, 7.286445617675781, 8.774351119995117, 9.428339004516602, 7.797019958496094, 7.462224006652832, 8.222999572753906, 8.637929916381836, 8.672062873840332, 8.102230072021484, 9.087991714477539, 7.701262950897217, 8.793184280395508, 8.910381317138672, 8.087322235107422, 8.70015811920166, 8.366348266601562, 8.005898475646973, 9.264739990234375, 7.684225082397461, 9.50102710723877, 9.032353401184082, 8.177644729614258, 8.98628044128418, 8.347683906555176, 8.138622283935547, 10.118572235107422, 7.22271728515625, 8.39554214477539, 9.197623252868652, 8.989940643310547, 9.385332107543945, 8.031993865966797, 8.51760482788086, 8.391153335571289, 8.24595832824707, 8.491640090942383, 8.476571083068848, 8.818933486938477, 8.993061065673828, 9.28632926940918, 8.947288513183594, 9.99532413482666, 7.869884967803955, 9.191007614135742, 9.035552978515625, 9.602083206176758, 8.244913101196289, 8.801420211791992, 8.852485656738281, 9.220680236816406, 8.781450271606445, 7.749661445617676, 8.544309616088867, 9.093393325805664, 7.9613542556762695, 8.057512283325195, 8.297201156616211, 8.665082931518555, 9.281164169311523, 8.360208511352539, 9.42557144165039, 8.84017562866211, 8.570347785949707, 8.94932746887207, 8.627392768859863, 8.863824844360352, 9.821277618408203, 9.050512313842773, 8.80897331237793, 8.418279647827148, 8.224456787109375, 8.869056701660156, 9.174510955810547, 8.936116218566895, 8.453097343444824, 8.20976448059082, 8.700490951538086, 8.732939720153809, 8.18438720703125, 7.896572113037109], "mean_td_error": 8.621790885925293, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12.0, "diff_num_grad_updates_vs_sampler_policy": 11.0}}, "num_env_steps_sampled": 3800, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 7600, "num_agent_steps_trained": 3072, "last_target_update_ts": 3800, "num_target_updates": 12}, "sampler_results": {"episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1955.684932119314, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2054.0882041437153, "('robot_1', 'robot_1')_total_reward_mean": 1946.5175717949653, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2044.2238361856778}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}}, "episode_reward_max": 4098.312040329392, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3902.202503914282, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2054.0882041437153, "robot_1": 2044.2238361856778}, "policy_reward_mean": {"robot_0": 1955.684932119314, "robot_1": 1946.5175717949653}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046], "episode_lengths": [500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7794363769942414, "mean_inference_ms": 3.4238546194430595, "mean_action_processing_ms": 0.4877386216869849, "mean_env_wait_ms": 0.46500105581835594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012531876564025879, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1652359962463379}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7600, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3800, "num_env_steps_trained": 3072, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 408.3286914812265, "num_env_steps_trained_throughput_per_sec": 522.66072509597, "timesteps_total": 3800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 7600, "timers": {"training_iteration_time_ms": 516.134, "sample_time_ms": 281.891, "load_time_ms": 0.409, "load_throughput": 626307.643, "learn_time_ms": 36.632, "learn_throughput": 6988.346, "synch_weights_time_ms": 11.202}, "counters": {"num_env_steps_sampled": 3800, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 7600, "num_agent_steps_trained": 3072, "last_target_update_ts": 3800, "num_target_updates": 12}, "done": false, "episodes_total": 4, "training_iteration": 8, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-45", "timestamp": 1742662545, "time_this_iter_s": 1.4872660636901855, "time_total_s": 9.449334144592285, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6CAD30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 9.449334144592285, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.35, "ram_util_percent": 92.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1963.370475016302, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1933.3688924065418, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.471227645874023, "actor_loss": -5.7191362380981445, "critic_loss": 6.302515029907227, "alpha_loss": -0.05255615711212158, "alpha_value": 0.9961062073707581, "log_alpha_value": -0.00390136381611228, "target_entropy": -8.0, "policy_t": -0.010782347060739994, "mean_q": 0.28704580664634705, "max_q": 0.5336007475852966, "min_q": 0.1671847105026245}, "td_error": [8.531256675720215, 7.892940521240234, 8.519428253173828, 8.457256317138672, 8.21988296508789, 8.487218856811523, 8.750473022460938, 8.510988235473633, 8.280097961425781, 8.248939514160156, 8.623159408569336, 9.135805130004883, 8.82839584350586, 8.176883697509766, 8.152830123901367, 8.152215957641602, 8.935416221618652, 9.217531204223633, 8.23944091796875, 8.042771339416504, 8.810017585754395, 8.595964431762695, 10.752056121826172, 9.255658149719238, 8.113409042358398, 7.869607925415039, 9.021585464477539, 8.353897094726562, 8.897554397583008, 8.580541610717773, 8.869779586791992, 8.944286346435547, 8.197443962097168, 8.571810722351074, 9.01784896850586, 8.02816390991211, 8.455453872680664, 7.713248252868652, 8.361433982849121, 8.286693572998047, 8.840387344360352, 8.681228637695312, 9.151084899902344, 7.688323974609375, 8.12293815612793, 8.166526794433594, 8.788580894470215, 8.300819396972656, 9.256231307983398, 8.277610778808594, 8.748619079589844, 8.051877975463867, 8.828489303588867, 8.231510162353516, 8.134021759033203, 8.198507308959961, 8.879279136657715, 8.7832612991333, 8.190631866455078, 7.291475772857666, 8.079351425170898, 9.015884399414062, 8.39117431640625, 8.005485534667969, 8.525775909423828, 8.576065063476562, 8.430667877197266, 8.983729362487793, 7.925329208374023, 7.738312721252441, 8.805781364440918, 7.940818786621094, 8.382646560668945, 8.409990310668945, 8.508727073669434, 8.972270965576172, 8.633110046386719, 7.8712873458862305, 8.93103313446045, 7.887044906616211, 9.505653381347656, 8.581064224243164, 9.474315643310547, 8.24142837524414, 8.091407775878906, 7.551365852355957, 8.902618408203125, 8.369001388549805, 9.43738842010498, 9.138976097106934, 10.73637580871582, 8.102134704589844, 8.361282348632812, 8.648588180541992, 9.108858108520508, 8.615448951721191, 9.008096694946289, 9.57684326171875, 9.257780075073242, 8.186205863952637, 8.332511901855469, 8.678525924682617, 8.720146179199219, 8.049196243286133, 9.318517684936523, 8.626611709594727, 7.511418342590332, 8.401254653930664, 8.524149894714355, 9.190999984741211, 8.682580947875977, 7.956721782684326, 9.730626106262207, 8.610713005065918, 8.149778366088867, 8.892127990722656, 8.087543487548828, 8.649028778076172, 8.217365264892578, 8.297770500183105, 8.430293083190918, 8.661995887756348, 9.232818603515625, 8.298681259155273, 8.962423324584961, 8.091079711914062, 8.499588966369629, 8.227156639099121], "mean_td_error": 8.551966667175293, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.464668273925781, "actor_loss": -5.697137355804443, "critic_loss": 6.226970195770264, "alpha_loss": -0.05252981185913086, "alpha_value": 0.9961062669754028, "log_alpha_value": -0.0039013074710965157, "target_entropy": -8.0, "policy_t": -0.010389471426606178, "mean_q": 0.2605438530445099, "max_q": 0.45309126377105713, "min_q": 0.16348938643932343}, "td_error": [7.885922431945801, 7.716423034667969, 8.114757537841797, 9.143805503845215, 8.159235000610352, 8.531675338745117, 7.830548286437988, 8.211968421936035, 8.677251815795898, 8.196494102478027, 7.847288131713867, 8.73575210571289, 8.207669258117676, 9.565045356750488, 7.816140174865723, 7.6825103759765625, 7.596663475036621, 8.526824951171875, 8.23940658569336, 8.295256614685059, 8.884344100952148, 9.206535339355469, 8.115022659301758, 7.595175743103027, 9.113975524902344, 8.044763565063477, 8.671632766723633, 8.909000396728516, 8.16938304901123, 8.85555648803711, 9.350975036621094, 7.731971740722656, 8.203060150146484, 8.373128890991211, 8.994307518005371, 8.241552352905273, 8.532190322875977, 7.936213970184326, 8.27038288116455, 8.114825248718262, 8.020376205444336, 8.980891227722168, 8.83494758605957, 8.068103790283203, 8.707672119140625, 8.752440452575684, 8.931259155273438, 8.666481971740723, 9.322074890136719, 8.175254821777344, 8.573112487792969, 8.030925750732422, 8.422589302062988, 8.720560073852539, 8.160463333129883, 8.432317733764648, 9.380834579467773, 8.270631790161133, 8.709918975830078, 8.833086967468262, 8.598215103149414, 8.472951889038086, 7.975730895996094, 8.301043510437012, 8.071297645568848, 8.34389591217041, 8.54725456237793, 8.252553939819336, 8.554486274719238, 9.262553215026855, 9.18630599975586, 8.270206451416016, 8.281908988952637, 8.612255096435547, 8.059202194213867, 8.327278137207031, 9.004124641418457, 8.432788848876953, 8.918262481689453, 8.03429889678955, 8.474767684936523, 8.086349487304688, 9.125213623046875, 8.333145141601562, 8.549516677856445, 8.382347106933594, 8.36836051940918, 8.646295547485352, 9.083076477050781, 8.530452728271484, 9.115325927734375, 8.156749725341797, 8.107854843139648, 8.133383750915527, 7.9890947341918945, 8.784414291381836, 9.043413162231445, 8.26665210723877, 8.827116012573242, 7.051465034484863, 8.189913749694824, 8.482279777526855, 8.43271255493164, 8.557579040527344, 8.977928161621094, 8.406994819641113, 8.23607063293457, 9.385547637939453, 8.22470474243164, 8.170366287231445, 7.778158664703369, 8.815485000610352, 8.533439636230469, 8.771516799926758, 8.431099891662598, 8.419527053833008, 7.623167037963867, 8.774174690246582, 8.211348533630371, 8.28021240234375, 7.834859848022461, 8.237183570861816, 8.523614883422852, 9.339595794677734, 8.572625160217285, 8.80811882019043, 8.402271270751953, 9.151374816894531], "mean_td_error": 8.456421852111816, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 13.0}}, "num_env_steps_sampled": 4200, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 3584, "last_target_update_ts": 4200, "num_target_updates": 14}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3896.739367422844, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1963.370475016302, "robot_1": 1933.3688924065418}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1963.370475016302, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1933.3688924065418, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7659041986563964, "mean_inference_ms": 3.4135731109499448, "mean_action_processing_ms": 0.47162659825458786, "mean_env_wait_ms": 0.47379595269629826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062659382820129395, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1340240240097046}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3896.739367422844, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1963.370475016302, "robot_1": 1933.3688924065418}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7659041986563964, "mean_inference_ms": 3.4135731109499448, "mean_action_processing_ms": 0.47162659825458786, "mean_env_wait_ms": 0.47379595269629826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062659382820129395, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1340240240097046}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 3584, "num_env_steps_sampled": 4200, "num_env_steps_trained": 3584, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 305.26363288340417, "num_env_steps_trained_throughput_per_sec": 390.7374500907573, "timesteps_total": 4200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8400, "timers": {"training_iteration_time_ms": 530.694, "sample_time_ms": 312.18, "load_time_ms": 0.41, "load_throughput": 624522.669, "learn_time_ms": 36.758, "learn_throughput": 6964.395, "synch_weights_time_ms": 10.922}, "counters": {"num_env_steps_sampled": 4200, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 8400, "num_agent_steps_trained": 3584, "last_target_update_ts": 4200, "num_target_updates": 14}, "done": false, "episodes_total": 8, "training_iteration": 9, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-46", "timestamp": 1742662546, "time_this_iter_s": 1.3273797035217285, "time_total_s": 10.776713848114014, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6CA280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 10.776713848114014, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.6, "ram_util_percent": 92.1}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1963.370475016302, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1933.3688924065418, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.446310997009277, "actor_loss": -5.808766841888428, "critic_loss": 6.358572006225586, "alpha_loss": -0.06457491219043732, "alpha_value": 0.9952090978622437, "log_alpha_value": -0.00480242632329464, "target_entropy": -8.0, "policy_t": 0.028301464393734932, "mean_q": 0.42204582691192627, "max_q": 0.7531841993331909, "min_q": 0.22868011891841888}, "td_error": [8.213333129882812, 9.312034606933594, 8.527639389038086, 8.382518768310547, 8.541500091552734, 8.160981178283691, 7.804411888122559, 8.21731948852539, 8.913728713989258, 8.150094985961914, 8.430461883544922, 8.328376770019531, 8.087139129638672, 7.614721298217773, 7.575562953948975, 8.61231517791748, 8.836191177368164, 8.203493118286133, 8.48330307006836, 8.016644477844238, 8.386835098266602, 8.640356063842773, 9.260766983032227, 8.927698135375977, 7.904720306396484, 8.815423965454102, 8.907864570617676, 7.874687194824219, 8.632347106933594, 8.001065254211426, 7.847414970397949, 10.17076301574707, 8.652252197265625, 8.119848251342773, 8.788747787475586, 9.50844955444336, 8.888107299804688, 8.440519332885742, 7.331425666809082, 7.962308883666992, 7.64955472946167, 9.512455940246582, 8.84488296508789, 8.44555377960205, 8.379115104675293, 7.857989311218262, 8.080068588256836, 8.77902603149414, 7.856773376464844, 9.160842895507812, 8.221233367919922, 8.471111297607422, 8.461578369140625, 8.241355895996094, 7.988866806030273, 8.158260345458984, 7.4887800216674805, 8.644305229187012, 8.679924011230469, 8.480435371398926, 9.175006866455078, 8.813465118408203, 8.812829971313477, 8.065998077392578, 9.069841384887695, 8.346536636352539, 8.090836524963379, 8.185300827026367, 7.864262104034424, 8.354681015014648, 8.109073638916016, 8.379781723022461, 8.461668968200684, 8.916605949401855, 9.290827751159668, 8.796415328979492, 7.820751190185547, 8.518288612365723, 8.4439697265625, 7.69235372543335, 7.4024457931518555, 7.9663848876953125, 8.53091812133789, 8.899272918701172, 7.825631141662598, 8.468955039978027, 8.516716003417969, 8.486928939819336, 8.572519302368164, 9.303884506225586, 8.527860641479492, 8.806535720825195, 8.379217147827148, 8.487314224243164, 7.918944358825684, 8.066210746765137, 9.220145225524902, 9.048836708068848, 8.017202377319336, 8.227394104003906, 8.061393737792969, 7.7537431716918945, 7.301923751831055, 8.598993301391602, 9.368026733398438, 8.148699760437012, 8.579687118530273, 9.187272071838379, 8.761123657226562, 8.801412582397461, 8.310982704162598, 8.133724212646484, 8.036711692810059, 8.898210525512695, 8.474788665771484, 8.244588851928711, 8.831384658813477, 8.46603012084961, 7.8783674240112305, 8.00011157989502, 7.797192573547363, 6.9920244216918945, 8.355926513671875, 8.34151840209961, 8.273346900939941, 8.486291885375977, 9.070627212524414, 7.896852016448975], "mean_td_error": 8.404752731323242, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.49138069152832, "actor_loss": -5.819549560546875, "critic_loss": 6.276533126831055, "alpha_loss": -0.06478848308324814, "alpha_value": 0.995209276676178, "log_alpha_value": -0.004802213050425053, "target_entropy": -8.0, "policy_t": -0.0002649407833814621, "mean_q": 0.3567381203174591, "max_q": 0.650702178478241, "min_q": 0.20443610846996307}, "td_error": [9.383832931518555, 7.669858932495117, 9.286759376525879, 8.991438865661621, 8.60285758972168, 7.689156532287598, 8.495450973510742, 8.794614791870117, 8.694403648376465, 9.087101936340332, 8.70363998413086, 8.58479118347168, 8.430156707763672, 8.315834999084473, 8.355721473693848, 8.124687194824219, 9.011205673217773, 8.303356170654297, 7.872088432312012, 7.9429450035095215, 8.407017707824707, 9.035880088806152, 8.419078826904297, 8.151958465576172, 8.607561111450195, 8.213011741638184, 7.528651237487793, 7.6977033615112305, 10.133367538452148, 8.169292449951172, 8.198657989501953, 8.224417686462402, 8.960363388061523, 8.758302688598633, 8.548656463623047, 8.447025299072266, 8.44882583618164, 8.006793022155762, 8.200080871582031, 8.14150619506836, 8.786312103271484, 7.995578289031982, 8.462039947509766, 9.106363296508789, 8.320178031921387, 8.375980377197266, 8.019149780273438, 8.502641677856445, 8.284614562988281, 7.732685089111328, 9.468420028686523, 8.06657600402832, 8.57509994506836, 8.030536651611328, 8.823267936706543, 8.149497985839844, 8.444927215576172, 7.876834392547607, 8.400622367858887, 8.409600257873535, 7.760056018829346, 8.402332305908203, 8.090648651123047, 7.8343329429626465, 7.821375370025635, 7.813143253326416, 8.532939910888672, 8.50578498840332, 8.002095222473145, 8.21722412109375, 8.417314529418945, 8.990153312683105, 7.967491149902344, 8.762964248657227, 8.459497451782227, 7.874289512634277, 7.781528472900391, 8.529020309448242, 8.226269721984863, 8.546857833862305, 8.477737426757812, 8.385700225830078, 8.110418319702148, 7.443839073181152, 8.505823135375977, 7.285825729370117, 8.901800155639648, 8.802278518676758, 8.100658416748047, 8.050065040588379, 8.307044982910156, 8.11367416381836, 7.374347686767578, 8.840736389160156, 8.423938751220703, 9.27566909790039, 8.209104537963867, 7.905889511108398, 9.061711311340332, 8.48246955871582, 9.142953872680664, 9.874834060668945, 7.723153114318848, 8.028568267822266, 7.96065616607666, 8.097870826721191, 8.760122299194336, 8.228015899658203, 7.73325252532959, 8.630538940429688, 8.122180938720703, 7.501277923583984, 8.645679473876953, 8.17401123046875, 9.10357666015625, 9.057502746582031, 7.971549034118652, 7.8907952308654785, 8.263818740844727, 9.014795303344727, 7.766645431518555, 8.424373626708984, 8.545333862304688, 8.955411911010742, 8.140092849731445, 8.822858810424805, 9.433273315429688, 8.046586036682129], "mean_td_error": 8.383771896362305, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 16.0}}, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4352, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 4352, "last_target_update_ts": 4800, "num_target_updates": 17}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3896.739367422844, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1963.370475016302, "robot_1": 1933.3688924065418}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1963.370475016302, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1933.3688924065418, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7659041986563964, "mean_inference_ms": 3.4135731109499448, "mean_action_processing_ms": 0.47162659825458786, "mean_env_wait_ms": 0.47379595269629826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062659382820129395, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1340240240097046}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3896.739367422844, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1963.370475016302, "robot_1": 1933.3688924065418}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7659041986563964, "mean_inference_ms": 3.4135731109499448, "mean_action_processing_ms": 0.47162659825458786, "mean_env_wait_ms": 0.47379595269629826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062659382820129395, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1340240240097046}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 4352, "num_env_steps_sampled": 4800, "num_env_steps_trained": 4352, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 401.8426192159272, "num_env_steps_trained_throughput_per_sec": 514.3585525963867, "timesteps_total": 4800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 9600, "timers": {"training_iteration_time_ms": 528.919, "sample_time_ms": 309.127, "load_time_ms": 0.511, "load_throughput": 501443.9, "learn_time_ms": 37.146, "learn_throughput": 6891.77, "synch_weights_time_ms": 11.242}, "counters": {"num_env_steps_sampled": 4800, "num_env_steps_trained": 4352, "num_agent_steps_sampled": 9600, "num_agent_steps_trained": 4352, "last_target_update_ts": 4800, "num_target_updates": 17}, "done": false, "episodes_total": 8, "training_iteration": 10, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-48", "timestamp": 1742662548, "time_this_iter_s": 1.5123353004455566, "time_total_s": 12.28904914855957, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6CAF70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 12.28904914855957, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.900000000000002, "ram_util_percent": 92.36666666666667}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1963.370475016302, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1933.3688924065418, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.411660194396973, "actor_loss": -5.917840957641602, "critic_loss": 5.969059944152832, "alpha_loss": -0.07649201899766922, "alpha_value": 0.9943128228187561, "log_alpha_value": -0.005703396629542112, "target_entropy": -8.0, "policy_t": -0.019528495147824287, "mean_q": 0.5776021480560303, "max_q": 1.0018270015716553, "min_q": 0.3431898355484009}, "td_error": [8.28492259979248, 8.617050170898438, 8.178754806518555, 8.009800910949707, 8.919746398925781, 8.619970321655273, 8.118705749511719, 8.222827911376953, 7.565614700317383, 8.623739242553711, 7.821134567260742, 8.133609771728516, 7.496054649353027, 7.886531829833984, 7.820261001586914, 8.012443542480469, 8.847451210021973, 8.096635818481445, 8.567513465881348, 8.245965957641602, 8.411632537841797, 8.592796325683594, 8.31224536895752, 8.597185134887695, 8.34621810913086, 8.787111282348633, 7.291499137878418, 8.376296997070312, 7.800227642059326, 8.612953186035156, 7.403207778930664, 8.608031272888184, 8.00003719329834, 8.949968338012695, 8.650091171264648, 8.421292304992676, 7.533165454864502, 8.585780143737793, 8.56513786315918, 8.324623107910156, 8.825679779052734, 8.21411418914795, 7.849642753601074, 8.174470901489258, 8.152283668518066, 8.357446670532227, 8.461286544799805, 8.343046188354492, 7.3097243309021, 7.228641510009766, 7.954988956451416, 7.746262073516846, 8.445684432983398, 8.629730224609375, 7.226710796356201, 8.447120666503906, 8.192394256591797, 8.391561508178711, 8.312307357788086, 8.203720092773438, 7.163083553314209, 8.468145370483398, 8.352210998535156, 8.295034408569336, 7.84492826461792, 8.08644962310791, 8.320499420166016, 7.357460975646973, 8.166879653930664, 8.721992492675781, 8.576401710510254, 7.428371906280518, 7.940900802612305, 8.745481491088867, 9.407085418701172, 8.277853012084961, 7.873380661010742, 7.6966047286987305, 7.855815410614014, 8.173629760742188, 9.50770378112793, 7.4063310623168945, 8.565696716308594, 8.55976390838623, 8.368008613586426, 7.852465629577637, 7.818879127502441, 9.369634628295898, 8.895401954650879, 8.500862121582031, 7.867206573486328, 8.12589168548584, 7.447820663452148, 9.305719375610352, 8.531553268432617, 7.876016616821289, 8.201688766479492, 8.418479919433594, 8.797602653503418, 8.381887435913086, 8.658390045166016, 7.8592634201049805, 8.895313262939453, 8.21407413482666, 8.643259048461914, 9.150091171264648, 7.953313827514648, 7.778956413269043, 8.330974578857422, 7.6982293128967285, 8.544879913330078, 7.886688709259033, 8.111745834350586, 8.085000991821289, 7.775338649749756, 8.900524139404297, 8.16504192352295, 8.374452590942383, 8.795356750488281, 7.90794563293457, 7.962312698364258, 8.372354507446289, 7.138421535491943, 8.318737030029297, 8.529041290283203, 8.288074493408203, 8.24071979522705, 7.763978958129883], "mean_td_error": 8.231393814086914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.452964782714844, "actor_loss": -5.908243179321289, "critic_loss": 6.069971561431885, "alpha_loss": -0.07672472298145294, "alpha_value": 0.9943130612373352, "log_alpha_value": -0.005703182891011238, "target_entropy": -8.0, "policy_t": -0.04334546625614166, "mean_q": 0.4938361644744873, "max_q": 0.8632294535636902, "min_q": 0.32353320717811584}, "td_error": [8.092155456542969, 8.201038360595703, 7.87746524810791, 7.584044456481934, 8.059550285339355, 8.108705520629883, 8.421195030212402, 8.158868789672852, 7.605214595794678, 8.896867752075195, 8.285809516906738, 7.611347198486328, 8.500154495239258, 8.778800010681152, 8.753755569458008, 8.662028312683105, 8.340707778930664, 8.352071762084961, 7.887042999267578, 9.052949905395508, 8.28648567199707, 8.512676239013672, 8.181528091430664, 8.274667739868164, 7.810256004333496, 8.455299377441406, 7.875110149383545, 8.020622253417969, 7.46143913269043, 9.02614974975586, 8.618717193603516, 7.429812431335449, 7.595559597015381, 7.903511047363281, 7.924679279327393, 8.528459548950195, 7.607675075531006, 8.338635444641113, 7.901022911071777, 8.30329704284668, 8.311885833740234, 7.158411026000977, 8.238792419433594, 7.662884712219238, 9.06934642791748, 8.4876708984375, 7.59184455871582, 8.75449275970459, 8.7648286819458, 8.737481117248535, 8.208311080932617, 8.231277465820312, 8.712408065795898, 8.658515930175781, 8.183778762817383, 7.723733901977539, 7.690254211425781, 8.178631782531738, 7.813875198364258, 8.963202476501465, 8.091717720031738, 8.643830299377441, 8.349979400634766, 8.159048080444336, 7.540322303771973, 7.6820173263549805, 8.524011611938477, 8.066095352172852, 9.262500762939453, 7.749295234680176, 8.659183502197266, 7.434826374053955, 7.480563163757324, 8.495027542114258, 7.853024482727051, 8.612014770507812, 8.458009719848633, 7.926012992858887, 8.157857894897461, 8.86528205871582, 7.906374931335449, 7.807625770568848, 8.862655639648438, 8.332817077636719, 9.468145370483398, 8.528341293334961, 8.473569869995117, 8.050985336303711, 8.307088851928711, 8.291125297546387, 8.663535118103027, 8.133057594299316, 8.374492645263672, 8.242225646972656, 8.979703903198242, 8.153326034545898, 8.06772232055664, 8.550950050354004, 8.386029243469238, 8.345162391662598, 8.361109733581543, 8.617053985595703, 8.230391502380371, 8.192405700683594, 7.816647052764893, 8.454080581665039, 8.128927230834961, 8.523422241210938, 8.474767684936523, 9.529119491577148, 7.743661880493164, 7.488703727722168, 8.395709991455078, 7.9731645584106445, 8.244377136230469, 8.69833755493164, 8.997961044311523, 7.395869731903076, 8.206069946289062, 8.067995071411133, 8.31753158569336, 8.257261276245117, 8.649214744567871, 7.84713077545166, 7.937845706939697, 8.92562198638916, 8.396015167236328, 7.618404388427734], "mean_td_error": 8.248838424682617, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20.0, "diff_num_grad_updates_vs_sampler_policy": 19.0}}, "num_env_steps_sampled": 5400, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 10800, "num_agent_steps_trained": 5120, "last_target_update_ts": 5400, "num_target_updates": 20}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3896.739367422844, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1963.370475016302, "robot_1": 1933.3688924065418}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1963.370475016302, "('robot_0', 'robot_0')_total_reward_min": 1808.5343820488142, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1933.3688924065418, "('robot_1', 'robot_1')_total_reward_min": 1849.3624861604812, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7659041986563964, "mean_inference_ms": 3.4135731109499448, "mean_action_processing_ms": 0.47162659825458786, "mean_env_wait_ms": 0.47379595269629826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062659382820129395, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1340240240097046}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3657.8968682093046, "episode_reward_mean": 3896.739367422844, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1808.5343820488142, "robot_1": 1849.3624861604812}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1963.370475016302, "robot_1": 1933.3688924065418}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7659041986563964, "mean_inference_ms": 3.4135731109499448, "mean_action_processing_ms": 0.47162659825458786, "mean_env_wait_ms": 0.47379595269629826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062659382820129395, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1340240240097046}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10800, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5400, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 402.7196810737389, "num_env_steps_trained_throughput_per_sec": 515.4811917743858, "timesteps_total": 5400, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 10800, "timers": {"training_iteration_time_ms": 529.594, "sample_time_ms": 311.103, "load_time_ms": 0.615, "load_throughput": 416437.257, "learn_time_ms": 36.22, "learn_throughput": 7067.89, "synch_weights_time_ms": 11.276}, "counters": {"num_env_steps_sampled": 5400, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 10800, "num_agent_steps_trained": 5120, "last_target_update_ts": 5400, "num_target_updates": 20}, "done": false, "episodes_total": 8, "training_iteration": 11, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-49", "timestamp": 1742662549, "time_this_iter_s": 1.5053420066833496, "time_total_s": 13.79439115524292, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6CAD30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 13.79439115524292, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.85, "ram_util_percent": 92.55}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1931.5067404464137, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1906.0383785136494, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.46213150024414, "actor_loss": -6.132070064544678, "critic_loss": 5.709356784820557, "alpha_loss": -0.08890990912914276, "alpha_value": 0.9934173226356506, "log_alpha_value": -0.006604445166885853, "target_entropy": -8.0, "policy_t": -0.033104460686445236, "mean_q": 0.7416670918464661, "max_q": 1.3106355667114258, "min_q": 0.4236055612564087}, "td_error": [8.487116813659668, 7.499655723571777, 8.826456069946289, 8.213172912597656, 7.975620269775391, 8.428825378417969, 7.581533908843994, 7.853057861328125, 8.314020156860352, 7.704671859741211, 7.071791648864746, 7.834394454956055, 8.244987487792969, 7.532414436340332, 8.156084060668945, 7.320009231567383, 7.881636142730713, 7.98887825012207, 7.425220489501953, 8.352989196777344, 7.439566612243652, 8.485376358032227, 7.324512004852295, 7.715699195861816, 7.679153919219971, 8.257427215576172, 7.94415283203125, 8.55919075012207, 7.881858825683594, 7.126132488250732, 8.799886703491211, 7.831111907958984, 7.510747909545898, 7.15673828125, 7.714442253112793, 8.154141426086426, 8.505732536315918, 7.421032905578613, 7.842732906341553, 7.568717002868652, 9.462783813476562, 7.908707618713379, 8.585742950439453, 7.724555015563965, 7.777419567108154, 7.455857753753662, 7.720026016235352, 7.478667736053467, 7.502256393432617, 8.34066104888916, 7.122796058654785, 8.387371063232422, 7.282711982727051, 7.199552059173584, 7.648979187011719, 7.552515983581543, 7.879290580749512, 8.276626586914062, 8.71313190460205, 7.63480281829834, 8.800771713256836, 7.816021919250488, 7.822574138641357, 7.387056827545166, 8.27440071105957, 7.62225341796875, 7.572758197784424, 7.578822135925293, 8.405691146850586, 8.108120918273926, 7.885560989379883, 8.25687313079834, 7.059260368347168, 7.501293182373047, 7.604207992553711, 8.188159942626953, 8.206623077392578, 7.695822715759277, 7.85032320022583, 7.653023719787598, 7.321468830108643, 8.570640563964844, 7.629141807556152, 8.35378360748291, 7.87873649597168, 7.782520294189453, 8.489131927490234, 7.456628799438477, 7.878015995025635, 8.42250919342041, 8.183464050292969, 7.937259674072266, 9.30994987487793, 8.090911865234375, 8.402694702148438, 8.173151016235352, 8.718924522399902, 8.339935302734375, 7.623072147369385, 8.36507797241211, 8.326484680175781, 7.670305252075195, 7.443667888641357, 7.973971366882324, 7.595588684082031, 7.250974655151367, 8.028909683227539, 8.064445495605469, 8.26051139831543, 8.394760131835938, 8.383892059326172, 7.953873634338379, 7.90969181060791, 8.1126127243042, 7.401583671569824, 7.585912704467773, 7.624258995056152, 8.573128700256348, 7.6185712814331055, 8.146059036254883, 7.875566482543945, 7.284095764160156, 8.315103530883789, 8.398167610168457, 8.053239822387695, 8.975245475769043, 8.541725158691406, 8.39631462097168], "mean_td_error": 7.950317859649658, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.480873107910156, "actor_loss": -6.090426921844482, "critic_loss": 5.834871292114258, "alpha_loss": -0.08903072029352188, "alpha_value": 0.9934175610542297, "log_alpha_value": -0.006604224909096956, "target_entropy": -8.0, "policy_t": 0.02904387004673481, "mean_q": 0.6434527039527893, "max_q": 1.1332571506500244, "min_q": 0.4438022971153259}, "td_error": [7.920407295227051, 7.825326919555664, 8.085535049438477, 8.950760841369629, 7.964853286743164, 7.738957405090332, 8.01110553741455, 8.009618759155273, 7.67043399810791, 8.051432609558105, 8.14955997467041, 7.931215286254883, 7.432348251342773, 7.409487247467041, 7.230680465698242, 7.593457221984863, 7.5773725509643555, 7.665572166442871, 7.973016262054443, 8.031599044799805, 7.948539733886719, 7.82879638671875, 8.24014663696289, 7.65473747253418, 8.003634452819824, 7.419713973999023, 7.870550632476807, 8.918089866638184, 9.318351745605469, 8.351341247558594, 7.562222480773926, 8.698114395141602, 8.049505233764648, 7.807892799377441, 8.512930870056152, 8.429800033569336, 8.37232780456543, 7.5841064453125, 7.636146545410156, 7.570345878601074, 7.730660438537598, 8.13294792175293, 7.868505477905273, 8.521743774414062, 7.356975555419922, 7.232387542724609, 7.707062721252441, 8.067058563232422, 7.966505527496338, 8.46883773803711, 8.090497970581055, 8.10871696472168, 7.994111061096191, 7.442418098449707, 7.990372180938721, 8.282848358154297, 8.903772354125977, 7.196106910705566, 8.186668395996094, 8.198726654052734, 7.7460150718688965, 7.510408878326416, 7.899828910827637, 7.588793754577637, 7.658977508544922, 7.9395904541015625, 7.40147590637207, 7.561270713806152, 7.822022914886475, 8.170350074768066, 7.8398895263671875, 7.854077339172363, 7.889601230621338, 8.155065536499023, 9.083078384399414, 9.3906831741333, 7.708271026611328, 7.739438056945801, 7.888715744018555, 8.868927001953125, 8.2085599899292, 7.478410720825195, 7.579641819000244, 8.247331619262695, 7.687305450439453, 8.476354598999023, 7.815518379211426, 7.899465084075928, 7.560497283935547, 7.906779766082764, 8.49494743347168, 8.127141952514648, 7.813318252563477, 8.26934814453125, 8.006471633911133, 7.940731525421143, 7.879807472229004, 8.397590637207031, 7.673066139221191, 7.911299705505371, 7.300628662109375, 8.04861831665039, 8.071664810180664, 8.434280395507812, 8.507312774658203, 7.764674186706543, 7.679770469665527, 7.876752853393555, 7.8229265213012695, 8.71578598022461, 8.620071411132812, 7.5845465660095215, 8.413297653198242, 8.03981876373291, 7.795432090759277, 7.8928375244140625, 8.109027862548828, 7.850440979003906, 8.368807792663574, 7.640301704406738, 7.945208549499512, 8.350479125976562, 7.698400497436523, 7.672833442687988, 7.966383457183838, 8.376981735229492, 8.269219398498535, 7.8503737449646], "mean_td_error": 7.985968112945557, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 5888, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 5888, "last_target_update_ts": 6000, "num_target_updates": 23}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3837.545118960064, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1931.5067404464137, "robot_1": 1906.0383785136494}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1931.5067404464137, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1906.0383785136494, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7591045833185696, "mean_inference_ms": 3.4006933007142073, "mean_action_processing_ms": 0.46654480198566234, "mean_env_wait_ms": 0.47313984448252894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289283434549968, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1304854949315389}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3837.545118960064, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1931.5067404464137, "robot_1": 1906.0383785136494}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7591045833185696, "mean_inference_ms": 3.4006933007142073, "mean_action_processing_ms": 0.46654480198566234, "mean_env_wait_ms": 0.47313984448252894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289283434549968, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1304854949315389}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 5888, "num_env_steps_sampled": 6000, "num_env_steps_trained": 5888, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 409.96966665906433, "num_env_steps_trained_throughput_per_sec": 524.7611733236023, "timesteps_total": 6000, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 526.872, "sample_time_ms": 309.12, "load_time_ms": 0.511, "load_throughput": 501092.88, "learn_time_ms": 35.467, "learn_throughput": 7217.894, "synch_weights_time_ms": 11.272}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 5888, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 5888, "last_target_update_ts": 6000, "num_target_updates": 23}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-51", "timestamp": 1742662551, "time_this_iter_s": 1.4846041202545166, "time_total_s": 15.278995275497437, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A628F70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 15.278995275497437, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 30.55, "ram_util_percent": 92.5}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1931.5067404464137, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1906.0383785136494, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.411123275756836, "actor_loss": -6.255815505981445, "critic_loss": 5.961568832397461, "alpha_loss": -0.09663128107786179, "alpha_value": 0.9928205609321594, "log_alpha_value": -0.007205307949334383, "target_entropy": -8.0, "policy_t": 0.008227983489632607, "mean_q": 0.9321457147598267, "max_q": 1.680312991142273, "min_q": 0.5137922167778015}, "td_error": [8.373123168945312, 7.412604331970215, 8.418939590454102, 7.9237260818481445, 8.695308685302734, 7.428065299987793, 7.506036281585693, 8.479364395141602, 8.305118560791016, 8.34912109375, 7.66133975982666, 8.087213516235352, 8.732267379760742, 7.403159141540527, 7.1299943923950195, 8.070047378540039, 8.828215599060059, 7.812718391418457, 7.676784515380859, 7.851222038269043, 7.523938179016113, 7.187075614929199, 8.678247451782227, 7.371761322021484, 7.711487770080566, 7.331994533538818, 8.37352180480957, 8.395275115966797, 7.272632598876953, 7.88825798034668, 8.183055877685547, 7.654543876647949, 7.874239921569824, 8.569395065307617, 7.624434947967529, 8.303586959838867, 8.51557445526123, 7.852185249328613, 7.710477828979492, 7.4736504554748535, 7.822538375854492, 8.070318222045898, 7.416751384735107, 7.745848655700684, 8.187843322753906, 8.231149673461914, 7.5971574783325195, 9.294958114624023, 8.54699420928955, 7.711716651916504, 7.4020233154296875, 8.529327392578125, 8.274972915649414, 7.646575450897217, 8.302967071533203, 7.598433971405029, 7.64327335357666, 7.892390251159668, 7.674769401550293, 7.986802577972412, 7.849804878234863, 8.18670654296875, 7.736273765563965, 8.257750511169434, 7.926072120666504, 8.041690826416016, 7.885725498199463, 8.043379783630371, 8.21181869506836, 8.17856216430664, 8.084548950195312, 7.740968704223633, 7.266390323638916, 7.91445255279541, 7.520755767822266, 8.197876930236816, 7.087759971618652, 7.899868965148926, 8.030071258544922, 8.201868057250977, 8.407632827758789, 7.468319416046143, 7.760928630828857, 7.759033679962158, 8.688886642456055, 7.476563453674316, 7.341428279876709, 6.882877349853516, 8.289094924926758, 7.613926887512207, 7.4842424392700195, 7.818572044372559, 7.083810806274414, 7.389886856079102, 7.972701072692871, 7.841629981994629, 7.787595748901367, 7.276906967163086, 7.87449836730957, 7.765419006347656, 7.941694736480713, 7.831216812133789, 7.3771233558654785, 8.483808517456055, 7.9083571434021, 7.17036247253418, 7.568275451660156, 7.49255895614624, 7.477631092071533, 8.204391479492188, 7.980456352233887, 7.782828330993652, 7.754404544830322, 7.320465087890625, 8.365188598632812, 7.562227249145508, 7.020633220672607, 7.257342338562012, 7.956860542297363, 7.569174289703369, 7.003032684326172, 8.148090362548828, 7.6779327392578125, 8.184090614318848, 8.491548538208008, 7.293741226196289, 7.68245267868042, 7.9916229248046875], "mean_td_error": 7.859065532684326, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.465954780578613, "actor_loss": -6.217825412750244, "critic_loss": 5.750209808349609, "alpha_loss": -0.09702091664075851, "alpha_value": 0.9928209781646729, "log_alpha_value": -0.007204904220998287, "target_entropy": -8.0, "policy_t": -0.021474748849868774, "mean_q": 0.8048990964889526, "max_q": 1.396213412284851, "min_q": 0.5040900707244873}, "td_error": [7.17081356048584, 7.807644844055176, 8.292428016662598, 8.342870712280273, 8.284625053405762, 7.523530006408691, 7.374926567077637, 8.613628387451172, 8.1159029006958, 8.316386222839355, 7.871615409851074, 7.506842613220215, 7.6064629554748535, 8.132877349853516, 7.993542194366455, 7.613184928894043, 8.475693702697754, 9.576828002929688, 8.200275421142578, 7.062727928161621, 8.02015209197998, 8.160152435302734, 8.054485321044922, 7.728263854980469, 7.797920227050781, 7.211224555969238, 8.963211059570312, 8.705461502075195, 8.388835906982422, 7.265226364135742, 8.64886474609375, 8.337813377380371, 8.144366264343262, 7.969676971435547, 8.081071853637695, 7.79779052734375, 8.127351760864258, 7.7633867263793945, 8.669984817504883, 9.729768753051758, 8.450233459472656, 7.54425573348999, 8.40080451965332, 7.510981559753418, 7.822938919067383, 8.043907165527344, 7.6153035163879395, 7.876361846923828, 7.795907020568848, 8.485466003417969, 7.353921890258789, 8.018621444702148, 8.156360626220703, 7.823410987854004, 8.455432891845703, 7.791924476623535, 7.731897830963135, 7.722445487976074, 7.39786434173584, 7.0511322021484375, 7.975964069366455, 7.647575378417969, 7.737422943115234, 8.09604263305664, 7.994564056396484, 7.893028259277344, 8.040022850036621, 7.336887359619141, 8.39959716796875, 7.658146858215332, 7.267339706420898, 7.980779647827148, 7.514291763305664, 8.446067810058594, 8.15401554107666, 8.015378952026367, 7.531349182128906, 7.6333513259887695, 8.201742172241211, 7.976118564605713, 7.844482898712158, 8.799266815185547, 7.9683427810668945, 7.920261859893799, 7.434297561645508, 7.812380790710449, 7.762684345245361, 8.83053207397461, 7.667562007904053, 6.9517822265625, 7.601938247680664, 7.424254417419434, 7.48372745513916, 7.583870887756348, 7.709301948547363, 8.290897369384766, 7.862829208374023, 7.4188127517700195, 7.840493202209473, 8.748756408691406, 7.348038673400879, 7.187403678894043, 7.342698574066162, 8.469978332519531, 7.567748069763184, 7.131648540496826, 7.949462890625, 8.13058090209961, 7.836212158203125, 9.186033248901367, 8.152137756347656, 7.44339656829834, 7.171206474304199, 8.120219230651855, 8.519784927368164, 7.754937171936035, 7.370299339294434, 7.473354816436768, 8.010501861572266, 7.914163112640381, 7.651783466339111, 7.8331780433654785, 7.669150352478027, 8.087775230407715, 8.018762588500977, 6.925171375274658, 7.274517059326172, 7.74506139755249], "mean_td_error": 7.908112049102783, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25.0, "diff_num_grad_updates_vs_sampler_policy": 24.0}}, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 6400, "last_target_update_ts": 6400, "num_target_updates": 25}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3837.545118960064, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1931.5067404464137, "robot_1": 1906.0383785136494}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1931.5067404464137, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1906.0383785136494, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7591045833185696, "mean_inference_ms": 3.4006933007142073, "mean_action_processing_ms": 0.46654480198566234, "mean_env_wait_ms": 0.47313984448252894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289283434549968, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1304854949315389}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3837.545118960064, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1931.5067404464137, "robot_1": 1906.0383785136494}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7591045833185696, "mean_inference_ms": 3.4006933007142073, "mean_action_processing_ms": 0.46654480198566234, "mean_env_wait_ms": 0.47313984448252894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289283434549968, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1304854949315389}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 6400, "num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 398.0107547161307, "num_env_steps_trained_throughput_per_sec": 509.45376603664727, "timesteps_total": 6400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 496.68, "sample_time_ms": 278.908, "load_time_ms": 0.511, "load_throughput": 501397.069, "learn_time_ms": 35.051, "learn_throughput": 7303.72, "synch_weights_time_ms": 11.098}, "counters": {"num_env_steps_sampled": 6400, "num_env_steps_trained": 6400, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 6400, "last_target_update_ts": 6400, "num_target_updates": 25}, "done": false, "episodes_total": 12, "training_iteration": 13, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-52", "timestamp": 1742662552, "time_this_iter_s": 1.0229854583740234, "time_total_s": 16.30198073387146, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6CAF70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 16.30198073387146, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 36.9, "ram_util_percent": 92.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1931.5067404464137, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1906.0383785136494, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.453112602233887, "actor_loss": -6.5074944496154785, "critic_loss": 5.587274551391602, "alpha_loss": -0.10905404388904572, "alpha_value": 0.9919265508651733, "log_alpha_value": -0.008106231689453125, "target_entropy": -8.0, "policy_t": 0.01651584729552269, "mean_q": 1.1521328687667847, "max_q": 2.143596649169922, "min_q": 0.7311524152755737}, "td_error": [8.59462833404541, 8.17575740814209, 7.281968116760254, 6.974794387817383, 7.929307460784912, 7.671462059020996, 6.439921855926514, 8.251077651977539, 7.179771423339844, 7.112645149230957, 7.749590873718262, 7.090071678161621, 7.400501251220703, 7.850711822509766, 7.345840930938721, 7.630756855010986, 7.260565280914307, 7.224911689758301, 7.337899208068848, 7.595972537994385, 7.398115158081055, 7.235490798950195, 8.134382247924805, 7.7837605476379395, 7.506829261779785, 8.075823783874512, 8.070898056030273, 7.679779052734375, 7.911124229431152, 7.6110382080078125, 7.739448070526123, 7.458474159240723, 7.982641220092773, 8.284461975097656, 8.232553482055664, 7.625566482543945, 8.312756538391113, 7.759949684143066, 6.80418586730957, 7.514915466308594, 8.142433166503906, 7.741876602172852, 7.850339889526367, 7.241509914398193, 8.043636322021484, 7.006651401519775, 7.197354793548584, 7.539868354797363, 9.00605583190918, 7.795590400695801, 6.899144172668457, 7.870086193084717, 7.895443439483643, 7.799053192138672, 7.434789657592773, 7.378963470458984, 7.559237003326416, 6.89684534072876, 8.008996963500977, 8.153542518615723, 8.047545433044434, 7.549558162689209, 6.965291976928711, 7.479125022888184, 7.105472564697266, 8.610130310058594, 8.011604309082031, 7.146630764007568, 7.179042816162109, 8.000808715820312, 7.268977165222168, 7.88228178024292, 7.275115013122559, 8.4735689163208, 7.920032024383545, 7.390388488769531, 7.4996795654296875, 7.589648723602295, 8.05302619934082, 8.246381759643555, 7.105434417724609, 7.118215560913086, 7.7591705322265625, 7.3249711990356445, 7.228556156158447, 6.971876621246338, 7.3486785888671875, 7.745730400085449, 7.275073051452637, 6.485563278198242, 7.5092668533325195, 8.226333618164062, 7.729556083679199, 7.15914249420166, 8.043242454528809, 7.116776466369629, 7.685884475708008, 7.117123603820801, 7.497148513793945, 8.356761932373047, 8.005693435668945, 8.196099281311035, 7.513283729553223, 6.476273536682129, 7.4888200759887695, 7.980952739715576, 7.334136009216309, 7.352826118469238, 7.636102676391602, 7.311966896057129, 7.925563812255859, 7.143589973449707, 7.028312683105469, 6.402186870574951, 7.688194274902344, 7.399197578430176, 8.210926055908203, 7.191923141479492, 7.838074684143066, 8.154839515686035, 8.22751235961914, 7.879619598388672, 6.91599178314209, 7.8635053634643555, 7.705700874328613, 7.192007064819336, 7.521572589874268, 6.973771572113037], "mean_td_error": 7.591712951660156, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.463951110839844, "actor_loss": -6.4850897789001465, "critic_loss": 5.546194076538086, "alpha_loss": -0.10913825035095215, "alpha_value": 0.9919267892837524, "log_alpha_value": -0.008105958811938763, "target_entropy": -8.0, "policy_t": -0.00602359976619482, "mean_q": 1.086930751800537, "max_q": 1.8574143648147583, "min_q": 0.7064664363861084}, "td_error": [7.7430524826049805, 8.128293991088867, 8.36020278930664, 7.391622543334961, 7.558224678039551, 7.221215724945068, 7.546809196472168, 7.78835391998291, 7.777467727661133, 8.061466217041016, 7.638433456420898, 7.560867786407471, 7.143073081970215, 7.2660322189331055, 8.091423034667969, 7.709725856781006, 7.450856685638428, 6.310834884643555, 7.480420112609863, 7.456501007080078, 7.219114780426025, 8.328553199768066, 7.060877799987793, 7.478105068206787, 8.713687896728516, 7.4228515625, 7.042567729949951, 7.790227890014648, 7.702209949493408, 8.283731460571289, 7.597219467163086, 8.137611389160156, 7.049526214599609, 7.550580978393555, 8.52729606628418, 8.154390335083008, 8.035626411437988, 7.750937461853027, 7.486710071563721, 7.523435115814209, 7.858259201049805, 7.173387050628662, 7.56612491607666, 7.597223281860352, 6.865253448486328, 7.353249549865723, 7.804962158203125, 7.681482315063477, 7.947872638702393, 7.850412845611572, 7.862539291381836, 8.248882293701172, 6.828390598297119, 8.061628341674805, 7.341892242431641, 7.572941780090332, 8.001533508300781, 7.614020347595215, 7.80886173248291, 7.243431091308594, 7.68123722076416, 7.779717445373535, 7.445471286773682, 7.987305641174316, 7.40785551071167, 7.099034309387207, 7.702629566192627, 7.460196495056152, 6.636019706726074, 8.337733268737793, 8.857433319091797, 8.00057315826416, 7.954676628112793, 7.474803924560547, 8.018617630004883, 8.344130516052246, 7.4515380859375, 8.188875198364258, 7.541190147399902, 7.569499969482422, 7.416467189788818, 7.727102279663086, 7.63587760925293, 7.900467872619629, 7.728569030761719, 7.421258449554443, 7.87816858291626, 7.166441917419434, 7.750725269317627, 7.602943420410156, 8.565004348754883, 7.537721157073975, 7.5248870849609375, 8.161319732666016, 7.821540832519531, 7.157065391540527, 7.307760238647461, 7.469212055206299, 7.480729103088379, 7.687406539916992, 8.005651473999023, 6.6897735595703125, 7.158761501312256, 8.631490707397461, 7.334232807159424, 7.25922966003418, 8.51321029663086, 8.013951301574707, 7.183561325073242, 7.470480918884277, 7.245180130004883, 7.596144676208496, 6.995950698852539, 7.989455699920654, 7.936862945556641, 7.100185394287109, 7.6190690994262695, 8.01805591583252, 8.2562837600708, 8.257001876831055, 7.521904945373535, 7.54142951965332, 7.88578462600708, 7.7280144691467285, 7.420408725738525, 7.270671844482422, 7.378597259521484, 7.393237590789795], "mean_td_error": 7.657158851623535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 7000, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 7168, "last_target_update_ts": 7000, "num_target_updates": 28}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3837.545118960064, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1931.5067404464137, "robot_1": 1906.0383785136494}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1931.5067404464137, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1906.0383785136494, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7591045833185696, "mean_inference_ms": 3.4006933007142073, "mean_action_processing_ms": 0.46654480198566234, "mean_env_wait_ms": 0.47313984448252894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289283434549968, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1304854949315389}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3837.545118960064, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1931.5067404464137, "robot_1": 1906.0383785136494}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7591045833185696, "mean_inference_ms": 3.4006933007142073, "mean_action_processing_ms": 0.46654480198566234, "mean_env_wait_ms": 0.47313984448252894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289283434549968, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1304854949315389}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7000, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 409.57706795062256, "num_env_steps_trained_throughput_per_sec": 524.2586469767969, "timesteps_total": 7000, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 492.251, "sample_time_ms": 275.737, "load_time_ms": 0.51, "load_throughput": 501936.156, "learn_time_ms": 34.852, "learn_throughput": 7345.446, "synch_weights_time_ms": 10.603}, "counters": {"num_env_steps_sampled": 7000, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 7168, "last_target_update_ts": 7000, "num_target_updates": 28}, "done": false, "episodes_total": 12, "training_iteration": 14, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-54", "timestamp": 1742662554, "time_this_iter_s": 1.4817090034484863, "time_total_s": 17.783689737319946, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A774F70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 17.783689737319946, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.833333333333332, "ram_util_percent": 92.96666666666665}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1931.5067404464137, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1906.0383785136494, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.519197463989258, "actor_loss": -6.846312999725342, "critic_loss": 5.357887268066406, "alpha_loss": -0.12176701426506042, "alpha_value": 0.9910334944725037, "log_alpha_value": -0.009006969630718231, "target_entropy": -8.0, "policy_t": 0.023182258009910583, "mean_q": 1.4581348896026611, "max_q": 2.7379534244537354, "min_q": 0.8109172582626343}, "td_error": [6.982141971588135, 6.506469249725342, 7.829206466674805, 7.250092506408691, 7.141237258911133, 6.69257926940918, 7.72746467590332, 7.325929641723633, 6.8849992752075195, 7.845454216003418, 7.772698879241943, 7.127854824066162, 6.931580066680908, 7.210648059844971, 6.611147403717041, 6.818338871002197, 6.741519927978516, 7.282416820526123, 7.211725234985352, 6.595573425292969, 7.0369367599487305, 6.947032451629639, 6.7370147705078125, 6.929553985595703, 7.560979843139648, 8.095046043395996, 7.089692115783691, 6.590878486633301, 7.92853307723999, 7.870395183563232, 7.641461372375488, 7.257386684417725, 7.69053316116333, 6.537996292114258, 7.372711181640625, 6.54432487487793, 7.007262229919434, 7.360719680786133, 7.035879611968994, 6.9224653244018555, 7.348958969116211, 7.396755218505859, 7.502164840698242, 7.381213665008545, 6.86598014831543, 7.4326581954956055, 7.256107807159424, 6.93488883972168, 6.862973213195801, 6.985029220581055, 7.98844051361084, 7.351654052734375, 6.4754557609558105, 7.51869010925293, 6.698910713195801, 7.2059173583984375, 7.326796531677246, 6.901904582977295, 7.820761680603027, 7.8565144538879395, 7.074034214019775, 7.654963493347168, 7.406642436981201, 7.09033727645874, 7.027141571044922, 7.0677571296691895, 6.877473831176758, 8.088361740112305, 7.0752058029174805, 7.435688018798828, 6.727027893066406, 7.605580806732178, 6.755015850067139, 7.2268853187561035, 7.703693389892578, 7.082395553588867, 7.383460521697998, 6.969245910644531, 7.2942657470703125, 7.026142120361328, 7.321723937988281, 8.247488975524902, 7.840198040008545, 6.962838172912598, 7.356129169464111, 7.765300273895264, 7.123672962188721, 7.258257865905762, 7.391335487365723, 7.029129981994629, 6.376638889312744, 6.636177062988281, 7.3956451416015625, 7.65425968170166, 7.242164611816406, 6.862853527069092, 7.242859840393066, 6.940669536590576, 7.597452163696289, 6.7807159423828125, 6.449193954467773, 6.987494468688965, 6.947803974151611, 7.95867919921875, 7.942156791687012, 7.515379428863525, 6.889108180999756, 7.28813362121582, 9.981494903564453, 6.616315841674805, 7.676177978515625, 7.576367378234863, 7.881548881530762, 6.91904878616333, 7.996998310089111, 7.001853942871094, 7.546328544616699, 6.985095024108887, 7.289759635925293, 6.641240119934082, 6.508554935455322, 7.121713638305664, 8.127616882324219, 7.835207939147949, 8.353857040405273, 7.705069541931152, 7.588606834411621, 7.4936017990112305], "mean_td_error": 7.267022132873535, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.466902732849121, "actor_loss": -6.663698196411133, "critic_loss": 5.563365936279297, "alpha_loss": -0.1212962418794632, "alpha_value": 0.9910334348678589, "log_alpha_value": -0.009006989188492298, "target_entropy": -8.0, "policy_t": 0.003219040110707283, "mean_q": 1.2757693529129028, "max_q": 2.340369462966919, "min_q": 0.7581831216812134}, "td_error": [7.154325008392334, 7.868637561798096, 7.458314895629883, 7.116309642791748, 7.51584529876709, 6.984709739685059, 7.555108070373535, 7.44218635559082, 7.308655738830566, 7.261480808258057, 7.231786251068115, 8.393709182739258, 7.626384258270264, 7.082184791564941, 7.218381404876709, 8.048436164855957, 6.821290016174316, 7.2137131690979, 7.772763252258301, 6.988777160644531, 8.097475051879883, 6.410325527191162, 7.308774948120117, 7.450566291809082, 7.960865497589111, 7.749538421630859, 6.994531631469727, 7.619222640991211, 7.561994552612305, 7.4165544509887695, 6.505560874938965, 7.052493095397949, 7.430561542510986, 7.199385643005371, 7.997220993041992, 7.608290672302246, 7.079039096832275, 8.560361862182617, 7.471588134765625, 7.760334014892578, 7.228816986083984, 7.6246771812438965, 7.174015045166016, 7.321362018585205, 6.9108171463012695, 7.819950580596924, 7.495816230773926, 7.845032691955566, 7.537005424499512, 6.936336517333984, 6.054135322570801, 6.854056358337402, 7.437148094177246, 7.416508674621582, 7.266691207885742, 6.646309852600098, 7.49708890914917, 8.306772232055664, 7.6745195388793945, 6.489137172698975, 7.349661827087402, 7.482305526733398, 7.124024868011475, 7.353909492492676, 7.729211807250977, 8.54453182220459, 7.122622489929199, 7.543344497680664, 7.743470191955566, 7.699706077575684, 8.192657470703125, 7.665190696716309, 7.122778415679932, 7.1969313621521, 6.524386405944824, 7.418850421905518, 7.139193534851074, 7.991234302520752, 7.2197065353393555, 7.556963920593262, 8.142950057983398, 6.899593353271484, 6.688986778259277, 6.805264472961426, 7.623204708099365, 6.870417594909668, 8.578535079956055, 7.436086654663086, 7.069602966308594, 7.465458869934082, 6.777109622955322, 7.269856929779053, 7.5107927322387695, 7.281804084777832, 6.750614166259766, 6.744593620300293, 6.886516094207764, 7.580460071563721, 7.944296836853027, 8.279359817504883, 6.391468524932861, 7.765962600708008, 7.593596458435059, 7.908382892608643, 7.2523722648620605, 7.299362659454346, 6.960147857666016, 6.632740020751953, 8.161301612854004, 7.262526035308838, 7.128396987915039, 8.457301139831543, 7.551981449127197, 8.102572441101074, 6.548098564147949, 7.947225570678711, 7.545177459716797, 7.307587146759033, 8.285378456115723, 7.231222152709961, 6.993049144744873, 7.583749771118164, 7.152107238769531, 7.1597208976745605, 7.374939441680908, 7.213955879211426, 7.245410919189453, 7.34047269821167], "mean_td_error": 7.394970893859863, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 7600, "num_env_steps_trained": 7936, "num_agent_steps_sampled": 15200, "num_agent_steps_trained": 7936, "last_target_update_ts": 7600, "num_target_updates": 31}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3837.545118960064, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1931.5067404464137, "robot_1": 1906.0383785136494}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1931.5067404464137, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1906.0383785136494, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7591045833185696, "mean_inference_ms": 3.4006933007142073, "mean_action_processing_ms": 0.46654480198566234, "mean_env_wait_ms": 0.47313984448252894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289283434549968, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1304854949315389}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3837.545118960064, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1931.5067404464137, "robot_1": 1906.0383785136494}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7591045833185696, "mean_inference_ms": 3.4006933007142073, "mean_action_processing_ms": 0.46654480198566234, "mean_env_wait_ms": 0.47313984448252894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006289283434549968, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.1304854949315389}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15200, "num_agent_steps_trained": 7936, "num_env_steps_sampled": 7600, "num_env_steps_trained": 7936, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 398.8877474857739, "num_env_steps_trained_throughput_per_sec": 510.5763167817906, "timesteps_total": 7600, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 15200, "timers": {"training_iteration_time_ms": 495.79, "sample_time_ms": 280.208, "load_time_ms": 0.305, "load_throughput": 840699.831, "learn_time_ms": 35.06, "learn_throughput": 7301.684, "synch_weights_time_ms": 10.798}, "counters": {"num_env_steps_sampled": 7600, "num_env_steps_trained": 7936, "num_agent_steps_sampled": 15200, "num_agent_steps_trained": 7936, "last_target_update_ts": 7600, "num_target_updates": 31}, "done": false, "episodes_total": 12, "training_iteration": 15, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-55", "timestamp": 1742662555, "time_this_iter_s": 1.5196778774261475, "time_total_s": 19.303367614746094, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7744C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 19.303367614746094, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.4, "ram_util_percent": 93.15}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1915.2303434470934, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1897.562771667, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.483736991882324, "actor_loss": -7.1599016189575195, "critic_loss": 4.682498931884766, "alpha_loss": -0.13359461724758148, "alpha_value": 0.9901410937309265, "log_alpha_value": -0.009907831437885761, "target_entropy": -8.0, "policy_t": 0.0030415623914450407, "mean_q": 1.8330260515213013, "max_q": 3.33691143989563, "min_q": 0.9389706254005432}, "td_error": [6.552706718444824, 6.644162178039551, 7.20239782333374, 5.828036308288574, 7.559159278869629, 7.828813552856445, 7.575429916381836, 6.702762603759766, 6.477102279663086, 7.044256210327148, 6.634672164916992, 7.050867080688477, 7.1056413650512695, 7.002310752868652, 6.2818145751953125, 7.564925193786621, 7.361736297607422, 6.5438432693481445, 6.809894561767578, 7.314697265625, 7.697162628173828, 7.628881454467773, 7.0640974044799805, 6.809987545013428, 6.496617794036865, 6.752126693725586, 7.141916275024414, 6.714113235473633, 6.375988483428955, 6.318406581878662, 7.601556777954102, 7.564922332763672, 9.134737014770508, 6.403624057769775, 6.521862030029297, 7.236689567565918, 6.532683849334717, 7.443154335021973, 6.488598346710205, 6.382864475250244, 6.784735679626465, 5.678753852844238, 7.510207176208496, 6.645743370056152, 6.681335926055908, 7.70670223236084, 6.13361120223999, 7.178510665893555, 6.2991228103637695, 6.577333450317383, 6.134418487548828, 6.9423017501831055, 7.452116966247559, 7.106748580932617, 8.03170394897461, 6.679096221923828, 7.090080261230469, 7.09000301361084, 6.638317108154297, 6.356758117675781, 7.458592414855957, 7.341161251068115, 7.285360813140869, 5.6472978591918945, 6.731972694396973, 6.892116546630859, 6.7537078857421875, 9.007081985473633, 6.694149494171143, 7.890568256378174, 6.859461784362793, 6.847230911254883, 6.721040725708008, 6.996480464935303, 6.527469158172607, 6.469643592834473, 5.988178253173828, 7.737287998199463, 7.2950029373168945, 6.57802677154541, 6.510387420654297, 6.593122959136963, 6.854342460632324, 5.749444961547852, 6.899148941040039, 6.504734992980957, 6.244625091552734, 7.118434906005859, 6.776593208312988, 6.540424346923828, 6.688293933868408, 7.106707572937012, 6.691025733947754, 6.018372535705566, 6.306463241577148, 7.069994926452637, 7.1261491775512695, 6.585630893707275, 6.840127944946289, 6.697132110595703, 6.540753364562988, 5.944328308105469, 6.4614667892456055, 6.613971710205078, 6.830358505249023, 6.345916748046875, 6.253116130828857, 6.713367462158203, 6.966800212860107, 7.015626907348633, 7.493612289428711, 7.382960319519043, 6.789238929748535, 6.619548797607422, 6.8434343338012695, 6.4070210456848145, 6.9377288818359375, 6.511138916015625, 6.702635288238525, 6.827765941619873, 6.5082316398620605, 6.243144512176514, 6.372511386871338, 7.069143772125244, 6.979559898376465, 6.96244478225708, 7.6068878173828125, 7.303213119506836], "mean_td_error": 6.859388828277588, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.429041862487793, "actor_loss": -6.991305828094482, "critic_loss": 5.1904377937316895, "alpha_loss": -0.13305425643920898, "alpha_value": 0.990140974521637, "log_alpha_value": -0.009907947853207588, "target_entropy": -8.0, "policy_t": 0.01872505433857441, "mean_q": 1.6378456354141235, "max_q": 2.7834537029266357, "min_q": 1.1546396017074585}, "td_error": [6.475926399230957, 6.941324234008789, 7.095977306365967, 6.8943352699279785, 6.848075866699219, 6.766149520874023, 6.332505702972412, 7.569176197052002, 6.575596332550049, 7.018078327178955, 6.678456783294678, 6.536072731018066, 7.88713264465332, 6.601161956787109, 6.422756195068359, 7.1274094581604, 7.081555366516113, 7.414600372314453, 6.578393936157227, 6.385113716125488, 7.34165620803833, 5.937865257263184, 6.658875465393066, 6.730390548706055, 6.573983192443848, 6.452617645263672, 6.833197593688965, 6.681636810302734, 5.564272880554199, 6.712993621826172, 7.934882640838623, 6.266410827636719, 7.551724433898926, 6.630009651184082, 7.293525695800781, 6.848598480224609, 6.707664966583252, 7.1914215087890625, 6.96146297454834, 7.10122013092041, 7.24646520614624, 6.908356189727783, 7.298384189605713, 7.234500885009766, 7.760891437530518, 7.368006706237793, 7.053872108459473, 6.554591178894043, 5.964154243469238, 6.850217819213867, 7.074704647064209, 7.211896896362305, 6.852999210357666, 6.728302955627441, 6.736202239990234, 7.074005126953125, 7.4728875160217285, 7.36163330078125, 6.367887496948242, 6.606218338012695, 6.72252082824707, 7.380522727966309, 7.457724571228027, 7.185521602630615, 7.643666744232178, 6.236936092376709, 7.216423034667969, 6.960716247558594, 6.927718162536621, 7.2293853759765625, 5.749663352966309, 7.292813777923584, 6.7834320068359375, 6.583901405334473, 7.176202774047852, 8.411153793334961, 7.038690567016602, 7.028051376342773, 7.124929428100586, 7.145698070526123, 5.79049015045166, 7.647374153137207, 6.661181449890137, 6.589418411254883, 6.988794326782227, 5.932641983032227, 8.713165283203125, 6.986392021179199, 6.211941719055176, 7.130627632141113, 6.704318046569824, 6.84975004196167, 7.008425235748291, 7.6402788162231445, 6.331863880157471, 7.708770751953125, 6.670495986938477, 6.665349960327148, 7.023212432861328, 7.091020584106445, 6.466531753540039, 6.749677658081055, 7.24209451675415, 6.832819938659668, 7.1448774337768555, 6.951348304748535, 7.371763229370117, 6.717790603637695, 6.927674293518066, 8.21920108795166, 6.861509323120117, 6.896051406860352, 6.837760925292969, 8.027392387390137, 7.154911518096924, 7.285508155822754, 7.195772171020508, 6.888921737670898, 7.408350944519043, 6.285800933837891, 7.015296936035156, 6.734370231628418, 6.596024036407471, 7.108842849731445, 6.81296968460083, 6.443957328796387, 7.434998035430908, 6.691173076629639], "mean_td_error": 6.9443359375, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 33.0}}, "num_env_steps_sampled": 8200, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 16400, "num_agent_steps_trained": 8704, "last_target_update_ts": 8200, "num_target_updates": 34}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3812.7931151140933, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1915.2303434470934, "robot_1": 1897.562771667}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1915.2303434470934, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1897.562771667, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7561174209757778, "mean_inference_ms": 3.393423803877578, "mean_action_processing_ms": 0.4656492044042698, "mean_env_wait_ms": 0.4696092924102925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007871538400650024, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15442892909049988}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3812.7931151140933, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1915.2303434470934, "robot_1": 1897.562771667}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7561174209757778, "mean_inference_ms": 3.393423803877578, "mean_action_processing_ms": 0.4656492044042698, "mean_env_wait_ms": 0.4696092924102925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007871538400650024, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15442892909049988}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16400, "num_agent_steps_trained": 8704, "num_env_steps_sampled": 8200, "num_env_steps_trained": 8704, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 404.6755256589491, "num_env_steps_trained_throughput_per_sec": 517.9846728434547, "timesteps_total": 8200, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 16400, "timers": {"training_iteration_time_ms": 495.301, "sample_time_ms": 280.706, "load_time_ms": 0.303, "load_throughput": 845199.798, "learn_time_ms": 34.845, "learn_throughput": 7346.838, "synch_weights_time_ms": 10.879}, "counters": {"num_env_steps_sampled": 8200, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 16400, "num_agent_steps_trained": 8704, "last_target_update_ts": 8200, "num_target_updates": 34}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-57", "timestamp": 1742662557, "time_this_iter_s": 1.500321626663208, "time_total_s": 20.8036892414093, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7378B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 20.8036892414093, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.75, "ram_util_percent": 93.25}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1915.2303434470934, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1897.562771667, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.466294288635254, "actor_loss": -7.548805236816406, "critic_loss": 4.767708778381348, "alpha_loss": -0.14555108547210693, "alpha_value": 0.9892496466636658, "log_alpha_value": -0.010808548890054226, "target_entropy": -8.0, "policy_t": 0.02023119293153286, "mean_q": 2.2733066082000732, "max_q": 3.9900496006011963, "min_q": 1.3939967155456543}, "td_error": [7.406118392944336, 7.248212814331055, 6.086465358734131, 6.708885192871094, 6.303195476531982, 7.322451114654541, 6.724758625030518, 6.423003196716309, 7.433009624481201, 7.033751487731934, 6.306057929992676, 5.923492908477783, 6.998048782348633, 6.028757572174072, 5.540913105010986, 6.7040300369262695, 6.246323585510254, 6.807490348815918, 6.306014060974121, 5.8140645027160645, 5.419635772705078, 5.946849822998047, 7.81242036819458, 5.933041095733643, 5.776352405548096, 5.86222505569458, 6.709688186645508, 7.042336940765381, 6.361242294311523, 6.461451530456543, 6.278731346130371, 7.020810127258301, 5.973795413970947, 5.971959114074707, 6.7749247550964355, 5.633370876312256, 6.295478820800781, 6.824796199798584, 7.249555587768555, 5.89052677154541, 6.1907453536987305, 6.215910911560059, 5.820942401885986, 6.706664085388184, 7.711610794067383, 5.822012424468994, 6.271267890930176, 6.630407333374023, 5.962882995605469, 5.985193252563477, 5.915224075317383, 7.407648086547852, 5.796354293823242, 7.07037878036499, 6.109816551208496, 7.207913875579834, 6.597659111022949, 6.829595565795898, 6.180133819580078, 6.342273712158203, 6.815479278564453, 7.0223236083984375, 6.811687469482422, 6.217845916748047, 7.7179155349731445, 6.054282188415527, 7.359984397888184, 7.690911293029785, 7.277641296386719, 7.054051399230957, 6.714588642120361, 6.4826812744140625, 6.504826545715332, 6.519425392150879, 6.276132106781006, 6.636823654174805, 6.641570091247559, 6.84135627746582, 6.540619850158691, 6.165675640106201, 6.026159286499023, 6.350915431976318, 5.934406757354736, 7.003589630126953, 6.057896137237549, 5.7456583976745605, 5.5046796798706055, 7.239114761352539, 7.131477355957031, 5.857094764709473, 6.841472625732422, 6.180660247802734, 5.975441932678223, 7.015043258666992, 7.295931339263916, 6.675127983093262, 5.473690509796143, 6.3042449951171875, 6.658600330352783, 6.223231792449951, 6.100070953369141, 5.998249530792236, 5.89334774017334, 6.193736553192139, 7.303511142730713, 6.050139427185059, 6.9733991622924805, 5.933572292327881, 6.408077239990234, 7.307293891906738, 6.906428337097168, 7.334600448608398, 7.174566268920898, 6.520598888397217, 6.804943561553955, 6.027297496795654, 6.4519548416137695, 6.811341285705566, 5.543561935424805, 6.320882797241211, 5.678882122039795, 5.514183044433594, 6.860531330108643, 6.996459484100342, 5.84269905090332, 6.175113677978516, 6.066745758056641, 6.71190881729126], "mean_td_error": 6.48533821105957, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.500361442565918, "actor_loss": -7.496799468994141, "critic_loss": 4.774116516113281, "alpha_loss": -0.145920529961586, "alpha_value": 0.989249587059021, "log_alpha_value": -0.010808638297021389, "target_entropy": -8.0, "policy_t": 0.018964678049087524, "mean_q": 2.072620391845703, "max_q": 3.697033643722534, "min_q": 1.2014890909194946}, "td_error": [6.030769348144531, 6.662714958190918, 6.540987014770508, 5.9923095703125, 5.520472526550293, 6.629465103149414, 6.453271389007568, 6.075071334838867, 7.267168998718262, 5.885727405548096, 6.705397605895996, 7.854007244110107, 6.005255699157715, 6.428452014923096, 6.520936965942383, 5.852555274963379, 5.580294609069824, 6.660646438598633, 6.205087184906006, 6.261706352233887, 5.770301342010498, 6.956604480743408, 7.340588569641113, 6.184665203094482, 6.872459888458252, 6.693035125732422, 6.846661567687988, 6.573563575744629, 6.536863327026367, 6.871595859527588, 6.559833526611328, 6.998085021972656, 6.295445442199707, 6.861794948577881, 6.807772159576416, 6.233380317687988, 8.434551239013672, 6.175461292266846, 7.618716239929199, 6.7215776443481445, 6.692096710205078, 7.661867141723633, 7.1393818855285645, 7.010438442230225, 6.029054164886475, 6.538942337036133, 6.106479644775391, 6.347311496734619, 7.405909538269043, 5.628849029541016, 6.536554336547852, 6.939859867095947, 6.590895652770996, 6.389307022094727, 6.5100579261779785, 6.823492050170898, 8.103296279907227, 6.394404888153076, 8.052978515625, 6.438589096069336, 5.921070098876953, 5.951704502105713, 6.959959030151367, 6.6467437744140625, 5.676083564758301, 6.215685844421387, 6.463432788848877, 5.51662015914917, 6.560170650482178, 6.300351142883301, 6.174610137939453, 7.0294318199157715, 6.280203342437744, 5.769471168518066, 6.554615020751953, 6.756248474121094, 6.080347061157227, 6.993930816650391, 6.487420082092285, 7.088501930236816, 6.785460948944092, 6.406842231750488, 6.471325397491455, 6.2573981285095215, 6.776043891906738, 7.23828125, 6.170222759246826, 5.904840469360352, 7.464895248413086, 6.337797164916992, 6.2169599533081055, 5.805643558502197, 7.0565385818481445, 6.239171981811523, 6.177852630615234, 7.265423774719238, 5.4382781982421875, 6.397862434387207, 6.9757609367370605, 6.867351055145264, 6.195330619812012, 6.8060221672058105, 6.587888717651367, 5.952967643737793, 5.931587219238281, 7.248246669769287, 6.262571334838867, 5.8800368309021, 6.036076068878174, 7.15241003036499, 6.1218485832214355, 6.460748672485352, 6.678472995758057, 6.709073066711426, 5.703701019287109, 5.904415130615234, 6.492912292480469, 6.213189125061035, 6.564455986022949, 6.660302639007568, 6.533616065979004, 6.045350551605225, 6.093195915222168, 7.428511619567871, 6.798601150512695, 6.571381568908691, 6.538880348205566, 7.462345123291016], "mean_td_error": 6.535466194152832, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 36.0}}, "num_env_steps_sampled": 8800, "num_env_steps_trained": 9472, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 9472, "last_target_update_ts": 8800, "num_target_updates": 37}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3812.7931151140933, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1915.2303434470934, "robot_1": 1897.562771667}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1915.2303434470934, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1897.562771667, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7561174209757778, "mean_inference_ms": 3.393423803877578, "mean_action_processing_ms": 0.4656492044042698, "mean_env_wait_ms": 0.4696092924102925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007871538400650024, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15442892909049988}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3812.7931151140933, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1915.2303434470934, "robot_1": 1897.562771667}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7561174209757778, "mean_inference_ms": 3.393423803877578, "mean_action_processing_ms": 0.4656492044042698, "mean_env_wait_ms": 0.4696092924102925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007871538400650024, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15442892909049988}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 9472, "num_env_steps_sampled": 8800, "num_env_steps_trained": 9472, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 416.0622375000248, "num_env_steps_trained_throughput_per_sec": 532.5596640000317, "timesteps_total": 8800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 17600, "timers": {"training_iteration_time_ms": 492.893, "sample_time_ms": 278.265, "load_time_ms": 0.101, "load_throughput": 2529427.147, "learn_time_ms": 34.996, "learn_throughput": 7315.1, "synch_weights_time_ms": 10.913}, "counters": {"num_env_steps_sampled": 8800, "num_env_steps_trained": 9472, "num_agent_steps_sampled": 17600, "num_agent_steps_trained": 9472, "last_target_update_ts": 8800, "num_target_updates": 37}, "done": false, "episodes_total": 16, "training_iteration": 17, "trial_id": "66c5b_00000", "date": "2025-03-22_16-55-58", "timestamp": 1742662558, "time_this_iter_s": 1.4591929912567139, "time_total_s": 22.262882232666016, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A737820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 22.262882232666016, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 34.6, "ram_util_percent": 93.35}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1915.2303434470934, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1897.562771667, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.445402145385742, "actor_loss": -8.05907154083252, "critic_loss": 4.266143798828125, "alpha_loss": -0.15743488073349, "alpha_value": 0.9883590936660767, "log_alpha_value": -0.011709198355674744, "target_entropy": -8.0, "policy_t": -0.004242058377712965, "mean_q": 2.8647711277008057, "max_q": 5.247848033905029, "min_q": 1.6470272541046143}, "td_error": [4.722927093505859, 6.375808238983154, 5.936200141906738, 5.677722454071045, 6.447292804718018, 5.187316417694092, 5.81796932220459, 5.804287910461426, 6.964208602905273, 5.419894695281982, 5.553637504577637, 5.031611919403076, 6.1603498458862305, 5.755745887756348, 5.619809627532959, 5.857072353363037, 5.616926193237305, 5.188733100891113, 6.855860233306885, 6.146349906921387, 5.971247673034668, 6.240809440612793, 6.35023832321167, 6.8695149421691895, 5.561805725097656, 5.7888288497924805, 6.713102340698242, 5.521947383880615, 5.869969844818115, 4.941553115844727, 5.672115325927734, 7.6026129722595215, 6.242845058441162, 5.182589530944824, 5.326253890991211, 6.321866989135742, 6.502574920654297, 5.949376106262207, 6.249848365783691, 5.551723957061768, 4.743954181671143, 6.097687244415283, 5.391493797302246, 5.855937957763672, 5.125292778015137, 5.538651943206787, 5.316592216491699, 6.2628560066223145, 5.536744117736816, 6.418976783752441, 5.8357133865356445, 6.4553422927856445, 5.5811967849731445, 5.759329795837402, 6.0284857749938965, 5.89306640625, 5.224549293518066, 6.532337188720703, 5.0460076332092285, 6.535829067230225, 7.057119369506836, 5.581751823425293, 4.599090576171875, 5.777679920196533, 6.237823009490967, 5.237529754638672, 5.188222885131836, 4.930247783660889, 6.0081071853637695, 6.197347640991211, 5.976301193237305, 4.701351642608643, 6.893899917602539, 5.032139301300049, 6.546536445617676, 6.034146785736084, 4.949436187744141, 5.806313514709473, 6.108685493469238, 5.847196578979492, 5.554346084594727, 5.755435466766357, 5.31672477722168, 5.468829154968262, 6.540438175201416, 5.372614860534668, 6.203603267669678, 5.272061347961426, 5.930196762084961, 6.59521484375, 4.729597091674805, 6.132349967956543, 6.761284351348877, 5.83687686920166, 6.643599510192871, 5.484503746032715, 6.5992841720581055, 5.6656999588012695, 6.195287704467773, 5.720085620880127, 6.647902011871338, 5.93547248840332, 5.467183589935303, 6.36612606048584, 6.090742588043213, 6.803711891174316, 5.768033027648926, 6.843537330627441, 5.59057092666626, 6.043677806854248, 5.22322416305542, 6.246196746826172, 6.422809600830078, 4.905399322509766, 6.200392723083496, 6.116097927093506, 4.930566787719727, 6.5425848960876465, 5.818951606750488, 4.211179733276367, 4.843710899353027, 4.891993522644043, 5.3151140213012695, 5.352116584777832, 5.682626724243164, 6.252270221710205, 5.768885135650635, 6.214566230773926], "mean_td_error": 5.833868980407715, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.44968032836914, "actor_loss": -7.996970176696777, "critic_loss": 4.333035469055176, "alpha_loss": -0.15748804807662964, "alpha_value": 0.9883588552474976, "log_alpha_value": -0.01170942559838295, "target_entropy": -8.0, "policy_t": -0.003165478352457285, "mean_q": 2.653782844543457, "max_q": 4.541627407073975, "min_q": 1.8275481462478638}, "td_error": [5.4523468017578125, 5.693988800048828, 5.449285507202148, 7.538264274597168, 5.291712284088135, 6.7881927490234375, 6.436936378479004, 6.187003135681152, 5.881190299987793, 7.126406669616699, 5.776669502258301, 7.133737564086914, 5.389249324798584, 6.1030378341674805, 5.548776626586914, 6.2052788734436035, 5.847704887390137, 6.786543846130371, 6.071232795715332, 6.341780185699463, 6.608362197875977, 6.4606194496154785, 5.861286163330078, 6.600988388061523, 4.180060386657715, 6.734105110168457, 4.834929943084717, 6.310467720031738, 6.727425575256348, 5.471462249755859, 6.173792839050293, 6.143540382385254, 6.645404815673828, 7.154592514038086, 4.911980152130127, 6.139161109924316, 5.757225513458252, 7.151853561401367, 6.334662914276123, 5.963674545288086, 4.680901527404785, 6.317987442016602, 6.161118507385254, 5.604726314544678, 5.969400405883789, 5.524038314819336, 5.558917045593262, 5.341660976409912, 5.171565055847168, 6.663703441619873, 4.948481559753418, 7.15332555770874, 6.399866104125977, 5.969825267791748, 5.627871036529541, 5.585840702056885, 5.452570915222168, 5.634061813354492, 6.082032203674316, 7.015647888183594, 6.345519065856934, 5.641743183135986, 6.118449687957764, 5.516812324523926, 4.7686920166015625, 6.737401962280273, 5.416146278381348, 6.214042663574219, 4.603102207183838, 5.852907657623291, 6.146798610687256, 6.08834171295166, 7.5604352951049805, 5.908489227294922, 6.781876564025879, 4.606048107147217, 6.333884239196777, 4.45957088470459, 5.4963507652282715, 6.7669830322265625, 6.419538974761963, 5.636909484863281, 7.072250843048096, 6.527709484100342, 6.705470085144043, 4.991298675537109, 4.768238067626953, 5.840555667877197, 5.553205490112305, 6.724392890930176, 5.79613733291626, 6.1161699295043945, 6.269737243652344, 5.906370639801025, 6.226351737976074, 5.407221794128418, 5.429759502410889, 5.773061752319336, 6.442572593688965, 5.846381187438965, 5.069413661956787, 5.774977207183838, 5.421959400177002, 6.416933536529541, 5.7350382804870605, 5.379421710968018, 6.441068172454834, 5.223362922668457, 6.22853946685791, 5.553929328918457, 5.990345001220703, 6.601698875427246, 6.431334018707275, 6.240163803100586, 6.4293742179870605, 5.861010551452637, 6.042964935302734, 5.681606292724609, 4.882755279541016, 6.477867603302002, 6.455717086791992, 5.280272960662842, 6.310921669006348, 5.089931488037109, 6.006590366363525, 7.302831649780273, 6.022859573364258, 5.822834491729736], "mean_td_error": 5.977118015289307, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40.0, "diff_num_grad_updates_vs_sampler_policy": 39.0}}, "num_env_steps_sampled": 9400, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 18800, "num_agent_steps_trained": 10240, "last_target_update_ts": 9400, "num_target_updates": 40}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3812.7931151140933, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1915.2303434470934, "robot_1": 1897.562771667}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1915.2303434470934, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1897.562771667, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7561174209757778, "mean_inference_ms": 3.393423803877578, "mean_action_processing_ms": 0.4656492044042698, "mean_env_wait_ms": 0.4696092924102925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007871538400650024, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15442892909049988}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3812.7931151140933, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1915.2303434470934, "robot_1": 1897.562771667}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7561174209757778, "mean_inference_ms": 3.393423803877578, "mean_action_processing_ms": 0.4656492044042698, "mean_env_wait_ms": 0.4696092924102925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007871538400650024, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15442892909049988}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18800, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 9400, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 410.62093838782755, "num_env_steps_trained_throughput_per_sec": 525.5948011364193, "timesteps_total": 9400, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 18800, "timers": {"training_iteration_time_ms": 489.332, "sample_time_ms": 273.457, "load_time_ms": 0.411, "load_throughput": 623145.391, "learn_time_ms": 33.774, "learn_throughput": 7579.871, "synch_weights_time_ms": 10.99}, "counters": {"num_env_steps_sampled": 9400, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 18800, "num_agent_steps_trained": 10240, "last_target_update_ts": 9400, "num_target_updates": 40}, "done": false, "episodes_total": 16, "training_iteration": 18, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-00", "timestamp": 1742662560, "time_this_iter_s": 1.4771809577941895, "time_total_s": 23.740063190460205, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A774670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 23.740063190460205, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.15, "ram_util_percent": 93.4}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1915.2303434470934, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1897.562771667, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.409262657165527, "actor_loss": -8.492088317871094, "critic_loss": 3.801164150238037, "alpha_loss": -0.16506226360797882, "alpha_value": 0.987765908241272, "log_alpha_value": -0.012309571728110313, "target_entropy": -8.0, "policy_t": -0.01775759644806385, "mean_q": 3.2782504558563232, "max_q": 5.848020553588867, "min_q": 1.7094169855117798}, "td_error": [6.039402484893799, 5.35939359664917, 5.598468780517578, 5.486634254455566, 4.751224994659424, 6.160153388977051, 6.593095779418945, 3.531001091003418, 4.517837047576904, 5.783039093017578, 7.073038578033447, 5.612787246704102, 4.9855852127075195, 5.366257667541504, 5.8413310050964355, 5.390711784362793, 5.080700874328613, 6.517087459564209, 6.516486167907715, 5.646277904510498, 4.76017951965332, 5.106540679931641, 6.246535301208496, 5.804467678070068, 5.268113613128662, 5.126648902893066, 5.344171524047852, 5.858452796936035, 5.908982276916504, 5.628463268280029, 4.97128963470459, 4.80300235748291, 6.026580810546875, 4.944095611572266, 5.592791557312012, 4.829202175140381, 4.2922682762146, 4.818289756774902, 4.832845211029053, 6.436134338378906, 4.4441986083984375, 6.092357158660889, 5.277690410614014, 6.872520446777344, 4.943884372711182, 6.156580924987793, 5.393694877624512, 5.12931489944458, 5.788905620574951, 6.569669723510742, 5.570232391357422, 4.34256649017334, 5.827058792114258, 4.951566219329834, 5.463030815124512, 5.633421897888184, 5.85565185546875, 4.390475749969482, 4.9643449783325195, 4.410103797912598, 5.417109966278076, 5.645564079284668, 6.202430725097656, 5.3097405433654785, 5.631649017333984, 5.338223457336426, 5.596216201782227, 5.180712699890137, 5.047493934631348, 5.761785984039307, 4.721301078796387, 3.9970388412475586, 5.874788284301758, 5.319782257080078, 4.543951034545898, 5.901537895202637, 6.6921467781066895, 5.156139373779297, 6.079115867614746, 5.624242782592773, 5.54539680480957, 5.276449680328369, 5.262275695800781, 5.4753499031066895, 5.1663689613342285, 6.253406047821045, 4.014217853546143, 6.055362701416016, 6.6689558029174805, 6.100728511810303, 5.640243053436279, 5.913015365600586, 4.602011680603027, 5.404855251312256, 6.013881683349609, 5.534083366394043, 5.921104907989502, 5.665979385375977, 6.864170551300049, 4.674012184143066, 5.914595603942871, 5.212556838989258, 4.535552501678467, 5.285694599151611, 4.883681297302246, 5.354572772979736, 4.690338134765625, 6.838137626647949, 5.767775535583496, 5.28774356842041, 6.82850456237793, 6.149533271789551, 4.155829429626465, 4.891014099121094, 4.789023399353027, 5.436795234680176, 4.739121913909912, 4.163747787475586, 5.394357681274414, 5.634746551513672, 4.125598907470703, 5.497672080993652, 4.402667999267578, 4.233792304992676, 6.066493988037109, 4.870224952697754, 5.643947601318359, 5.0675225257873535], "mean_td_error": 5.417819976806641, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.490055084228516, "actor_loss": -8.324850082397461, "critic_loss": 4.009462356567383, "alpha_loss": -0.16606184840202332, "alpha_value": 0.9877654910087585, "log_alpha_value": -0.012309946119785309, "target_entropy": -8.0, "policy_t": -0.0015609399415552616, "mean_q": 2.9722607135772705, "max_q": 5.240304946899414, "min_q": 1.8871049880981445}, "td_error": [5.910922050476074, 5.823063373565674, 5.05037260055542, 4.623437881469727, 6.057645797729492, 5.755287170410156, 7.578778266906738, 6.766623497009277, 5.267876625061035, 5.852275848388672, 4.854311943054199, 5.673724174499512, 5.395258903503418, 5.678476333618164, 5.712636947631836, 5.527017593383789, 5.41838264465332, 4.762355804443359, 5.870304584503174, 5.764501571655273, 6.032596588134766, 5.020877838134766, 5.586021423339844, 5.911238193511963, 5.600988388061523, 5.777044296264648, 5.275243759155273, 5.054071426391602, 5.184539794921875, 5.907041072845459, 6.114905834197998, 4.195998191833496, 5.483436584472656, 6.173634052276611, 6.054388999938965, 5.331697940826416, 4.905898094177246, 5.337743759155273, 7.004651069641113, 4.532918930053711, 4.874643802642822, 5.180215835571289, 5.97456169128418, 6.597613334655762, 4.752619743347168, 5.5279741287231445, 5.980417251586914, 5.8228631019592285, 6.080425262451172, 6.524540901184082, 5.156129837036133, 5.975573539733887, 7.508000373840332, 6.0998406410217285, 4.614025115966797, 4.805986404418945, 6.000041961669922, 6.564404487609863, 5.345232009887695, 6.108403205871582, 6.091818809509277, 5.501213073730469, 6.22200870513916, 5.463711738586426, 6.113871097564697, 5.503963470458984, 5.864831447601318, 5.385505199432373, 4.766220569610596, 5.909368515014648, 5.5308637619018555, 5.182275772094727, 4.395107269287109, 5.2934770584106445, 5.68429708480835, 6.242314338684082, 5.2907395362854, 4.769511699676514, 4.729300022125244, 4.901318073272705, 6.629109859466553, 5.12763786315918, 4.947075843811035, 5.635867118835449, 4.434413433074951, 5.37240743637085, 4.670580863952637, 6.402963638305664, 6.712069511413574, 5.666033744812012, 6.306674003601074, 5.336492538452148, 6.600615501403809, 5.143834590911865, 6.771284103393555, 5.362743854522705, 4.8400092124938965, 5.673122882843018, 5.107427597045898, 7.188578128814697, 5.774601936340332, 5.315063953399658, 7.130419731140137, 6.156010150909424, 5.963788986206055, 5.022421836853027, 5.688353538513184, 5.5234832763671875, 5.842167854309082, 5.767691135406494, 5.2593607902526855, 6.061855792999268, 6.744693756103516, 5.355628967285156, 5.354471206665039, 6.039077281951904, 3.9184999465942383, 5.339145660400391, 5.317034721374512, 5.6458635330200195, 5.981477737426758, 6.875916481018066, 4.950692176818848, 4.795655250549316, 6.736719608306885, 6.590765476226807, 6.069916248321533, 5.862813472747803], "mean_td_error": 5.649811744689941, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42.0, "diff_num_grad_updates_vs_sampler_policy": 41.0}}, "num_env_steps_sampled": 9800, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 19600, "num_agent_steps_trained": 10752, "last_target_update_ts": 9800, "num_target_updates": 42}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3812.7931151140933, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1915.2303434470934, "robot_1": 1897.562771667}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1915.2303434470934, "('robot_0', 'robot_0')_total_reward_min": 1756.9013879231488, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1897.562771667, "('robot_1', 'robot_1')_total_reward_min": 1743.730382601533, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7561174209757778, "mean_inference_ms": 3.393423803877578, "mean_action_processing_ms": 0.4656492044042698, "mean_env_wait_ms": 0.4696092924102925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007871538400650024, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15442892909049988}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3500.631770524681, "episode_reward_mean": 3812.7931151140933, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1756.9013879231488, "robot_1": 1743.730382601533}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1915.2303434470934, "robot_1": 1897.562771667}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7561174209757778, "mean_inference_ms": 3.393423803877578, "mean_action_processing_ms": 0.4656492044042698, "mean_env_wait_ms": 0.4696092924102925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007871538400650024, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.15442892909049988}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19600, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 9800, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 336.55371189270863, "num_env_steps_trained_throughput_per_sec": 430.78875122266703, "timesteps_total": 9800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19600, "timers": {"training_iteration_time_ms": 507.769, "sample_time_ms": 275.075, "load_time_ms": 0.411, "load_throughput": 623145.391, "learn_time_ms": 33.593, "learn_throughput": 7620.671, "synch_weights_time_ms": 10.905}, "counters": {"num_env_steps_sampled": 9800, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 19600, "num_agent_steps_trained": 10752, "last_target_update_ts": 9800, "num_target_updates": 42}, "done": false, "episodes_total": 16, "training_iteration": 19, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-01", "timestamp": 1742662561, "time_this_iter_s": 1.207061529159546, "time_total_s": 24.94712471961975, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7378B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 24.94712471961975, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.35, "ram_util_percent": 93.95}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1898.9668516900852, "('robot_0', 'robot_0')_total_reward_min": 1742.50893725167, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1884.3296829475407, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.517580032348633, "actor_loss": -8.857487678527832, "critic_loss": 3.6470789909362793, "alpha_loss": -0.1745097041130066, "alpha_value": 0.9871731400489807, "log_alpha_value": -0.012909832410514355, "target_entropy": -8.0, "policy_t": 0.0010252976790070534, "mean_q": 3.5709855556488037, "max_q": 6.527371883392334, "min_q": 2.4615752696990967}, "td_error": [4.353112697601318, 4.635121822357178, 5.4279890060424805, 4.494169235229492, 5.070732116699219, 3.3619372844696045, 6.404524803161621, 5.207841873168945, 6.390889644622803, 5.633554458618164, 6.280160903930664, 5.113799571990967, 5.665400505065918, 4.767385482788086, 6.111964225769043, 4.678455352783203, 5.169611930847168, 4.820683479309082, 6.04321813583374, 5.352601528167725, 4.740311622619629, 5.538917064666748, 5.300290107727051, 6.48504114151001, 5.615998268127441, 4.392545223236084, 4.776920318603516, 5.043557167053223, 7.609809875488281, 3.524397373199463, 4.756932735443115, 5.058959007263184, 5.273779392242432, 4.345935344696045, 4.93545389175415, 5.424123764038086, 4.77433967590332, 4.969098091125488, 5.5829548835754395, 4.611814498901367, 6.705850601196289, 4.474056243896484, 3.7423388957977295, 6.088942050933838, 5.504481792449951, 4.858644485473633, 5.370476722717285, 5.26835823059082, 5.431099891662598, 5.040882587432861, 5.315672874450684, 4.921221733093262, 5.33459997177124, 4.912813186645508, 5.377027988433838, 6.341076850891113, 5.357054710388184, 5.19329833984375, 6.432389736175537, 3.866269111633301, 4.370558738708496, 3.9907584190368652, 5.418222904205322, 3.5253987312316895, 6.021946907043457, 4.714064598083496, 5.254105567932129, 5.794942378997803, 5.317873954772949, 4.9312334060668945, 5.170277118682861, 6.293690204620361, 6.224707126617432, 3.853950262069702, 5.637810707092285, 4.954522132873535, 4.051486968994141, 5.231319904327393, 4.519021987915039, 5.735496520996094, 5.839007377624512, 5.771108150482178, 3.6722829341888428, 4.380885124206543, 6.337335586547852, 5.061515808105469, 4.794565200805664, 6.0188679695129395, 4.237336158752441, 4.5430006980896, 6.861815452575684, 4.299616813659668, 6.116269111633301, 4.658548355102539, 4.707756519317627, 5.036557674407959, 5.760747909545898, 4.90638542175293, 5.107766151428223, 5.294864654541016, 5.913029670715332, 6.5359344482421875, 6.222428321838379, 5.743868350982666, 5.666860103607178, 3.9655380249023438, 4.765504360198975, 5.429450988769531, 5.040578365325928, 5.891635417938232, 5.836279392242432, 5.9662933349609375, 4.194239616394043, 5.654598236083984, 5.128503799438477, 4.884522438049316, 4.874144077301025, 4.636584281921387, 4.704300403594971, 3.7567026615142822, 5.253779411315918, 3.5250906944274902, 5.247638702392578, 5.409577369689941, 5.508835792541504, 5.572526931762695, 5.7192702293396, 6.175846576690674], "mean_td_error": 5.194704055786133, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.445237159729004, "actor_loss": -8.681451797485352, "critic_loss": 3.729773998260498, "alpha_loss": -0.1735863834619522, "alpha_value": 0.9871723651885986, "log_alpha_value": -0.012910621240735054, "target_entropy": -8.0, "policy_t": 0.03281405195593834, "mean_q": 3.358677387237549, "max_q": 5.625894069671631, "min_q": 2.090301036834717}, "td_error": [5.441740989685059, 3.812959909439087, 6.200417518615723, 5.681768417358398, 4.086258888244629, 4.769850730895996, 5.791062355041504, 5.857696533203125, 4.627561092376709, 6.679286003112793, 5.370612144470215, 4.815167427062988, 4.653232097625732, 5.403012275695801, 5.226369857788086, 5.365713119506836, 4.835600852966309, 5.400998115539551, 5.692945957183838, 6.480417728424072, 4.496881008148193, 5.092962265014648, 4.9292707443237305, 5.6034464836120605, 5.030029773712158, 4.998297214508057, 4.149531364440918, 4.282373428344727, 5.812432289123535, 5.744171142578125, 6.288047790527344, 5.243247985839844, 5.274149417877197, 4.547198295593262, 5.731903076171875, 6.273085594177246, 5.542506217956543, 5.986776351928711, 4.957585334777832, 5.59002685546875, 5.470486640930176, 4.708055019378662, 6.274309158325195, 5.11177921295166, 5.309659004211426, 3.9584109783172607, 4.735177040100098, 5.6341328620910645, 4.352431297302246, 5.199804306030273, 4.852959632873535, 4.5492424964904785, 5.767250061035156, 5.520227432250977, 5.140787124633789, 5.206493854522705, 4.499512672424316, 4.111276626586914, 4.699016571044922, 6.43861722946167, 5.226994514465332, 4.696829795837402, 3.483135223388672, 5.22532844543457, 5.250123500823975, 4.326694488525391, 5.074367046356201, 4.8437933921813965, 5.178766250610352, 5.560966491699219, 6.736571311950684, 5.340342998504639, 5.44483757019043, 4.789127349853516, 5.760618209838867, 5.034818649291992, 5.1335954666137695, 4.862913608551025, 4.963998794555664, 4.851632595062256, 6.15071964263916, 5.932891845703125, 4.509055137634277, 5.15480899810791, 4.513996124267578, 4.691290855407715, 5.1835737228393555, 4.697661876678467, 5.9625749588012695, 4.639150619506836, 6.5212507247924805, 4.805571556091309, 4.352474689483643, 4.625857830047607, 5.292491912841797, 4.9341020584106445, 5.528587341308594, 4.763713836669922, 5.67349910736084, 7.118414878845215, 5.825047492980957, 5.177268981933594, 6.42226505279541, 5.628105640411377, 4.433631896972656, 5.117607116699219, 5.257113456726074, 5.159499168395996, 4.112030506134033, 4.542620658874512, 5.3341264724731445, 4.823236465454102, 5.435479640960693, 5.2905964851379395, 5.607157230377197, 5.387598037719727, 6.247182846069336, 5.552202224731445, 4.411752700805664, 5.018551349639893, 4.955715179443359, 4.791609287261963, 4.136448383331299, 4.545834541320801, 5.297727584838867, 4.785823822021484, 4.819077014923096, 5.296409606933594], "mean_td_error": 5.184023857116699, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44.0, "diff_num_grad_updates_vs_sampler_policy": 43.0}}, "num_env_steps_sampled": 10200, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 20400, "num_agent_steps_trained": 11264, "last_target_update_ts": 10200, "num_target_updates": 44}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3783.296534637625, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1742.50893725167, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1898.9668516900852, "robot_1": 1884.3296829475407}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1898.9668516900852, "('robot_0', 'robot_0')_total_reward_min": 1742.50893725167, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1884.3296829475407, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7536418583313775, "mean_inference_ms": 3.3877261196942925, "mean_action_processing_ms": 0.4635909521959176, "mean_env_wait_ms": 0.46799896276851777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011315345764160156, "StateBufferConnector_ms": 0.0025069713592529297, "ViewRequirementAgentConnector_ms": 0.1480954885482788}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3783.296534637625, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1742.50893725167, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1898.9668516900852, "robot_1": 1884.3296829475407}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7536418583313775, "mean_inference_ms": 3.3877261196942925, "mean_action_processing_ms": 0.4635909521959176, "mean_env_wait_ms": 0.46799896276851777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011315345764160156, "StateBufferConnector_ms": 0.0025069713592529297, "ViewRequirementAgentConnector_ms": 0.1480954885482788}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20400, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 10200, "num_env_steps_trained": 11264, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 313.18702570799854, "num_env_steps_trained_throughput_per_sec": 400.87939290623814, "timesteps_total": 10200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20400, "timers": {"training_iteration_time_ms": 536.9, "sample_time_ms": 270.419, "load_time_ms": 0.412, "load_throughput": 620911.25, "learn_time_ms": 34.228, "learn_throughput": 7479.181, "synch_weights_time_ms": 42.303}, "counters": {"num_env_steps_sampled": 10200, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 20400, "num_agent_steps_trained": 11264, "last_target_update_ts": 10200, "num_target_updates": 44}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-02", "timestamp": 1742662562, "time_this_iter_s": 1.2925176620483398, "time_total_s": 26.23964238166809, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7741F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 26.23964238166809, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.85, "ram_util_percent": 94.0}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1898.9668516900852, "('robot_0', 'robot_0')_total_reward_min": 1742.50893725167, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1884.3296829475407, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.436222076416016, "actor_loss": -9.242607116699219, "critic_loss": 3.3905510902404785, "alpha_loss": -0.18152885138988495, "alpha_value": 0.9865804314613342, "log_alpha_value": -0.013510407879948616, "target_entropy": -8.0, "policy_t": -0.011333017610013485, "mean_q": 4.069372653961182, "max_q": 7.360884666442871, "min_q": 2.195096731185913}, "td_error": [4.7218217849731445, 5.105158805847168, 5.022174835205078, 5.938875198364258, 4.7092437744140625, 4.099586486816406, 5.230832576751709, 4.620621204376221, 5.522615909576416, 2.799661159515381, 4.033624649047852, 5.395145416259766, 4.769679069519043, 4.003789901733398, 3.2081291675567627, 4.908363342285156, 3.069753408432007, 4.980420112609863, 4.834200859069824, 4.5047688484191895, 6.065214157104492, 3.9382455348968506, 4.612842559814453, 3.7468245029449463, 4.639041900634766, 4.935973167419434, 4.998195648193359, 5.187797546386719, 5.245084762573242, 4.359607696533203, 4.703762531280518, 2.8611819744110107, 5.850996017456055, 4.182549476623535, 5.332369804382324, 4.586320400238037, 5.651963233947754, 3.7786476612091064, 5.234315872192383, 4.245369911193848, 4.781469345092773, 4.234877586364746, 3.8234527111053467, 5.596872329711914, 5.158888816833496, 3.725123405456543, 4.809893608093262, 3.0168704986572266, 1.9427821636199951, 4.816635608673096, 5.0394487380981445, 4.092763900756836, 4.583124160766602, 5.634232044219971, 5.772096633911133, 4.665314674377441, 4.686789035797119, 5.074288368225098, 4.344256401062012, 5.0391526222229, 3.090588092803955, 5.670730113983154, 3.795628309249878, 5.077143669128418, 3.348295211791992, 5.248569011688232, 5.411916732788086, 4.5325164794921875, 3.8252484798431396, 3.8657257556915283, 5.144712448120117, 6.301863193511963, 4.778556823730469, 4.8827056884765625, 4.1222357749938965, 5.997527599334717, 4.5007452964782715, 4.039341926574707, 4.205291748046875, 3.6973419189453125, 5.1363725662231445, 5.226062297821045, 4.780155181884766, 4.676716327667236, 4.7220778465271, 3.965363025665283, 2.3306047916412354, 3.3886051177978516, 6.272173881530762, 2.862839937210083, 4.059287071228027, 2.5273287296295166, 4.152602195739746, 6.022493362426758, 5.4795026779174805, 4.477375030517578, 4.7629289627075195, 4.0415472984313965, 4.817358016967773, 4.052293300628662, 4.992916107177734, 4.227460861206055, 3.831758499145508, 5.1854448318481445, 5.877981185913086, 5.515004634857178, 4.797122478485107, 5.0902099609375, 4.811498641967773, 2.8968091011047363, 4.408381462097168, 4.357515335083008, 4.785554885864258, 5.172679901123047, 5.425078868865967, 5.973668098449707, 3.70438551902771, 5.31879997253418, 5.509704113006592, 4.814211845397949, 5.431765556335449, 4.348947048187256, 2.8995888233184814, 4.924330711364746, 4.467259407043457, 5.2291765213012695, 6.217344760894775, 4.137321472167969], "mean_td_error": 4.610276222229004, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.480539321899414, "actor_loss": -9.056330680847168, "critic_loss": 3.4247827529907227, "alpha_loss": -0.18213868141174316, "alpha_value": 0.9865796566009521, "log_alpha_value": -0.013511231169104576, "target_entropy": -8.0, "policy_t": 0.024538669735193253, "mean_q": 3.7224907875061035, "max_q": 7.229588508605957, "min_q": 2.3784117698669434}, "td_error": [4.781018257141113, 6.305548667907715, 5.023879051208496, 4.665165424346924, 5.373926162719727, 4.948575019836426, 5.2845845222473145, 3.755606174468994, 5.337502956390381, 5.505320072174072, 4.949166774749756, 5.625551700592041, 3.8684709072113037, 5.931166648864746, 3.301908016204834, 4.875184059143066, 6.690700531005859, 4.407822608947754, 5.968502521514893, 4.29543399810791, 3.3351361751556396, 5.446189880371094, 5.139305114746094, 4.687621116638184, 4.653847694396973, 6.057084083557129, 3.7543697357177734, 4.571109771728516, 5.156167984008789, 4.854066371917725, 5.4469499588012695, 3.7619826793670654, 5.23991584777832, 3.721489429473877, 4.652866363525391, 5.539816856384277, 6.118288516998291, 4.882350921630859, 4.264522075653076, 5.08610725402832, 3.836907386779785, 6.107733726501465, 4.953088283538818, 4.764614105224609, 4.782175064086914, 4.774131774902344, 5.188755989074707, 4.809116840362549, 4.306610107421875, 4.889569282531738, 5.186191558837891, 4.427753448486328, 2.564829111099243, 4.562768936157227, 3.787332534790039, 6.042971611022949, 3.912445545196533, 5.024572849273682, 4.776248455047607, 5.622806549072266, 4.55607795715332, 5.829885005950928, 4.733930587768555, 3.334519624710083, 4.2350077629089355, 5.220070838928223, 4.839089393615723, 4.774965286254883, 4.05873966217041, 5.153482913970947, 5.692600727081299, 6.093770980834961, 3.9506802558898926, 4.344012260437012, 4.366908073425293, 4.535863399505615, 4.053571701049805, 4.712465763092041, 5.316700458526611, 5.756984233856201, 5.411509990692139, 4.330142974853516, 4.7122087478637695, 5.195176124572754, 4.416849613189697, 2.638709306716919, 4.946760177612305, 5.741293907165527, 5.567461967468262, 4.758009910583496, 4.15022087097168, 2.7156782150268555, 5.703607559204102, 5.097309112548828, 4.852017879486084, 6.141040802001953, 4.52008056640625, 4.018955707550049, 5.682654857635498, 4.132092475891113, 5.026398658752441, 4.550442695617676, 5.174694061279297, 5.9029693603515625, 5.5206146240234375, 5.705557346343994, 4.529318332672119, 4.783262252807617, 4.78188419342041, 5.137217044830322, 4.797774791717529, 4.520719528198242, 4.838988304138184, 4.7379961013793945, 4.348613262176514, 4.649636745452881, 4.826581001281738, 4.268357276916504, 5.022922992706299, 6.100497245788574, 3.911785364151001, 4.4849958419799805, 4.919682502746582, 4.1087965965271, 4.390511512756348, 5.462169647216797, 4.1113433837890625, 6.48272705078125], "mean_td_error": 4.835721969604492, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46.0, "diff_num_grad_updates_vs_sampler_policy": 45.0}}, "num_env_steps_sampled": 10600, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 21200, "num_agent_steps_trained": 11776, "last_target_update_ts": 10600, "num_target_updates": 46}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3783.296534637625, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1742.50893725167, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1898.9668516900852, "robot_1": 1884.3296829475407}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1898.9668516900852, "('robot_0', 'robot_0')_total_reward_min": 1742.50893725167, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1884.3296829475407, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7536418583313775, "mean_inference_ms": 3.3877261196942925, "mean_action_processing_ms": 0.4635909521959176, "mean_env_wait_ms": 0.46799896276851777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011315345764160156, "StateBufferConnector_ms": 0.0025069713592529297, "ViewRequirementAgentConnector_ms": 0.1480954885482788}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3783.296534637625, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1742.50893725167, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1898.9668516900852, "robot_1": 1884.3296829475407}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7536418583313775, "mean_inference_ms": 3.3877261196942925, "mean_action_processing_ms": 0.4635909521959176, "mean_env_wait_ms": 0.46799896276851777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011315345764160156, "StateBufferConnector_ms": 0.0025069713592529297, "ViewRequirementAgentConnector_ms": 0.1480954885482788}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21200, "num_agent_steps_trained": 11776, "num_env_steps_sampled": 10600, "num_env_steps_trained": 11776, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 397.7412702284879, "num_env_steps_trained_throughput_per_sec": 509.1088258924645, "timesteps_total": 10600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 21200, "timers": {"training_iteration_time_ms": 542.0, "sample_time_ms": 274.934, "load_time_ms": 0.412, "load_throughput": 620911.25, "learn_time_ms": 34.433, "learn_throughput": 7434.747, "synch_weights_time_ms": 42.551}, "counters": {"num_env_steps_sampled": 10600, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 21200, "num_agent_steps_trained": 11776, "last_target_update_ts": 10600, "num_target_updates": 46}, "done": false, "episodes_total": 20, "training_iteration": 21, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-03", "timestamp": 1742662563, "time_this_iter_s": 1.021146535873413, "time_total_s": 27.260788917541504, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A774670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 27.260788917541504, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 26.1, "ram_util_percent": 94.1}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1898.9668516900852, "('robot_0', 'robot_0')_total_reward_min": 1742.50893725167, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1884.3296829475407, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.426887512207031, "actor_loss": -10.179880142211914, "critic_loss": 2.545966148376465, "alpha_loss": -0.19349513947963715, "alpha_value": 0.9856923222541809, "log_alpha_value": -0.014411019161343575, "target_entropy": -8.0, "policy_t": -0.0022147130221128464, "mean_q": 5.00076961517334, "max_q": 9.188865661621094, "min_q": 2.837085247039795}, "td_error": [2.8828980922698975, 3.5394158363342285, 3.7469756603240967, 3.0454678535461426, 4.655616760253906, 4.036503791809082, 3.1368625164031982, 3.73154354095459, 4.274527549743652, 3.9032821655273438, 4.665184020996094, 1.6752712726593018, 4.631007671356201, 4.137170791625977, 4.051418304443359, 2.33964467048645, 4.1262640953063965, 3.4885988235473633, 4.731655120849609, 3.9081923961639404, 3.4046854972839355, 4.086203575134277, 4.775797367095947, 3.351125717163086, 3.4999375343322754, 3.473247528076172, 2.765239953994751, 2.5956554412841797, 3.1872682571411133, 3.8467724323272705, 4.180225849151611, 3.9461910724639893, 3.8846511840820312, 3.875654458999634, 1.6869187355041504, 3.330017328262329, 5.551722526550293, 2.5700173377990723, 2.3298940658569336, 3.6299619674682617, 4.693570137023926, 2.986278772354126, 3.4310505390167236, 4.063106536865234, 4.624147415161133, 3.9064643383026123, 3.650974988937378, 2.342886447906494, 4.521518707275391, 1.4262561798095703, 4.008958339691162, 4.2528910636901855, 3.2288331985473633, 1.741053819656372, 4.325725078582764, 5.311951637268066, 2.845379590988159, 4.928493022918701, 4.023134231567383, 4.795341491699219, 3.8667969703674316, 4.1243510246276855, 2.8686139583587646, 4.4128737449646, 2.3548057079315186, 4.770118713378906, 2.4941468238830566, 4.343729496002197, 4.953583717346191, 4.359570503234863, 5.293997764587402, 3.3358356952667236, 3.677548885345459, 3.1484034061431885, 3.4589383602142334, 4.223513603210449, 3.449270486831665, 5.249303340911865, 5.4963579177856445, 3.364661693572998, 4.682512283325195, 3.9116382598876953, 3.6275370121002197, 3.7197670936584473, 3.3982956409454346, 2.1507461071014404, 4.860069274902344, 3.384449005126953, 4.776326656341553, 3.307034969329834, 1.9054312705993652, 4.48929500579834, 3.4697015285491943, 4.270730495452881, 1.3015742301940918, 4.636752128601074, 5.298349380493164, 1.6905128955841064, 4.807052135467529, 4.060246467590332, 5.420546531677246, 3.693068265914917, 4.182441711425781, 4.211849212646484, 4.783317565917969, 3.4819624423980713, 2.529054641723633, 3.89499568939209, 2.7833282947540283, 4.947041988372803, 3.4674253463745117, 3.788492202758789, 0.8024654388427734, 4.015851974487305, 3.6014509201049805, 4.574967384338379, 2.836122989654541, 2.908360004425049, 4.724332809448242, 3.0447094440460205, 3.8120152950286865, 4.271307468414307, 4.557352066040039, 2.6050257682800293, 4.285229206085205, 2.5651931762695312, 4.038390159606934, 5.148900985717773], "mean_td_error": 3.7324717044830322, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.506221771240234, "actor_loss": -9.894407272338867, "critic_loss": 2.8438825607299805, "alpha_loss": -0.19465379416942596, "alpha_value": 0.9856911897659302, "log_alpha_value": -0.014412157237529755, "target_entropy": -8.0, "policy_t": 4.261825233697891e-05, "mean_q": 4.50911808013916, "max_q": 7.75712251663208, "min_q": 2.76155161857605}, "td_error": [5.781779766082764, 4.372626304626465, 4.139834403991699, 3.9904894828796387, 3.091481924057007, 4.579990863800049, 4.101654529571533, 3.2086167335510254, 4.432444095611572, 2.9457366466522217, 5.078484535217285, 5.817587852478027, 2.6468570232391357, 4.718674182891846, 2.6762781143188477, 2.443502187728882, 3.4433956146240234, 4.012835502624512, 3.3228936195373535, 3.3173575401306152, 5.0053391456604, 4.191222667694092, 4.2286882400512695, 3.0806491374969482, 4.102073669433594, 3.369485378265381, 3.636719226837158, 4.118954181671143, 2.789479970932007, 4.072515487670898, 3.2441482543945312, 2.242842674255371, 5.6640543937683105, 3.460465908050537, 1.9440271854400635, 5.062373161315918, 3.3039960861206055, 5.188653469085693, 4.687504768371582, 4.611868858337402, 3.41326904296875, 4.5957255363464355, 4.530549049377441, 4.012976169586182, 4.713155746459961, 2.510150909423828, 2.6361794471740723, 4.603019714355469, 3.6068010330200195, 4.205305576324463, 4.48825740814209, 5.721254348754883, 5.069660663604736, 4.126669406890869, 4.395848751068115, 4.537196159362793, 3.322802782058716, 3.557666778564453, 4.919198513031006, 4.596223831176758, 5.231678009033203, 4.3389716148376465, 5.256771564483643, 2.236267328262329, 2.399108648300171, 4.020566940307617, 4.133110523223877, 4.677899360656738, 3.5070486068725586, 3.1371631622314453, 4.164020538330078, 2.8612864017486572, 4.926111698150635, 3.683116912841797, 2.563271999359131, 4.72745418548584, 2.677995204925537, 3.5329275131225586, 3.4351556301116943, 3.730909585952759, 6.138759613037109, 4.637393474578857, 3.2382473945617676, 3.9856746196746826, 4.546003341674805, 4.145835876464844, 4.139028549194336, 4.263065814971924, 3.936525583267212, 4.940849781036377, 4.458254337310791, 3.9768149852752686, 3.448343276977539, 3.995382308959961, 3.7418458461761475, 3.301222562789917, 3.5806803703308105, 4.4672393798828125, 4.569756507873535, 4.063982009887695, 4.826085567474365, 2.62485408782959, 5.707708358764648, 3.6752498149871826, 5.565974235534668, 4.6556549072265625, 4.445215225219727, 4.3786468505859375, 2.3192107677459717, 4.070120811462402, 4.583695411682129, 3.5701446533203125, 4.350221157073975, 2.8666696548461914, 4.798717498779297, 5.4065985679626465, 3.0039002895355225, 4.406330108642578, 5.689813137054443, 4.279876232147217, 4.692837715148926, 4.966876029968262, 4.8133416175842285, 4.38850736618042, 4.255406379699707, 4.366239547729492, 5.124190807342529, 3.8426320552825928], "mean_td_error": 4.063905715942383, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 48.0}}, "num_env_steps_sampled": 11200, "num_env_steps_trained": 12544, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 12544, "last_target_update_ts": 11200, "num_target_updates": 49}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3783.296534637625, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1742.50893725167, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1898.9668516900852, "robot_1": 1884.3296829475407}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1898.9668516900852, "('robot_0', 'robot_0')_total_reward_min": 1742.50893725167, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1884.3296829475407, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7536418583313775, "mean_inference_ms": 3.3877261196942925, "mean_action_processing_ms": 0.4635909521959176, "mean_env_wait_ms": 0.46799896276851777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011315345764160156, "StateBufferConnector_ms": 0.0025069713592529297, "ViewRequirementAgentConnector_ms": 0.1480954885482788}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3783.296534637625, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1742.50893725167, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1898.9668516900852, "robot_1": 1884.3296829475407}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7536418583313775, "mean_inference_ms": 3.3877261196942925, "mean_action_processing_ms": 0.4635909521959176, "mean_env_wait_ms": 0.46799896276851777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011315345764160156, "StateBufferConnector_ms": 0.0025069713592529297, "ViewRequirementAgentConnector_ms": 0.1480954885482788}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 12544, "num_env_steps_sampled": 11200, "num_env_steps_trained": 12544, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 369.5988636143338, "num_env_steps_trained_throughput_per_sec": 473.0865454263473, "timesteps_total": 11200, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 22400, "timers": {"training_iteration_time_ms": 557.465, "sample_time_ms": 284.764, "load_time_ms": 0.31, "load_throughput": 824939.939, "learn_time_ms": 36.156, "learn_throughput": 7080.399, "synch_weights_time_ms": 42.616}, "counters": {"num_env_steps_sampled": 11200, "num_env_steps_trained": 12544, "num_agent_steps_sampled": 22400, "num_agent_steps_trained": 12544, "last_target_update_ts": 11200, "num_target_updates": 49}, "done": false, "episodes_total": 20, "training_iteration": 22, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-05", "timestamp": 1742662565, "time_this_iter_s": 1.6433377265930176, "time_total_s": 28.90412664413452, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A774D30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 28.90412664413452, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 35.166666666666664, "ram_util_percent": 94.36666666666667}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1898.9668516900852, "('robot_0', 'robot_0')_total_reward_min": 1742.50893725167, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1884.3296829475407, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.413557052612305, "actor_loss": -10.54837417602539, "critic_loss": 1.4602899551391602, "alpha_loss": -0.20135265588760376, "alpha_value": 0.9851009845733643, "log_alpha_value": -0.015011130832135677, "target_entropy": -8.0, "policy_t": 0.003916382789611816, "mean_q": 5.420871257781982, "max_q": 9.812444686889648, "min_q": 2.8957650661468506}, "td_error": [2.210162401199341, 3.024522066116333, 5.453584671020508, 2.891649007797241, 4.205411911010742, 2.033475637435913, 4.718451499938965, 5.41023063659668, 4.369878768920898, 3.2759921550750732, 4.046962738037109, 2.5328145027160645, 3.184610605239868, 3.3528900146484375, 2.9319980144500732, 3.427083730697632, 2.646678924560547, 4.610502243041992, 5.423125743865967, 3.5682737827301025, 1.9727840423583984, 3.5323166847229004, 1.3066527843475342, 3.3904366493225098, 3.0061864852905273, 0.5038671493530273, 2.9795708656311035, 3.847014904022217, 4.308834075927734, 0.3981809616088867, 3.8302628993988037, 3.064455509185791, 3.4947593212127686, 4.283378601074219, 3.9420673847198486, 5.139917373657227, 3.4587976932525635, 3.391833543777466, 3.5817649364471436, 5.688094139099121, 3.679373264312744, 4.620107650756836, 0.8532943725585938, 2.6350574493408203, 4.0960693359375, 4.933558464050293, 4.875551223754883, 3.5624616146087646, 3.8792338371276855, 4.06343936920166, 4.037153720855713, 4.877345085144043, 4.389412879943848, 3.2762670516967773, 4.096893787384033, 4.130270957946777, 2.036306381225586, 3.3634085655212402, 3.3894832134246826, 5.400966644287109, 4.691523551940918, 0.4702329635620117, 4.055797576904297, 3.6188647747039795, 5.108053684234619, 1.9809825420379639, 1.9148449897766113, 1.406374454498291, 3.574744462966919, 3.403871536254883, 3.9473495483398438, 2.882613182067871, 3.5363168716430664, 2.3354809284210205, 4.307805061340332, 3.4125752449035645, 3.473346710205078, 3.7386486530303955, 3.165297031402588, 3.1755781173706055, 3.508857011795044, 3.0365805625915527, 4.526508331298828, 2.4835267066955566, 3.233952283859253, 3.677197217941284, 0.4783000946044922, 4.013322830200195, 3.5942039489746094, 2.8786795139312744, 0.9283971786499023, 4.39314079284668, 0.5603678226470947, 2.9276304244995117, 5.0698323249816895, 5.200522422790527, 2.508880615234375, 4.130684852600098, 4.773767471313477, 4.689823627471924, 0.9664058685302734, 0.5036864280700684, 0.3299446105957031, 2.7364678382873535, 3.352285861968994, 3.2883055210113525, 4.489778995513916, 2.0702779293060303, 2.2552385330200195, 2.5705976486206055, 4.107488632202148, 4.700308799743652, 3.5163679122924805, 3.1259679794311523, 3.7483749389648438, 3.430668830871582, 4.342471599578857, 3.6434226036071777, 4.237154960632324, 4.4522199630737305, 3.8089096546173096, 3.178164482116699, 3.2009778022766113, 3.5535898208618164, 3.096604585647583, 2.6551449298858643, 2.513627052307129, 3.9690332412719727], "mean_td_error": 3.3851022720336914, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.498031616210938, "actor_loss": -10.387089729309082, "critic_loss": 2.291288137435913, "alpha_loss": -0.202644944190979, "alpha_value": 0.985099196434021, "log_alpha_value": -0.015012925490736961, "target_entropy": -8.0, "policy_t": -0.025429710745811462, "mean_q": 5.0686845779418945, "max_q": 9.407668113708496, "min_q": 3.2263474464416504}, "td_error": [3.260331153869629, 3.7264723777770996, 4.579641819000244, 4.0268049240112305, 4.3202362060546875, 3.6040966510772705, 3.7118301391601562, 4.918213844299316, 3.1831679344177246, 3.6196045875549316, 3.856438398361206, 1.7788841724395752, 4.935831546783447, 2.5697717666625977, 1.5325443744659424, 3.681363582611084, 4.610941410064697, 0.8669195175170898, 4.83416748046875, 2.592317581176758, 3.875011682510376, 3.850342035293579, 4.016222953796387, 3.208888292312622, 2.684072732925415, 3.260896921157837, 0.38249778747558594, 3.3849198818206787, 3.8873207569122314, 2.432859182357788, 4.1353535652160645, 3.4464004039764404, 4.203511714935303, 5.572587966918945, 3.112546682357788, 4.257904529571533, 4.010516166687012, 0.7786974906921387, 3.4928231239318848, 1.687838077545166, 3.6958634853363037, 1.9248089790344238, 2.282360076904297, 3.957524538040161, 4.244460105895996, 4.066494464874268, 3.233971118927002, 3.208991289138794, 3.4879770278930664, 3.8410449028015137, 2.522273063659668, 2.983870029449463, 3.747392416000366, 4.305089950561523, 3.159236431121826, 2.504098415374756, 1.3098316192626953, 2.4147326946258545, 3.0717170238494873, 4.164308547973633, 4.101801872253418, 5.376114368438721, 4.026434898376465, 3.546276330947876, 3.9703967571258545, 4.123758792877197, 3.326425313949585, 3.3051178455352783, 4.261768817901611, 3.0308003425598145, 4.018241882324219, 1.4025936126708984, 3.618147134780884, 4.545051574707031, 3.5142433643341064, 4.161175727844238, 2.6242544651031494, 3.6464905738830566, 2.86042857170105, 4.377649307250977, 3.257866859436035, 2.77715802192688, 3.543219566345215, 4.753479957580566, 3.948711395263672, 5.078958511352539, 3.9872560501098633, 4.2481465339660645, 3.7950925827026367, 4.632659912109375, 3.753723621368408, 1.0193367004394531, 4.38791561126709, 4.17982292175293, 3.509174346923828, 3.2025609016418457, 3.125026226043701, 3.996952772140503, 3.807835578918457, 2.5627927780151367, 1.9058516025543213, 2.7494959831237793, 4.2046308517456055, 3.7474546432495117, 3.3566174507141113, 3.931267023086548, 3.7038986682891846, 4.569582939147949, 2.427788496017456, 2.650355815887451, 0.8613572120666504, 4.856687545776367, 4.778669357299805, 4.079060077667236, 2.552462577819824, 2.560328960418701, 4.121294975280762, 4.1531853675842285, 3.3132035732269287, 4.0945281982421875, 5.0618767738342285, 4.617679595947266, 4.640085697174072, 3.3690545558929443, 4.4954986572265625, 4.264355182647705, 2.7174882888793945, 2.4088969230651855], "mean_td_error": 3.4969873428344727, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 11600, "num_env_steps_trained": 13056, "num_agent_steps_sampled": 23200, "num_agent_steps_trained": 13056, "last_target_update_ts": 11600, "num_target_updates": 51}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3783.296534637625, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1742.50893725167, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1898.9668516900852, "robot_1": 1884.3296829475407}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1898.9668516900852, "('robot_0', 'robot_0')_total_reward_min": 1742.50893725167, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1884.3296829475407, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7536418583313775, "mean_inference_ms": 3.3877261196942925, "mean_action_processing_ms": 0.4635909521959176, "mean_env_wait_ms": 0.46799896276851777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011315345764160156, "StateBufferConnector_ms": 0.0025069713592529297, "ViewRequirementAgentConnector_ms": 0.1480954885482788}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3783.296534637625, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1742.50893725167, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1898.9668516900852, "robot_1": 1884.3296829475407}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7536418583313775, "mean_inference_ms": 3.3877261196942925, "mean_action_processing_ms": 0.4635909521959176, "mean_env_wait_ms": 0.46799896276851777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011315345764160156, "StateBufferConnector_ms": 0.0025069713592529297, "ViewRequirementAgentConnector_ms": 0.1480954885482788}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23200, "num_agent_steps_trained": 13056, "num_env_steps_sampled": 11600, "num_env_steps_trained": 13056, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 389.3949103349514, "num_env_steps_trained_throughput_per_sec": 498.42548522873784, "timesteps_total": 11600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23200, "timers": {"training_iteration_time_ms": 544.117, "sample_time_ms": 285.529, "load_time_ms": 0.332, "load_throughput": 770204.307, "learn_time_ms": 36.929, "learn_throughput": 6932.148, "synch_weights_time_ms": 42.512}, "counters": {"num_env_steps_sampled": 11600, "num_env_steps_trained": 13056, "num_agent_steps_sampled": 23200, "num_agent_steps_trained": 13056, "last_target_update_ts": 11600, "num_target_updates": 51}, "done": false, "episodes_total": 20, "training_iteration": 23, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-06", "timestamp": 1742662566, "time_this_iter_s": 1.048295259475708, "time_total_s": 29.95242190361023, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7741F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 29.95242190361023, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 35.9, "ram_util_percent": 93.4}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1885.5299778727165, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1873.4732314458872, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.474024772644043, "actor_loss": -11.5050048828125, "critic_loss": 0.8933552503585815, "alpha_loss": -0.21438813209533691, "alpha_value": 0.984214723110199, "log_alpha_value": -0.015911219641566277, "target_entropy": -8.0, "policy_t": -0.008823085576295853, "mean_q": 6.394847393035889, "max_q": 11.929359436035156, "min_q": 3.9363608360290527}, "td_error": [2.3393774032592773, 2.0982673168182373, 2.6727888584136963, 0.8362338542938232, 1.2106680870056152, 2.7731266021728516, 3.756958246231079, 2.042043924331665, 2.671393632888794, 2.2789294719696045, 3.2191951274871826, 2.0631890296936035, 0.323641300201416, 2.3298213481903076, 1.971264362335205, 3.2344934940338135, 1.7418572902679443, 0.6320095062255859, 3.4758059978485107, 3.740300416946411, 1.095088005065918, 1.562295913696289, 3.0742900371551514, 3.418069362640381, 3.677798271179199, 2.9090938568115234, 4.2373738288879395, 3.644261360168457, 2.0057430267333984, 1.4931840896606445, 3.085139513015747, 3.44551682472229, 2.0207743644714355, 2.5463831424713135, 0.691108226776123, 1.7115478515625, 3.8772623538970947, 0.8676712512969971, 3.6153879165649414, 3.630282163619995, 3.125511646270752, 2.6830878257751465, 3.429683208465576, 3.10439133644104, 4.3868560791015625, 2.5660130977630615, 3.879930019378662, 1.9008195400238037, 2.040722370147705, 3.087697982788086, 1.1282768249511719, 2.4254209995269775, 2.480818510055542, 2.9607715606689453, 2.8318469524383545, 2.738769054412842, 2.995006561279297, 1.4961631298065186, 2.3950321674346924, 3.5708165168762207, 0.5635042190551758, 3.648110866546631, 2.1369385719299316, 3.8428516387939453, 2.5957534313201904, 1.4963915348052979, 1.9805560111999512, 2.9213314056396484, 1.795788049697876, 1.6458461284637451, 0.522118091583252, 3.802018880844116, 3.3642849922180176, 2.760016679763794, 3.288607358932495, 2.2525110244750977, 2.4119300842285156, 0.46822166442871094, 1.3433780670166016, 1.5885121822357178, 0.15627193450927734, 2.945725202560425, 3.4948978424072266, 1.700685739517212, 2.7270305156707764, 1.9714350700378418, 3.3305699825286865, 3.626278877258301, 0.6075682640075684, 2.0787737369537354, 4.339948654174805, 1.739475965499878, 3.889838933944702, 2.7615609169006348, 2.929302930831909, 2.583803415298462, 3.464022159576416, 3.072866916656494, 2.57047176361084, 1.8117725849151611, 2.935784339904785, 3.788825750350952, 3.9992411136627197, 1.7052185535430908, 2.8454737663269043, 2.1617157459259033, 2.030935764312744, 0.6383833885192871, 0.9649434089660645, 0.9454684257507324, 3.55623197555542, 3.0886754989624023, 2.8565878868103027, 2.5128250122070312, 0.5027637481689453, 1.1995420455932617, 1.8722388744354248, 1.1449286937713623, 0.700711727142334, 3.0391485691070557, 2.4524877071380615, 2.964569330215454, 1.927886724472046, 2.471608877182007, 2.4072370529174805, 2.0690715312957764, 1.5607264041900635, 3.513547658920288], "mean_td_error": 2.432304620742798, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.424114227294922, "actor_loss": -11.212854385375977, "critic_loss": 1.269086480140686, "alpha_loss": -0.21363352239131927, "alpha_value": 0.984211802482605, "log_alpha_value": -0.01591416448354721, "target_entropy": -8.0, "policy_t": -0.0022579017095267773, "mean_q": 5.898521423339844, "max_q": 11.56859016418457, "min_q": 2.7966580390930176}, "td_error": [1.9969847202301025, 3.2793376445770264, 3.589496374130249, 2.6726837158203125, 1.5720810890197754, 2.594597578048706, 2.9386579990386963, 0.9297604560852051, 2.3371965885162354, 1.6800765991210938, 2.315514326095581, 2.122779369354248, 3.652395009994507, 2.4488024711608887, 0.8878273963928223, 2.3149147033691406, 1.6615099906921387, 2.862030506134033, 0.7953565120697021, 5.077020168304443, 3.0126471519470215, 2.581231117248535, 1.006500244140625, 3.018526792526245, 0.8136942386627197, 2.9241883754730225, 3.2099621295928955, 2.9568424224853516, 1.9821791648864746, 3.66764760017395, 4.057129859924316, 2.4616410732269287, 1.286149501800537, 3.69807505607605, 1.478020191192627, 0.7956390380859375, 3.0124351978302, 1.1056556701660156, 1.1130475997924805, 1.2381219863891602, 3.810948610305786, 3.2781972885131836, 2.305330276489258, 3.484633445739746, 1.9662885665893555, 1.9473633766174316, 2.2989895343780518, 1.8457746505737305, 2.895308256149292, 2.8847758769989014, 1.4595727920532227, 3.5557808876037598, 4.246978759765625, 3.727544069290161, 3.5411009788513184, 3.535606861114502, 2.753624200820923, 3.5662450790405273, 4.35434627532959, 2.43179988861084, 3.613295793533325, 3.059410810470581, 3.66066312789917, 3.449134111404419, 3.6004886627197266, 3.223543405532837, 3.441681146621704, 2.3099067211151123, 0.6112799644470215, 2.244533061981201, 3.9837148189544678, 0.609694242477417, 2.697693109512329, 2.5346806049346924, 4.090850830078125, 0.7589597702026367, 3.972559690475464, 2.595036268234253, 3.1296465396881104, 3.942997455596924, 3.947941780090332, 4.08906364440918, 0.7421536445617676, 2.5389366149902344, 2.976586103439331, 0.759688138961792, 2.045504093170166, 3.7898941040039062, 1.9147379398345947, 1.9814300537109375, 2.8155245780944824, 2.3236806392669678, 3.645477294921875, 3.3080787658691406, 3.2498981952667236, 2.642268419265747, 2.9610230922698975, 3.0975496768951416, 2.868201494216919, 3.109113931655884, 3.382636547088623, 2.186692237854004, 1.5722837448120117, 3.255903959274292, 3.2594387531280518, 3.5844027996063232, 2.376429319381714, 0.907038688659668, 0.8495087623596191, 3.3882980346679688, 3.74424147605896, 2.112299680709839, 3.9877121448516846, 2.2565863132476807, 4.53877592086792, 3.958268165588379, 2.594564199447632, 2.6456143856048584, 2.539783000946045, 4.481051445007324, 2.9793479442596436, 3.2945542335510254, 1.3760547637939453, 2.326732635498047, 2.689244270324707, 2.5051164627075195, 2.4891886711120605, 3.55989146232605], "mean_td_error": 2.6891934871673584, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54.0, "diff_num_grad_updates_vs_sampler_policy": 53.0}}, "num_env_steps_sampled": 12200, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 24400, "num_agent_steps_trained": 13824, "last_target_update_ts": 12200, "num_target_updates": 54}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3759.0032093186032, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1885.5299778727165, "robot_1": 1873.4732314458872}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1885.5299778727165, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1873.4732314458872, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7524920371435941, "mean_inference_ms": 3.386016643007375, "mean_action_processing_ms": 0.46269610868472394, "mean_env_wait_ms": 0.4675492099321712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009429454803466797, "StateBufferConnector_ms": 0.0020891427993774414, "ViewRequirementAgentConnector_ms": 0.14858345190684}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3759.0032093186032, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1885.5299778727165, "robot_1": 1873.4732314458872}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7524920371435941, "mean_inference_ms": 3.386016643007375, "mean_action_processing_ms": 0.46269610868472394, "mean_env_wait_ms": 0.4675492099321712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009429454803466797, "StateBufferConnector_ms": 0.0020891427993774414, "ViewRequirementAgentConnector_ms": 0.14858345190684}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24400, "num_agent_steps_trained": 13824, "num_env_steps_sampled": 12200, "num_env_steps_trained": 13824, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 406.4634044705796, "num_env_steps_trained_throughput_per_sec": 520.2731577223418, "timesteps_total": 12200, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 24400, "timers": {"training_iteration_time_ms": 513.093, "sample_time_ms": 286.954, "load_time_ms": 0.432, "load_throughput": 592213.239, "learn_time_ms": 36.394, "learn_throughput": 7034.173, "synch_weights_time_ms": 11.075}, "counters": {"num_env_steps_sampled": 12200, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 24400, "num_agent_steps_trained": 13824, "last_target_update_ts": 12200, "num_target_updates": 54}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-08", "timestamp": 1742662568, "time_this_iter_s": 1.4937381744384766, "time_total_s": 31.446160078048706, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A650EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 31.446160078048706, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 41.45, "ram_util_percent": 90.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1885.5299778727165, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1873.4732314458872, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.397655487060547, "actor_loss": -12.41141128540039, "critic_loss": 0.5722404718399048, "alpha_loss": -0.22523538768291473, "alpha_value": 0.9833289980888367, "log_alpha_value": -0.01681155152618885, "target_entropy": -8.0, "policy_t": -0.009676503017544746, "mean_q": 7.400454998016357, "max_q": 13.043488502502441, "min_q": 4.598336696624756}, "td_error": [0.9787189960479736, 0.4628474712371826, 0.23844313621520996, 0.19892072677612305, 2.552056074142456, 1.4245860576629639, 2.5813817977905273, 1.5657598972320557, 1.8937056064605713, 2.179812431335449, 3.4757421016693115, 0.638831377029419, 1.7315423488616943, 0.6060476303100586, 2.7924623489379883, 1.6829650402069092, 1.796947956085205, 1.9225060939788818, 1.8145596981048584, 1.2444252967834473, 3.033405303955078, 1.631718397140503, 0.6010551452636719, 2.039647102355957, 0.6683650016784668, 1.8308045864105225, 3.564462661743164, 0.25128746032714844, 2.1865077018737793, 2.4476990699768066, 1.8705410957336426, 3.3959877490997314, 0.7936544418334961, 0.8759121894836426, 1.4172022342681885, 0.8022494316101074, 0.6276402473449707, 1.8598122596740723, 2.6715903282165527, 1.4377787113189697, 0.5562844276428223, 3.2862930297851562, 2.830320119857788, 2.887824535369873, 3.3132567405700684, 3.370598316192627, 1.860344409942627, 0.3703489303588867, 2.9816696643829346, 0.4865734577178955, 2.7732672691345215, 1.4679327011108398, 2.968966007232666, 2.467092514038086, 1.4576857089996338, 1.6205430030822754, 1.8832066059112549, 1.6156435012817383, 1.7074346542358398, 0.8159594535827637, 1.6078109741210938, 2.329838514328003, 0.5799498558044434, 1.0238313674926758, 2.019758701324463, 2.838700532913208, 2.3807172775268555, 1.7676265239715576, 1.7971689701080322, 1.8894052505493164, 2.207516670227051, 0.5164923667907715, 1.7011301517486572, 2.965883493423462, 2.0512595176696777, 3.007791042327881, 3.6705286502838135, 2.202572822570801, 1.6834568977355957, 0.6205863952636719, 1.365750789642334, 2.146592617034912, 1.4208111763000488, 1.8246560096740723, 3.0155272483825684, 3.079772472381592, 0.9010899066925049, 0.5389280319213867, 2.229355812072754, 0.5569210052490234, 0.5493402481079102, 0.5578410625457764, 1.8743762969970703, 1.2688817977905273, 1.6774115562438965, 2.078667640686035, 1.3155324459075928, 1.7243046760559082, 0.42832255363464355, 2.8981263637542725, 2.282548189163208, 2.2664730548858643, 2.8872687816619873, 3.631976842880249, 1.3308765888214111, 1.6297345161437988, 3.0240318775177, 2.063082695007324, 0.8353102207183838, 2.223153829574585, 0.9318325519561768, 0.6557087898254395, 2.8606252670288086, 0.8498456478118896, 0.5672996044158936, 1.7945871353149414, 3.198956251144409, 0.6078979969024658, 3.145817756652832, 2.6607251167297363, 0.44638562202453613, 0.961371660232544, 2.2859416007995605, 2.8147177696228027, 0.9206054210662842, 0.5462281703948975, 1.179635763168335, 1.48752760887146], "mean_td_error": 1.7727751731872559, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.454696655273438, "actor_loss": -12.01877212524414, "critic_loss": 0.6868546009063721, "alpha_loss": -0.2262406051158905, "alpha_value": 0.9833256006240845, "log_alpha_value": -0.01681498996913433, "target_entropy": -8.0, "policy_t": 0.018770840018987656, "mean_q": 6.785454750061035, "max_q": 11.194574356079102, "min_q": 3.1038050651550293}, "td_error": [0.9844052791595459, 3.012885093688965, 2.0474042892456055, 2.3422350883483887, 2.8319475650787354, 1.9905834197998047, 2.2075448036193848, 3.0407140254974365, 1.2701811790466309, 1.0074667930603027, 0.6913371086120605, 2.0645461082458496, 3.1772801876068115, 2.2325186729431152, 2.1940746307373047, 2.792839765548706, 2.045846700668335, 1.3987371921539307, 2.6763808727264404, 2.377640962600708, 0.5051589012145996, 0.5599029064178467, 0.7560555934906006, 0.3801913261413574, 0.4420895576477051, 3.837395191192627, 1.7869212627410889, 1.146545648574829, 1.081824779510498, 1.587500810623169, 0.8701996803283691, 0.7369489669799805, 1.8568134307861328, 1.53556489944458, 1.4039855003356934, 1.5632469654083252, 2.1406595706939697, 2.653050422668457, 2.89955472946167, 3.265911102294922, 3.0798609256744385, 0.9201450347900391, 1.3782835006713867, 1.0861845016479492, 1.6319808959960938, 3.1212518215179443, 1.3484210968017578, 3.019343376159668, 0.7718024253845215, 0.7204113006591797, 1.378312587738037, 0.3082461357116699, 1.9665756225585938, 1.237776756286621, 1.2919034957885742, 2.2938201427459717, 1.1313393115997314, 3.2933638095855713, 2.5168347358703613, 0.5355644226074219, 2.709610939025879, 1.931027889251709, 0.6426100730895996, 1.916917324066162, 1.8187894821166992, 2.061326503753662, 2.5212759971618652, 2.026193857192993, 0.555612325668335, 4.780550956726074, 2.636211395263672, 0.7083158493041992, 2.3794469833374023, 1.562256097793579, 3.3526065349578857, 2.273311138153076, 1.4377076625823975, 0.7396860122680664, 1.9337897300720215, 0.6761283874511719, 1.4595060348510742, 1.2250525951385498, 3.169187068939209, 1.9375898838043213, 2.3488898277282715, 1.8746025562286377, 0.6632101535797119, 2.3840901851654053, 2.5461833477020264, 0.6936178207397461, 2.0428473949432373, 1.3983063697814941, 2.89396071434021, 3.1340627670288086, 1.8795251846313477, 2.6085071563720703, 2.5170109272003174, 4.369052886962891, 1.5468852519989014, 1.3763065338134766, 3.5430960655212402, 2.906428337097168, 2.6750049591064453, 0.5088872909545898, 2.7402477264404297, 2.5030057430267334, 2.912419080734253, 2.8580071926116943, 0.27980518341064453, 4.4788689613342285, 1.906872272491455, 2.239314079284668, 0.4038662910461426, 2.9593522548675537, 2.9571127891540527, 1.939134120941162, 1.5309648513793945, 1.2200629711151123, 3.8415451049804688, 1.5162222385406494, 3.0483767986297607, 1.7835135459899902, 2.810230255126953, 1.9489176273345947, 2.0121407508850098, 2.7353861331939697, 3.895336866378784, 1.8160712718963623], "mean_td_error": 1.9775739908218384, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57.0, "diff_num_grad_updates_vs_sampler_policy": 56.0}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 14592, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 14592, "last_target_update_ts": 12800, "num_target_updates": 57}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3759.0032093186032, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1885.5299778727165, "robot_1": 1873.4732314458872}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1885.5299778727165, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1873.4732314458872, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7524920371435941, "mean_inference_ms": 3.386016643007375, "mean_action_processing_ms": 0.46269610868472394, "mean_env_wait_ms": 0.4675492099321712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009429454803466797, "StateBufferConnector_ms": 0.0020891427993774414, "ViewRequirementAgentConnector_ms": 0.14858345190684}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3759.0032093186032, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1885.5299778727165, "robot_1": 1873.4732314458872}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7524920371435941, "mean_inference_ms": 3.386016643007375, "mean_action_processing_ms": 0.46269610868472394, "mean_env_wait_ms": 0.4675492099321712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009429454803466797, "StateBufferConnector_ms": 0.0020891427993774414, "ViewRequirementAgentConnector_ms": 0.14858345190684}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 14592, "num_env_steps_sampled": 12800, "num_env_steps_trained": 14592, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 411.92384315226246, "num_env_steps_trained_throughput_per_sec": 527.262519234896, "timesteps_total": 12800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 509.552, "sample_time_ms": 283.69, "load_time_ms": 0.787, "load_throughput": 325435.48, "learn_time_ms": 36.149, "learn_throughput": 7081.894, "synch_weights_time_ms": 10.877}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 14592, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 14592, "last_target_update_ts": 12800, "num_target_updates": 57}, "done": false, "episodes_total": 24, "training_iteration": 25, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-09", "timestamp": 1742662569, "time_this_iter_s": 1.4717965126037598, "time_total_s": 32.917956590652466, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A774D30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 32.917956590652466, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 30.25, "ram_util_percent": 87.8}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1885.5299778727165, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1873.4732314458872, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.490038871765137, "actor_loss": -12.875758171081543, "critic_loss": 0.3542395234107971, "alpha_loss": -0.23488137125968933, "alpha_value": 0.9827392101287842, "log_alpha_value": -0.01741146668791771, "target_entropy": -8.0, "policy_t": 0.013018249534070492, "mean_q": 7.906700611114502, "max_q": 14.416123390197754, "min_q": 4.879753589630127}, "td_error": [0.46364355087280273, 1.5892252922058105, 1.5356087684631348, 2.155440092086792, 1.9842865467071533, 0.698516845703125, 0.5218944549560547, 1.8953778743743896, 1.864957332611084, 0.7705461978912354, 0.7526118755340576, 0.5111374855041504, 1.0778398513793945, 0.7823171615600586, 0.4223794937133789, 0.3925356864929199, 0.944594144821167, 1.8522872924804688, 1.6313705444335938, 1.0805387496948242, 2.1427054405212402, 0.19557762145996094, 2.434087038040161, 1.3845582008361816, 0.33178138732910156, 1.4558086395263672, 1.3001368045806885, 1.1979012489318848, 1.2441034317016602, 1.8385438919067383, 0.40895986557006836, 1.8453624248504639, 0.7835931777954102, 1.4377238750457764, 0.712862491607666, 1.4750676155090332, 1.0589535236358643, 1.8718171119689941, 1.8559308052062988, 1.4998438358306885, 0.5259592533111572, 0.7568511962890625, 2.201293468475342, 1.1262540817260742, 1.7459712028503418, 0.17330694198608398, 0.9996767044067383, 0.7064416408538818, 0.6416096687316895, 1.015944004058838, 1.200009822845459, 0.7211625576019287, 0.21531105041503906, 1.913093090057373, 1.5875120162963867, 0.5606236457824707, 3.4097707271575928, 4.132662773132324, 1.8642144203186035, 3.7644612789154053, 1.584770679473877, 0.8036537170410156, 0.7161526679992676, 2.0312938690185547, 0.024255752563476562, 1.950758934020996, 0.6818451881408691, 2.7228589057922363, 2.177743434906006, 1.2128944396972656, 0.6751265525817871, 2.5078320503234863, 1.911752700805664, 1.8152780532836914, 0.9076719284057617, 0.6071057319641113, 1.8604459762573242, 0.9288415908813477, 2.401505947113037, 0.9248449802398682, 3.0307726860046387, 1.4808919429779053, 1.0419881343841553, 2.970045328140259, 2.6701254844665527, 0.6840822696685791, 1.5660126209259033, 1.1248466968536377, 0.6423373222351074, 0.5524365901947021, 2.5527946949005127, 1.3675460815429688, 0.5595307350158691, 0.40388011932373047, 1.6552636623382568, 2.8752644062042236, 0.6927788257598877, 2.057961940765381, 0.6097044944763184, 1.4213805198669434, 1.1407670974731445, 1.864607810974121, 1.9045252799987793, 0.4216477870941162, 2.1127278804779053, 1.285348892211914, 1.1994178295135498, 1.8554270267486572, 1.471480131149292, 2.1601645946502686, 0.6039361953735352, 2.148545980453491, 1.6272928714752197, 2.1191420555114746, 1.5552582740783691, 0.7374284267425537, 0.5268261432647705, 1.2166728973388672, 2.158618450164795, 0.9037108421325684, 1.2856216430664062, 4.730820655822754, 0.8812599182128906, 2.0410680770874023, 0.2486248016357422, 0.28815650939941406, 1.739591360092163, 1.2154006958007812], "mean_td_error": 1.3946478366851807, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.462465286254883, "actor_loss": -12.691676139831543, "critic_loss": 0.5148613452911377, "alpha_loss": -0.2344549000263214, "alpha_value": 0.9827353358268738, "log_alpha_value": -0.017415450885891914, "target_entropy": -8.0, "policy_t": 0.007549779023975134, "mean_q": 7.433023452758789, "max_q": 12.936932563781738, "min_q": 3.343001365661621}, "td_error": [1.130897045135498, 2.136260747909546, 1.8433454036712646, 1.9268906116485596, 1.042348861694336, 2.2128398418426514, 0.9681434631347656, 0.8570985794067383, 2.1984670162200928, 0.5145251750946045, 2.2476871013641357, 2.18916654586792, 1.500443935394287, 3.0213141441345215, 0.6415114402770996, 3.8653385639190674, 2.0831480026245117, 0.6274712085723877, 1.0807421207427979, 2.9092161655426025, 0.5122919082641602, 0.7859470844268799, 2.476137638092041, 0.8783869743347168, 2.262486219406128, 1.7547247409820557, 0.7541007995605469, 0.7265515327453613, 2.332782745361328, 0.9928367137908936, 1.561389446258545, 1.3902950286865234, 1.606039047241211, 0.3650240898132324, 1.1612069606781006, 0.6622693538665771, 2.430685043334961, 0.706568717956543, 0.8997721672058105, 1.1568453311920166, 1.9413647651672363, 4.757196426391602, 2.374556541442871, 1.7569425106048584, 1.7005481719970703, 0.23908042907714844, 2.1458029747009277, 0.9322788715362549, 0.29643726348876953, 0.5286412239074707, 1.2614243030548096, 1.598555326461792, 2.943286895751953, 2.7925641536712646, 2.27644419670105, 0.9727330207824707, 1.378507375717163, 1.930307149887085, 2.166477918624878, 2.094182014465332, 2.0748214721679688, 1.0526840686798096, 3.097872018814087, 2.11016845703125, 1.455880880355835, 2.455033302307129, 1.4541599750518799, 1.8309364318847656, 1.2130134105682373, 1.8173243999481201, 0.548487663269043, 2.760960817337036, 2.4550564289093018, 2.454240083694458, 1.5579161643981934, 2.27514910697937, 0.34900474548339844, 1.111973524093628, 1.4976327419281006, 1.8550891876220703, 0.9877843856811523, 1.281815528869629, 0.3793039321899414, 2.8608384132385254, 2.114835262298584, 0.3308730125427246, 0.3140983581542969, 0.8754618167877197, 1.6881256103515625, 0.4776172637939453, 0.5621986389160156, 1.4200901985168457, 2.894876003265381, 0.6976017951965332, 1.3711917400360107, 0.23599529266357422, 1.3410420417785645, 2.191534996032715, 2.600147008895874, 1.0144832134246826, 0.5725855827331543, 2.1596906185150146, 0.6335794925689697, 1.9553353786468506, 1.9213581085205078, 0.5269670486450195, 0.34608960151672363, 1.1073415279388428, 0.8626315593719482, 0.10274219512939453, 2.077322244644165, 1.0865590572357178, 1.317967414855957, 0.7097012996673584, 1.6228325366973877, 0.5664973258972168, 0.5869734287261963, 1.7797937393188477, 2.3655972480773926, 2.5294153690338135, 2.0789570808410645, 1.1623220443725586, 2.8056135177612305, 0.9456009864807129, 1.368422031402588, 0.10742807388305664, 1.4571609497070312, 1.3908846378326416], "mean_td_error": 1.5134000778198242, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 13200, "num_env_steps_trained": 15104, "num_agent_steps_sampled": 26400, "num_agent_steps_trained": 15104, "last_target_update_ts": 13200, "num_target_updates": 59}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3759.0032093186032, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1885.5299778727165, "robot_1": 1873.4732314458872}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1885.5299778727165, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1873.4732314458872, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7524920371435941, "mean_inference_ms": 3.386016643007375, "mean_action_processing_ms": 0.46269610868472394, "mean_env_wait_ms": 0.4675492099321712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009429454803466797, "StateBufferConnector_ms": 0.0020891427993774414, "ViewRequirementAgentConnector_ms": 0.14858345190684}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3759.0032093186032, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1885.5299778727165, "robot_1": 1873.4732314458872}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7524920371435941, "mean_inference_ms": 3.386016643007375, "mean_action_processing_ms": 0.46269610868472394, "mean_env_wait_ms": 0.4675492099321712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009429454803466797, "StateBufferConnector_ms": 0.0020891427993774414, "ViewRequirementAgentConnector_ms": 0.14858345190684}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26400, "num_agent_steps_trained": 15104, "num_env_steps_sampled": 13200, "num_env_steps_trained": 15104, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 384.4412486377339, "num_env_steps_trained_throughput_per_sec": 492.0847982562994, "timesteps_total": 13200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26400, "timers": {"training_iteration_time_ms": 499.892, "sample_time_ms": 276.299, "load_time_ms": 0.782, "load_throughput": 327350.332, "learn_time_ms": 36.042, "learn_throughput": 7102.858, "synch_weights_time_ms": 10.847}, "counters": {"num_env_steps_sampled": 13200, "num_env_steps_trained": 15104, "num_agent_steps_sampled": 26400, "num_agent_steps_trained": 15104, "last_target_update_ts": 13200, "num_target_updates": 59}, "done": false, "episodes_total": 24, "training_iteration": 26, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-10", "timestamp": 1742662570, "time_this_iter_s": 1.0588953495025635, "time_total_s": 33.97685194015503, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7741F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 33.97685194015503, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 32.15, "ram_util_percent": 87.85}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1885.5299778727165, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1873.4732314458872, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.42840576171875, "actor_loss": -13.466337203979492, "critic_loss": 0.334331214427948, "alpha_loss": -0.24186530709266663, "alpha_value": 0.9821497797966003, "log_alpha_value": -0.018011469393968582, "target_entropy": -8.0, "policy_t": -0.0007707122713327408, "mean_q": 8.417201042175293, "max_q": 14.832271575927734, "min_q": 5.628521919250488}, "td_error": [0.685842752456665, 1.3295831680297852, 0.6363451480865479, 0.3725142478942871, 3.433096408843994, 1.6452176570892334, 1.3943829536437988, 1.9490447044372559, 3.3577370643615723, 3.1123228073120117, 0.44637227058410645, 0.3511686325073242, 4.354406833648682, 1.0513203144073486, 0.3689126968383789, 1.2779037952423096, 1.1102545261383057, 0.9298989772796631, 0.3412508964538574, 2.370821952819824, 1.2775795459747314, 0.3599674701690674, 1.6682624816894531, 1.1208164691925049, 0.8495917320251465, 0.5220913887023926, 1.557305097579956, 1.620363473892212, 0.1425180435180664, 2.8115992546081543, 0.8512985706329346, 1.7061755657196045, 0.42749834060668945, 4.148062705993652, 0.5703213214874268, 0.4432344436645508, 0.7530303001403809, 1.2076647281646729, 4.911993026733398, 1.3491363525390625, 1.8995366096496582, 1.9166314601898193, 0.49967336654663086, 3.562242031097412, 2.4207067489624023, 1.4849576950073242, 0.875084400177002, 1.7216472625732422, 1.6723599433898926, 0.7946641445159912, 1.39312744140625, 1.2459661960601807, 0.02733755111694336, 1.5356173515319824, 1.415694236755371, 0.48874855041503906, 0.5794949531555176, 1.2699639797210693, 0.775665283203125, 0.7787106037139893, 2.703596830368042, 2.626652240753174, 1.3599746227264404, 0.47006750106811523, 0.9929008483886719, 3.2558064460754395, 1.391108751296997, 0.7586498260498047, 0.6166565418243408, 0.7311069965362549, 0.2174513339996338, 1.1897926330566406, 0.3564109802246094, 0.6290030479431152, 1.9848508834838867, 0.9238753318786621, 0.7449784278869629, 1.6516599655151367, 0.4028627872467041, 0.5301899909973145, 1.6174306869506836, 1.6110308170318604, 0.6527161598205566, 1.2211005687713623, 0.3934197425842285, 1.0297694206237793, 0.18791437149047852, 3.069902181625366, 1.46856689453125, 1.6192498207092285, 2.7950782775878906, 0.8181889057159424, 0.3281736373901367, 0.8701653480529785, 1.5836248397827148, 0.53647780418396, 1.19169020652771, 1.7018890380859375, 0.40174388885498047, 0.42516136169433594, 0.08775663375854492, 0.6493911743164062, 0.368304967880249, 0.9863247871398926, 0.8792538642883301, 0.49199676513671875, 2.173487663269043, 2.2733588218688965, 1.1585338115692139, 1.4746651649475098, 2.551537036895752, 2.2646496295928955, 0.197922945022583, 2.105236053466797, 3.824110507965088, 0.911412239074707, 0.9124891757965088, 3.580549955368042, 0.6010117530822754, 3.2545456886291504, 0.47240519523620605, 0.18751788139343262, 0.5479598045349121, 0.9010195732116699, 0.8453843593597412, 1.7414171695709229, 3.684028148651123, 3.4269320964813232], "mean_td_error": 1.3655376434326172, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.433416366577148, "actor_loss": -13.228614807128906, "critic_loss": 0.3511407971382141, "alpha_loss": -0.2420141100883484, "alpha_value": 0.9821454882621765, "log_alpha_value": -0.018015826120972633, "target_entropy": -8.0, "policy_t": 0.017849840223789215, "mean_q": 8.058576583862305, "max_q": 14.313741683959961, "min_q": 5.563872814178467}, "td_error": [0.9677653312683105, 0.36621809005737305, 1.991835594177246, 0.43039631843566895, 1.1455087661743164, 0.7936654090881348, 1.0025551319122314, 0.8221983909606934, 0.8480198383331299, 2.409827709197998, 1.7571830749511719, 1.116952896118164, 1.1731348037719727, 1.3566699028015137, 1.1168897151947021, 1.0999348163604736, 1.7267138957977295, 1.3600616455078125, 0.5116546154022217, 0.2632334232330322, 1.219590187072754, 1.628783941268921, 1.8215107917785645, 0.6066241264343262, 0.8968672752380371, 0.5054464340209961, 2.1944355964660645, 1.777850866317749, 1.0215930938720703, 0.6852664947509766, 0.16075420379638672, 2.1032485961914062, 1.6594223976135254, 0.516221284866333, 0.8279991149902344, 1.3348166942596436, 1.8261206150054932, 2.651702404022217, 3.714907646179199, 1.4681978225708008, 0.6026196479797363, 1.3945348262786865, 0.7925360202789307, 1.5387663841247559, 0.2018136978149414, 0.29386091232299805, 1.4483206272125244, 3.4598259925842285, 1.3142685890197754, 1.3596880435943604, 0.3238534927368164, 1.7117204666137695, 0.4985201358795166, 1.8229100704193115, 2.1290948390960693, 0.7976858615875244, 0.5852775573730469, 0.4814281463623047, 0.6130552291870117, 0.2927861213684082, 1.2418739795684814, 1.9232518672943115, 0.2845907211303711, 0.5318984985351562, 0.7502360343933105, 3.3982224464416504, 1.538320541381836, 4.840134143829346, 1.0054597854614258, 1.8113844394683838, 0.42544078826904297, 0.4278745651245117, 1.2570791244506836, 1.131105899810791, 0.9070494174957275, 0.859987735748291, 1.02534818649292, 1.2804954051971436, 0.5775046348571777, 0.8197183609008789, 0.6879549026489258, 1.769681453704834, 0.50455641746521, 0.8556993007659912, 0.29668259620666504, 1.135026454925537, 2.0698959827423096, 0.6567025184631348, 0.525235652923584, 1.508387565612793, 2.877046823501587, 1.9219183921813965, 1.0494744777679443, 2.2528769969940186, 0.9724342823028564, 1.8952267169952393, 0.4611485004425049, 0.482252836227417, 1.9151980876922607, 0.8391685485839844, 1.8844783306121826, 0.1348114013671875, 1.7371876239776611, 0.28712892532348633, 0.36319494247436523, 0.8699772357940674, 1.3842008113861084, 1.5538125038146973, 0.6075758934020996, 2.9139795303344727, 3.6129584312438965, 0.798419713973999, 1.0638031959533691, 0.6805984973907471, 2.8335728645324707, 0.4060544967651367, 2.9257333278656006, 0.31581640243530273, 0.5796217918395996, 0.5917019844055176, 1.1477904319763184, 1.851883888244629, 2.109203815460205, 0.6097366809844971, 0.4517323970794678, 0.9191315174102783, 1.8879988193511963, 1.6383583545684814], "mean_td_error": 1.2454558610916138, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 60.0}}, "num_env_steps_sampled": 13600, "num_env_steps_trained": 15616, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 15616, "last_target_update_ts": 13600, "num_target_updates": 61}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3759.0032093186032, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1885.5299778727165, "robot_1": 1873.4732314458872}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1885.5299778727165, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1873.4732314458872, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7524920371435941, "mean_inference_ms": 3.386016643007375, "mean_action_processing_ms": 0.46269610868472394, "mean_env_wait_ms": 0.4675492099321712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009429454803466797, "StateBufferConnector_ms": 0.0020891427993774414, "ViewRequirementAgentConnector_ms": 0.14858345190684}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3759.0032093186032, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1885.5299778727165, "robot_1": 1873.4732314458872}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7524920371435941, "mean_inference_ms": 3.386016643007375, "mean_action_processing_ms": 0.46269610868472394, "mean_env_wait_ms": 0.4675492099321712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009429454803466797, "StateBufferConnector_ms": 0.0020891427993774414, "ViewRequirementAgentConnector_ms": 0.14858345190684}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 15616, "num_env_steps_sampled": 13600, "num_env_steps_trained": 15616, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 353.3961252679084, "num_env_steps_trained_throughput_per_sec": 452.34704034292275, "timesteps_total": 13600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27200, "timers": {"training_iteration_time_ms": 510.356, "sample_time_ms": 282.673, "load_time_ms": 0.827, "load_throughput": 309578.429, "learn_time_ms": 36.198, "learn_throughput": 7072.219, "synch_weights_time_ms": 11.161}, "counters": {"num_env_steps_sampled": 13600, "num_env_steps_trained": 15616, "num_agent_steps_sampled": 27200, "num_agent_steps_trained": 15616, "last_target_update_ts": 13600, "num_target_updates": 61}, "done": false, "episodes_total": 24, "training_iteration": 27, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-12", "timestamp": 1742662572, "time_this_iter_s": 1.1477491855621338, "time_total_s": 35.12460112571716, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A650EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 35.12460112571716, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 35.45, "ram_util_percent": 88.30000000000001}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1879.6434351378723, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1863.4998445040133, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.481334686279297, "actor_loss": -14.239355087280273, "critic_loss": 0.339313805103302, "alpha_loss": -0.2509046792984009, "alpha_value": 0.9815608859062195, "log_alpha_value": -0.01861126534640789, "target_entropy": -8.0, "policy_t": -0.01390083972364664, "mean_q": 9.211807250976562, "max_q": 14.89306640625, "min_q": 5.532217979431152}, "td_error": [0.44582414627075195, 4.904873371124268, 0.20718765258789062, 0.6155774593353271, 2.9937233924865723, 1.1306843757629395, 1.277982234954834, 0.6144838333129883, 2.2188518047332764, 1.4184684753417969, 1.5717582702636719, 0.5744552612304688, 1.0088045597076416, 0.6217923164367676, 0.443634033203125, 0.5126283168792725, 0.5002124309539795, 0.8462960720062256, 2.762427806854248, 1.2898149490356445, 0.8265421390533447, 1.2234508991241455, 1.4421782493591309, 0.46231722831726074, 1.2790298461914062, 0.4797072410583496, 2.148423433303833, 1.5890636444091797, 0.22205638885498047, 3.389146327972412, 2.1510367393493652, 1.259079933166504, 0.33307671546936035, 0.5750870704650879, 1.4899406433105469, 0.966576337814331, 0.12190818786621094, 0.6304876804351807, 1.6559300422668457, 0.413013219833374, 3.163015842437744, 3.123537063598633, 2.7122955322265625, 2.9787745475769043, 4.548582077026367, 0.609224796295166, 1.6968529224395752, 2.0278425216674805, 0.2930178642272949, 1.6032261848449707, 1.438227653503418, 0.3323402404785156, 0.20459985733032227, 2.5160133838653564, 2.534696102142334, 0.9200167655944824, 0.21135568618774414, 0.20432758331298828, 0.5892643928527832, 1.3862180709838867, 3.1713204383850098, 0.4937565326690674, 2.1834917068481445, 0.48599863052368164, 0.7102723121643066, 0.7592723369598389, 0.6032052040100098, 1.6135601997375488, 4.081050395965576, 2.976639747619629, 0.7071573734283447, 3.3401904106140137, 5.8674516677856445, 0.19313716888427734, 0.4582233428955078, 1.7432684898376465, 4.998519420623779, 2.6110029220581055, 1.8529071807861328, 0.4113433361053467, 1.9434313774108887, 0.6929597854614258, 0.9149386882781982, 0.3007354736328125, 2.1064157485961914, 2.191159963607788, 2.191507339477539, 0.2504434585571289, 0.885490894317627, 0.6847128868103027, 1.1663002967834473, 0.17187738418579102, 2.3135833740234375, 2.2765111923217773, 0.9846305847167969, 0.631770133972168, 0.33153867721557617, 1.3851139545440674, 1.968928337097168, 0.2557051181793213, 0.6324951648712158, 0.5916886329650879, 0.17309045791625977, 0.3426523208618164, 0.3594691753387451, 4.222617149353027, 3.030367374420166, 0.5575613975524902, 0.8698329925537109, 1.537902593612671, 1.2211816310882568, 2.6573376655578613, 1.297257900238037, 0.4000663757324219, 1.0885138511657715, 1.2032947540283203, 1.1337883472442627, 0.8945250511169434, 0.6334667205810547, 0.5305747985839844, 0.2692134380340576, 4.130977630615234, 0.4895915985107422, 3.0342164039611816, 0.8376584053039551, 1.4497671127319336, 1.3450758457183838, 0.2964797019958496], "mean_td_error": 1.4050871133804321, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.407703399658203, "actor_loss": -13.85633659362793, "critic_loss": 0.44735121726989746, "alpha_loss": -0.2495979517698288, "alpha_value": 0.9815561771392822, "log_alpha_value": -0.01861600950360298, "target_entropy": -8.0, "policy_t": -0.026862649247050285, "mean_q": 8.795693397521973, "max_q": 14.208396911621094, "min_q": 5.468894958496094}, "td_error": [5.396991729736328, 0.5538668632507324, 0.8295555114746094, 1.7092196941375732, 0.8241291046142578, 0.22271347045898438, 2.79531192779541, 1.357421875, 3.99367094039917, 1.7610142230987549, 0.6826262474060059, 1.7024657726287842, 1.8194851875305176, 0.4394345283508301, 4.3434367179870605, 0.2404952049255371, 0.04097175598144531, 0.7453842163085938, 1.7438225746154785, 0.8101615905761719, 0.43369245529174805, 0.9008779525756836, 0.6681156158447266, 3.0238447189331055, 1.4646546840667725, 0.6010189056396484, 1.0616264343261719, 0.8480062484741211, 2.611067771911621, 3.2209787368774414, 2.549903392791748, 0.4065089225769043, 0.28871965408325195, 0.8437771797180176, 0.45921850204467773, 0.5259699821472168, 0.6516623497009277, 0.7205543518066406, 1.2586348056793213, 0.4172401428222656, 1.510387897491455, 1.190241813659668, 3.532193660736084, 0.16200637817382812, 1.4830658435821533, 1.1305162906646729, 3.972961902618408, 1.4418535232543945, 0.8444933891296387, 0.17160606384277344, 4.559112071990967, 2.097759962081909, 1.3698205947875977, 3.684110641479492, 3.855438709259033, 0.34477806091308594, 2.1051769256591797, 3.4630608558654785, 0.43465614318847656, 1.274139642715454, 0.26471805572509766, 1.4900050163269043, 0.6050271987915039, 0.8630955219268799, 0.36318445205688477, 0.49300575256347656, 2.9323928356170654, 0.5587081909179688, 2.2359778881073, 0.4350247383117676, 1.4163222312927246, 1.786207914352417, 0.5281326770782471, 0.20014142990112305, 4.183223724365234, 1.4128453731536865, 0.34035778045654297, 2.8469295501708984, 1.2129333019256592, 0.5950231552124023, 0.5924966335296631, 1.2811949253082275, 2.8200955390930176, 0.5423314571380615, 0.6498947143554688, 0.5466346740722656, 2.725724697113037, 1.1669769287109375, 0.29701805114746094, 1.1364316940307617, 0.3022470474243164, 0.668306827545166, 1.5033793449401855, 2.0672945976257324, 1.658449649810791, 0.91965651512146, 1.1213338375091553, 2.9673500061035156, 1.0676655769348145, 0.478055477142334, 0.7160778045654297, 1.7766151428222656, 1.998600721359253, 1.0878839492797852, 2.900930881500244, 2.5970652103424072, 0.6261277198791504, 0.5031352043151855, 0.479189395904541, 1.3165078163146973, 0.14158344268798828, 0.24310779571533203, 0.20505118370056152, 0.7298088073730469, 0.6331996917724609, 2.5081214904785156, 1.0431246757507324, 2.1970248222351074, 2.3116140365600586, 0.1749281883239746, 0.6454682350158691, 0.7346806526184082, 1.690253734588623, 1.5361285209655762, 1.057748556137085, 1.7208929061889648, 2.0785598754882812, 0.5895843505859375], "mean_td_error": 1.3837065696716309, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 16128, "last_target_update_ts": 14000, "num_target_updates": 63}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3743.1432796418853, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1879.6434351378723, "robot_1": 1863.4998445040133}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1879.6434351378723, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1863.4998445040133, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7523365845222623, "mean_inference_ms": 3.3858449503280648, "mean_action_processing_ms": 0.4620953907992965, "mean_env_wait_ms": 0.4669264743746205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00986840043749128, "StateBufferConnector_ms": 0.0017906938280378068, "ViewRequirementAgentConnector_ms": 0.14702592577253068}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3743.1432796418853, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1879.6434351378723, "robot_1": 1863.4998445040133}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7523365845222623, "mean_inference_ms": 3.3858449503280648, "mean_action_processing_ms": 0.4620953907992965, "mean_env_wait_ms": 0.4669264743746205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00986840043749128, "StateBufferConnector_ms": 0.0017906938280378068, "ViewRequirementAgentConnector_ms": 0.14702592577253068}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 16128, "num_env_steps_sampled": 14000, "num_env_steps_trained": 16128, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 391.21107381008846, "num_env_steps_trained_throughput_per_sec": 500.7501744769132, "timesteps_total": 14000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 513.559, "sample_time_ms": 283.431, "load_time_ms": 0.726, "load_throughput": 352798.365, "learn_time_ms": 36.39, "learn_throughput": 7034.961, "synch_weights_time_ms": 11.319}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 16128, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 16128, "last_target_update_ts": 14000, "num_target_updates": 63}, "done": false, "episodes_total": 28, "training_iteration": 28, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-13", "timestamp": 1742662573, "time_this_iter_s": 1.1082892417907715, "time_total_s": 36.232890367507935, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7DADC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 36.232890367507935, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.7, "ram_util_percent": 88.5}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1879.6434351378723, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1863.4998445040133, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.39495849609375, "actor_loss": -14.09478759765625, "critic_loss": 0.2816670835018158, "alpha_loss": -0.2613501250743866, "alpha_value": 0.9806780219078064, "log_alpha_value": -0.019511081278324127, "target_entropy": -8.0, "policy_t": -0.012184247374534607, "mean_q": 9.108848571777344, "max_q": 17.340150833129883, "min_q": 5.3670549392700195}, "td_error": [0.4790620803833008, 1.1263442039489746, 1.6887187957763672, 1.1499991416931152, 0.26737308502197266, 0.39394521713256836, 0.878443717956543, 0.7742202281951904, 1.4628558158874512, 0.9844777584075928, 0.8115391731262207, 0.5454001426696777, 0.8761193752288818, 1.4718594551086426, 1.0055227279663086, 3.2833242416381836, 0.28214216232299805, 0.45754241943359375, 1.0276360511779785, 0.7289352416992188, 0.47615933418273926, 1.2992072105407715, 1.8999693393707275, 1.341435432434082, 0.42351698875427246, 4.121682167053223, 0.609421968460083, 0.5734295845031738, 0.42002105712890625, 2.0538644790649414, 0.3603043556213379, 1.5670843124389648, 0.10481405258178711, 0.3514065742492676, 0.10928773880004883, 0.3438277244567871, 1.8760342597961426, 2.937131881713867, 1.8027088642120361, 0.2783927917480469, 0.830721378326416, 0.6890816688537598, 1.0325160026550293, 0.48543405532836914, 0.851661205291748, 1.96946382522583, 7.20147705078125, 0.4463005065917969, 0.6223812103271484, 0.5747170448303223, 1.0119028091430664, 2.8094425201416016, 0.7949919700622559, 0.7137002944946289, 2.715925693511963, 0.634087085723877, 1.395458698272705, 0.9509658813476562, 1.267685890197754, 1.8455212116241455, 0.8780426979064941, 0.8449347019195557, 0.4380779266357422, 0.4010927677154541, 0.39391040802001953, 0.996544361114502, 1.141031265258789, 0.21878290176391602, 0.1427617073059082, 0.9518766403198242, 0.8302264213562012, 1.6853151321411133, 0.496168851852417, 1.4974772930145264, 0.7042570114135742, 0.9198298454284668, 0.9193100929260254, 0.9083285331726074, 0.7639226913452148, 5.6079020500183105, 1.7707023620605469, 0.5563168525695801, 2.3490047454833984, 0.42606019973754883, 1.835592269897461, 0.839501142501831, 0.9803354740142822, 0.9918007850646973, 0.7473983764648438, 0.6824989318847656, 3.6331634521484375, 1.1007461547851562, 0.38669490814208984, 0.8546280860900879, 0.6710195541381836, 1.4891812801361084, 0.8654313087463379, 1.061924934387207, 0.5448315143585205, 0.9202260971069336, 1.200275182723999, 1.94032621383667, 2.1147844791412354, 0.35517120361328125, 2.3405776023864746, 0.924687385559082, 1.7130069732666016, 4.91330623626709, 0.9221620559692383, 0.8303191661834717, 0.04768872261047363, 2.260608196258545, 1.2549233436584473, 1.4954910278320312, 0.9030542373657227, 0.6071443557739258, 1.0858936309814453, 0.6174659729003906, 0.5287175178527832, 0.5410811901092529, 0.5151615142822266, 2.354097366333008, 0.26979541778564453, 0.9328198432922363, 1.049403190612793, 2.603848457336426, 2.5663108825683594, 0.5049467086791992], "mean_td_error": 1.1900664567947388, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.48119831085205, "actor_loss": -14.249500274658203, "critic_loss": 0.35478293895721436, "alpha_loss": -0.2630949318408966, "alpha_value": 0.9806734919548035, "log_alpha_value": -0.019515693187713623, "target_entropy": -8.0, "policy_t": -0.018810894340276718, "mean_q": 9.18083381652832, "max_q": 15.678702354431152, "min_q": 6.434326648712158}, "td_error": [4.408504486083984, 0.33489322662353516, 4.146148204803467, 0.326444149017334, 0.8959360122680664, 5.913168907165527, 4.646631717681885, 2.1896324157714844, 0.2986011505126953, 0.10946464538574219, 0.11756038665771484, 3.553342342376709, 0.2974388599395752, 0.6602268218994141, 1.3835866451263428, 0.5646233558654785, 0.44650721549987793, 0.43734121322631836, 0.04552602767944336, 0.9714605808258057, 0.725743293762207, 1.0126709938049316, 2.0236778259277344, 0.3070220947265625, 2.01123309135437, 0.48078036308288574, 0.3177461624145508, 2.0646514892578125, 0.8996315002441406, 0.42913818359375, 1.256833553314209, 2.2653393745422363, 1.1693792343139648, 0.20059967041015625, 0.5622148513793945, 1.7449889183044434, 0.9713449478149414, 0.9689197540283203, 0.9977760314941406, 1.7876501083374023, 0.7493405342102051, 0.23368072509765625, 0.8876774311065674, 0.7307748794555664, 1.280919075012207, 0.8608267307281494, 1.7248919010162354, 5.556689262390137, 1.5472357273101807, 3.1720409393310547, 2.6101016998291016, 0.7030510902404785, 0.5125322341918945, 0.7897324562072754, 0.43125391006469727, 1.5230255126953125, 2.525878429412842, 1.3390307426452637, 0.3009662628173828, 0.3928098678588867, 1.125662088394165, 0.9874114990234375, 1.915308952331543, 0.8197450637817383, 1.144874095916748, 1.251051425933838, 0.5175535678863525, 0.2419905662536621, 1.0017073154449463, 2.2650299072265625, 1.243901252746582, 1.4345967769622803, 0.5167942047119141, 1.7583789825439453, 0.34067821502685547, 0.756913423538208, 2.4928836822509766, 0.5778193473815918, 0.8772950172424316, 0.3071155548095703, 1.0640454292297363, 0.7291173934936523, 0.8262300491333008, 0.8056304454803467, 0.8088765144348145, 1.1125574111938477, 0.574918270111084, 0.4835498332977295, 0.07596874237060547, 1.7523961067199707, 0.40901708602905273, 1.6947627067565918, 1.0136387348175049, 0.3938627243041992, 0.9856662750244141, 0.7177000045776367, 1.6314306259155273, 1.7719693183898926, 0.4778881072998047, 0.4428670406341553, 1.579869270324707, 0.09894657135009766, 3.214533805847168, 0.21395492553710938, 1.466517448425293, 0.7013716697692871, 1.6079704761505127, 1.8305435180664062, 0.1341552734375, 0.8090782165527344, 0.909174919128418, 1.8315253257751465, 1.0903892517089844, 2.3648810386657715, 1.1527175903320312, 0.7829952239990234, 1.6320815086364746, 0.888145923614502, 1.1709303855895996, 1.2319800853729248, 0.39995431900024414, 1.7603378295898438, 0.7452404499053955, 4.19101095199585, 2.7844114303588867, 0.48752832412719727, 5.062201976776123, 1.1653711795806885], "mean_td_error": 1.2693239450454712, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 65.0}}, "num_env_steps_sampled": 14600, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 29200, "num_agent_steps_trained": 16896, "last_target_update_ts": 14600, "num_target_updates": 66}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3743.1432796418853, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1879.6434351378723, "robot_1": 1863.4998445040133}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1879.6434351378723, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1863.4998445040133, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7523365845222623, "mean_inference_ms": 3.3858449503280648, "mean_action_processing_ms": 0.4620953907992965, "mean_env_wait_ms": 0.4669264743746205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00986840043749128, "StateBufferConnector_ms": 0.0017906938280378068, "ViewRequirementAgentConnector_ms": 0.14702592577253068}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3743.1432796418853, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1879.6434351378723, "robot_1": 1863.4998445040133}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7523365845222623, "mean_inference_ms": 3.3858449503280648, "mean_action_processing_ms": 0.4620953907992965, "mean_env_wait_ms": 0.4669264743746205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00986840043749128, "StateBufferConnector_ms": 0.0017906938280378068, "ViewRequirementAgentConnector_ms": 0.14702592577253068}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29200, "num_agent_steps_trained": 16896, "num_env_steps_sampled": 14600, "num_env_steps_trained": 16896, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 405.1268561736478, "num_env_steps_trained_throughput_per_sec": 518.5623759022692, "timesteps_total": 14600, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 29200, "timers": {"training_iteration_time_ms": 517.19, "sample_time_ms": 286.53, "load_time_ms": 0.627, "load_throughput": 408220.288, "learn_time_ms": 36.621, "learn_throughput": 6990.429, "synch_weights_time_ms": 11.32}, "counters": {"num_env_steps_sampled": 14600, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 29200, "num_agent_steps_trained": 16896, "last_target_update_ts": 14600, "num_target_updates": 66}, "done": false, "episodes_total": 28, "training_iteration": 29, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-14", "timestamp": 1742662574, "time_this_iter_s": 1.504847764968872, "time_total_s": 37.73773813247681, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7DAD30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 37.73773813247681, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.36666666666667, "ram_util_percent": 88.63333333333333}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1879.6434351378723, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1863.4998445040133, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.425809860229492, "actor_loss": -14.549348831176758, "critic_loss": 0.3707590401172638, "alpha_loss": -0.2700023353099823, "alpha_value": 0.9800902009010315, "log_alpha_value": -0.02011069469153881, "target_entropy": -8.0, "policy_t": -0.01571802608668804, "mean_q": 9.598977088928223, "max_q": 17.03854751586914, "min_q": 6.2514142990112305}, "td_error": [1.1885361671447754, 0.5264174938201904, 0.4081549644470215, 0.931265115737915, 1.422879695892334, 1.3067948818206787, 0.4935183525085449, 0.7802083492279053, 3.030381679534912, 2.793393611907959, 1.026801586151123, 1.2068424224853516, 0.811699628829956, 0.9356040954589844, 2.163233757019043, 0.2666959762573242, 4.422072410583496, 0.26093363761901855, 0.39732813835144043, 2.422183036804199, 0.339200496673584, 0.30259227752685547, 1.7466444969177246, 4.039066314697266, 0.7026877403259277, 0.45201730728149414, 1.5707883834838867, 2.9160518646240234, 1.4416756629943848, 2.513772487640381, 1.8021974563598633, 0.6175894737243652, 0.14166688919067383, 2.9122443199157715, 4.32594108581543, 1.0841050148010254, 0.7398321628570557, 0.2502098083496094, 1.5082035064697266, 1.2774736881256104, 0.1857919692993164, 7.397793769836426, 1.2267234325408936, 0.45684146881103516, 1.5351688861846924, 1.1857836246490479, 0.1490795612335205, 1.19572114944458, 0.6350498199462891, 2.620084762573242, 0.5513334274291992, 0.521181583404541, 2.7279610633850098, 1.1618938446044922, 1.26259183883667, 0.3955647945404053, 2.226757287979126, 2.4778003692626953, 0.7997918128967285, 0.766045093536377, 0.17174673080444336, 4.029665946960449, 0.40311670303344727, 5.228105545043945, 1.3804378509521484, 0.3630080223083496, 0.573451042175293, 4.074655055999756, 1.807469367980957, 0.11656808853149414, 0.6467454433441162, 0.3596973419189453, 0.708961009979248, 1.7737350463867188, 0.8178956508636475, 3.3718504905700684, 3.1561989784240723, 1.3978815078735352, 5.166945457458496, 0.8733186721801758, 0.987917423248291, 0.377910852432251, 1.6156387329101562, 0.15574383735656738, 2.5163745880126953, 2.409694194793701, 0.44427967071533203, 1.961461067199707, 0.8030390739440918, 1.7686872482299805, 0.6461749076843262, 0.9840860366821289, 2.868722438812256, 1.0142779350280762, 0.9544696807861328, 0.8594155311584473, 1.2095661163330078, 3.0779385566711426, 0.37888193130493164, 0.7688660621643066, 1.7224102020263672, 1.0943374633789062, 0.4748411178588867, 2.195080280303955, 0.5863919258117676, 0.31006288528442383, 1.4731378555297852, 1.4034228324890137, 1.3011374473571777, 0.12438464164733887, 1.2671635150909424, 0.5749349594116211, 4.22175931930542, 1.2871217727661133, 0.43526506423950195, 1.4380388259887695, 1.0557904243469238, 0.7598445415496826, 1.5362138748168945, 3.2084832191467285, 0.5531001091003418, 2.7056632041931152, 1.9366166591644287, 1.2455615997314453, 0.28252363204956055, 0.6914467811584473, 3.4880480766296387, 0.5445284843444824], "mean_td_error": 1.461717128753662, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.358282089233398, "actor_loss": -14.538140296936035, "critic_loss": 0.38061439990997314, "alpha_loss": -0.2687090337276459, "alpha_value": 0.9800854325294495, "log_alpha_value": -0.02011553943157196, "target_entropy": -8.0, "policy_t": -0.02811373583972454, "mean_q": 9.384099960327148, "max_q": 15.375237464904785, "min_q": 6.5524492263793945}, "td_error": [2.0249290466308594, 1.626418113708496, 0.6690070629119873, 0.765625, 1.3222029209136963, 0.4927859306335449, 0.44152069091796875, 1.5894713401794434, 1.3593764305114746, 5.2847394943237305, 0.1064915657043457, 0.894923210144043, 0.39009523391723633, 0.24077510833740234, 5.330530643463135, 1.1083965301513672, 0.666234016418457, 0.9609360694885254, 5.361547946929932, 0.9632515907287598, 0.315828800201416, 0.3924596309661865, 4.542530536651611, 0.8597230911254883, 2.7368993759155273, 2.230403423309326, 1.7872567176818848, 2.6097092628479004, 0.5076498985290527, 0.09762954711914062, 3.496267795562744, 0.6676092147827148, 0.3726482391357422, 3.5171284675598145, 0.008871078491210938, 0.8423151969909668, 0.496859073638916, 0.39685726165771484, 0.3716416358947754, 0.24483013153076172, 0.29279422760009766, 0.38324427604675293, 0.8413686752319336, 3.0576891899108887, 0.32314109802246094, 0.6918418407440186, 5.10754919052124, 4.991731643676758, 1.3060622215270996, 0.4398527145385742, 1.6265201568603516, 3.230043888092041, 1.1217341423034668, 1.335226058959961, 0.37468576431274414, 1.940934181213379, 2.6568603515625, 1.6846518516540527, 1.9376535415649414, 0.6020960807800293, 0.11131525039672852, 0.9374349117279053, 1.7919020652770996, 0.35304689407348633, 0.47608423233032227, 0.7125425338745117, 1.8905935287475586, 0.37341737747192383, 1.8126287460327148, 0.6297764778137207, 0.7957968711853027, 0.7744622230529785, 1.0825848579406738, 2.5547633171081543, 0.9088363647460938, 1.5868017673492432, 2.5219533443450928, 1.3047263622283936, 1.066601276397705, 1.1911768913269043, 0.807955265045166, 4.060767650604248, 0.7060418128967285, 0.5134906768798828, 1.036698341369629, 2.5552639961242676, 0.4277210235595703, 0.844841480255127, 1.6376352310180664, 5.2971954345703125, 0.1559467315673828, 0.5749015808105469, 1.575648307800293, 0.6517457962036133, 0.4988875389099121, 0.8730916976928711, 1.8891100883483887, 2.443115711212158, 0.2741086483001709, 1.3323638439178467, 0.17253589630126953, 4.688451290130615, 1.1642091274261475, 0.8328981399536133, 0.1552591323852539, 1.722292423248291, 0.8719677925109863, 2.006561279296875, 2.719170093536377, 1.204324722290039, 4.193263530731201, 0.26175522804260254, 0.06569719314575195, 0.23148584365844727, 1.4468021392822266, 0.9849424362182617, 1.0867927074432373, 0.942866325378418, 0.8386116027832031, 0.8675107955932617, 0.30313539505004883, 1.4881014823913574, 0.17398977279663086, 0.1369490623474121, 0.6154637336730957, 1.7591462135314941, 0.24554920196533203, 0.916038990020752], "mean_td_error": 1.3685061931610107, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 67.0}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 17408, "last_target_update_ts": 15000, "num_target_updates": 68}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3743.1432796418853, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1879.6434351378723, "robot_1": 1863.4998445040133}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1879.6434351378723, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1863.4998445040133, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7523365845222623, "mean_inference_ms": 3.3858449503280648, "mean_action_processing_ms": 0.4620953907992965, "mean_env_wait_ms": 0.4669264743746205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00986840043749128, "StateBufferConnector_ms": 0.0017906938280378068, "ViewRequirementAgentConnector_ms": 0.14702592577253068}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3743.1432796418853, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1879.6434351378723, "robot_1": 1863.4998445040133}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7523365845222623, "mean_inference_ms": 3.3858449503280648, "mean_action_processing_ms": 0.4620953907992965, "mean_env_wait_ms": 0.4669264743746205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00986840043749128, "StateBufferConnector_ms": 0.0017906938280378068, "ViewRequirementAgentConnector_ms": 0.14702592577253068}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 15000, "num_env_steps_trained": 17408, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 333.6994957079283, "num_env_steps_trained_throughput_per_sec": 427.1353545061482, "timesteps_total": 15000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 536.483, "sample_time_ms": 308.438, "load_time_ms": 0.578, "load_throughput": 443090.754, "learn_time_ms": 35.889, "learn_throughput": 7133.085, "synch_weights_time_ms": 11.393}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 17408, "last_target_update_ts": 15000, "num_target_updates": 68}, "done": false, "episodes_total": 28, "training_iteration": 30, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-16", "timestamp": 1742662576, "time_this_iter_s": 1.2147176265716553, "time_total_s": 38.95245575904846, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7DA700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 38.95245575904846, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 32.2, "ram_util_percent": 88.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1879.6434351378723, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1863.4998445040133, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.415332794189453, "actor_loss": -14.614269256591797, "critic_loss": 0.30732256174087524, "alpha_loss": -0.28185486793518066, "alpha_value": 0.9792092442512512, "log_alpha_value": -0.0210099034011364, "target_entropy": -8.0, "policy_t": 0.01503306720405817, "mean_q": 9.60713005065918, "max_q": 15.543766975402832, "min_q": 5.2187323570251465}, "td_error": [2.2648773193359375, 0.3237338066101074, 0.8094973564147949, 0.9702425003051758, 0.871635913848877, 0.3124246597290039, 0.8160929679870605, 1.3366761207580566, 1.854670524597168, 0.517758846282959, 0.7725281715393066, 1.2533721923828125, 0.8926224708557129, 0.1707744598388672, 1.516404628753662, 1.465205192565918, 7.228122234344482, 0.72316575050354, 0.9566028118133545, 2.6003599166870117, 5.465300559997559, 1.5763113498687744, 0.7936191558837891, 0.8228764533996582, 0.4776957035064697, 2.2562308311462402, 0.5219478607177734, 0.5709028244018555, 0.7199420928955078, 0.06592369079589844, 2.34981632232666, 0.15749216079711914, 0.7213954925537109, 2.366386890411377, 0.29137134552001953, 0.7486834526062012, 1.1438040733337402, 0.6794071197509766, 0.2199873924255371, 0.42827939987182617, 0.19554948806762695, 0.9727878570556641, 2.587327003479004, 0.12649106979370117, 0.46631526947021484, 0.38022565841674805, 0.06423330307006836, 1.27443265914917, 0.9076333045959473, 0.5958876609802246, 0.2276597023010254, 0.6289539337158203, 3.3736629486083984, 2.5694189071655273, 0.74965500831604, 0.6098055839538574, 1.1449575424194336, 1.2146832942962646, 1.450136661529541, 2.8090739250183105, 0.45941781997680664, 0.4105496406555176, 0.47850751876831055, 0.2759394645690918, 0.4061293601989746, 1.046217918395996, 1.6530389785766602, 0.8173282146453857, 1.2653937339782715, 2.5435738563537598, 0.9665112495422363, 0.9489030838012695, 1.0253667831420898, 0.2068483829498291, 3.033235549926758, 0.4775681495666504, 4.852409362792969, 3.182389259338379, 0.6149754524230957, 0.24419879913330078, 0.6421566009521484, 1.4281091690063477, 2.0275158882141113, 0.10323238372802734, 0.5607602596282959, 0.7903003692626953, 0.4056739807128906, 0.6700644493103027, 1.3078160285949707, 5.012937068939209, 1.8964905738830566, 3.5198044776916504, 1.8825287818908691, 0.508183479309082, 0.5971922874450684, 0.2521519660949707, 1.6355814933776855, 0.2573122978210449, 0.47679853439331055, 1.2988624572753906, 0.8676357269287109, 0.16857075691223145, 6.967217445373535, 0.18736982345581055, 0.6366324424743652, 1.22532320022583, 1.378575325012207, 0.7161297798156738, 0.057353973388671875, 1.7885980606079102, 0.7476344108581543, 1.4757652282714844, 0.20002412796020508, 0.6415190696716309, 1.0077214241027832, 1.1321110725402832, 0.32915663719177246, 0.16088438034057617, 2.031764030456543, 3.879394054412842, 1.3448638916015625, 2.6987128257751465, 3.8142247200012207, 2.7307381629943848, 1.683243751525879, 0.36185288429260254, 1.7876496315002441, 2.3103575706481934], "mean_td_error": 1.288250207901001, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.459094047546387, "actor_loss": -14.58021354675293, "critic_loss": 0.27266407012939453, "alpha_loss": -0.2828409969806671, "alpha_value": 0.9792044162750244, "log_alpha_value": -0.02101486176252365, "target_entropy": -8.0, "policy_t": 0.007320265285670757, "mean_q": 9.623148918151855, "max_q": 15.562809944152832, "min_q": 6.601012229919434}, "td_error": [0.1880207061767578, 1.1631247997283936, 1.202733039855957, 1.3384299278259277, 0.9144797325134277, 2.008059024810791, 3.5608081817626953, 0.7953910827636719, 1.2577049732208252, 0.043157100677490234, 0.5466718673706055, 0.8941535949707031, 0.13434576988220215, 0.3973841667175293, 5.237123966217041, 2.3747341632843018, 2.128322124481201, 0.263857364654541, 1.8625295162200928, 1.9574275016784668, 1.22493577003479, 0.9690546989440918, 0.519862174987793, 1.0890545845031738, 0.4113776683807373, 3.7557835578918457, 1.7944750785827637, 0.3961763381958008, 1.371037483215332, 3.6437506675720215, 0.5476670265197754, 0.7456133365631104, 0.9175012111663818, 1.2878971099853516, 1.018233060836792, 0.755551815032959, 0.9421446323394775, 0.6663374900817871, 0.49889039993286133, 1.528430461883545, 0.9809870719909668, 0.46424341201782227, 0.28980493545532227, 0.19039678573608398, 1.6998577117919922, 0.237884521484375, 0.32881832122802734, 0.46196818351745605, 6.121000289916992, 0.8198022842407227, 0.6290202140808105, 4.667752265930176, 2.434638500213623, 4.619173526763916, 0.8168127536773682, 1.376868724822998, 3.330348014831543, 0.1936020851135254, 0.08387994766235352, 3.0180602073669434, 0.3110227584838867, 0.5688579082489014, 0.356168270111084, 1.634091854095459, 0.9197344779968262, 0.10133600234985352, 2.233630657196045, 4.25080680847168, 2.5679125785827637, 2.4826550483703613, 0.22247314453125, 4.450547695159912, 2.290968894958496, 0.49053359031677246, 0.19805002212524414, 2.0134224891662598, 0.5207233428955078, 0.45452356338500977, 2.0310699939727783, 0.4463820457458496, 1.6597154140472412, 1.1440434455871582, 2.8253884315490723, 0.5765218734741211, 1.4962821006774902, 2.0570292472839355, 2.0733041763305664, 1.1393418312072754, 2.997847080230713, 3.7997894287109375, 0.6904788017272949, 0.20523834228515625, 0.29831457138061523, 1.5803256034851074, 1.4920330047607422, 0.3307061195373535, 1.4159584045410156, 1.8800959587097168, 0.4936041831970215, 1.9033613204956055, 0.18479394912719727, 1.651536464691162, 1.245302438735962, 1.099320888519287, 0.9722318649291992, 2.1666016578674316, 0.21817874908447266, 0.35538625717163086, 1.735884666442871, 0.8014402389526367, 1.2191662788391113, 1.1514184474945068, 0.18217802047729492, 0.30328989028930664, 1.3659095764160156, 0.42992353439331055, 2.585014820098877, 0.3404555320739746, 0.46132469177246094, 4.45648717880249, 1.5756492614746094, 0.3824620246887207, 0.24007368087768555, 0.48431825637817383, 0.48349475860595703, 3.197531223297119, 0.7081136703491211, 0.2628500461578369], "mean_td_error": 1.3592326641082764, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 15600, "num_env_steps_trained": 18176, "num_agent_steps_sampled": 31200, "num_agent_steps_trained": 18176, "last_target_update_ts": 15600, "num_target_updates": 71}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3743.1432796418853, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1879.6434351378723, "robot_1": 1863.4998445040133}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1879.6434351378723, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1863.4998445040133, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7523365845222623, "mean_inference_ms": 3.3858449503280648, "mean_action_processing_ms": 0.4620953907992965, "mean_env_wait_ms": 0.4669264743746205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00986840043749128, "StateBufferConnector_ms": 0.0017906938280378068, "ViewRequirementAgentConnector_ms": 0.14702592577253068}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3743.1432796418853, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1879.6434351378723, "robot_1": 1863.4998445040133}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7523365845222623, "mean_inference_ms": 3.3858449503280648, "mean_action_processing_ms": 0.4620953907992965, "mean_env_wait_ms": 0.4669264743746205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00986840043749128, "StateBufferConnector_ms": 0.0017906938280378068, "ViewRequirementAgentConnector_ms": 0.14702592577253068}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31200, "num_agent_steps_trained": 18176, "num_env_steps_sampled": 15600, "num_env_steps_trained": 18176, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 402.15309857885524, "num_env_steps_trained_throughput_per_sec": 514.7559661809347, "timesteps_total": 15600, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 31200, "timers": {"training_iteration_time_ms": 519.414, "sample_time_ms": 299.584, "load_time_ms": 0.608, "load_throughput": 420761.716, "learn_time_ms": 34.226, "learn_throughput": 7479.696, "synch_weights_time_ms": 11.171}, "counters": {"num_env_steps_sampled": 15600, "num_env_steps_trained": 18176, "num_agent_steps_sampled": 31200, "num_agent_steps_trained": 18176, "last_target_update_ts": 15600, "num_target_updates": 71}, "done": false, "episodes_total": 28, "training_iteration": 31, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-17", "timestamp": 1742662577, "time_this_iter_s": 1.5071837902069092, "time_total_s": 40.45963954925537, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A6CADC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 40.45963954925537, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 27.299999999999997, "ram_util_percent": 88.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1866.0030788160511, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1856.2922954998594, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.446001052856445, "actor_loss": -14.795068740844727, "critic_loss": 0.3758423328399658, "alpha_loss": -0.2945859432220459, "alpha_value": 0.9783294200897217, "log_alpha_value": -0.02190881408751011, "target_entropy": -8.0, "policy_t": 0.011812417767941952, "mean_q": 9.655866622924805, "max_q": 16.131790161132812, "min_q": 7.011274814605713}, "td_error": [0.6095566749572754, 2.319187641143799, 1.7776999473571777, 0.5053777694702148, 0.9621114730834961, 0.5776019096374512, 0.34119367599487305, 6.0786542892456055, 0.7038445472717285, 1.1356902122497559, 1.1810088157653809, 3.2700276374816895, 2.4455676078796387, 1.486065149307251, 1.0789823532104492, 0.32921743392944336, 0.10301017761230469, 5.932246208190918, 4.167905330657959, 0.5726416110992432, 2.592433452606201, 2.5021181106567383, 3.074683666229248, 0.7852427959442139, 1.6582131385803223, 1.8447775840759277, 2.256031036376953, 2.4121880531311035, 1.5131821632385254, 1.716071367263794, 0.871680498123169, 0.9792447090148926, 0.6705389022827148, 1.301196575164795, 0.6986098289489746, 0.6406645774841309, 0.519763708114624, 4.21701717376709, 0.19016599655151367, 1.6302204132080078, 0.7314610481262207, 1.1859757900238037, 0.9327340126037598, 1.393354892730713, 0.9494071006774902, 0.8606243133544922, 0.44716548919677734, 1.1142635345458984, 0.20331859588623047, 3.218979835510254, 0.28074169158935547, 1.156707525253296, 0.7830617427825928, 0.7225112915039062, 0.7675721645355225, 3.590406894683838, 0.263674259185791, 0.30388545989990234, 1.5258808135986328, 1.4259452819824219, 1.227217197418213, 0.7468600273132324, 0.22468805313110352, 0.6842255592346191, 1.2936797142028809, 1.9631309509277344, 1.725130558013916, 0.8415722846984863, 0.23068523406982422, 0.5784759521484375, 1.6599125862121582, 1.3114829063415527, 1.6564478874206543, 1.2054715156555176, 0.6317839622497559, 0.5165920257568359, 1.966214656829834, 1.0498757362365723, 3.5748486518859863, 0.7257544994354248, 1.105858325958252, 1.8751745223999023, 1.1768760681152344, 1.02695894241333, 2.5373754501342773, 2.276996612548828, 0.5599074363708496, 0.4076075553894043, 0.2922854423522949, 1.890212059020996, 0.19410014152526855, 0.5647130012512207, 1.9009623527526855, 0.4518876075744629, 0.5197672843933105, 4.67495059967041, 1.6231985092163086, 2.736185073852539, 0.14559698104858398, 1.3094463348388672, 3.059349536895752, 3.0481700897216797, 0.3694586753845215, 3.9010677337646484, 0.9645905494689941, 0.2703990936279297, 0.6921699047088623, 3.1026110649108887, 1.228327751159668, 0.4543497562408447, 1.0970935821533203, 1.1014761924743652, 2.283017635345459, 1.1985056400299072, 4.609020233154297, 0.6544003486633301, 0.4337196350097656, 0.15297794342041016, 4.425195693969727, 1.4279780387878418, 0.4241905212402344, 0.6508598327636719, 1.793990135192871, 1.9644880294799805, 3.3297338485717773, 1.3717284202575684, 1.2769184112548828, 3.1844043731689453], "mean_td_error": 1.4770593643188477, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.427496910095215, "actor_loss": -14.876319885253906, "critic_loss": 0.30511391162872314, "alpha_loss": -0.29425376653671265, "alpha_value": 0.9783241152763367, "log_alpha_value": -0.021914266049861908, "target_entropy": -8.0, "policy_t": -0.018000584095716476, "mean_q": 9.821722030639648, "max_q": 17.30209732055664, "min_q": 6.363285541534424}, "td_error": [2.0245361328125, 0.7361979484558105, 0.6987142562866211, 0.5371417999267578, 1.4122066497802734, 0.444730281829834, 4.556546211242676, 1.650618553161621, 0.3056035041809082, 0.4902644157409668, 3.892548084259033, 0.551513671875, 0.6932687759399414, 3.253304958343506, 1.0577852725982666, 1.3035802841186523, 1.2081997394561768, 0.8784050941467285, 2.6516342163085938, 0.6120645999908447, 2.663473129272461, 1.604921817779541, 0.3255016803741455, 0.6258277893066406, 1.0366148948669434, 2.7936038970947266, 3.0641136169433594, 4.66794490814209, 1.545717716217041, 1.5980334281921387, 0.8986618518829346, 0.2419281005859375, 0.6596505641937256, 1.0188684463500977, 1.0434093475341797, 2.273728370666504, 1.3612561225891113, 0.5114679336547852, 3.182811737060547, 4.171877861022949, 4.176145076751709, 0.48522233963012695, 2.2600955963134766, 0.27026844024658203, 0.3145561218261719, 0.3470282554626465, 1.3072915077209473, 1.089055061340332, 0.2411642074584961, 3.4294190406799316, 1.8993301391601562, 1.0372910499572754, 0.6305720806121826, 0.6783542633056641, 0.2688720226287842, 3.4072017669677734, 1.101968765258789, 0.29378604888916016, 0.571220874786377, 0.5045332908630371, 1.3919029235839844, 3.711972236633301, 0.38515615463256836, 0.8728747367858887, 0.5570068359375, 1.3142027854919434, 4.226975440979004, 1.9235663414001465, 1.945969581604004, 3.6779403686523438, 2.27817964553833, 0.8724708557128906, 1.6842150688171387, 1.3520846366882324, 0.38205909729003906, 0.8742542266845703, 0.4921441078186035, 1.4932222366333008, 3.051060199737549, 1.5598340034484863, 0.7915859222412109, 1.0701971054077148, 1.313732624053955, 1.030468463897705, 1.1336803436279297, 3.2505431175231934, 1.0439414978027344, 0.18449831008911133, 0.6322474479675293, 0.9998016357421875, 0.9938693046569824, 0.2939138412475586, 0.3157081604003906, 1.0954437255859375, 0.6589574813842773, 6.972752094268799, 2.411525249481201, 0.6428461074829102, 0.7417240142822266, 3.6504735946655273, 1.4945557117462158, 0.7853388786315918, 0.9080667495727539, 0.8709635734558105, 1.3415651321411133, 3.689852237701416, 0.6417679786682129, 1.1918387413024902, 0.6413235664367676, 0.5499343872070312, 3.520224094390869, 0.5697422027587891, 0.49132800102233887, 1.352534294128418, 2.4936094284057617, 5.030511379241943, 0.12769603729248047, 0.4237394332885742, 3.915544033050537, 0.7510108947753906, 0.13010692596435547, 1.924839735031128, 0.6232085227966309, 0.30257749557495117, 0.6593427658081055, 4.586180686950684, 1.1824593544006348, 0.9606368541717529], "mean_td_error": 1.5077903270721436, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74.0, "diff_num_grad_updates_vs_sampler_policy": 73.0}}, "num_env_steps_sampled": 16200, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 32400, "num_agent_steps_trained": 18944, "last_target_update_ts": 16200, "num_target_updates": 74}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3722.29537431591, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1866.0030788160511, "robot_1": 1856.2922954998594}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1866.0030788160511, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1856.2922954998594, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513585163769444, "mean_inference_ms": 3.3840921401768727, "mean_action_processing_ms": 0.4614678350359166, "mean_env_wait_ms": 0.4665244863836943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00863485038280487, "StateBufferConnector_ms": 0.001566857099533081, "ViewRequirementAgentConnector_ms": 0.14797858893871307}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3722.29537431591, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1866.0030788160511, "robot_1": 1856.2922954998594}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513585163769444, "mean_inference_ms": 3.3840921401768727, "mean_action_processing_ms": 0.4614678350359166, "mean_env_wait_ms": 0.4665244863836943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00863485038280487, "StateBufferConnector_ms": 0.001566857099533081, "ViewRequirementAgentConnector_ms": 0.14797858893871307}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32400, "num_agent_steps_trained": 18944, "num_env_steps_sampled": 16200, "num_env_steps_trained": 18944, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 402.27748900746616, "num_env_steps_trained_throughput_per_sec": 514.9151859295566, "timesteps_total": 16200, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 32400, "timers": {"training_iteration_time_ms": 516.904, "sample_time_ms": 299.698, "load_time_ms": 0.402, "load_throughput": 636178.353, "learn_time_ms": 34.105, "learn_throughput": 7506.306, "synch_weights_time_ms": 11.04}, "counters": {"num_env_steps_sampled": 16200, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 32400, "num_agent_steps_trained": 18944, "last_target_update_ts": 16200, "num_target_updates": 74}, "done": false, "episodes_total": 32, "training_iteration": 32, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-19", "timestamp": 1742662579, "time_this_iter_s": 1.509610652923584, "time_total_s": 41.969250202178955, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7DA940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 41.969250202178955, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 27.96666666666667, "ram_util_percent": 88.89999999999999}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1866.0030788160511, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1856.2922954998594, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.396080017089844, "actor_loss": -14.57985782623291, "critic_loss": 0.33172234892845154, "alpha_loss": -0.3055378198623657, "alpha_value": 0.9774501323699951, "log_alpha_value": -0.022808002308011055, "target_entropy": -8.0, "policy_t": 0.009319007396697998, "mean_q": 9.471643447875977, "max_q": 14.999701499938965, "min_q": 5.151747703552246}, "td_error": [1.6345338821411133, 1.092479944229126, 1.4046051502227783, 0.8645913600921631, 2.1102170944213867, 2.971928358078003, 1.9006538391113281, 2.3298373222351074, 0.663996696472168, 2.225454330444336, 0.4828627109527588, 0.36816978454589844, 1.9455757141113281, 5.459171772003174, 0.35437679290771484, 1.830794334411621, 0.5443582534790039, 2.3866539001464844, 0.5049500465393066, 1.2399306297302246, 4.767236232757568, 0.9688248634338379, 2.8438215255737305, 1.0438504219055176, 0.7364306449890137, 1.492948055267334, 0.1665501594543457, 0.28536415100097656, 1.035860300064087, 3.6665353775024414, 1.8368549346923828, 0.8713979721069336, 1.5412168502807617, 0.48411083221435547, 0.7756693363189697, 1.0657463073730469, 2.121151924133301, 0.8043792247772217, 0.8665885925292969, 0.29273152351379395, 0.6745481491088867, 0.5811982154846191, 1.730055809020996, 1.0905795097351074, 0.5642976760864258, 4.311679363250732, 0.882596492767334, 3.236210346221924, 0.29442262649536133, 2.6484432220458984, 3.659658432006836, 1.3441638946533203, 2.576249122619629, 0.9745097160339355, 1.4009103775024414, 0.7931907176971436, 3.7088117599487305, 1.3950467109680176, 0.899437427520752, 2.6696958541870117, 0.7639217376708984, 1.431239128112793, 0.5668416023254395, 0.5508899688720703, 0.48407530784606934, 1.8212769031524658, 0.3499324321746826, 1.5266304016113281, 0.24145770072937012, 1.8624897003173828, 1.3407602310180664, 0.5909347534179688, 0.42917537689208984, 2.3680949211120605, 1.473862648010254, 2.1363186836242676, 0.15241718292236328, 0.3639411926269531, 1.3237056732177734, 1.1405296325683594, 2.3200035095214844, 1.3534040451049805, 1.657379150390625, 0.12767839431762695, 1.7786211967468262, 0.5457322597503662, 1.0194005966186523, 2.434785842895508, 1.6785359382629395, 0.45259809494018555, 0.07912230491638184, 0.9690022468566895, 0.520226001739502, 2.112581253051758, 0.4435091018676758, 0.5895957946777344, 0.33864927291870117, 0.7723610401153564, 3.0320229530334473, 0.09098386764526367, 0.42238426208496094, 0.22608399391174316, 1.3135433197021484, 0.3994433879852295, 0.6024537086486816, 0.4468536376953125, 0.2965693473815918, 2.3194780349731445, 1.0694971084594727, 2.3997745513916016, 0.9105279445648193, 0.4953799247741699, 4.228682518005371, 0.9758753776550293, 2.774531841278076, 2.282712459564209, 0.8521342277526855, 2.4121100902557373, 0.22394466400146484, 1.2711806297302246, 0.5998587608337402, 1.0077786445617676, 0.6083803176879883, 3.4795660972595215, 1.2833929061889648, 0.10667800903320312, 0.6401920318603516, 1.7436800003051758], "mean_td_error": 1.3597303628921509, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.481518745422363, "actor_loss": -14.820453643798828, "critic_loss": 0.303813099861145, "alpha_loss": -0.30756038427352905, "alpha_value": 0.9774447679519653, "log_alpha_value": -0.02281348407268524, "target_entropy": -8.0, "policy_t": 0.04461957514286041, "mean_q": 9.861759185791016, "max_q": 15.648807525634766, "min_q": 4.297562599182129}, "td_error": [2.3638992309570312, 1.9312629699707031, 0.21733903884887695, 1.0082497596740723, 1.110806941986084, 0.1201939582824707, 3.399956703186035, 0.18074274063110352, 0.8744630813598633, 1.2959961891174316, 2.6246724128723145, 2.7069053649902344, 1.1278676986694336, 0.34855175018310547, 0.11831378936767578, 2.226285934448242, 0.09072160720825195, 2.4582996368408203, 0.2948031425476074, 2.828721046447754, 1.4774808883666992, 0.5159759521484375, 1.2533354759216309, 1.1295437812805176, 0.17043781280517578, 1.6183595657348633, 0.9798765182495117, 1.9844589233398438, 1.038435459136963, 0.26053452491760254, 0.2960071563720703, 0.6218633651733398, 0.857414722442627, 0.9824666976928711, 1.2283844947814941, 4.524431228637695, 0.8863525390625, 0.9969382286071777, 5.079356670379639, 0.4879779815673828, 1.0729436874389648, 0.6982946395874023, 1.0085830688476562, 0.11524677276611328, 3.2235207557678223, 2.9011549949645996, 0.8219194412231445, 1.3789410591125488, 1.973867416381836, 0.8718047142028809, 0.4997978210449219, 0.3545083999633789, 3.228959560394287, 3.164222240447998, 3.272764205932617, 0.835456371307373, 1.2718873023986816, 0.14340877532958984, 1.285048007965088, 0.18692445755004883, 0.39173030853271484, 4.280608654022217, 3.7845358848571777, 1.3411140441894531, 0.6820535659790039, 2.0967249870300293, 0.4290151596069336, 0.8217477798461914, 1.6821718215942383, 0.36677074432373047, 1.0668950080871582, 5.247673511505127, 0.2419145107269287, 0.9910430908203125, 0.604421854019165, 3.86208176612854, 2.3020949363708496, 3.416779041290283, 1.0216622352600098, 0.8950307369232178, 0.555513858795166, 0.7028393745422363, 2.596754550933838, 0.5792410373687744, 1.0344743728637695, 0.7002639770507812, 0.9644458293914795, 0.15425682067871094, 4.013881683349609, 0.6395153999328613, 1.0085868835449219, 1.5259132385253906, 3.054684638977051, 2.71610689163208, 0.5847749710083008, 0.49643802642822266, 0.9255876541137695, 0.34276700019836426, 1.6373414993286133, 1.590792179107666, 0.21800994873046875, 0.6111621856689453, 0.11504650115966797, 2.0486583709716797, 0.08195734024047852, 0.038912296295166016, 1.050051212310791, 3.770812511444092, 5.735086917877197, 1.1061408519744873, 3.0620288848876953, 0.36124086380004883, 1.7537684440612793, 1.1792049407958984, 2.0476927757263184, 1.6102294921875, 0.6268231868743896, 0.08558940887451172, 4.356060981750488, 0.34621524810791016, 0.8099255561828613, 2.087893009185791, 0.9702749252319336, 0.9014644622802734, 1.4110260009765625, 2.5895910263061523, 5.024824619293213, 0.9455523490905762], "mean_td_error": 1.471268892288208, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 16800, "num_env_steps_trained": 19712, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 19712, "last_target_update_ts": 16800, "num_target_updates": 77}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3722.29537431591, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1866.0030788160511, "robot_1": 1856.2922954998594}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1866.0030788160511, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1856.2922954998594, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513585163769444, "mean_inference_ms": 3.3840921401768727, "mean_action_processing_ms": 0.4614678350359166, "mean_env_wait_ms": 0.4665244863836943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00863485038280487, "StateBufferConnector_ms": 0.001566857099533081, "ViewRequirementAgentConnector_ms": 0.14797858893871307}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3722.29537431591, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1866.0030788160511, "robot_1": 1856.2922954998594}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513585163769444, "mean_inference_ms": 3.3840921401768727, "mean_action_processing_ms": 0.4614678350359166, "mean_env_wait_ms": 0.4665244863836943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00863485038280487, "StateBufferConnector_ms": 0.001566857099533081, "ViewRequirementAgentConnector_ms": 0.14797858893871307}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 19712, "num_env_steps_sampled": 16800, "num_env_steps_trained": 19712, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 406.52939297852305, "num_env_steps_trained_throughput_per_sec": 520.3576230125095, "timesteps_total": 16800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 33600, "timers": {"training_iteration_time_ms": 517.379, "sample_time_ms": 301.833, "load_time_ms": 0.452, "load_throughput": 565871.844, "learn_time_ms": 33.578, "learn_throughput": 7624.096, "synch_weights_time_ms": 10.857}, "counters": {"num_env_steps_sampled": 16800, "num_env_steps_trained": 19712, "num_agent_steps_sampled": 33600, "num_agent_steps_trained": 19712, "last_target_update_ts": 16800, "num_target_updates": 77}, "done": false, "episodes_total": 32, "training_iteration": 33, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-20", "timestamp": 1742662580, "time_this_iter_s": 1.4920933246612549, "time_total_s": 43.46134352684021, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7DA700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 43.46134352684021, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 33.25, "ram_util_percent": 88.95}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1866.0030788160511, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1856.2922954998594, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.388640403747559, "actor_loss": -14.616279602050781, "critic_loss": 0.32719069719314575, "alpha_loss": -0.31339117884635925, "alpha_value": 0.9768645763397217, "log_alpha_value": -0.023407243192195892, "target_entropy": -8.0, "policy_t": -0.01857263594865799, "mean_q": 9.481430053710938, "max_q": 16.240192413330078, "min_q": 6.4561028480529785}, "td_error": [0.6373286247253418, 1.1364719867706299, 0.8858306407928467, 1.0694947242736816, 0.5782945156097412, 2.0573809146881104, 3.9613089561462402, 1.6137456893920898, 4.604471683502197, 0.5335726737976074, 0.4826211929321289, 0.22342443466186523, 0.20540332794189453, 1.0275397300720215, 1.9258408546447754, 1.525007724761963, 1.7600979804992676, 1.2312893867492676, 0.23430204391479492, 1.9870691299438477, 0.9708776473999023, 0.46843814849853516, 0.5116171836853027, 1.9742331504821777, 0.986358642578125, 0.07454180717468262, 1.276975154876709, 0.20077276229858398, 0.45626401901245117, 0.3538484573364258, 1.0794410705566406, 2.1498332023620605, 4.330193996429443, 0.40569162368774414, 0.733616828918457, 4.133058071136475, 0.2890810966491699, 0.2363748550415039, 1.213721752166748, 1.4245529174804688, 3.5357089042663574, 2.2312636375427246, 0.4687504768371582, 0.7400755882263184, 0.3602578639984131, 1.8858180046081543, 0.2755732536315918, 2.0345864295959473, 0.8790521621704102, 1.7961654663085938, 5.9711432456970215, 0.947929859161377, 0.38399505615234375, 0.27402830123901367, 0.9080548286437988, 0.7358098030090332, 0.7418379783630371, 0.7402849197387695, 0.37358665466308594, 1.3758296966552734, 1.656205177307129, 0.7322430610656738, 0.07838201522827148, 0.31746912002563477, 2.016571521759033, 0.9842438697814941, 2.1335599422454834, 3.1638636589050293, 3.6638355255126953, 1.7752165794372559, 6.4600934982299805, 0.6542258262634277, 0.8233795166015625, 0.38198423385620117, 0.9663872718811035, 0.8491814136505127, 1.0497536659240723, 0.6638219356536865, 1.5145173072814941, 0.2650268077850342, 1.4135236740112305, 0.7369613647460938, 4.467278480529785, 0.3788938522338867, 1.7155394554138184, 0.6499683856964111, 0.7358431816101074, 1.0335078239440918, 0.43225669860839844, 0.19646120071411133, 0.10283184051513672, 1.3875055313110352, 1.0548062324523926, 0.4107356071472168, 1.9005913734436035, 0.3978276252746582, 0.7856302261352539, 0.9046838283538818, 4.5712690353393555, 1.856734275817871, 0.10114765167236328, 0.40633392333984375, 1.222907543182373, 0.2432570457458496, 0.3191099166870117, 1.2640700340270996, 0.3666815757751465, 1.5867729187011719, 3.0047335624694824, 0.7253842353820801, 0.8161053657531738, 1.0574593544006348, 0.15420103073120117, 4.597129821777344, 3.256744861602783, 0.6717016696929932, 1.1846652030944824, 0.2953629493713379, 1.8833060264587402, 1.6461553573608398, 0.6270952224731445, 2.261721611022949, 1.0635402202606201, 0.8118677139282227, 0.7861618995666504, 2.184885025024414, 0.32027220726013184, 2.213637351989746], "mean_td_error": 1.3122261762619019, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.355382919311523, "actor_loss": -14.37031078338623, "critic_loss": 0.20392978191375732, "alpha_loss": -0.31269019842147827, "alpha_value": 0.976858913898468, "log_alpha_value": -0.023413049057126045, "target_entropy": -8.0, "policy_t": 0.017589572817087173, "mean_q": 9.281932830810547, "max_q": 14.185286521911621, "min_q": 5.820694446563721}, "td_error": [4.200958251953125, 1.066549301147461, 0.44907259941101074, 0.9237604141235352, 0.3152165412902832, 0.34974145889282227, 1.070728063583374, 0.4768185615539551, 0.8039793968200684, 1.5753369331359863, 1.3444406986236572, 1.0884547233581543, 0.10023021697998047, 0.1661849021911621, 1.9198455810546875, 3.0082786083221436, 2.574532985687256, 0.5762701034545898, 0.9661092758178711, 0.44225025177001953, 0.8224263191223145, 0.46051025390625, 2.294422149658203, 2.8928303718566895, 0.5870003700256348, 1.1955175399780273, 0.0666956901550293, 0.47147655487060547, 0.5121669769287109, 0.5306689739227295, 1.282762050628662, 2.348966598510742, 0.3727760314941406, 0.7560429573059082, 0.31233882904052734, 0.33997559547424316, 4.886802673339844, 0.2431340217590332, 0.36354947090148926, 2.138087749481201, 0.12802982330322266, 0.8745379447937012, 1.6528663635253906, 0.3369479179382324, 0.4368572235107422, 0.6736941337585449, 0.11325263977050781, 3.1889185905456543, 1.127791166305542, 1.1440057754516602, 1.1838107109069824, 0.40425968170166016, 0.9826784133911133, 0.4403533935546875, 3.0524654388427734, 1.4175457954406738, 0.8219923973083496, 2.909818172454834, 3.629037380218506, 1.425607442855835, 1.4398932456970215, 1.0623645782470703, 0.9702849388122559, 0.32636022567749023, 0.8068461418151855, 0.0437924861907959, 2.343083381652832, 0.5865671634674072, 0.5094304084777832, 0.7185225486755371, 1.8433475494384766, 0.4555325508117676, 1.137528419494629, 4.5519819259643555, 0.5806331634521484, 1.1247334480285645, 1.633230209350586, 3.976456642150879, 0.2612011432647705, 1.5128583908081055, 1.5987162590026855, 1.5611753463745117, 0.530137300491333, 1.7457733154296875, 0.9905314445495605, 0.8840608596801758, 1.5380504131317139, 0.2706012725830078, 0.33403635025024414, 0.5301532745361328, 0.5057005882263184, 1.2346177101135254, 0.2999281883239746, 0.3924217224121094, 1.0849809646606445, 0.6779618263244629, 0.19158697128295898, 0.608036994934082, 1.503516674041748, 1.632021427154541, 1.12518310546875, 1.632948875427246, 1.8059430122375488, 0.8757681846618652, 0.3756394386291504, 0.4804568290710449, 0.9678997993469238, 1.450700283050537, 2.224696636199951, 0.507296085357666, 0.5316596031188965, 0.15010309219360352, 0.40087318420410156, 2.351714611053467, 2.840399742126465, 0.4226863384246826, 0.10708904266357422, 1.1050951480865479, 1.3624048233032227, 0.3453354835510254, 4.418528079986572, 1.5419483184814453, 0.20343780517578125, 0.5709333419799805, 0.8501107692718506, 0.04241204261779785, 0.9613008499145508, 1.0399632453918457], "mean_td_error": 1.147910714149475, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 17200, "num_env_steps_trained": 20224, "num_agent_steps_sampled": 34400, "num_agent_steps_trained": 20224, "last_target_update_ts": 17200, "num_target_updates": 79}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3722.29537431591, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1866.0030788160511, "robot_1": 1856.2922954998594}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1866.0030788160511, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1856.2922954998594, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513585163769444, "mean_inference_ms": 3.3840921401768727, "mean_action_processing_ms": 0.4614678350359166, "mean_env_wait_ms": 0.4665244863836943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00863485038280487, "StateBufferConnector_ms": 0.001566857099533081, "ViewRequirementAgentConnector_ms": 0.14797858893871307}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3722.29537431591, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1866.0030788160511, "robot_1": 1856.2922954998594}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513585163769444, "mean_inference_ms": 3.3840921401768727, "mean_action_processing_ms": 0.4614678350359166, "mean_env_wait_ms": 0.4665244863836943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00863485038280487, "StateBufferConnector_ms": 0.001566857099533081, "ViewRequirementAgentConnector_ms": 0.14797858893871307}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34400, "num_agent_steps_trained": 20224, "num_env_steps_sampled": 17200, "num_env_steps_trained": 20224, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 397.1114461160766, "num_env_steps_trained_throughput_per_sec": 508.30265102857805, "timesteps_total": 17200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34400, "timers": {"training_iteration_time_ms": 497.918, "sample_time_ms": 282.587, "load_time_ms": 0.471, "load_throughput": 543914.606, "learn_time_ms": 33.641, "learn_throughput": 7609.788, "synch_weights_time_ms": 10.693}, "counters": {"num_env_steps_sampled": 17200, "num_env_steps_trained": 20224, "num_agent_steps_sampled": 34400, "num_agent_steps_trained": 20224, "last_target_update_ts": 17200, "num_target_updates": 79}, "done": false, "episodes_total": 32, "training_iteration": 34, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-25", "timestamp": 1742662585, "time_this_iter_s": 1.0244715213775635, "time_total_s": 44.48581504821777, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7744C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 44.48581504821777, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 13.928571428571429, "ram_util_percent": 89.07142857142857}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1866.0030788160511, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1856.2922954998594, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.335220336914062, "actor_loss": -14.025890350341797, "critic_loss": 0.17795559763908386, "alpha_loss": -0.3241223692893982, "alpha_value": 0.9759872555732727, "log_alpha_value": -0.024305738508701324, "target_entropy": -8.0, "policy_t": -0.01170467957854271, "mean_q": 8.964824676513672, "max_q": 13.874848365783691, "min_q": 6.918214321136475}, "td_error": [0.12084174156188965, 1.5964536666870117, 0.1486053466796875, 1.531165599822998, 0.3324012756347656, 0.8261356353759766, 1.690028190612793, 0.49660229682922363, 0.6223616600036621, 0.5116863250732422, 2.1573214530944824, 0.3885519504547119, 1.399176836013794, 1.437093734741211, 1.4423565864562988, 2.1942996978759766, 0.18321466445922852, 0.37424325942993164, 0.26394009590148926, 0.889225959777832, 2.860654830932617, 0.3998985290527344, 0.5719156265258789, 0.6235013008117676, 0.2812840938568115, 1.08378267288208, 0.16852951049804688, 0.3542335033416748, 1.9188270568847656, 0.36870384216308594, 0.41189098358154297, 0.1192469596862793, 0.28162384033203125, 0.4924449920654297, 0.13717174530029297, 1.3847143650054932, 1.0006299018859863, 0.4009397029876709, 1.654047966003418, 1.0284161567687988, 0.7608962059020996, 0.5991990566253662, 0.7207474708557129, 1.3276476860046387, 1.453829288482666, 0.3829832077026367, 0.8037481307983398, 2.826819896697998, 0.37093257904052734, 0.80596923828125, 0.6042025089263916, 0.7782673835754395, 0.5371088981628418, 0.9883246421813965, 1.1094627380371094, 1.6006431579589844, 1.5434703826904297, 0.49077653884887695, 1.156682014465332, 0.3935127258300781, 4.0364251136779785, 0.5061535835266113, 1.2953014373779297, 1.1300394535064697, 0.6668477058410645, 0.3872346878051758, 0.7062993049621582, 0.29424571990966797, 0.6131458282470703, 0.6810164451599121, 0.46556520462036133, 0.37951135635375977, 0.32297253608703613, 0.38076210021972656, 0.3248331546783447, 1.446371078491211, 2.701633930206299, 0.17282533645629883, 0.8878440856933594, 0.15295696258544922, 0.35320329666137695, 1.1600494384765625, 0.37866830825805664, 1.841115951538086, 1.098801612854004, 0.6261816024780273, 0.4060850143432617, 0.5111374855041504, 0.6273393630981445, 0.8535807132720947, 0.9370973110198975, 0.20090866088867188, 0.6346731185913086, 3.6886954307556152, 0.25358033180236816, 0.096710205078125, 0.8562498092651367, 0.7150402069091797, 0.8464069366455078, 1.4882841110229492, 0.9605848789215088, 0.3071861267089844, 0.7249555587768555, 0.7456300258636475, 0.4085268974304199, 2.120532512664795, 0.31537389755249023, 1.9716410636901855, 1.9467730522155762, 0.5542216300964355, 1.3821563720703125, 0.30962038040161133, 0.503368616104126, 1.2395038604736328, 2.635200023651123, 0.7739295959472656, 0.448056697845459, 1.8936576843261719, 0.3832883834838867, 0.7306482791900635, 2.561494827270508, 1.3025329113006592, 0.2401719093322754, 1.7178981304168701, 1.4080147743225098, 1.5756278038024902, 0.5740952491760254, 0.6593122482299805], "mean_td_error": 0.9290874004364014, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.39044189453125, "actor_loss": -14.57620906829834, "critic_loss": 0.23452846705913544, "alpha_loss": -0.32554468512535095, "alpha_value": 0.9759814143180847, "log_alpha_value": -0.024311721324920654, "target_entropy": -8.0, "policy_t": 0.00867239385843277, "mean_q": 9.528695106506348, "max_q": 15.679627418518066, "min_q": 6.52255392074585}, "td_error": [0.769439697265625, 0.26624083518981934, 3.3327488899230957, 2.849331855773926, 0.8913445472717285, 1.8120341300964355, 0.30568408966064453, 0.4959750175476074, 1.6052393913269043, 0.1342763900756836, 0.7067618370056152, 0.4262065887451172, 2.9040603637695312, 0.6961820125579834, 1.3914775848388672, 0.5221352577209473, 0.9448361396789551, 0.8383915424346924, 0.38616251945495605, 1.305312156677246, 2.062887668609619, 2.7511086463928223, 0.6810221672058105, 3.034254550933838, 1.263150691986084, 0.8497319221496582, 1.7924132347106934, 0.40320420265197754, 0.415708065032959, 1.1992294788360596, 2.3414807319641113, 4.185059070587158, 1.6531164646148682, 1.1572365760803223, 0.30592870712280273, 0.7644882202148438, 1.1286351680755615, 0.4621415138244629, 0.537376880645752, 0.44563913345336914, 1.330583095550537, 1.9094853401184082, 0.619563102722168, 0.2927212715148926, 3.9602127075195312, 0.7582821846008301, 1.111865520477295, 0.9527416229248047, 1.1800611019134521, 1.8666596412658691, 2.756704330444336, 2.5428013801574707, 1.4330193996429443, 0.5566222667694092, 0.12116575241088867, 1.1204133033752441, 0.6535725593566895, 1.870147705078125, 4.2335944175720215, 0.34047865867614746, 2.739651679992676, 1.2591910362243652, 0.34335994720458984, 0.28169918060302734, 1.0538692474365234, 3.669321060180664, 4.279789924621582, 0.44623422622680664, 4.347240924835205, 1.2718048095703125, 1.557420253753662, 2.4762649536132812, 1.9968290328979492, 2.191409111022949, 0.10420036315917969, 2.870575428009033, 1.521566390991211, 4.200344562530518, 3.104440689086914, 0.7705898284912109, 1.0898957252502441, 0.35362815856933594, 0.5946621894836426, 0.30943918228149414, 3.967273712158203, 0.6069860458374023, 0.7368249893188477, 0.8191444873809814, 0.48674774169921875, 0.8668949604034424, 0.8025894165039062, 0.872748851776123, 0.0699610710144043, 0.21886634826660156, 4.295267581939697, 0.737112283706665, 0.4078512191772461, 0.2532773017883301, 0.9023628234863281, 0.8491690158843994, 0.31203126907348633, 0.9569871425628662, 0.5919456481933594, 1.4484305381774902, 0.778782844543457, 1.959054946899414, 0.6568808555603027, 0.11664724349975586, 0.21013164520263672, 1.3781709671020508, 0.390230655670166, 1.2332301139831543, 2.763944625854492, 2.009645938873291, 0.7149984836578369, 0.35155797004699707, 0.7382824420928955, 3.8290514945983887, 0.3075723648071289, 0.36044955253601074, 1.8355810642242432, 1.57102370262146, 0.6399083137512207, 0.7474918365478516, 1.924367904663086, 1.2147021293640137, 0.769395112991333, 0.7309379577636719], "mean_td_error": 1.3273147344589233, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82.0, "diff_num_grad_updates_vs_sampler_policy": 81.0}}, "num_env_steps_sampled": 17800, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 35600, "num_agent_steps_trained": 20992, "last_target_update_ts": 17800, "num_target_updates": 82}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3722.29537431591, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1866.0030788160511, "robot_1": 1856.2922954998594}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1866.0030788160511, "('robot_0', 'robot_0')_total_reward_min": 1709.0145254221547, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1856.2922954998594, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513585163769444, "mean_inference_ms": 3.3840921401768727, "mean_action_processing_ms": 0.4614678350359166, "mean_env_wait_ms": 0.4665244863836943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00863485038280487, "StateBufferConnector_ms": 0.001566857099533081, "ViewRequirementAgentConnector_ms": 0.14797858893871307}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3450.1503101896874, "episode_reward_mean": 3722.29537431591, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1709.0145254221547, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1866.0030788160511, "robot_1": 1856.2922954998594}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7513585163769444, "mean_inference_ms": 3.3840921401768727, "mean_action_processing_ms": 0.4614678350359166, "mean_env_wait_ms": 0.4665244863836943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00863485038280487, "StateBufferConnector_ms": 0.001566857099533081, "ViewRequirementAgentConnector_ms": 0.14797858893871307}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35600, "num_agent_steps_trained": 20992, "num_env_steps_sampled": 17800, "num_env_steps_trained": 20992, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 404.71223031995424, "num_env_steps_trained_throughput_per_sec": 518.0316548095414, "timesteps_total": 17800, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 35600, "timers": {"training_iteration_time_ms": 497.118, "sample_time_ms": 282.229, "load_time_ms": 0.376, "load_throughput": 681654.281, "learn_time_ms": 33.974, "learn_throughput": 7535.083, "synch_weights_time_ms": 10.782}, "counters": {"num_env_steps_sampled": 17800, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 35600, "num_agent_steps_trained": 20992, "last_target_update_ts": 17800, "num_target_updates": 82}, "done": false, "episodes_total": 32, "training_iteration": 35, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-27", "timestamp": 1742662587, "time_this_iter_s": 1.498650312423706, "time_total_s": 45.98446536064148, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A737940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 45.98446536064148, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 25.9, "ram_util_percent": 89.4}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1863.560369784926, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1852.8109802917118, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.258835792541504, "actor_loss": -13.959587097167969, "critic_loss": 0.26071697473526, "alpha_loss": -0.33417391777038574, "alpha_value": 0.9751111268997192, "log_alpha_value": -0.02520386129617691, "target_entropy": -8.0, "policy_t": 0.009259477257728577, "mean_q": 8.8273344039917, "max_q": 13.275138854980469, "min_q": 6.404591083526611}, "td_error": [0.9459018707275391, 0.5505836009979248, 0.6183180809020996, 1.7707345485687256, 2.008897304534912, 2.627002239227295, 0.7865850925445557, 2.2827677726745605, 0.7371363639831543, 1.5629687309265137, 1.1605730056762695, 2.0432863235473633, 1.0833759307861328, 0.795952320098877, 2.3008217811584473, 0.07608914375305176, 1.3516669273376465, 0.898493766784668, 1.104036569595337, 0.4035825729370117, 1.4430837631225586, 0.11734247207641602, 0.7087466716766357, 0.18821477890014648, 0.9185376167297363, 1.6914317607879639, 0.930293083190918, 0.1685347557067871, 0.4234142303466797, 2.298919677734375, 0.3423471450805664, 1.1806941032409668, 3.2308430671691895, 0.27463626861572266, 1.3822369575500488, 1.0505127906799316, 0.3711891174316406, 0.5701339244842529, 0.2730123996734619, 0.6541752815246582, 1.6251816749572754, 0.484283447265625, 0.19426298141479492, 3.23933744430542, 2.0206198692321777, 1.68345308303833, 0.9873518943786621, 0.7294819355010986, 0.7002830505371094, 3.374216079711914, 0.30789709091186523, 2.937863826751709, 1.242049217224121, 0.5226924419403076, 0.1927037239074707, 1.9198191165924072, 0.3296031951904297, 1.295797348022461, 1.5988929271697998, 0.22734427452087402, 0.7738142013549805, 0.7803645133972168, 0.5712480545043945, 0.7254354953765869, 1.3063364028930664, 0.4378085136413574, 0.6219692230224609, 0.5092873573303223, 1.7593202590942383, 1.3422083854675293, 2.001903533935547, 0.9230194091796875, 1.7779033184051514, 0.9291379451751709, 0.3776068687438965, 0.9546122550964355, 0.796745777130127, 2.952572822570801, 0.2730712890625, 0.4090113639831543, 0.59617018699646, 4.377871513366699, 3.31887149810791, 0.17606115341186523, 2.6364595890045166, 1.5028650760650635, 2.984833240509033, 1.6923294067382812, 0.5392584800720215, 1.3313193321228027, 1.5201985836029053, 1.5055475234985352, 0.7006206512451172, 0.18130970001220703, 0.8201489448547363, 1.7458672523498535, 0.7143502235412598, 1.6945290565490723, 0.13780832290649414, 2.627228260040283, 0.813931941986084, 1.008190631866455, 2.299354314804077, 1.920259952545166, 1.2893505096435547, 0.2775421142578125, 0.2261490821838379, 2.0359387397766113, 0.7029998302459717, 3.423515796661377, 0.894599199295044, 0.679905891418457, 0.33471155166625977, 1.2409734725952148, 1.3237438201904297, 0.28652524948120117, 0.3620333671569824, 0.1615123748779297, 0.24600648880004883, 1.6506586074829102, 1.5852057933807373, 0.8886885643005371, 1.9634177684783936, 0.4361872673034668, 1.0381102561950684, 0.4356803894042969, 1.7802529335021973, 1.4794034957885742], "mean_td_error": 1.177750587463379, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.358176231384277, "actor_loss": -14.271544456481934, "critic_loss": 0.20466294884681702, "alpha_loss": -0.3367564082145691, "alpha_value": 0.975105345249176, "log_alpha_value": -0.025209762156009674, "target_entropy": -8.0, "policy_t": 0.021134885028004646, "mean_q": 9.129668235778809, "max_q": 13.602765083312988, "min_q": 5.892228603363037}, "td_error": [1.346405029296875, 0.9232783317565918, 2.0679001808166504, 0.479372501373291, 0.6390433311462402, 1.3829011917114258, 0.17896127700805664, 0.34264540672302246, 2.112542152404785, 1.0516231060028076, 1.0172834396362305, 0.918018102645874, 1.6808319091796875, 1.0974645614624023, 1.9305925369262695, 0.9954361915588379, 0.03334665298461914, 0.8026089668273926, 1.0863447189331055, 0.2836945056915283, 1.031407117843628, 1.515681266784668, 1.9186592102050781, 1.3189358711242676, 0.18472909927368164, 1.2159113883972168, 1.1670570373535156, 2.2625951766967773, 1.5077037811279297, 0.2983510494232178, 0.593329906463623, 1.1738052368164062, 0.9606719017028809, 1.8047571182250977, 0.679438591003418, 0.6211910247802734, 0.5106480121612549, 0.08507037162780762, 1.7286441326141357, 0.9055972099304199, 0.6586518287658691, 0.4820284843444824, 0.892268180847168, 1.4930071830749512, 0.48836803436279297, 0.2980766296386719, 2.784111499786377, 0.30374956130981445, 0.5489821434020996, 0.8679914474487305, 1.0249886512756348, 0.17869853973388672, 0.8557305335998535, 2.043196439743042, 1.8528428077697754, 0.7312901020050049, 0.4796128273010254, 0.15297985076904297, 1.0202593803405762, 2.0509071350097656, 0.7198379039764404, 0.1538867950439453, 0.479372501373291, 1.1669983863830566, 0.9973258972167969, 0.9829502105712891, 1.5028305053710938, 1.7627894878387451, 2.4217119216918945, 1.355638027191162, 0.5308036804199219, 3.2102417945861816, 0.46181774139404297, 0.8180794715881348, 0.837486743927002, 0.6800446510314941, 0.08770179748535156, 0.3338007926940918, 1.3019366264343262, 0.2365860939025879, 0.6712112426757812, 3.1777968406677246, 0.9972376823425293, 0.2515106201171875, 3.5850510597229004, 0.6990346908569336, 2.309447765350342, 1.0617470741271973, 2.805373191833496, 0.3407602310180664, 1.3308358192443848, 0.8579807281494141, 1.916297435760498, 1.8239526748657227, 0.21770238876342773, 1.36649751663208, 0.34296751022338867, 1.590677261352539, 0.851165771484375, 0.6968812942504883, 1.6197137832641602, 1.8585124015808105, 2.9896745681762695, 0.06960010528564453, 1.9674358367919922, 0.28657960891723633, 1.6128668785095215, 3.104719638824463, 1.5107073783874512, 2.1145009994506836, 1.841003179550171, 0.8869662284851074, 0.31716012954711914, 1.4696218967437744, 0.18365859985351562, 0.27940845489501953, 2.9018898010253906, 0.48415040969848633, 3.4301669597625732, 4.570609092712402, 0.07438087463378906, 0.3514242172241211, 0.8974261283874512, 2.0223441123962402, 1.926124095916748, 1.9449024200439453, 1.0520176887512207, 1.7678565979003906], "mean_td_error": 1.1838563680648804, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 84.0}}, "num_env_steps_sampled": 18400, "num_env_steps_trained": 21760, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 21760, "last_target_update_ts": 18400, "num_target_updates": 85}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3716.3713500766366, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1863.560369784926, "robot_1": 1852.8109802917118}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1863.560369784926, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1852.8109802917118, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7507272537326762, "mean_inference_ms": 3.3836873028455416, "mean_action_processing_ms": 0.4610687813639341, "mean_env_wait_ms": 0.46608832769649694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007675422562493218, "StateBufferConnector_ms": 0.0013927618662516277, "ViewRequirementAgentConnector_ms": 0.1541733741760254}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3716.3713500766366, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1863.560369784926, "robot_1": 1852.8109802917118}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7507272537326762, "mean_inference_ms": 3.3836873028455416, "mean_action_processing_ms": 0.4610687813639341, "mean_env_wait_ms": 0.46608832769649694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007675422562493218, "StateBufferConnector_ms": 0.0013927618662516277, "ViewRequirementAgentConnector_ms": 0.1541733741760254}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 21760, "num_env_steps_sampled": 18400, "num_env_steps_trained": 21760, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 402.9527229361218, "num_env_steps_trained_throughput_per_sec": 515.7794853582359, "timesteps_total": 18400, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 36800, "timers": {"training_iteration_time_ms": 496.249, "sample_time_ms": 281.153, "load_time_ms": 0.427, "load_throughput": 598985.732, "learn_time_ms": 34.102, "learn_throughput": 7506.805, "synch_weights_time_ms": 10.647}, "counters": {"num_env_steps_sampled": 18400, "num_env_steps_trained": 21760, "num_agent_steps_sampled": 36800, "num_agent_steps_trained": 21760, "last_target_update_ts": 18400, "num_target_updates": 85}, "done": false, "episodes_total": 36, "training_iteration": 36, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-29", "timestamp": 1742662589, "time_this_iter_s": 1.5068387985229492, "time_total_s": 47.49130415916443, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7748B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 47.49130415916443, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 35.0, "ram_util_percent": 89.55}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1863.560369784926, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1852.8109802917118, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.397262573242188, "actor_loss": -13.822013854980469, "critic_loss": 0.21764692664146423, "alpha_loss": -0.3496788740158081, "alpha_value": 0.9742369055747986, "log_alpha_value": -0.026100773364305496, "target_entropy": -8.0, "policy_t": 0.005781293846666813, "mean_q": 8.745083808898926, "max_q": 13.709715843200684, "min_q": 6.4969162940979}, "td_error": [0.5100665092468262, 1.260298252105713, 0.8522353172302246, 0.6134204864501953, 1.2431135177612305, 0.5295867919921875, 2.1182596683502197, 0.8199872970581055, 0.599517822265625, 0.29437685012817383, 0.6778078079223633, 0.4906926155090332, 1.7894902229309082, 0.7485179901123047, 2.8554162979125977, 1.0109193325042725, 1.9936609268188477, 0.41938018798828125, 0.2250041961669922, 1.1272590160369873, 0.5660064220428467, 0.1437549591064453, 0.7278001308441162, 0.19699811935424805, 1.720574140548706, 0.6289801597595215, 0.5023832321166992, 2.1923468112945557, 0.23950552940368652, 0.3314785957336426, 1.214393138885498, 0.06265902519226074, 0.5911469459533691, 1.8654394149780273, 1.0400328636169434, 0.40563535690307617, 2.4008946418762207, 3.0506062507629395, 1.3950042724609375, 2.126805305480957, 2.465599775314331, 0.26116037368774414, 0.31755828857421875, 0.6981055736541748, 0.40139198303222656, 0.6227226257324219, 1.8952107429504395, 0.8698296546936035, 2.570723533630371, 2.3052749633789062, 1.7546699047088623, 1.1942005157470703, 1.7955286502838135, 0.6558952331542969, 1.8879292011260986, 1.6792187690734863, 2.050180435180664, 0.7344560623168945, 2.2337703704833984, 1.2661468982696533, 0.47771692276000977, 0.7703783512115479, 0.5885071754455566, 0.9787564277648926, 0.9085559844970703, 0.8529653549194336, 0.6348123550415039, 1.0404386520385742, 0.8234539031982422, 0.5079970359802246, 1.3417067527770996, 0.3811378479003906, 1.4588868618011475, 0.32793712615966797, 1.9633753299713135, 0.9889307022094727, 1.1632137298583984, 0.44121789932250977, 0.6164209842681885, 0.3666410446166992, 1.6876106262207031, 0.6252117156982422, 0.8642616271972656, 1.9462699890136719, 2.265652656555176, 0.16904067993164062, 0.4369797706604004, 0.4298563003540039, 1.4622540473937988, 1.7425732612609863, 1.716845989227295, 0.2330307960510254, 0.2572927474975586, 0.6120390892028809, 0.2701869010925293, 1.995175838470459, 0.8354706764221191, 1.3431761264801025, 1.9474191665649414, 1.7219228744506836, 1.1536686420440674, 1.055264949798584, 2.2738475799560547, 0.14894342422485352, 0.9455313682556152, 0.8110370635986328, 0.20929861068725586, 0.18098688125610352, 0.34463930130004883, 1.160783290863037, 1.9487690925598145, 0.7889504432678223, 1.364633560180664, 2.0036187171936035, 0.639348030090332, 0.5200080871582031, 0.5196948051452637, 1.0609416961669922, 1.8594353199005127, 1.694845199584961, 0.9427556991577148, 0.4508647918701172, 0.4566357135772705, 0.925966739654541, 1.2853331565856934, 0.9445695877075195, 1.5720582008361816, 1.1760101318359375], "mean_td_error": 1.0693342685699463, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.424484252929688, "actor_loss": -13.861675262451172, "critic_loss": 0.19582870602607727, "alpha_loss": -0.35047656297683716, "alpha_value": 0.9742305874824524, "log_alpha_value": -0.026107266545295715, "target_entropy": -8.0, "policy_t": 0.02948000282049179, "mean_q": 8.73379135131836, "max_q": 13.641156196594238, "min_q": 6.1915788650512695}, "td_error": [0.24852228164672852, 0.9196710586547852, 0.2418675422668457, 0.5326886177062988, 1.480224609375, 0.5611042976379395, 0.6504459381103516, 2.2869646549224854, 0.18041181564331055, 0.7041380405426025, 2.389779567718506, 0.5648870468139648, 0.4063887596130371, 1.9581103324890137, 0.4357566833496094, 1.2113831043243408, 0.6588320732116699, 1.2629003524780273, 1.6022005081176758, 1.010472297668457, 0.05333876609802246, 0.4975895881652832, 3.0368289947509766, 0.914888858795166, 1.337998867034912, 2.5348052978515625, 1.8126661777496338, 0.6070456504821777, 0.4036521911621094, 2.130662441253662, 0.46420764923095703, 0.26921892166137695, 2.166541814804077, 0.14001083374023438, 0.8063478469848633, 1.0121967792510986, 0.6520743370056152, 1.13612961769104, 3.2031493186950684, 2.1959915161132812, 0.3807804584503174, 0.255159854888916, 1.7643475532531738, 4.049746513366699, 0.3499898910522461, 2.3493895530700684, 0.9717602729797363, 1.3408102989196777, 1.2963857650756836, 1.5777292251586914, 0.4197869300842285, 1.2848091125488281, 0.8926553726196289, 1.020460605621338, 1.9048199653625488, 0.5388240814208984, 0.3316774368286133, 2.5692138671875, 0.3625788688659668, 2.6566429138183594, 1.5603313446044922, 0.0921316146850586, 0.07244157791137695, 0.2973465919494629, 0.19568347930908203, 1.1348228454589844, 1.3307838439941406, 0.7523281574249268, 0.7455294132232666, 1.15797758102417, 0.2942953109741211, 0.2520456314086914, 0.2864365577697754, 1.5442407131195068, 0.17616748809814453, 0.8225672245025635, 1.001138687133789, 0.9563801288604736, 0.2742295265197754, 0.3459787368774414, 0.37787914276123047, 0.2378087043762207, 0.12772035598754883, 0.1437664031982422, 3.2302610874176025, 1.8302688598632812, 0.5348308086395264, 0.8877191543579102, 1.0254085063934326, 0.30254030227661133, 0.26166343688964844, 1.0716211795806885, 0.39279890060424805, 3.135679006576538, 0.5603547096252441, 0.44273829460144043, 0.39507555961608887, 1.0594336986541748, 0.18343400955200195, 3.1965346336364746, 1.9478404521942139, 1.9282407760620117, 1.572214126586914, 1.6992428302764893, 2.226468563079834, 0.15418672561645508, 1.187729835510254, 0.5898725986480713, 0.3521876335144043, 0.7814030647277832, 2.303262710571289, 1.8666019439697266, 0.5297951698303223, 2.125401020050049, 2.7970781326293945, 1.225574016571045, 0.7417449951171875, 0.6591389179229736, 1.8481249809265137, 2.3943846225738525, 1.205378532409668, 0.17804813385009766, 0.3746037483215332, 1.5993313789367676, 0.3597080707550049, 0.2635345458984375, 1.3905327320098877, 0.818507194519043], "mean_td_error": 1.0844546556472778, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 87.0}}, "num_env_steps_sampled": 19000, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 22528, "last_target_update_ts": 19000, "num_target_updates": 88}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3716.3713500766366, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1863.560369784926, "robot_1": 1852.8109802917118}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1863.560369784926, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1852.8109802917118, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7507272537326762, "mean_inference_ms": 3.3836873028455416, "mean_action_processing_ms": 0.4610687813639341, "mean_env_wait_ms": 0.46608832769649694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007675422562493218, "StateBufferConnector_ms": 0.0013927618662516277, "ViewRequirementAgentConnector_ms": 0.1541733741760254}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3716.3713500766366, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1863.560369784926, "robot_1": 1852.8109802917118}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7507272537326762, "mean_inference_ms": 3.3836873028455416, "mean_action_processing_ms": 0.4610687813639341, "mean_env_wait_ms": 0.46608832769649694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007675422562493218, "StateBufferConnector_ms": 0.0013927618662516277, "ViewRequirementAgentConnector_ms": 0.1541733741760254}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 19000, "num_env_steps_trained": 22528, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 408.96711274284525, "num_env_steps_trained_throughput_per_sec": 523.4779043108418, "timesteps_total": 19000, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 494.431, "sample_time_ms": 278.776, "load_time_ms": 0.313, "load_throughput": 818026.683, "learn_time_ms": 33.958, "learn_throughput": 7538.792, "synch_weights_time_ms": 10.82}, "counters": {"num_env_steps_sampled": 19000, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 22528, "last_target_update_ts": 19000, "num_target_updates": 88}, "done": false, "episodes_total": 36, "training_iteration": 37, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-30", "timestamp": 1742662590, "time_this_iter_s": 1.4824910163879395, "time_total_s": 48.97379517555237, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7744C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 48.97379517555237, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 29.6, "ram_util_percent": 89.6}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1863.560369784926, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1852.8109802917118, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.332613945007324, "actor_loss": -13.462872505187988, "critic_loss": 0.2029290795326233, "alpha_loss": -0.35595980286598206, "alpha_value": 0.9736548066139221, "log_alpha_value": -0.02669842727482319, "target_entropy": -8.0, "policy_t": 0.017980998381972313, "mean_q": 8.436535835266113, "max_q": 13.239828109741211, "min_q": 4.425032615661621}, "td_error": [2.337351083755493, 0.6807537078857422, 3.4507012367248535, 1.0111703872680664, 0.42300891876220703, 1.6467857360839844, 1.4405245780944824, 0.12194299697875977, 1.9224164485931396, 0.3419644832611084, 1.2922782897949219, 0.5125589370727539, 0.33684825897216797, 1.5125141143798828, 1.125819206237793, 1.0221686363220215, 1.3292369842529297, 0.4308905601501465, 1.1974883079528809, 0.4794158935546875, 0.25040745735168457, 1.2105991840362549, 0.18712854385375977, 0.18555998802185059, 0.8600001335144043, 0.5786471366882324, 0.4610409736633301, 2.9143459796905518, 1.3639369010925293, 0.22931909561157227, 1.34527587890625, 0.2696957588195801, 0.6148338317871094, 0.40995168685913086, 1.410120964050293, 2.472480297088623, 0.4742248058319092, 0.7546572685241699, 1.7008781433105469, 0.8494019508361816, 0.8689351081848145, 1.5894544124603271, 1.8941490650177002, 2.6956787109375, 0.14713621139526367, 1.4285907745361328, 1.0825130939483643, 0.35567259788513184, 0.6397030353546143, 0.9698581695556641, 1.1017403602600098, 0.5243563652038574, 0.9770445823669434, 0.5434832572937012, 3.4566798210144043, 0.6866359710693359, 1.570166826248169, 0.5453205108642578, 1.7664601802825928, 0.42621517181396484, 0.5266759395599365, 0.2410125732421875, 2.3071157932281494, 1.4290094375610352, 1.2983250617980957, 1.5468270778656006, 0.8401570320129395, 2.1778762340545654, 0.27632713317871094, 0.5858750343322754, 1.310354232788086, 0.4624505043029785, 1.2274878025054932, 0.24608516693115234, 2.4025659561157227, 0.8685622215270996, 0.6834235191345215, 0.08068203926086426, 0.4422316551208496, 2.435317277908325, 0.9006857872009277, 0.5179238319396973, 0.5206880569458008, 0.6519889831542969, 1.3141565322875977, 0.21915578842163086, 1.0902328491210938, 1.1139683723449707, 0.29087114334106445, 0.774439811706543, 0.5640671253204346, 0.7489309310913086, 0.5418059825897217, 1.024062156677246, 0.3626554012298584, 0.47673583030700684, 0.16532087326049805, 0.1415414810180664, 0.6257033348083496, 0.8687784671783447, 1.704803466796875, 1.3949899673461914, 2.5899195671081543, 1.6809792518615723, 0.9975461959838867, 1.434828519821167, 1.3045446872711182, 1.9972121715545654, 1.2311034202575684, 0.5722794532775879, 1.795722246170044, 1.1873812675476074, 0.7686901092529297, 0.9918808937072754, 1.9592959880828857, 0.3725295066833496, 0.10338973999023438, 1.3102631568908691, 0.6344671249389648, 0.07410025596618652, 0.8398921489715576, 1.4040992259979248, 0.6913561820983887, 1.2132039070129395, 0.3109464645385742, 0.6527543067932129, 0.647770881652832, 0.7180733680725098], "mean_td_error": 1.0102673768997192, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.424541473388672, "actor_loss": -13.736631393432617, "critic_loss": 0.21696797013282776, "alpha_loss": -0.35851120948791504, "alpha_value": 0.9736477732658386, "log_alpha_value": -0.026705656200647354, "target_entropy": -8.0, "policy_t": -0.010124504566192627, "mean_q": 8.66120719909668, "max_q": 13.477560997009277, "min_q": 5.4998393058776855}, "td_error": [0.5100870132446289, 2.2164244651794434, 2.3562521934509277, 0.8650405406951904, 4.109704494476318, 0.6646056175231934, 0.13187313079833984, 0.5224180221557617, 1.3409857749938965, 0.9815211296081543, 0.2345867156982422, 1.2521395683288574, 2.0917928218841553, 1.0705416202545166, 0.3009331226348877, 2.200484275817871, 0.22258949279785156, 1.6216177940368652, 0.4209601879119873, 0.3448805809020996, 1.5775208473205566, 1.3539056777954102, 2.9652624130249023, 0.7874724864959717, 2.6694211959838867, 1.772263526916504, 0.019243717193603516, 0.721937894821167, 1.008868932723999, 0.8645708560943604, 0.6233048439025879, 1.8359580039978027, 0.4453420639038086, 1.0021672248840332, 1.1919283866882324, 0.12539219856262207, 1.350182294845581, 1.0191903114318848, 3.054636001586914, 1.6765823364257812, 0.39339375495910645, 2.3302066326141357, 1.7186901569366455, 1.434189796447754, 0.44872403144836426, 2.6399474143981934, 1.4452168941497803, 1.6750552654266357, 2.635314464569092, 0.5444955825805664, 0.17956876754760742, 2.1920690536499023, 0.05552482604980469, 1.3309712409973145, 0.8066027164459229, 1.4913957118988037, 1.8914716243743896, 0.37729835510253906, 1.9708900451660156, 1.4202027320861816, 1.8818955421447754, 0.5233449935913086, 0.42127513885498047, 0.9946403503417969, 1.546154499053955, 1.5664904117584229, 1.5700340270996094, 1.0383403301239014, 1.170738697052002, 1.2334320545196533, 0.3485708236694336, 0.6903843879699707, 2.049685478210449, 0.9989988803863525, 0.8961482048034668, 0.7240371704101562, 2.403809070587158, 0.7101912498474121, 1.693437099456787, 2.064380645751953, 1.7579104900360107, 0.6767306327819824, 1.7243363857269287, 1.038578987121582, 0.37311744689941406, 1.5025551319122314, 2.04573917388916, 0.5045361518859863, 1.1714956760406494, 0.6733193397521973, 1.8951494693756104, 0.7694637775421143, 2.1555027961730957, 0.7446126937866211, 0.2622718811035156, 0.5184471607208252, 1.4117670059204102, 1.0024619102478027, 1.090968132019043, 2.170055389404297, 0.5928096771240234, 0.42414426803588867, 0.6773161888122559, 0.9588241577148438, 2.6942920684814453, 0.5060276985168457, 2.7850189208984375, 2.4585957527160645, 0.8330285549163818, 0.7357492446899414, 1.270895004272461, 2.170077323913574, 0.8523454666137695, 1.765404224395752, 0.8136098384857178, 0.2648897171020508, 0.7433409690856934, 1.528336524963379, 0.8551497459411621, 1.025186538696289, 0.4495878219604492, 1.103522539138794, 0.45870471000671387, 0.5448274612426758, 1.6648571491241455, 1.102248191833496, 1.167107343673706, 1.1424484252929688], "mean_td_error": 1.2196028232574463, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 89.0}}, "num_env_steps_sampled": 19400, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 38800, "num_agent_steps_trained": 23040, "last_target_update_ts": 19400, "num_target_updates": 90}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3716.3713500766366, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1863.560369784926, "robot_1": 1852.8109802917118}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1863.560369784926, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1852.8109802917118, "('robot_1', 'robot_1')_total_reward_min": 1707.6413729380138, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7507272537326762, "mean_inference_ms": 3.3836873028455416, "mean_action_processing_ms": 0.4610687813639341, "mean_env_wait_ms": 0.46608832769649694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007675422562493218, "StateBufferConnector_ms": 0.0013927618662516277, "ViewRequirementAgentConnector_ms": 0.1541733741760254}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3716.3713500766366, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1707.6413729380138}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1863.560369784926, "robot_1": 1852.8109802917118}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7507272537326762, "mean_inference_ms": 3.3836873028455416, "mean_action_processing_ms": 0.4610687813639341, "mean_env_wait_ms": 0.46608832769649694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007675422562493218, "StateBufferConnector_ms": 0.0013927618662516277, "ViewRequirementAgentConnector_ms": 0.1541733741760254}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38800, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 19400, "num_env_steps_trained": 23040, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 338.54757554263875, "num_env_steps_trained_throughput_per_sec": 433.3408966945776, "timesteps_total": 19400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38800, "timers": {"training_iteration_time_ms": 512.509, "sample_time_ms": 276.237, "load_time_ms": 0.313, "load_throughput": 818026.683, "learn_time_ms": 33.941, "learn_throughput": 7542.478, "synch_weights_time_ms": 10.796}, "counters": {"num_env_steps_sampled": 19400, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 38800, "num_agent_steps_trained": 23040, "last_target_update_ts": 19400, "num_target_updates": 90}, "done": false, "episodes_total": 36, "training_iteration": 38, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-31", "timestamp": 1742662591, "time_this_iter_s": 1.2008893489837646, "time_total_s": 50.17468452453613, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A77F700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 50.17468452453613, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 24.9, "ram_util_percent": 89.65}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1855.4692529041192, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1846.0067469447658, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.353757858276367, "actor_loss": -13.413589477539062, "critic_loss": 0.26901689171791077, "alpha_loss": -0.3684881925582886, "alpha_value": 0.9727829098701477, "log_alpha_value": -0.027594342827796936, "target_entropy": -8.0, "policy_t": 0.01044462714344263, "mean_q": 8.399609565734863, "max_q": 12.532567024230957, "min_q": 4.3415303230285645}, "td_error": [0.19212675094604492, 0.5065975189208984, 1.1555838584899902, 1.1136596202850342, 1.1927189826965332, 1.222465991973877, 0.15301179885864258, 1.1006953716278076, 0.7586724758148193, 2.12149715423584, 0.8262655735015869, 0.33453989028930664, 1.7242012023925781, 1.177074909210205, 0.1680307388305664, 0.2558305263519287, 0.020312786102294922, 1.8866183757781982, 1.8743410110473633, 0.6012239456176758, 0.8980412483215332, 0.29051637649536133, 0.36263275146484375, 2.2922005653381348, 0.33905792236328125, 1.2820582389831543, 0.45671963691711426, 2.1120142936706543, 0.3483891487121582, 0.37048840522766113, 1.7522435188293457, 0.18878507614135742, 2.582521438598633, 2.043948173522949, 0.4971504211425781, 0.34421515464782715, 1.1790528297424316, 1.772597312927246, 0.11093807220458984, 1.6676909923553467, 0.24453949928283691, 2.47385835647583, 0.9114742279052734, 0.8604276180267334, 0.3413670063018799, 0.39568042755126953, 0.39814281463623047, 1.1396148204803467, 0.7950782775878906, 1.536015510559082, 1.1582152843475342, 2.331552028656006, 2.973600387573242, 0.7011008262634277, 0.8557572364807129, 2.302025318145752, 2.875460386276245, 1.1323580741882324, 0.35648012161254883, 0.44722461700439453, 1.666750192642212, 1.0631723403930664, 1.206554889678955, 2.4256629943847656, 0.7724571228027344, 2.618726968765259, 1.3599658012390137, 1.4128105640411377, 0.5074052810668945, 0.7331008911132812, 0.7546596527099609, 2.6061155796051025, 0.2656717300415039, 0.9085330963134766, 1.2507243156433105, 1.5440168380737305, 0.3885684013366699, 0.9054255485534668, 1.590519905090332, 1.605668067932129, 1.829357624053955, 0.4225032329559326, 0.6815109252929688, 0.9433932304382324, 2.9543981552124023, 1.3177783489227295, 0.8299405574798584, 1.0574212074279785, 0.5385279655456543, 0.2990083694458008, 1.9031367301940918, 0.7729148864746094, 0.487260103225708, 0.5083351135253906, 0.11805319786071777, 0.4580414295196533, 1.9448003768920898, 1.0810699462890625, 0.9097931385040283, 0.8064627647399902, 2.4179630279541016, 0.6399707794189453, 0.050400733947753906, 1.886202335357666, 0.7958498001098633, 2.5266785621643066, 3.0028395652770996, 1.5293450355529785, 0.2645401954650879, 2.03060245513916, 1.002331256866455, 2.0807249546051025, 0.819610595703125, 1.9268484115600586, 0.598297119140625, 2.1262803077697754, 0.20443296432495117, 0.4129500389099121, 1.4240002632141113, 1.1702871322631836, 1.7213540077209473, 0.06259346008300781, 2.9551587104797363, 3.6955771446228027, 3.3754079341888428, 0.2573881149291992, 0.7615656852722168, 1.9027061462402344], "mean_td_error": 1.1765532493591309, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.50973892211914, "actor_loss": -13.573127746582031, "critic_loss": 0.21187302470207214, "alpha_loss": -0.37291473150253296, "alpha_value": 0.972774088382721, "log_alpha_value": -0.027603400871157646, "target_entropy": -8.0, "policy_t": 0.022237379103899002, "mean_q": 8.4100341796875, "max_q": 13.90132999420166, "min_q": 4.4633097648620605}, "td_error": [2.07641339302063, 0.9649319648742676, 0.6761984825134277, 0.9371919631958008, 0.7930669784545898, 0.9304676055908203, 1.8842973709106445, 2.8209667205810547, 0.9346883296966553, 0.9826445579528809, 1.3895699977874756, 0.770596981048584, 0.15956878662109375, 0.1891040802001953, 1.1994946002960205, 1.4446163177490234, 0.5327854156494141, 1.4685781002044678, 0.20422983169555664, 0.3061041831970215, 3.111973285675049, 0.9048926830291748, 0.9018120765686035, 0.5172610282897949, 0.9850983619689941, 0.99080491065979, 1.8198881149291992, 1.9152193069458008, 0.2536044120788574, 0.6407184600830078, 0.9833002090454102, 2.5944647789001465, 1.1665644645690918, 0.6027400493621826, 1.4552578926086426, 1.5126628875732422, 0.7098336219787598, 0.3815121650695801, 0.7359833717346191, 0.1693415641784668, 0.6824586391448975, 1.4857821464538574, 0.23877191543579102, 0.45536136627197266, 0.9775090217590332, 0.8667173385620117, 1.580793857574463, 0.8491148948669434, 0.5526599884033203, 1.4575145244598389, 0.26612043380737305, 1.2663187980651855, 2.6177024841308594, 1.0432982444763184, 1.4592361450195312, 0.20817089080810547, 2.536299705505371, 1.905928134918213, 2.229637622833252, 2.6020071506500244, 0.5601701736450195, 0.5668997764587402, 0.4734830856323242, 0.2955808639526367, 0.14223670959472656, 0.5080142021179199, 1.1538968086242676, 0.4455373287200928, 0.5326223373413086, 0.615781307220459, 0.8790173530578613, 0.47483110427856445, 1.052988052368164, 2.823843002319336, 0.37201380729675293, 0.9648470878601074, 0.31743574142456055, 0.030232906341552734, 1.881967306137085, 0.5558319091796875, 0.8215088844299316, 3.900944232940674, 0.5274879932403564, 1.6968355178833008, 1.6034643650054932, 1.517293930053711, 0.7710816860198975, 2.689199924468994, 0.9187097549438477, 0.2554292678833008, 1.548494815826416, 2.831010341644287, 1.4901022911071777, 0.7590012550354004, 1.2257492542266846, 1.9745121002197266, 2.68304705619812, 1.9947388172149658, 1.6598005294799805, 0.9697420597076416, 0.9816746711730957, 0.2500121593475342, 0.6306343078613281, 0.9281635284423828, 2.602648973464966, 0.1932966709136963, 2.357515335083008, 2.2969465255737305, 0.5578713417053223, 1.120957374572754, 0.22463369369506836, 2.608121871948242, 2.6507885456085205, 2.425327777862549, 0.3552718162536621, 2.7014119625091553, 0.043347835540771484, 0.20451879501342773, 1.6604585647583008, 0.44442129135131836, 2.0059516429901123, 1.3179211616516113, 0.11976385116577148, 2.379446506500244, 1.4045743942260742, 0.7205700874328613, 0.7832460403442383, 0.1523761749267578], "mean_td_error": 1.1633367538452148, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 23808, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 23808, "last_target_update_ts": 20000, "num_target_updates": 93}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3701.4759998488844, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1855.4692529041192, "robot_1": 1846.0067469447658}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1855.4692529041192, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1846.0067469447658, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.750206497238094, "mean_inference_ms": 3.3828940752293137, "mean_action_processing_ms": 0.4607257535588234, "mean_env_wait_ms": 0.46572164839739827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069078803062438965, "StateBufferConnector_ms": 0.0028571486473083496, "ViewRequirementAgentConnector_ms": 0.15957772731781006}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3701.4759998488844, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1855.4692529041192, "robot_1": 1846.0067469447658}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.750206497238094, "mean_inference_ms": 3.3828940752293137, "mean_action_processing_ms": 0.4607257535588234, "mean_env_wait_ms": 0.46572164839739827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069078803062438965, "StateBufferConnector_ms": 0.0028571486473083496, "ViewRequirementAgentConnector_ms": 0.15957772731781006}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 23808, "num_env_steps_sampled": 20000, "num_env_steps_trained": 23808, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 402.7566118979354, "num_env_steps_trained_throughput_per_sec": 515.5284632293573, "timesteps_total": 20000, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 514.008, "sample_time_ms": 277.269, "load_time_ms": 0.41, "load_throughput": 623760.79, "learn_time_ms": 33.976, "learn_throughput": 7534.824, "synch_weights_time_ms": 10.722}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 23808, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 23808, "last_target_update_ts": 20000, "num_target_updates": 93}, "done": false, "episodes_total": 40, "training_iteration": 39, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-33", "timestamp": 1742662593, "time_this_iter_s": 1.5059540271759033, "time_total_s": 51.680638551712036, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A77FD30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 51.680638551712036, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 29.049999999999997, "ram_util_percent": 89.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1855.4692529041192, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1846.0067469447658, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.31226921081543, "actor_loss": -13.5145902633667, "critic_loss": 0.22426101565361023, "alpha_loss": -0.3752939999103546, "alpha_value": 0.9722020626068115, "log_alpha_value": -0.028191588819026947, "target_entropy": -8.0, "policy_t": -0.002130065578967333, "mean_q": 8.537301063537598, "max_q": 13.090574264526367, "min_q": 4.3458638191223145}, "td_error": [0.4918088912963867, 0.5867280960083008, 1.6195313930511475, 0.5501224994659424, 1.9460911750793457, 0.37216877937316895, 2.8721961975097656, 2.0649940967559814, 2.607651710510254, 1.0325500965118408, 1.6121838092803955, 0.411226749420166, 0.27754902839660645, 2.1383132934570312, 0.7634086608886719, 1.3162286281585693, 0.1738262176513672, 1.9107122421264648, 0.8106210231781006, 1.4451420307159424, 3.653432846069336, 0.6712784767150879, 1.6817586421966553, 0.6452274322509766, 1.3926973342895508, 0.4300575256347656, 0.8634533882141113, 1.2377290725708008, 0.21399784088134766, 0.29548168182373047, 1.1852824687957764, 0.6549997329711914, 0.5548906326293945, 1.5479958057403564, 2.3602676391601562, 0.43134164810180664, 0.2075366973876953, 0.7140631675720215, 0.6141841411590576, 0.6269657611846924, 2.1225333213806152, 2.4188265800476074, 0.36895012855529785, 0.4589247703552246, 0.37305259704589844, 1.17771577835083, 0.3008580207824707, 0.2473464012145996, 1.6973962783813477, 1.4594602584838867, 1.4769816398620605, 1.2729921340942383, 1.7714247703552246, 0.6067018508911133, 0.46762752532958984, 0.7397236824035645, 0.3833048343658447, 2.940906524658203, 1.4596447944641113, 0.3335099220275879, 1.770963191986084, 3.1454577445983887, 0.19384479522705078, 0.9915008544921875, 0.39914369583129883, 0.8680086135864258, 1.73494553565979, 0.5346322059631348, 2.045987129211426, 0.8392820358276367, 0.7549352645874023, 0.3019595146179199, 1.840127944946289, 0.8305857181549072, 0.44887423515319824, 0.3626699447631836, 0.6256580352783203, 1.249497890472412, 1.723790168762207, 0.6466245651245117, 0.5612516403198242, 0.31943225860595703, 0.2523946762084961, 0.279757022857666, 0.697080135345459, 0.8572988510131836, 0.37027835845947266, 1.341463327407837, 0.9264163970947266, 0.841033935546875, 0.7558245658874512, 0.2076873779296875, 0.9413352012634277, 0.3903641700744629, 0.9692609310150146, 1.8805761337280273, 2.2195382118225098, 1.0619518756866455, 1.7561731338500977, 3.2432124614715576, 3.1352901458740234, 1.094301462173462, 1.0161309242248535, 1.3855743408203125, 0.8313641548156738, 2.091355562210083, 0.597034215927124, 0.6868805885314941, 1.5810356140136719, 0.6144018173217773, 0.42776918411254883, 1.2368965148925781, 0.9253592491149902, 0.9599747657775879, 0.09491539001464844, 1.0636296272277832, 2.565579891204834, 1.583568811416626, 1.556250810623169, 1.5552024841308594, 0.6064910888671875, 0.31498050689697266, 0.3167757987976074, 0.23758983612060547, 0.13824057579040527, 0.572178840637207, 0.2409043312072754, 0.502530574798584], "mean_td_error": 1.0638797283172607, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.369102478027344, "actor_loss": -13.686881065368652, "critic_loss": 0.1753939539194107, "alpha_loss": -0.37703749537467957, "alpha_value": 0.9721918106079102, "log_alpha_value": -0.028202153742313385, "target_entropy": -8.0, "policy_t": 0.008328608237206936, "mean_q": 8.641059875488281, "max_q": 13.59941291809082, "min_q": 4.654131889343262}, "td_error": [0.1937694549560547, 1.1196894645690918, 1.5251476764678955, 1.704150676727295, 2.2649481296539307, 0.743577241897583, 0.6842103004455566, 1.035566806793213, 0.661081075668335, 0.2630000114440918, 0.86920166015625, 0.9264640808105469, 0.41647911071777344, 1.466630220413208, 1.8469643592834473, 0.9262411594390869, 1.2745141983032227, 0.7088885307312012, 0.4410243034362793, 2.308490037918091, 1.5911462306976318, 0.0975656509399414, 0.3150520324707031, 0.5477042198181152, 1.5419368743896484, 0.49952054023742676, 0.3882617950439453, 0.9468493461608887, 0.9611749649047852, 0.3645939826965332, 1.2916851043701172, 0.765815019607544, 2.267904043197632, 1.4078330993652344, 0.6684665679931641, 0.36666345596313477, 1.1808862686157227, 0.8377857208251953, 0.8880777359008789, 0.38221240043640137, 0.14377212524414062, 0.508880615234375, 2.4088387489318848, 1.7526724338531494, 0.5279750823974609, 0.42574548721313477, 0.9160256385803223, 0.5259208679199219, 2.604445457458496, 0.5515379905700684, 0.7792186737060547, 1.4890718460083008, 0.502448558807373, 0.5805964469909668, 1.4189746379852295, 0.4264059066772461, 2.9501945972442627, 0.24488258361816406, 0.16455650329589844, 0.696333646774292, 1.14548921585083, 2.430025100708008, 1.5395774841308594, 0.40393567085266113, 1.5572385787963867, 0.19597482681274414, 0.506401777267456, 1.2547307014465332, 0.6130709648132324, 1.1447582244873047, 0.9961535930633545, 0.7847065925598145, 1.4948344230651855, 1.5100107192993164, 1.3474586009979248, 1.3220787048339844, 1.7241520881652832, 0.40421438217163086, 0.43270301818847656, 1.7782185077667236, 0.32917356491088867, 0.32953453063964844, 0.9911291599273682, 0.057659149169921875, 0.5458931922912598, 0.19858312606811523, 0.5200352668762207, 1.075425624847412, 0.7276096343994141, 0.2667851448059082, 0.1498398780822754, 1.1824533939361572, 1.8886375427246094, 1.421579360961914, 1.0123412609100342, 1.192410945892334, 1.5788843631744385, 0.31873607635498047, 0.9988436698913574, 1.1443328857421875, 1.9067683219909668, 0.4055352210998535, 3.214601755142212, 0.3086237907409668, 0.503976583480835, 2.1308701038360596, 0.23655271530151367, 2.159397840499878, 0.5908236503601074, 3.0810670852661133, 1.9005804061889648, 1.2788004875183105, 1.174349308013916, 0.1396169662475586, 2.2041516304016113, 0.25789356231689453, 1.5534024238586426, 0.4283599853515625, 1.281646490097046, 1.12064790725708, 0.7519803047180176, 0.6263010501861572, 0.8526487350463867, 0.3596072196960449, 2.4150609970092773, 0.5356354713439941, 1.6699204444885254, 2.1727774143218994], "mean_td_error": 1.0319288969039917, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 20400, "num_env_steps_trained": 24320, "num_agent_steps_sampled": 40800, "num_agent_steps_trained": 24320, "last_target_update_ts": 20400, "num_target_updates": 95}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3701.4759998488844, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1855.4692529041192, "robot_1": 1846.0067469447658}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1855.4692529041192, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1846.0067469447658, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.750206497238094, "mean_inference_ms": 3.3828940752293137, "mean_action_processing_ms": 0.4607257535588234, "mean_env_wait_ms": 0.46572164839739827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069078803062438965, "StateBufferConnector_ms": 0.0028571486473083496, "ViewRequirementAgentConnector_ms": 0.15957772731781006}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3701.4759998488844, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1855.4692529041192, "robot_1": 1846.0067469447658}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.750206497238094, "mean_inference_ms": 3.3828940752293137, "mean_action_processing_ms": 0.4607257535588234, "mean_env_wait_ms": 0.46572164839739827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069078803062438965, "StateBufferConnector_ms": 0.0028571486473083496, "ViewRequirementAgentConnector_ms": 0.15957772731781006}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40800, "num_agent_steps_trained": 24320, "num_env_steps_sampled": 20400, "num_env_steps_trained": 24320, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 307.4431548095717, "num_env_steps_trained_throughput_per_sec": 393.52723815625177, "timesteps_total": 20400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40800, "timers": {"training_iteration_time_ms": 543.838, "sample_time_ms": 275.094, "load_time_ms": 0.614, "load_throughput": 416679.663, "learn_time_ms": 33.972, "learn_throughput": 7535.718, "synch_weights_time_ms": 42.067}, "counters": {"num_env_steps_sampled": 20400, "num_env_steps_trained": 24320, "num_agent_steps_sampled": 40800, "num_agent_steps_trained": 24320, "last_target_update_ts": 20400, "num_target_updates": 95}, "done": false, "episodes_total": 40, "training_iteration": 40, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-34", "timestamp": 1742662594, "time_this_iter_s": 1.3215115070343018, "time_total_s": 53.00215005874634, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A77F670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 53.00215005874634, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 26.65, "ram_util_percent": 89.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1855.4692529041192, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1846.0067469447658, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.404328346252441, "actor_loss": -13.410430908203125, "critic_loss": 0.16736483573913574, "alpha_loss": -0.3898879289627075, "alpha_value": 0.9713322520256042, "log_alpha_value": -0.029086720198392868, "target_entropy": -8.0, "policy_t": 0.0004119095392525196, "mean_q": 8.335350036621094, "max_q": 11.71045207977295, "min_q": 5.823975086212158}, "td_error": [0.09952020645141602, 1.5013415813446045, 0.7001023292541504, 0.7881636619567871, 0.1442852020263672, 0.10144281387329102, 1.4081077575683594, 1.267350673675537, 0.7183923721313477, 1.2201886177062988, 0.3936800956726074, 0.5528302192687988, 1.3632922172546387, 0.9411077499389648, 0.9684963226318359, 1.210939884185791, 0.9476437568664551, 1.7027480602264404, 1.3866493701934814, 1.5481071472167969, 0.713416337966919, 0.8003659248352051, 0.6962509155273438, 0.5786502361297607, 0.8971583843231201, 2.304499626159668, 1.0484776496887207, 0.19015908241271973, 1.4539518356323242, 2.1089305877685547, 0.5708088874816895, 0.3549327850341797, 1.2490582466125488, 0.32974815368652344, 0.4345226287841797, 0.14190292358398438, 0.6645355224609375, 1.080193042755127, 0.16706466674804688, 0.809685230255127, 0.8651914596557617, 0.4905848503112793, 0.3807802200317383, 0.43025994300842285, 0.42554283142089844, 0.10097932815551758, 0.5327539443969727, 1.1088042259216309, 0.14926576614379883, 1.7159521579742432, 1.688720464706421, 0.606903076171875, 0.4219694137573242, 1.4083678722381592, 0.3987002372741699, 1.2486193180084229, 1.0807843208312988, 1.0797600746154785, 0.8392448425292969, 0.3464503288269043, 0.31032705307006836, 1.5895500183105469, 0.2523078918457031, 1.072533130645752, 1.1640958786010742, 0.1958932876586914, 0.5469799041748047, 0.7220382690429688, 1.0808134078979492, 0.5087189674377441, 1.9769151210784912, 1.5385541915893555, 0.6300704479217529, 0.8263206481933594, 0.9315040111541748, 0.4256570339202881, 2.5515739917755127, 0.1620345115661621, 0.9300003051757812, 1.1226582527160645, 1.4978477954864502, 2.755641222000122, 0.46173524856567383, 0.10781288146972656, 0.08319783210754395, 0.7184786796569824, 1.3394548892974854, 1.0236363410949707, 0.18542242050170898, 0.9623830318450928, 1.5405473709106445, 0.36577367782592773, 1.0684778690338135, 2.277533769607544, 0.6279788017272949, 0.30954456329345703, 0.5042617321014404, 0.49826717376708984, 0.49549388885498047, 0.3606085777282715, 1.8474831581115723, 0.5536084175109863, 0.2147984504699707, 0.6754899024963379, 0.9561643600463867, 1.5178627967834473, 0.8106720447540283, 0.40309667587280273, 0.47605347633361816, 2.0848209857940674, 0.9161062240600586, 0.15749549865722656, 1.838644027709961, 0.35721254348754883, 0.7286453247070312, 0.4064345359802246, 0.9328386783599854, 0.8727383613586426, 0.8545718193054199, 0.5969700813293457, 0.6045949459075928, 0.9550766944885254, 0.8922996520996094, 0.5087642669677734, 2.489158868789673, 0.23652362823486328, 0.9609572887420654, 1.046694278717041], "mean_td_error": 0.8710683584213257, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.409517288208008, "actor_loss": -13.471014022827148, "critic_loss": 0.1712828278541565, "alpha_loss": -0.3902217149734497, "alpha_value": 0.9713189601898193, "log_alpha_value": -0.029100356623530388, "target_entropy": -8.0, "policy_t": 0.028574027121067047, "mean_q": 8.347380638122559, "max_q": 12.123568534851074, "min_q": 4.744413375854492}, "td_error": [1.502535343170166, 0.6999833583831787, 1.1284828186035156, 1.150050401687622, 1.7629411220550537, 1.209669589996338, 0.6536498069763184, 1.6107780933380127, 1.7022109031677246, 1.185297966003418, 0.5347275733947754, 0.41730690002441406, 0.5844783782958984, 1.117544412612915, 0.970252513885498, 0.5799696445465088, 0.746208906173706, 2.819561719894409, 1.780705451965332, 0.836639404296875, 0.24288511276245117, 0.5281472206115723, 0.8231234550476074, 1.1455259323120117, 0.19679784774780273, 1.2178187370300293, 0.6309571266174316, 0.9704875946044922, 1.3538269996643066, 0.8221502304077148, 2.2450437545776367, 0.32822322845458984, 1.0091352462768555, 0.3022303581237793, 1.0972590446472168, 1.6670961380004883, 1.0855908393859863, 0.24760103225708008, 2.057248592376709, 2.1069211959838867, 0.5171785354614258, 1.057438850402832, 0.3770871162414551, 0.6557064056396484, 0.5261306762695312, 1.1479334831237793, 2.0401463508605957, 1.265925407409668, 0.5321507453918457, 0.40038013458251953, 1.2248311042785645, 1.0144617557525635, 0.9770855903625488, 0.2964448928833008, 0.564302921295166, 1.3235235214233398, 1.0844120979309082, 1.579932689666748, 0.5176334381103516, 1.8128166198730469, 0.35897159576416016, 1.70756196975708, 1.2214174270629883, 2.2216262817382812, 0.2848498821258545, 0.5607953071594238, 0.8003497123718262, 1.6986939907073975, 0.915463924407959, 2.348496675491333, 1.5636773109436035, 0.38788723945617676, 0.47548818588256836, 0.8953571319580078, 1.7735624313354492, 0.5270528793334961, 0.7104711532592773, 2.384756565093994, 1.2912659645080566, 0.31602954864501953, 1.2100892066955566, 1.8654074668884277, 0.17230534553527832, 1.3515558242797852, 1.2743172645568848, 1.09671950340271, 0.8291687965393066, 1.429023265838623, 0.11278295516967773, 1.8191728591918945, 0.7470057010650635, 0.4890875816345215, 0.10448312759399414, 0.393186092376709, 2.1017749309539795, 3.1637814044952393, 0.9552583694458008, 1.659651279449463, 0.7601895332336426, 0.9581921100616455, 0.3476078510284424, 1.6225461959838867, 1.7317829132080078, 0.42439746856689453, 0.31360769271850586, 0.530937671661377, 1.7602365016937256, 0.506417989730835, 2.125041961669922, 1.517604112625122, 0.04085874557495117, 1.5252065658569336, 1.1036162376403809, 0.27092885971069336, 0.9829344749450684, 1.6247601509094238, 1.7494897842407227, 0.8541989326477051, 0.442626953125, 0.07170534133911133, 1.0485000610351562, 0.5094742774963379, 1.1544201374053955, 0.07027006149291992, 2.8505115509033203, 1.1223845481872559, 0.24536752700805664, 0.9733002185821533], "mean_td_error": 1.0503456592559814, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}}, "num_env_steps_sampled": 21000, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 25088, "last_target_update_ts": 21000, "num_target_updates": 98}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3701.4759998488844, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1855.4692529041192, "robot_1": 1846.0067469447658}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1855.4692529041192, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1846.0067469447658, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.750206497238094, "mean_inference_ms": 3.3828940752293137, "mean_action_processing_ms": 0.4607257535588234, "mean_env_wait_ms": 0.46572164839739827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069078803062438965, "StateBufferConnector_ms": 0.0028571486473083496, "ViewRequirementAgentConnector_ms": 0.15957772731781006}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3701.4759998488844, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1855.4692529041192, "robot_1": 1846.0067469447658}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.750206497238094, "mean_inference_ms": 3.3828940752293137, "mean_action_processing_ms": 0.4607257535588234, "mean_env_wait_ms": 0.46572164839739827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069078803062438965, "StateBufferConnector_ms": 0.0028571486473083496, "ViewRequirementAgentConnector_ms": 0.15957772731781006}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 25088, "num_env_steps_sampled": 21000, "num_env_steps_trained": 25088, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 404.5995993847522, "num_env_steps_trained_throughput_per_sec": 517.8874872124828, "timesteps_total": 21000, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 545.422, "sample_time_ms": 275.896, "load_time_ms": 0.659, "load_throughput": 388249.141, "learn_time_ms": 34.183, "learn_throughput": 7489.113, "synch_weights_time_ms": 42.063}, "counters": {"num_env_steps_sampled": 21000, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 25088, "last_target_update_ts": 21000, "num_target_updates": 98}, "done": false, "episodes_total": 40, "training_iteration": 41, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-36", "timestamp": 1742662596, "time_this_iter_s": 1.4988996982574463, "time_total_s": 54.501049757003784, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7DA820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 54.501049757003784, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 35.1, "ram_util_percent": 89.7}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1855.4692529041192, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1846.0067469447658, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.426162719726562, "actor_loss": -13.682353019714355, "critic_loss": 0.24128657579421997, "alpha_loss": -0.4025455415248871, "alpha_value": 0.9704627990722656, "log_alpha_value": -0.029982175678014755, "target_entropy": -8.0, "policy_t": 0.0069649359211325645, "mean_q": 8.502969741821289, "max_q": 12.578168869018555, "min_q": 5.812058448791504}, "td_error": [1.5274734497070312, 1.2386422157287598, 0.11439943313598633, 1.0687973499298096, 2.9454524517059326, 0.31802916526794434, 3.8139851093292236, 0.9333164691925049, 0.37873268127441406, 1.0548725128173828, 0.1708049774169922, 1.3731837272644043, 0.20963191986083984, 0.5713334083557129, 0.05893278121948242, 1.3656673431396484, 0.8114590644836426, 1.2769355773925781, 0.8424911499023438, 0.5763812065124512, 2.151279926300049, 1.8032104969024658, 0.4371199607849121, 0.8969225883483887, 0.8436708450317383, 2.268587827682495, 0.8453223705291748, 1.5970044136047363, 1.3423659801483154, 0.8519148826599121, 0.8957104682922363, 0.732884407043457, 1.3377022743225098, 0.37094879150390625, 0.2441716194152832, 1.3544058799743652, 2.6607115268707275, 1.2897567749023438, 0.8101739883422852, 0.19605493545532227, 0.5530674457550049, 0.3613255023956299, 0.12583351135253906, 0.2918083667755127, 0.8101680278778076, 1.4047586917877197, 0.20757722854614258, 0.5945878028869629, 0.5685129165649414, 0.6704578399658203, 0.2202296257019043, 0.801262378692627, 0.737551212310791, 0.8532969951629639, 0.9878082275390625, 2.424551486968994, 1.1502068042755127, 1.374290943145752, 3.2175679206848145, 1.7666730880737305, 2.3838558197021484, 0.7196736335754395, 0.6583161354064941, 0.40820837020874023, 0.6480441093444824, 0.21131324768066406, 2.3572633266448975, 0.2919449806213379, 0.43367624282836914, 0.953009843826294, 0.056929588317871094, 2.0760486125946045, 1.4335384368896484, 1.107306957244873, 0.9684333801269531, 1.3656983375549316, 0.5033245086669922, 1.0886104106903076, 1.1044857501983643, 0.24886369705200195, 1.1826775074005127, 2.3258461952209473, 1.5595831871032715, 1.122952938079834, 1.3026371002197266, 0.9747390747070312, 1.7114760875701904, 0.528897762298584, 0.5040550231933594, 1.0934443473815918, 2.563401222229004, 0.2725534439086914, 1.7385752201080322, 0.9805924892425537, 0.22487878799438477, 2.3314735889434814, 1.0017194747924805, 0.6613240242004395, 0.11331319808959961, 0.4333474636077881, 0.3503303527832031, 0.278536319732666, 1.3236885070800781, 0.8320813179016113, 1.2921051979064941, 0.08045268058776855, 0.8755223751068115, 0.3102092742919922, 0.6207423210144043, 0.6955502033233643, 1.5796449184417725, 1.718557596206665, 1.9736275672912598, 1.3116106986999512, 2.228581428527832, 0.4030780792236328, 2.0535542964935303, 2.2585442066192627, 2.1967580318450928, 1.0544228553771973, 3.2789344787597656, 0.6270098686218262, 0.44199371337890625, 0.8396105766296387, 2.0384938716888428, 0.2637062072753906, 1.1837024688720703, 0.6641721725463867], "mean_td_error": 1.071275234222412, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.302427291870117, "actor_loss": -13.490385055541992, "critic_loss": 0.1882321834564209, "alpha_loss": -0.39905881881713867, "alpha_value": 0.9704465270042419, "log_alpha_value": -0.02999894507229328, "target_entropy": -8.0, "policy_t": 0.00024017086252570152, "mean_q": 8.483187675476074, "max_q": 12.405513763427734, "min_q": 5.079914093017578}, "td_error": [0.21102142333984375, 0.935706615447998, 0.5448408126831055, 1.5140299797058105, 0.8145802021026611, 2.0231547355651855, 1.3211779594421387, 0.920100212097168, 0.7352743148803711, 1.457601547241211, 1.687225341796875, 1.4959943294525146, 2.397020101547241, 0.7625198364257812, 0.5023193359375, 1.780256748199463, 0.40812063217163086, 0.3984341621398926, 0.5857248306274414, 1.4394702911376953, 0.7218585014343262, 0.2441401481628418, 0.3240175247192383, 1.0333123207092285, 1.038133144378662, 0.5278348922729492, 0.24874591827392578, 1.4423575401306152, 3.2341156005859375, 1.6407439708709717, 0.1669301986694336, 1.0988764762878418, 0.9630064964294434, 1.5529069900512695, 0.6033196449279785, 2.4241089820861816, 0.19964027404785156, 0.21357417106628418, 0.13329553604125977, 0.31305551528930664, 1.4749832153320312, 0.8998498916625977, 0.40074968338012695, 2.071606159210205, 1.1254987716674805, 1.4872636795043945, 1.6765029430389404, 1.1974096298217773, 1.2340521812438965, 1.67402982711792, 1.1860482692718506, 0.5600371360778809, 0.809025764465332, 0.9304804801940918, 0.8585467338562012, 1.0465764999389648, 1.1340646743774414, 0.24098443984985352, 1.1353793144226074, 0.47755908966064453, 2.4711966514587402, 0.25434398651123047, 2.3988943099975586, 1.6827666759490967, 0.27614355087280273, 1.4168462753295898, 0.41402530670166016, 1.627673625946045, 1.8518199920654297, 0.4852161407470703, 0.8864037990570068, 1.4100866317749023, 0.7268161773681641, 1.078059196472168, 0.2554755210876465, 0.6632399559020996, 2.983213186264038, 0.3083305358886719, 1.5625038146972656, 1.1473751068115234, 3.0141594409942627, 2.090289831161499, 0.3382377624511719, 0.39456892013549805, 0.24416494369506836, 1.9712259769439697, 0.7410478591918945, 0.7254638671875, 0.2624845504760742, 1.205237865447998, 1.3277180194854736, 0.7188565731048584, 1.53294038772583, 2.4051127433776855, 1.869607925415039, 0.23679780960083008, 1.7380237579345703, 1.029219388961792, 0.7786879539489746, 0.0747079849243164, 1.4072108268737793, 0.5217337608337402, 0.22743844985961914, 2.4689338207244873, 0.8570356369018555, 1.1539554595947266, 1.601646900177002, 1.631784439086914, 0.7422523498535156, 1.246307611465454, 0.12317705154418945, 0.6210432052612305, 1.263969898223877, 1.3125734329223633, 1.9431829452514648, 0.6362271308898926, 0.03351736068725586, 0.5815396308898926, 1.075066089630127, 0.22070074081420898, 2.879870653152466, 2.0833587646484375, 0.42641687393188477, 1.7088065147399902, 0.7598381042480469, 0.9535336494445801, 1.309251308441162, 1.1810030937194824], "mean_td_error": 1.087887167930603, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 21600, "num_env_steps_trained": 25856, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 25856, "last_target_update_ts": 21600, "num_target_updates": 101}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3701.4759998488844, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1855.4692529041192, "robot_1": 1846.0067469447658}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1855.4692529041192, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1846.0067469447658, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.750206497238094, "mean_inference_ms": 3.3828940752293137, "mean_action_processing_ms": 0.4607257535588234, "mean_env_wait_ms": 0.46572164839739827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069078803062438965, "StateBufferConnector_ms": 0.0028571486473083496, "ViewRequirementAgentConnector_ms": 0.15957772731781006}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3701.4759998488844, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1855.4692529041192, "robot_1": 1846.0067469447658}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.750206497238094, "mean_inference_ms": 3.3828940752293137, "mean_action_processing_ms": 0.4607257535588234, "mean_env_wait_ms": 0.46572164839739827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069078803062438965, "StateBufferConnector_ms": 0.0028571486473083496, "ViewRequirementAgentConnector_ms": 0.15957772731781006}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 25856, "num_env_steps_sampled": 21600, "num_env_steps_trained": 25856, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 409.6680779797554, "num_env_steps_trained_throughput_per_sec": 524.375139814087, "timesteps_total": 21600, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 43200, "timers": {"training_iteration_time_ms": 523.77, "sample_time_ms": 275.127, "load_time_ms": 0.764, "load_throughput": 335125.413, "learn_time_ms": 34.802, "learn_throughput": 7355.913, "synch_weights_time_ms": 42.18}, "counters": {"num_env_steps_sampled": 21600, "num_env_steps_trained": 25856, "num_agent_steps_sampled": 43200, "num_agent_steps_trained": 25856, "last_target_update_ts": 21600, "num_target_updates": 101}, "done": false, "episodes_total": 40, "training_iteration": 42, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-43", "timestamp": 1742662603, "time_this_iter_s": 1.4826288223266602, "time_total_s": 55.983678579330444, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A77F160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 55.983678579330444, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 14.936363636363636, "ram_util_percent": 89.89999999999999}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1849.6098398294582, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1842.791308342964, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.413158416748047, "actor_loss": -13.883438110351562, "critic_loss": 0.19236980378627777, "alpha_loss": -0.41016751527786255, "alpha_value": 0.9698833227157593, "log_alpha_value": -0.03057948872447014, "target_entropy": -8.0, "policy_t": -0.054673921316862106, "mean_q": 8.821924209594727, "max_q": 12.868721008300781, "min_q": 6.117859840393066}, "td_error": [2.7450006008148193, 0.7185642719268799, 0.605236291885376, 0.2323017120361328, 0.9360983371734619, 0.9234557151794434, 1.2324330806732178, 1.75996994972229, 0.575777530670166, 0.22989845275878906, 0.2005763053894043, 0.38280725479125977, 0.3883342742919922, 0.7430667877197266, 0.6839022636413574, 0.45578861236572266, 1.4089479446411133, 2.5219035148620605, 0.2584071159362793, 0.9165775775909424, 0.15073490142822266, 1.1418049335479736, 0.13799571990966797, 0.1449565887451172, 1.232872486114502, 0.35421085357666016, 0.09717082977294922, 0.4152066707611084, 0.46869707107543945, 0.8987133502960205, 0.641179084777832, 2.298365592956543, 0.5011520385742188, 0.9079604148864746, 0.512270450592041, 0.7153408527374268, 1.1863865852355957, 1.1368992328643799, 0.6497106552124023, 0.6247673034667969, 1.0319850444793701, 1.7518982887268066, 1.6483418941497803, 0.9814691543579102, 0.8098335266113281, 1.6584680080413818, 2.227081775665283, 1.1492514610290527, 0.8739252090454102, 2.0829849243164062, 1.1027607917785645, 0.9204833507537842, 0.9513750076293945, 0.8939330577850342, 0.615227222442627, 0.45067358016967773, 1.1413931846618652, 0.7225642204284668, 0.08917856216430664, 0.6611804962158203, 1.3946099281311035, 0.8703842163085938, 0.7669367790222168, 2.6996994018554688, 0.4629979133605957, 0.30713558197021484, 2.15944766998291, 0.9990932941436768, 1.289909839630127, 0.7341785430908203, 1.4118728637695312, 1.1508631706237793, 1.0152530670166016, 0.7193825244903564, 0.4759073257446289, 1.1677978038787842, 0.9971098899841309, 0.6268367767333984, 1.617297649383545, 1.060868263244629, 0.10414409637451172, 1.5278434753417969, 0.28728485107421875, 0.805107593536377, 0.5298833847045898, 0.6755695343017578, 2.0496716499328613, 2.0160820484161377, 0.13808774948120117, 1.145826816558838, 0.13002967834472656, 1.4465641975402832, 1.5585379600524902, 1.224114179611206, 0.25693798065185547, 0.868725061416626, 1.669724464416504, 1.1174225807189941, 0.4548015594482422, 0.23067903518676758, 0.9608278274536133, 1.5859670639038086, 0.04879426956176758, 0.2586660385131836, 0.5377302169799805, 0.4249424934387207, 1.3434605598449707, 1.4986534118652344, 2.021270275115967, 1.1620287895202637, 0.35611438751220703, 1.143305778503418, 0.2980527877807617, 0.5750808715820312, 1.0985984802246094, 0.6623468399047852, 1.4062509536743164, 1.0343403816223145, 0.2589535713195801, 1.0482723712921143, 1.576270580291748, 1.1310091018676758, 0.5963525772094727, 1.0757737159729004, 1.4404354095458984, 1.986452579498291, 1.453554630279541, 0.3353400230407715], "mean_td_error": 0.9483039379119873, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.369707107543945, "actor_loss": -13.72620964050293, "critic_loss": 0.17354214191436768, "alpha_loss": -0.4090818166732788, "alpha_value": 0.9698656797409058, "log_alpha_value": -0.030597668141126633, "target_entropy": -8.0, "policy_t": 0.00886877067387104, "mean_q": 8.586088180541992, "max_q": 11.614158630371094, "min_q": 6.356768608093262}, "td_error": [1.4943151473999023, 0.5071449279785156, 1.507204532623291, 0.42650651931762695, 0.6601614952087402, 1.0516412258148193, 0.19962739944458008, 0.33754658699035645, 0.1741800308227539, 1.575089454650879, 0.5702974796295166, 1.0627660751342773, 2.9222638607025146, 1.6280186176300049, 1.813654899597168, 0.8016500473022461, 0.42881083488464355, 1.0830268859863281, 2.6814236640930176, 1.6025030612945557, 0.9515409469604492, 1.3672068119049072, 0.7375860214233398, 0.47222399711608887, 1.720062255859375, 1.7446491718292236, 1.137721061706543, 1.1826014518737793, 1.0155887603759766, 0.48125648498535156, 1.7329635620117188, 1.757190465927124, 0.6570956707000732, 2.8363428115844727, 0.12220335006713867, 0.24147891998291016, 0.0948953628540039, 0.7398710250854492, 0.26148176193237305, 0.5649385452270508, 1.7177526950836182, 1.9900062084197998, 0.3382081985473633, 1.5735483169555664, 1.653928279876709, 2.1501026153564453, 0.8288478851318359, 1.6034390926361084, 0.4447002410888672, 0.5858116149902344, 0.7353930473327637, 0.32781434059143066, 0.8090653419494629, 1.5990667343139648, 0.5712599754333496, 0.6933183670043945, 1.0983762741088867, 1.3011407852172852, 0.43092918395996094, 0.24829959869384766, 0.8657264709472656, 1.9462344646453857, 0.22696733474731445, 0.6136105060577393, 0.7907266616821289, 0.6534595489501953, 2.410531520843506, 1.9249389171600342, 0.7287693023681641, 0.8548226356506348, 0.9135422706604004, 0.35167455673217773, 1.5117018222808838, 1.0302557945251465, 1.9832382202148438, 0.993403434753418, 0.27216434478759766, 2.1962547302246094, 0.9444596767425537, 0.3780202865600586, 0.9419248104095459, 1.2177329063415527, 1.0884883403778076, 0.5089387893676758, 1.3318212032318115, 1.6126925945281982, 0.3552823066711426, 0.6088638305664062, 0.22519588470458984, 0.36977100372314453, 0.3168020248413086, 0.037149906158447266, 1.0538551807403564, 0.9491055011749268, 0.7376909255981445, 0.8703007698059082, 1.9822218418121338, 1.6196222305297852, 1.8214471340179443, 1.8767807483673096, 2.1293046474456787, 0.8861703872680664, 1.437695026397705, 0.30103206634521484, 0.3666238784790039, 0.9572906494140625, 1.5034303665161133, 0.552067756652832, 1.7294392585754395, 1.1792900562286377, 0.8682112693786621, 0.2618856430053711, 1.8724870681762695, 0.8997373580932617, 0.8082225322723389, 1.1551952362060547, 1.2086009979248047, 0.3894805908203125, 0.8731584548950195, 0.8037090301513672, 0.10169458389282227, 0.37085580825805664, 0.8036870956420898, 0.24021530151367188, 1.2402245998382568, 0.20832014083862305, 1.2618303298950195, 0.09078407287597656], "mean_td_error": 1.0051920413970947, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 26368, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 26368, "last_target_update_ts": 22000, "num_target_updates": 103}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3692.4011481724215, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1849.6098398294582, "robot_1": 1842.791308342964}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1849.6098398294582, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1842.791308342964, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483, 3597.9469909199365, 3463.5359363620073, 3700.9277323560373, 3644.199865993208], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538, 1781.8047240146204, 1712.9073491440474, 1791.1132720114151, 1878.2374911613078], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096, 1816.1422669053181, 1750.6285872179624, 1909.8144603446171, 1765.9623748319011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7497050149913335, "mean_inference_ms": 3.382134755658396, "mean_action_processing_ms": 0.4601790213739109, "mean_env_wait_ms": 0.4654372654445523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007448142225092108, "StateBufferConnector_ms": 0.0025974078611894088, "ViewRequirementAgentConnector_ms": 0.15480843457308682}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3692.4011481724215, "episode_len_mean": 500.0, "episodes_this_iter": 4, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1849.6098398294582, "robot_1": 1842.791308342964}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483, 3597.9469909199365, 3463.5359363620073, 3700.9277323560373, 3644.199865993208], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538, 1781.8047240146204, 1712.9073491440474, 1791.1132720114151, 1878.2374911613078], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096, 1816.1422669053181, 1750.6285872179624, 1909.8144603446171, 1765.9623748319011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7497050149913335, "mean_inference_ms": 3.382134755658396, "mean_action_processing_ms": 0.4601790213739109, "mean_env_wait_ms": 0.4654372654445523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007448142225092108, "StateBufferConnector_ms": 0.0025974078611894088, "ViewRequirementAgentConnector_ms": 0.15480843457308682}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 26368, "num_env_steps_sampled": 22000, "num_env_steps_trained": 26368, "num_env_steps_sampled_this_iter": 400, "num_env_steps_trained_this_iter": 512, "num_env_steps_sampled_throughput_per_sec": 397.2194757916349, "num_env_steps_trained_throughput_per_sec": 508.4409290132927, "timesteps_total": 22000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 525.56, "sample_time_ms": 277.024, "load_time_ms": 0.666, "load_throughput": 384605.568, "learn_time_ms": 34.992, "learn_throughput": 7315.863, "synch_weights_time_ms": 42.038}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 26368, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 26368, "last_target_update_ts": 22000, "num_target_updates": 103}, "done": false, "episodes_total": 44, "training_iteration": 43, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-44", "timestamp": 1742662604, "time_this_iter_s": 1.0232305526733398, "time_total_s": 57.006909132003784, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A774310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 57.006909132003784, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 29.4, "ram_util_percent": 89.9}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1849.6098398294582, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1842.791308342964, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.35635757446289, "actor_loss": -13.806065559387207, "critic_loss": 0.1965964138507843, "alpha_loss": -0.4203997552394867, "alpha_value": 0.969014585018158, "log_alpha_value": -0.03147562965750694, "target_entropy": -8.0, "policy_t": 0.017583949491381645, "mean_q": 8.681779861450195, "max_q": 12.41971206665039, "min_q": 6.413282871246338}, "td_error": [1.103036880493164, 1.4126605987548828, 1.059995174407959, 0.33424901962280273, 0.2409801483154297, 0.08806514739990234, 0.7532753944396973, 0.08280181884765625, 1.4230949878692627, 0.8375635147094727, 0.9744338989257812, 1.9949374198913574, 0.605097770690918, 1.6613264083862305, 1.0046467781066895, 0.9515929222106934, 0.45623183250427246, 0.40260839462280273, 1.1472926139831543, 1.2894024848937988, 0.6900086402893066, 1.5252857208251953, 0.28250741958618164, 0.6387848854064941, 0.9129178524017334, 1.0853347778320312, 1.0014503002166748, 0.38820648193359375, 0.7511885166168213, 0.2720630168914795, 0.08026552200317383, 0.842949390411377, 1.3329761028289795, 1.932878017425537, 0.30353498458862305, 0.9000284671783447, 0.8001418113708496, 1.6231873035430908, 1.6519911289215088, 1.9483256340026855, 1.634565830230713, 0.6016733646392822, 0.7435965538024902, 1.954634666442871, 0.4937121868133545, 0.35554981231689453, 0.26085710525512695, 0.9951834678649902, 0.6227831840515137, 1.744692087173462, 0.399233341217041, 1.3311097621917725, 0.23974967002868652, 0.37557411193847656, 2.452080726623535, 1.4586329460144043, 0.5778293609619141, 0.29445934295654297, 2.3798742294311523, 1.0663814544677734, 0.793914794921875, 2.5510830879211426, 0.12381505966186523, 2.729323148727417, 1.5681543350219727, 1.453251838684082, 0.22450637817382812, 0.886488676071167, 0.2729206085205078, 0.6040425300598145, 1.466627597808838, 0.4031972885131836, 1.3913369178771973, 1.0018267631530762, 0.682499885559082, 0.6998634338378906, 1.9129984378814697, 0.3370680809020996, 0.23198652267456055, 0.17323780059814453, 0.5186491012573242, 0.5535488128662109, 2.086428165435791, 0.20966768264770508, 0.38284993171691895, 0.5537400245666504, 0.3963770866394043, 0.3693089485168457, 0.7937273979187012, 3.5542054176330566, 0.9761333465576172, 2.2486813068389893, 0.70847487449646, 1.0577404499053955, 1.3912346363067627, 0.5119261741638184, 1.187253475189209, 1.7399351596832275, 2.413209915161133, 0.3210482597351074, 0.24306011199951172, 1.4909920692443848, 0.2685868740081787, 0.8738903999328613, 0.40572643280029297, 0.5070886611938477, 0.3528759479522705, 1.902402639389038, 0.7916626930236816, 0.416806697845459, 0.8567750453948975, 0.5437874794006348, 1.4542651176452637, 3.001389741897583, 0.8978538513183594, 0.22713708877563477, 0.7489991188049316, 0.38906145095825195, 0.6375837326049805, 0.7855479717254639, 1.0769641399383545, 1.020277500152588, 1.984971284866333, 1.2164952754974365, 1.0061814785003662, 0.4593775272369385, 0.6566476821899414, 0.2258892059326172], "mean_td_error": 0.9585474133491516, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.259760856628418, "actor_loss": -13.659399032592773, "critic_loss": 0.1534850001335144, "alpha_loss": -0.4176231026649475, "alpha_value": 0.9689952731132507, "log_alpha_value": -0.03149551898241043, "target_entropy": -8.0, "policy_t": -0.030311454087495804, "mean_q": 8.622489929199219, "max_q": 11.990185737609863, "min_q": 6.233774185180664}, "td_error": [1.512892246246338, 1.5932798385620117, 1.3264789581298828, 0.23755884170532227, 0.7565209865570068, 2.66212797164917, 0.8476836681365967, 0.8278951644897461, 0.7038969993591309, 0.9239406585693359, 1.3690285682678223, 1.2489728927612305, 0.5447292327880859, 0.7635672092437744, 2.7988975048065186, 0.3770017623901367, 0.1491560935974121, 1.0504341125488281, 1.6207032203674316, 0.20558500289916992, 0.41672229766845703, 0.21836233139038086, 0.1513962745666504, 0.9951906204223633, 1.6779041290283203, 0.3721346855163574, 2.8629753589630127, 0.5443568229675293, 1.3777034282684326, 1.480936050415039, 0.5437760353088379, 1.1504089832305908, 1.232537031173706, 0.4245023727416992, 1.9436302185058594, 0.48056554794311523, 1.2056429386138916, 1.1977131366729736, 0.8751063346862793, 0.498471736907959, 0.6078629493713379, 0.3790602684020996, 0.39694881439208984, 0.1530756950378418, 1.546743392944336, 0.5218110084533691, 0.8551440238952637, 0.19196176528930664, 0.5167403221130371, 0.17119407653808594, 0.4187793731689453, 0.4541950225830078, 0.7787876129150391, 1.3597888946533203, 0.4344038963317871, 0.3625655174255371, 0.4470076560974121, 0.21845626831054688, 2.147158622741699, 0.6550660133361816, 0.6933956146240234, 0.48542165756225586, 1.8923015594482422, 3.12526273727417, 1.833402156829834, 0.9498333930969238, 1.1104907989501953, 0.2785468101501465, 1.6792998313903809, 0.5914816856384277, 1.3338358402252197, 0.08929920196533203, 2.1555092334747314, 0.2966771125793457, 0.22879338264465332, 1.338447093963623, 0.646970272064209, 1.244511604309082, 1.1019871234893799, 1.1556286811828613, 1.1585774421691895, 1.2355060577392578, 1.3933842182159424, 0.8320188522338867, 2.9671168327331543, 2.53336763381958, 1.0327496528625488, 0.11810016632080078, 1.1964216232299805, 0.631711483001709, 1.4296588897705078, 1.0734457969665527, 0.23514127731323242, 0.14513635635375977, 1.0151054859161377, 0.36564207077026367, 3.089432954788208, 0.44151973724365234, 1.334650993347168, 2.375145435333252, 1.3965444564819336, 0.5910739898681641, 0.4015183448791504, 0.05975914001464844, 0.6509017944335938, 0.681368350982666, 0.6371231079101562, 0.907559871673584, 0.5370345115661621, 0.05333137512207031, 0.6091594696044922, 0.7529869079589844, 0.6949295997619629, 0.7401978969573975, 0.09865188598632812, 1.5187199115753174, 0.7043681144714355, 0.13065004348754883, 0.30657315254211426, 0.6813926696777344, 0.6615633964538574, 0.0790700912475586, 1.7311129570007324, 1.1840190887451172, 0.4976358413696289, 0.32513952255249023, 1.1401066780090332, 0.334014892578125], "mean_td_error": 0.9275670051574707, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 106.0, "diff_num_grad_updates_vs_sampler_policy": 105.0}}, "num_env_steps_sampled": 22600, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 45200, "num_agent_steps_trained": 27136, "last_target_update_ts": 22600, "num_target_updates": 106}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3692.4011481724215, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1849.6098398294582, "robot_1": 1842.791308342964}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1849.6098398294582, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1842.791308342964, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483, 3597.9469909199365, 3463.5359363620073, 3700.9277323560373, 3644.199865993208], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538, 1781.8047240146204, 1712.9073491440474, 1791.1132720114151, 1878.2374911613078], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096, 1816.1422669053181, 1750.6285872179624, 1909.8144603446171, 1765.9623748319011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7497050149913335, "mean_inference_ms": 3.382134755658396, "mean_action_processing_ms": 0.4601790213739109, "mean_env_wait_ms": 0.4654372654445523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007448142225092108, "StateBufferConnector_ms": 0.0025974078611894088, "ViewRequirementAgentConnector_ms": 0.15480843457308682}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3692.4011481724215, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1849.6098398294582, "robot_1": 1842.791308342964}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483, 3597.9469909199365, 3463.5359363620073, 3700.9277323560373, 3644.199865993208], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538, 1781.8047240146204, 1712.9073491440474, 1791.1132720114151, 1878.2374911613078], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096, 1816.1422669053181, 1750.6285872179624, 1909.8144603446171, 1765.9623748319011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7497050149913335, "mean_inference_ms": 3.382134755658396, "mean_action_processing_ms": 0.4601790213739109, "mean_env_wait_ms": 0.4654372654445523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007448142225092108, "StateBufferConnector_ms": 0.0025974078611894088, "ViewRequirementAgentConnector_ms": 0.15480843457308682}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45200, "num_agent_steps_trained": 27136, "num_env_steps_sampled": 22600, "num_env_steps_trained": 27136, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 408.0671578878753, "num_env_steps_trained_throughput_per_sec": 522.3259620964803, "timesteps_total": 22600, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 45200, "timers": {"training_iteration_time_ms": 491.759, "sample_time_ms": 273.358, "load_time_ms": 0.512, "load_throughput": 499670.447, "learn_time_ms": 34.69, "learn_throughput": 7379.588, "synch_weights_time_ms": 11.039}, "counters": {"num_env_steps_sampled": 22600, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 45200, "num_agent_steps_trained": 27136, "last_target_update_ts": 22600, "num_target_updates": 106}, "done": false, "episodes_total": 44, "training_iteration": 44, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-46", "timestamp": 1742662606, "time_this_iter_s": 1.4889533519744873, "time_total_s": 58.49586248397827, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7398B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 58.49586248397827, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 36.6, "ram_util_percent": 89.9}}
{"custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1849.6098398294582, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1842.791308342964, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "episode_media": {}, "info": {"learner": {"robot_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.412003517150879, "actor_loss": -13.9111328125, "critic_loss": 0.19616521894931793, "alpha_loss": -0.43417468667030334, "alpha_value": 0.9681462645530701, "log_alpha_value": -0.03237209469079971, "target_entropy": -8.0, "policy_t": -0.02870846353471279, "mean_q": 8.705690383911133, "max_q": 11.671992301940918, "min_q": 6.406226634979248}, "td_error": [1.2575788497924805, 0.3433079719543457, 0.7606444358825684, 1.3713603019714355, 0.2867422103881836, 1.7763519287109375, 0.5290713310241699, 0.8039979934692383, 1.2489984035491943, 0.9835071563720703, 1.907029151916504, 0.27295923233032227, 0.651461124420166, 0.7202539443969727, 0.12312936782836914, 1.053943157196045, 1.6073296070098877, 0.2771263122558594, 0.2022700309753418, 1.115999698638916, 2.4859395027160645, 2.2020349502563477, 0.823868989944458, 0.2988772392272949, 0.9579806327819824, 0.11502838134765625, 1.0631217956542969, 1.3450679779052734, 0.7798008918762207, 2.7583911418914795, 0.60296630859375, 1.6807188987731934, 1.9765911102294922, 0.9958348274230957, 0.37361669540405273, 1.5352201461791992, 0.06753015518188477, 0.3417809009552002, 0.8725190162658691, 1.1383562088012695, 1.4428095817565918, 1.3024449348449707, 0.4611201286315918, 0.6375565528869629, 1.5909972190856934, 0.20418453216552734, 1.4109604358673096, 1.3665730953216553, 0.9299373626708984, 0.20021700859069824, 0.7272553443908691, 2.6847174167633057, 0.5104732513427734, 1.1581029891967773, 1.1969189643859863, 0.34571385383605957, 0.8910460472106934, 0.35854530334472656, 0.5479316711425781, 0.46427297592163086, 0.6036763191223145, 1.0477790832519531, 0.2848234176635742, 0.9884848594665527, 0.8961806297302246, 1.9082818031311035, 0.3863797187805176, 0.4079008102416992, 2.961456298828125, 1.0957040786743164, 1.0755610466003418, 1.5405828952789307, 0.9654319286346436, 0.36452817916870117, 0.7485766410827637, 0.5533261299133301, 1.7744784355163574, 1.453728437423706, 1.4806849956512451, 1.0878734588623047, 1.3561935424804688, 0.6800026893615723, 0.6446371078491211, 1.083683967590332, 0.17434477806091309, 0.34888267517089844, 0.2689328193664551, 0.14136409759521484, 1.3017258644104004, 1.409421443939209, 0.6473531723022461, 0.7157692909240723, 2.7828989028930664, 1.3946990966796875, 0.15020418167114258, 0.6202855110168457, 0.5484428405761719, 1.675349473953247, 0.1672067642211914, 1.4992351531982422, 0.8769779205322266, 0.26824378967285156, 0.2847294807434082, 1.7616088390350342, 1.0629191398620605, 2.0902156829833984, 0.23279142379760742, 0.43621206283569336, 1.124763011932373, 0.30092763900756836, 0.4495820999145508, 0.2244105339050293, 0.22394466400146484, 1.4516382217407227, 0.33466482162475586, 2.132786750793457, 0.2710533142089844, 1.68406081199646, 0.2913022041320801, 0.5402474403381348, 1.1842975616455078, 0.37236499786376953, 0.07662200927734375, 1.1009197235107422, 0.6595678329467773, 0.6673130989074707, 1.3210477828979492, 0.35205554962158203], "mean_td_error": 0.9308862090110779, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 109.0, "diff_num_grad_updates_vs_sampler_policy": 108.0}, "robot_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.377410888671875, "actor_loss": -13.50776195526123, "critic_loss": 0.17850860953330994, "alpha_loss": -0.4333241581916809, "alpha_value": 0.9681267738342285, "log_alpha_value": -0.0323922261595726, "target_entropy": -8.0, "policy_t": -0.023770906031131744, "mean_q": 8.3739595413208, "max_q": 11.971290588378906, "min_q": 6.031166076660156}, "td_error": [0.7314410209655762, 0.08885979652404785, 1.2578260898590088, 1.27949857711792, 0.7027640342712402, 0.7347960472106934, 1.4099953174591064, 1.0313477516174316, 1.7917687892913818, 2.276655912399292, 0.1291956901550293, 1.2112722396850586, 0.4010019302368164, 1.3292441368103027, 0.170806884765625, 1.8657662868499756, 1.491767406463623, 1.463085412979126, 0.452470064163208, 1.217236042022705, 3.084057331085205, 0.5095968246459961, 0.9579262733459473, 2.831594228744507, 0.8006405830383301, 0.14958953857421875, 1.8779449462890625, 1.0329372882843018, 1.5217738151550293, 0.4349665641784668, 0.47551774978637695, 0.15506410598754883, 0.6564540863037109, 2.1466877460479736, 2.166167974472046, 0.6004195213317871, 1.1669166088104248, 1.7022695541381836, 0.8453946113586426, 1.8997397422790527, 0.933354377746582, 0.47395801544189453, 1.948883295059204, 1.4127628803253174, 1.4074642658233643, 0.9717860221862793, 0.504572868347168, 0.6772112846374512, 0.6002006530761719, 0.804135799407959, 1.0255277156829834, 1.4790194034576416, 1.2909131050109863, 0.23563432693481445, 0.23111486434936523, 1.0573649406433105, 2.0291221141815186, 2.0246663093566895, 0.5960311889648438, 0.04870748519897461, 0.27849912643432617, 1.9695491790771484, 0.3010740280151367, 1.8736190795898438, 0.5253126621246338, 1.0808165073394775, 1.1555566787719727, 0.19905328750610352, 0.34476661682128906, 1.0326182842254639, 0.22036457061767578, 0.17013263702392578, 0.7281863689422607, 1.2127127647399902, 0.8478085994720459, 2.3539023399353027, 0.3334341049194336, 2.0936238765716553, 0.6513152122497559, 2.760572671890259, 1.3556029796600342, 0.7696213722229004, 0.3331124782562256, 1.1743769645690918, 0.3910946846008301, 1.3491134643554688, 0.6495537757873535, 1.2578048706054688, 0.3777003288269043, 0.7672567367553711, 0.8619811534881592, 0.5565361976623535, 0.3543534278869629, 1.626157522201538, 0.18413543701171875, 0.7071595191955566, 0.7002019882202148, 0.35336923599243164, 0.5347232818603516, 0.7664504051208496, 0.2020096778869629, 2.187739849090576, 1.4857234954833984, 1.2948288917541504, 0.5863156318664551, 1.3729345798492432, 0.8744540214538574, 0.1336226463317871, 1.099489450454712, 0.4297361373901367, 1.2329983711242676, 0.844660758972168, 0.7282876968383789, 1.4467356204986572, 2.685985803604126, 0.5489778518676758, 1.0436105728149414, 2.4443345069885254, 0.9418854713439941, 0.2488555908203125, 0.7504191398620605, 2.3172876834869385, 1.6740269660949707, 0.48016357421875, 0.8115015029907227, 0.3633894920349121, 1.9271726608276367, 1.4443509578704834], "mean_td_error": 1.0360126495361328, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 109.0, "diff_num_grad_updates_vs_sampler_policy": 108.0}}, "num_env_steps_sampled": 23200, "num_env_steps_trained": 27904, "num_agent_steps_sampled": 46400, "num_agent_steps_trained": 27904, "last_target_update_ts": 23200, "num_target_updates": 109}, "sampler_results": {"episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3692.4011481724215, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1849.6098398294582, "robot_1": 1842.791308342964}, "custom_metrics": {"('robot_0', 'robot_0')_total_reward_mean": 1849.6098398294582, "('robot_0', 'robot_0')_total_reward_min": 1692.5342464351622, "('robot_0', 'robot_0')_total_reward_max": 2132.997732411978, "('robot_1', 'robot_1')_total_reward_mean": 1842.791308342964, "('robot_1', 'robot_1')_total_reward_min": 1684.608831185319, "('robot_1', 'robot_1')_total_reward_max": 2064.4273586429217}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483, 3597.9469909199365, 3463.5359363620073, 3700.9277323560373, 3644.199865993208], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538, 1781.8047240146204, 1712.9073491440474, 1791.1132720114151, 1878.2374911613078], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096, 1816.1422669053181, 1750.6285872179624, 1909.8144603446171, 1765.9623748319011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7497050149913335, "mean_inference_ms": 3.382134755658396, "mean_action_processing_ms": 0.4601790213739109, "mean_env_wait_ms": 0.4654372654445523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007448142225092108, "StateBufferConnector_ms": 0.0025974078611894088, "ViewRequirementAgentConnector_ms": 0.15480843457308682}}, "episode_reward_max": 4197.425091054894, "episode_reward_min": 3406.6325681456983, "episode_reward_mean": 3692.4011481724215, "episode_len_mean": 500.0, "episodes_this_iter": 0, "policy_reward_min": {"robot_0": 1692.5342464351622, "robot_1": 1684.608831185319}, "policy_reward_max": {"robot_0": 2132.997732411978, "robot_1": 2064.4273586429217}, "policy_reward_mean": {"robot_0": 1849.6098398294582, "robot_1": 1842.791308342964}, "hist_stats": {"episode_reward": [3992.323933405896, 4098.312040329392, 3860.277173712534, 3657.8968682093046, 3705.497314483103, 3857.1073673851447, 4197.425091054894, 3805.075150802486, 3802.5369891713754, 3500.631770524681, 3860.304086049503, 3713.1536423924467, 3880.592019885277, 3695.2430799201347, 3616.5458082492873, 3761.767506250031, 3683.1688804303435, 3450.1503101896874, 3641.368973943013, 3886.552686363975, 3754.5052727616003, 3780.338018526733, 3471.266714353803, 3544.036325251827, 3685.1149150711576, 3729.4395146883967, 3613.680436297335, 3563.6999402694278, 3483.8903122922666, 3533.8667740572337, 3706.081334451907, 3581.601727334921, 3406.6325681456983, 3680.4340158304117, 3927.31571973012, 3661.5343209435737, 3592.5455065880647, 3450.356288562615, 3559.45481687204, 3667.3147791737483, 3597.9469909199365, 3463.5359363620073, 3700.9277323560373, 3644.199865993208], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_robot_0_reward": [1949.88436462052, 2054.0882041437153, 2010.2327776642069, 1808.5343820488142, 1817.9340419958512, 1979.2509997916143, 2132.997732411978, 1954.0412974537157, 1919.5607491212006, 1756.9013879231488, 1896.5667877838014, 1898.0881603983983, 1953.561140610118, 1815.4910387224268, 1779.0400127032367, 1917.5124177607486, 1859.8734810755495, 1742.50893725167, 1830.820967703217, 1902.4481526177751, 1923.4688754063163, 1877.6358967040048, 1763.2631376110096, 1709.0145254221547, 1847.7539177309297, 1941.3914420185492, 1829.099743885282, 1759.0516112804728, 1736.3701502894553, 1739.5055386836282, 1833.4844168613374, 1772.7222324187856, 1692.5342464351622, 1918.2913394186905, 1919.007596558585, 1846.241607731253, 1746.0987103130099, 1765.747457377293, 1773.0425260296042, 1845.708110187538, 1781.8047240146204, 1712.9073491440474, 1791.1132720114151, 1878.2374911613078], "policy_robot_1_reward": [2042.4395687853732, 2044.2238361856778, 1850.0443960483285, 1849.3624861604812, 1887.5632724872485, 1877.8563675935304, 2064.4273586429217, 1851.0338533487727, 1882.9762400501793, 1743.730382601533, 1963.7372982657034, 1815.0654819940444, 1927.030879275164, 1879.7520411977066, 1837.5057955460518, 1844.2550884892844, 1823.295399354793, 1707.6413729380138, 1810.5480062397985, 1984.1045337462058, 1831.036397355288, 1902.7021218227271, 1708.0035767427955, 1835.0217998296746, 1837.3609973402301, 1788.048072669845, 1784.5806924120488, 1804.64832898896, 1747.5201620028115, 1794.3612353736032, 1872.5969175905711, 1808.8794949161331, 1714.0983217105345, 1762.142676411727, 2008.3081231715373, 1815.292713212317, 1846.4467962750603, 1684.608831185319, 1786.4122908424322, 1821.6066689862096, 1816.1422669053181, 1750.6285872179624, 1909.8144603446171, 1765.9623748319011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7497050149913335, "mean_inference_ms": 3.382134755658396, "mean_action_processing_ms": 0.4601790213739109, "mean_env_wait_ms": 0.4654372654445523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007448142225092108, "StateBufferConnector_ms": 0.0025974078611894088, "ViewRequirementAgentConnector_ms": 0.15480843457308682}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46400, "num_agent_steps_trained": 27904, "num_env_steps_sampled": 23200, "num_env_steps_trained": 27904, "num_env_steps_sampled_this_iter": 600, "num_env_steps_trained_this_iter": 768, "num_env_steps_sampled_throughput_per_sec": 402.9124662302685, "num_env_steps_trained_throughput_per_sec": 515.7279567747437, "timesteps_total": 23200, "num_steps_trained_this_iter": 768, "agent_timesteps_total": 46400, "timers": {"training_iteration_time_ms": 494.763, "sample_time_ms": 275.44, "load_time_ms": 0.258, "load_throughput": 991359.823, "learn_time_ms": 34.825, "learn_throughput": 7350.962, "synch_weights_time_ms": 11.046}, "counters": {"num_env_steps_sampled": 23200, "num_env_steps_trained": 27904, "num_agent_steps_sampled": 46400, "num_agent_steps_trained": 27904, "last_target_update_ts": 23200, "num_target_updates": 109}, "done": false, "episodes_total": 44, "training_iteration": 45, "trial_id": "66c5b_00000", "date": "2025-03-22_16-56-47", "timestamp": 1742662607, "time_this_iter_s": 1.506371259689331, "time_total_s": 60.0022337436676, "pid": 15528, "hostname": "Jacob", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "dual-panda-env-v5", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.9, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function DualPandaSACAgent.__init__.<locals>.<lambda> at 0x000002511A7DA8B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 1, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 100, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "twin_q": true, "q_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "policy_model_config": {"fcnet_hiddens": [256, 256], "fcnet_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": null, "custom_model": null, "custom_model_config": {}}, "tau": 0.005, "initial_alpha": 1.0, "target_entropy": "auto", "n_step": 1, "replay_buffer_config": {"_enable_replay_buffer_api": true, "type": "MultiAgentPrioritizedReplayBuffer", "capacity": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "worker_side_prioritization": false}, "store_buffer_in_checkpoints": false, "training_intensity": null, "optimization": {"actor_learning_rate": 0.0003, "critic_learning_rate": 0.0003, "entropy_learning_rate": 0.0003}, "target_network_update_freq": 0, "num_steps_sampled_before_learning_starts": 1500, "_deterministic_loss": false, "_use_beta_distribution": false, "use_state_preprocessor": -1, "worker_side_prioritization": -1, "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"robot_0": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}], "robot_1": [null, "Box(-inf, inf, (21,), float32)", "Box(-1.0, 1.0, (8,), float32)", {}]}, "callbacks": "<class 'agents.dual_sac_agent.MultiAgentRewardCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 60.0022337436676, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 31.35, "ram_util_percent": 90.0}}
